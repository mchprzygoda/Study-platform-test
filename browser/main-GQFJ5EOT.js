import{A as UE,B as $E,C as HE,D as cr,E as Ct,a as q,b as Ee,c as Gf,d as x,e as PE,f as Tc,g as kE,h as OE,i as FE,j as Wf,k as Kf,l as Qf,m as LE,n as VE,o as Yf,p as ia,q as Zf,r as Cc,s as jE,t as BE,u as bc,v as xe,w as Qr,x as dn,y as Sc,z as oa}from"./chunk-KC2S36JU.js";function qE(n,e){return Object.is(n,e)}var Ke=null,Ac=!1,Xf=1,Ji=Symbol("SIGNAL");function he(n){let e=Ke;return Ke=n,e}function ep(){return Ke}var Rc={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function tp(n){if(Ac)throw new Error("");if(Ke===null)return;Ke.consumerOnSignalRead(n);let e=Ke.nextProducerIndex++;if(xc(Ke),e<Ke.producerNode.length&&Ke.producerNode[e]!==n&&sa(Ke)){let t=Ke.producerNode[e];Mc(t,Ke.producerIndexOfThis[e])}Ke.producerNode[e]!==n&&(Ke.producerNode[e]=n,Ke.producerIndexOfThis[e]=sa(Ke)?QE(n,Ke,e):0),Ke.producerLastReadVersion[e]=n.version}function zE(){Xf++}function GE(n){if(!(sa(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Xf)){if(!n.producerMustRecompute(n)&&!ip(n)){Jf(n);return}n.producerRecomputeValue(n),Jf(n)}}function np(n){if(n.liveConsumerNode===void 0)return;let e=Ac;Ac=!0;try{for(let t of n.liveConsumerNode)t.dirty||qM(t)}finally{Ac=e}}function WE(){return Ke?.consumerAllowSignalWrites!==!1}function qM(n){n.dirty=!0,np(n),n.consumerMarkedDirty?.(n)}function Jf(n){n.dirty=!1,n.lastCleanEpoch=Xf}function rp(n){return n&&(n.nextProducerIndex=0),he(n)}function KE(n,e){if(he(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(sa(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Mc(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function ip(n){xc(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(GE(t),r!==t.version))return!0}return!1}function op(n){if(xc(n),sa(n))for(let e=0;e<n.producerNode.length;e++)Mc(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function QE(n,e,t){if(YE(n),n.liveConsumerNode.length===0&&ZE(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=QE(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function Mc(n,e){if(YE(n),n.liveConsumerNode.length===1&&ZE(n))for(let r=0;r<n.producerNode.length;r++)Mc(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];xc(i),i.producerIndexOfThis[r]=e}}function sa(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function xc(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function YE(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function ZE(n){return n.producerNode!==void 0}function zM(){throw new Error}var JE=zM;function GM(n){JE(n)}function sp(n){JE=n}var WM=null;function ap(n,e){WE()||GM(n),n.equal(n.value,e)||(n.value=e,KM(n))}var up=Ee(q({},Rc),{equal:qE,value:void 0,kind:"signal"});function KM(n){n.version++,zE(),np(n),WM?.()}function cp(n){let e=he(null);try{return n()}finally{he(e)}}var lp;function aa(){return lp}function kn(n){let e=lp;return lp=n,e}var Nc=Symbol("NotFound");function ee(n){return typeof n=="function"}function Xi(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Pc=Xi(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Yr(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Le=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ee(r))try{r()}catch(o){e=o instanceof Pc?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{XE(o)}catch(s){e=e??[],s instanceof Pc?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Pc(e)}}add(e){var t;if(e&&e!==this)if(this.closed)XE(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Yr(t,e)}remove(e){let{_finalizers:t}=this;t&&Yr(t,e),e instanceof n&&e._removeParent(this)}};Le.EMPTY=(()=>{let n=new Le;return n.closed=!0,n})();var dp=Le.EMPTY;function kc(n){return n instanceof Le||n&&"closed"in n&&ee(n.remove)&&ee(n.add)&&ee(n.unsubscribe)}function XE(n){ee(n)?n():n.unsubscribe()}var Wt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var eo={setTimeout(n,e,...t){let{delegate:r}=eo;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=eo;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Oc(n){eo.setTimeout(()=>{let{onUnhandledError:e}=Wt;if(e)e(n);else throw n})}function ua(){}var eI=hp("C",void 0,void 0);function tI(n){return hp("E",void 0,n)}function nI(n){return hp("N",n,void 0)}function hp(n,e,t){return{kind:n,value:e,error:t}}var Zr=null;function to(n){if(Wt.useDeprecatedSynchronousErrorHandling){let e=!Zr;if(e&&(Zr={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Zr;if(Zr=null,t)throw r}}else n()}function rI(n){Wt.useDeprecatedSynchronousErrorHandling&&Zr&&(Zr.errorThrown=!0,Zr.error=n)}var Jr=class extends Le{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,kc(e)&&e.add(this)):this.destination=rx}static create(e,t,r){return new On(e,t,r)}next(e){this.isStopped?pp(nI(e),this):this._next(e)}error(e){this.isStopped?pp(tI(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?pp(eI,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},tx=Function.prototype.bind;function fp(n,e){return tx.call(n,e)}var gp=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Fc(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Fc(r)}else Fc(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Fc(t)}}},On=class extends Jr{constructor(e,t,r){super();let i;if(ee(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&Wt.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&fp(e.next,o),error:e.error&&fp(e.error,o),complete:e.complete&&fp(e.complete,o)}):i=e}this.destination=new gp(i)}};function Fc(n){Wt.useDeprecatedSynchronousErrorHandling?rI(n):Oc(n)}function nx(n){throw n}function pp(n,e){let{onStoppedNotification:t}=Wt;t&&eo.setTimeout(()=>t(n,e))}var rx={closed:!0,next:ua,error:nx,complete:ua};var no=typeof Symbol=="function"&&Symbol.observable||"@@observable";function vt(n){return n}function mp(...n){return yp(n)}function yp(n){return n.length===0?vt:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var ce=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=ox(t)?t:new On(t,r,i);return to(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=iI(r),new r((i,o)=>{let s=new On({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[no](){return this}pipe(...t){return yp(t)(this)}toPromise(t){return t=iI(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function iI(n){var e;return(e=n??Wt.Promise)!==null&&e!==void 0?e:Promise}function ix(n){return n&&ee(n.next)&&ee(n.error)&&ee(n.complete)}function ox(n){return n&&n instanceof Jr||ix(n)&&kc(n)}function vp(n){return ee(n?.lift)}function se(n){return e=>{if(vp(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ue(n,e,t,r,i){return new _p(n,e,t,r,i)}var _p=class extends Jr{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function ro(){return se((n,e)=>{let t=null;n._refCount++;let r=ue(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var io=class extends ce{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,vp(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Le;let t=this.getSubject();e.add(this.source.subscribe(ue(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Le.EMPTY)}return e}refCount(){return ro()(this)}};var oI=Xi(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ne=(()=>{class n extends ce{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Lc(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new oI}next(t){to(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){to(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){to(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?dp:(this.currentObservers=null,o.push(t),new Le(()=>{this.currentObservers=null,Yr(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new ce;return t.source=this,t}}return n.create=(e,t)=>new Lc(e,t),n})(),Lc=class extends Ne{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:dp}};var tt=class extends Ne{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var ca={now(){return(ca.delegate||Date).now()},delegate:void 0};var la=class extends Ne{constructor(e=1/0,t=1/0,r=ca){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let c=1;c<r.length&&r[c]<=s;c+=2)a=c;a&&r.splice(0,a+1)}}};var Vc=class extends Le{constructor(e,t){super()}schedule(e,t=0){return this}};var da={setInterval(n,e,...t){let{delegate:r}=da;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=da;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var oo=class extends Vc{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return da.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&da.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Yr(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var so=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};so.now=ca.now;var ao=class extends so{constructor(e,t=so.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var ha=new ao(oo);var jc=class extends oo{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var Bc=class extends ao{};var wp=new Bc(jc);var lt=new ce(n=>n.complete());function sI(n){return n&&ee(n.schedule)}function Ep(n){return n[n.length-1]}function aI(n){return ee(Ep(n))?n.pop():void 0}function hn(n){return sI(Ep(n))?n.pop():void 0}function uI(n,e){return typeof Ep(n)=="number"?n.pop():e}var Uc=n=>n&&typeof n.length=="number"&&typeof n!="function";function $c(n){return ee(n?.then)}function Hc(n){return ee(n[no])}function qc(n){return Symbol.asyncIterator&&ee(n?.[Symbol.asyncIterator])}function zc(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function sx(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Gc=sx();function Wc(n){return ee(n?.[Gc])}function Kc(n){return kE(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Tc(t.read());if(i)return yield Tc(void 0);yield yield Tc(r)}}finally{t.releaseLock()}})}function Qc(n){return ee(n?.getReader)}function Pe(n){if(n instanceof ce)return n;if(n!=null){if(Hc(n))return ax(n);if(Uc(n))return ux(n);if($c(n))return cx(n);if(qc(n))return cI(n);if(Wc(n))return lx(n);if(Qc(n))return dx(n)}throw zc(n)}function ax(n){return new ce(e=>{let t=n[no]();if(ee(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function ux(n){return new ce(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function cx(n){return new ce(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Oc)})}function lx(n){return new ce(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function cI(n){return new ce(e=>{hx(n,e).catch(t=>e.error(t))})}function dx(n){return cI(Kc(n))}function hx(n,e){var t,r,i,o;return PE(this,void 0,void 0,function*(){try{for(t=OE(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function bt(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function fn(n,e=0){return se((t,r)=>{t.subscribe(ue(r,i=>bt(r,n,()=>r.next(i),e),()=>bt(r,n,()=>r.complete(),e),i=>bt(r,n,()=>r.error(i),e)))})}function Fn(n,e=0){return se((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function lI(n,e){return Pe(n).pipe(Fn(e),fn(e))}function dI(n,e){return Pe(n).pipe(Fn(e),fn(e))}function hI(n,e){return new ce(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function fI(n,e){return new ce(t=>{let r;return bt(t,e,()=>{r=n[Gc](),bt(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>ee(r?.return)&&r.return()})}function Yc(n,e){if(!n)throw new Error("Iterable cannot be null");return new ce(t=>{bt(t,e,()=>{let r=n[Symbol.asyncIterator]();bt(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function pI(n,e){return Yc(Kc(n),e)}function gI(n,e){if(n!=null){if(Hc(n))return lI(n,e);if(Uc(n))return hI(n,e);if($c(n))return dI(n,e);if(qc(n))return Yc(n,e);if(Wc(n))return fI(n,e);if(Qc(n))return pI(n,e)}throw zc(n)}function _e(n,e){return e?gI(n,e):Pe(n)}function Y(...n){let e=hn(n);return _e(n,e)}function uo(n,e){let t=ee(n)?n:()=>n,r=i=>i.error(t());return new ce(e?i=>e.schedule(r,0,i):r)}function Ip(n){return!!n&&(n instanceof ce||ee(n.lift)&&ee(n.subscribe))}var Ln=Xi(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function X(n,e){return se((t,r)=>{let i=0;t.subscribe(ue(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:fx}=Array;function px(n,e){return fx(e)?n(...e):n(e)}function mI(n){return X(e=>px(n,e))}var{isArray:gx}=Array,{getPrototypeOf:mx,prototype:yx,keys:vx}=Object;function yI(n){if(n.length===1){let e=n[0];if(gx(e))return{args:e,keys:null};if(_x(e)){let t=vx(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function _x(n){return n&&typeof n=="object"&&mx(n)===yx}function vI(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Zc(...n){let e=hn(n),t=aI(n),{args:r,keys:i}=yI(n);if(r.length===0)return _e([],e);let o=new ce(wx(r,e,i?s=>vI(i,s):vt));return t?o.pipe(mI(t)):o}function wx(n,e,t=vt){return r=>{_I(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let c=0;c<i;c++)_I(e,()=>{let l=_e(n[c],e),h=!1;l.subscribe(ue(r,p=>{o[c]=p,h||(h=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function _I(n,e,t){n?bt(t,n,e):e()}function wI(n,e,t,r,i,o,s,a){let c=[],l=0,h=0,p=!1,m=()=>{p&&!c.length&&!l&&e.complete()},y=A=>l<r?T(A):c.push(A),T=A=>{o&&e.next(A),l++;let N=!1;Pe(t(A,h++)).subscribe(ue(e,V=>{i?.(V),o?y(V):e.next(V)},()=>{N=!0},void 0,()=>{if(N)try{for(l--;c.length&&l<r;){let V=c.shift();s?bt(e,s,()=>T(V)):T(V)}m()}catch(V){e.error(V)}}))};return n.subscribe(ue(e,y,()=>{p=!0,m()})),()=>{a?.()}}function Qe(n,e,t=1/0){return ee(e)?Qe((r,i)=>X((o,s)=>e(r,o,i,s))(Pe(n(r,i))),t):(typeof e=="number"&&(t=e),se((r,i)=>wI(r,i,n,t)))}function Jc(n=1/0){return Qe(vt,n)}function EI(){return Jc(1)}function co(...n){return EI()(_e(n,hn(n)))}function Xc(n){return new ce(e=>{Pe(n()).subscribe(e)})}function Dp(...n){let e=hn(n),t=uI(n,1/0),r=n;return r.length?r.length===1?Pe(r[0]):Jc(t)(_e(r,e)):lt}function dt(n,e){return se((t,r)=>{let i=0;t.subscribe(ue(r,o=>n.call(e,o,i++)&&r.next(o)))})}function lr(n){return se((e,t)=>{let r=null,i=!1,o;r=e.subscribe(ue(t,void 0,void 0,s=>{o=Pe(n(s,lr(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function II(n,e,t,r,i){return(o,s)=>{let a=t,c=e,l=0;o.subscribe(ue(s,h=>{let p=l++;c=a?n(c,h,p):(a=!0,h),r&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}function lo(n,e){return ee(e)?Qe(n,e,1):Qe(n,1)}function dr(n){return se((e,t)=>{let r=!1;e.subscribe(ue(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Vn(n){return n<=0?()=>lt:se((e,t)=>{let r=0;e.subscribe(ue(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Tp(n,e=vt){return n=n??Ex,se((t,r)=>{let i,o=!0;t.subscribe(ue(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function Ex(n,e){return n===e}function el(n=Ix){return se((e,t)=>{let r=!1;e.subscribe(ue(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function Ix(){return new Ln}function fa(n){return se((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Kt(n,e){let t=arguments.length>=2;return r=>r.pipe(n?dt((i,o)=>n(i,o,r)):vt,Vn(1),t?dr(e):el(()=>new Ln))}function ho(n){return n<=0?()=>lt:se((e,t)=>{let r=[];e.subscribe(ue(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Cp(n,e){let t=arguments.length>=2;return r=>r.pipe(n?dt((i,o)=>n(i,o,r)):vt,ho(1),t?dr(e):el(()=>new Ln))}function pa(){return se((n,e)=>{let t,r=!1;n.subscribe(ue(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function Xr(n,e){return se(II(n,e,arguments.length>=2,!0))}function DI(n={}){let{connector:e=()=>new Ne,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return o=>{let s,a,c,l=0,h=!1,p=!1,m=()=>{a?.unsubscribe(),a=void 0},y=()=>{m(),s=c=void 0,h=p=!1},T=()=>{let A=s;y(),A?.unsubscribe()};return se((A,N)=>{l++,!p&&!h&&m();let V=c=c??e();N.add(()=>{l--,l===0&&!p&&!h&&(a=bp(T,i))}),V.subscribe(N),!s&&l>0&&(s=new On({next:H=>V.next(H),error:H=>{p=!0,m(),a=bp(y,t,H),V.error(H)},complete:()=>{h=!0,m(),a=bp(y,r),V.complete()}}),Pe(A).subscribe(s))})(o)}}function bp(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new On({next:()=>{r.unsubscribe(),n()}});return Pe(e(...t)).subscribe(r)}function tl(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,DI({connector:()=>new la(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function ei(...n){let e=hn(n);return se((t,r)=>{(e?co(n,t,e):co(n,t)).subscribe(r)})}function je(n,e){return se((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(ue(r,c=>{i?.unsubscribe();let l=0,h=o++;Pe(n(c,h)).subscribe(i=ue(r,p=>r.next(e?e(c,p,h,l++):p),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function nl(n,e){return ee(e)?je(()=>n,e):je(()=>n)}function Sp(n){return se((e,t)=>{Pe(n).subscribe(ue(t,()=>t.complete(),ua)),!t.closed&&e.subscribe(t)})}function nt(n,e,t){let r=ee(n)||e||t?{next:n,error:e,complete:t}:n;return r?se((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(ue(o,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),o.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),o.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):vt}var K=class extends Error{code;constructor(e,t){super(Tx(e,t)),this.code=e}};function Dx(n){return`NG0${Math.abs(n)}`}function Tx(n,e){return`${Dx(n)}${e?": "+e:""}`}var uD=Symbol("InputSignalNode#UNSET"),Cx=Ee(q({},up),{transformFn:void 0,applyValueToInputSignal(n,e){ap(n,e)}});function cD(n,e){let t=Object.create(Cx);t.value=n,t.transformFn=e?.transform;function r(){if(tp(t),t.value===uD){let i=null;throw new K(-950,i)}return t.value}return r[Ji]=t,r}function Ra(n){return{toString:n}.toString()}var rl="__parameters__";function bx(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function Sx(n,e,t){return Ra(()=>{let r=bx(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(c,l,h){let p=c.hasOwnProperty(rl)?c[rl]:Object.defineProperty(c,rl,{value:[]})[rl];for(;p.length<=h;)p.push(null);return(p[h]=p[h]||[]).push(s),c}}return i.prototype.ngMetadataName=n,i.annotationCls=i,i})}function Ce(n){for(let e in n)if(n[e]===Ce)return e;throw Error("Could not find renamed property on target object.")}function Pt(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Pt).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function TI(n,e){return n?e?`${n} ${e}`:n:e||""}var Ax=Ce({__forward_ref__:Ce});function lD(n){return n.__forward_ref__=lD,n.toString=function(){return Pt(this())},n}function jt(n){return dD(n)?n():n}function dD(n){return typeof n=="function"&&n.hasOwnProperty(Ax)&&n.__forward_ref__===lD}function Q(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Bn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Pl(n){return CI(n,fD)||CI(n,pD)}function hD(n){return Pl(n)!==null}function CI(n,e){return n.hasOwnProperty(e)?n[e]:null}function Rx(n){let e=n&&(n[fD]||n[pD]);return e||null}function bI(n){return n&&(n.hasOwnProperty(SI)||n.hasOwnProperty(Mx))?n[SI]:null}var fD=Ce({\u0275prov:Ce}),SI=Ce({\u0275inj:Ce}),pD=Ce({ngInjectableDef:Ce}),Mx=Ce({ngInjectorDef:Ce}),G=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Q({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function gD(n){return n&&!!n.\u0275providers}var xx=Ce({\u0275cmp:Ce}),Nx=Ce({\u0275dir:Ce}),Px=Ce({\u0275pipe:Ce}),kx=Ce({\u0275mod:Ce}),cl=Ce({\u0275fac:Ce}),va=Ce({__NG_ELEMENT_ID__:Ce}),AI=Ce({__NG_ENV_ID__:Ce});function Lp(n){return typeof n=="string"?n:n==null?"":String(n)}function Ox(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Lp(n)}function mD(n,e){throw new K(-200,n)}function Eg(n,e){throw new K(-201,!1)}var oe=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(oe||{}),Vp;function yD(){return Vp}function St(n){let e=Vp;return Vp=n,e}function vD(n,e,t){let r=Pl(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&oe.Optional)return null;if(e!==void 0)return e;Eg(n,"Injector")}var Fx={},ti=Fx,jp="__NG_DI_FLAG__",ll=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=t;return this.injector.get(e,r.optional?Nc:ti,r)}},dl="ngTempTokenPath",Lx="ngTokenPath",Vx=/\n/gm,jx="\u0275",RI="__source";function Bx(n,e=oe.Default){if(aa()===void 0)throw new K(-203,!1);if(aa()===null)return vD(n,void 0,e);{let t=aa(),r;return t instanceof ll?r=t.injector:r=t,r.get(n,e&oe.Optional?null:void 0,e)}}function U(n,e=oe.Default){return(yD()||Bx)(jt(n),e)}function O(n,e=oe.Default){return U(n,kl(e))}function kl(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Bp(n){let e=[];for(let t=0;t<n.length;t++){let r=jt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new K(900,!1);let i,o=oe.Default;for(let s=0;s<r.length;s++){let a=r[s],c=$x(a);typeof c=="number"?c===-1?i=a.token:o|=c:i=a}e.push(U(i,o))}else e.push(U(r))}return e}function Ux(n,e){return n[jp]=e,n.prototype[jp]=e,n}function $x(n){return n[jp]}function Hx(n,e,t,r){let i=n[dl];throw e[RI]&&i.unshift(e[RI]),n.message=qx(`
`+n.message,i,t,r),n[Lx]=i,n[dl]=null,n}function qx(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==jx?n.slice(2):n;let i=Pt(e);if(Array.isArray(e))i=e.map(Pt).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):Pt(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(Vx,`
  `)}`}var _D=Ux(Sx("Optional"),8);function ii(n,e){let t=n.hasOwnProperty(cl);return t?n[cl]:null}function Ig(n,e){n.forEach(t=>Array.isArray(t)?Ig(t,e):e(t))}function wD(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function hl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var yo={},pn=[],_a=new G(""),ED=new G("",-1),ID=new G(""),fl=class{get(e,t=ti){if(t===ti){let r=new Error(`NullInjectorError: No provider for ${Pt(e)}!`);throw r.name="NullInjectorError",r}return t}};function DD(n,e){let t=n[kx]||null;if(!t&&e===!0)throw new Error(`Type ${Pt(n)} does not have '\u0275mod' property.`);return t}function vo(n){return n[xx]||null}function zx(n){return n[Nx]||null}function Gx(n){return n[Px]||null}function TD(n){return{\u0275providers:n}}function Dg(...n){return{\u0275providers:CD(!0,n),\u0275fromNgModule:!0}}function CD(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return Ig(e,s=>{let a=s;Up(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&bD(i,o),t}function bD(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Tg(i,o=>{e(o,r)})}}function Up(n,e,t,r){if(n=jt(n),!n)return!1;let i=null,o=bI(n),s=!o&&vo(n);if(!o&&!s){let c=n.ngModule;if(o=bI(c),o)i=c;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of c)Up(l,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let l;try{Ig(o.imports,h=>{Up(h,e,t,r)&&(l||=[],l.push(h))})}finally{}l!==void 0&&bD(l,e)}if(!a){let l=ii(i)||(()=>new i);e({provide:i,useFactory:l,deps:pn},i),e({provide:ID,useValue:i,multi:!0},i),e({provide:_a,useValue:()=>U(i),multi:!0},i)}let c=o.providers;if(c!=null&&!a){let l=n;Tg(c,h=>{e(h,l)})}}else return!1;return i!==n&&n.providers!==void 0}function Tg(n,e){for(let t of n)gD(t)&&(t=t.\u0275providers),Array.isArray(t)?Tg(t,e):e(t)}var Wx=Ce({provide:String,useValue:Ce});function SD(n){return n!==null&&typeof n=="object"&&Wx in n}function Kx(n){return!!(n&&n.useExisting)}function Qx(n){return!!(n&&n.useFactory)}function $p(n){return typeof n=="function"}var Ol=new G(""),il={},MI={},Ap;function Cg(){return Ap===void 0&&(Ap=new fl),Ap}var Ye=class{},wa=class extends Ye{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,qp(e,s=>this.processProvider(s)),this.records.set(ED,fo(void 0,this)),i.has("environment")&&this.records.set(Ye,fo(void 0,this));let o=this.records.get(Ol);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(ID,pn,oe.Self))}retrieve(e,t){let r=t;return this.get(e,r.optional?Nc:ti,r)}destroy(){ma(this),this._destroyed=!0;let e=he(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),he(e)}}onDestroy(e){return ma(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){ma(this);let t=kn(this),r=St(void 0),i;try{return e()}finally{kn(t),St(r)}}get(e,t=ti,r=oe.Default){if(ma(this),e.hasOwnProperty(AI))return e[AI](this);r=kl(r);let i,o=kn(this),s=St(void 0);try{if(!(r&oe.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=tN(e)&&Pl(e);l&&this.injectableDefInScope(l)?c=fo(Hp(e),il):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c,r)}let a=r&oe.Self?Cg():this.parent;return t=r&oe.Optional&&t===ti?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[dl]=a[dl]||[]).unshift(Pt(e)),o)throw a;return Hx(a,e,"R3InjectorError",this.source)}else throw a}finally{St(s),kn(o)}}resolveInjectorInitializers(){let e=he(null),t=kn(this),r=St(void 0),i;try{let o=this.get(_a,pn,oe.Self);for(let s of o)s()}finally{kn(t),St(r),he(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Pt(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=jt(e);let t=$p(e)?e:jt(e&&e.provide),r=Zx(e);if(!$p(e)&&e.multi===!0){let i=this.records.get(t);i||(i=fo(void 0,il,!0),i.factory=()=>Bp(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let i=he(null);try{return t.value===MI?mD(Pt(e)):t.value===il&&(t.value=MI,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&eN(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{he(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=jt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Hp(n){let e=Pl(n),t=e!==null?e.factory:ii(n);if(t!==null)return t;if(n instanceof G)throw new K(204,!1);if(n instanceof Function)return Yx(n);throw new K(204,!1)}function Yx(n){if(n.length>0)throw new K(204,!1);let t=Rx(n);return t!==null?()=>t.factory(n):()=>new n}function Zx(n){if(SD(n))return fo(void 0,n.useValue);{let e=Jx(n);return fo(e,il)}}function Jx(n,e,t){let r;if($p(n)){let i=jt(n);return ii(i)||Hp(i)}else if(SD(n))r=()=>jt(n.useValue);else if(Qx(n))r=()=>n.useFactory(...Bp(n.deps||[]));else if(Kx(n))r=(i,o)=>U(jt(n.useExisting),o!==void 0&&o&oe.Optional?oe.Optional:void 0);else{let i=jt(n&&(n.useClass||n.provide));if(Xx(n))r=()=>new i(...Bp(n.deps));else return ii(i)||Hp(i)}return r}function ma(n){if(n.destroyed)throw new K(205,!1)}function fo(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Xx(n){return!!n.deps}function eN(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function tN(n){return typeof n=="function"||typeof n=="object"&&n instanceof G}function qp(n,e){for(let t of n)Array.isArray(t)?qp(t,e):t&&gD(t)?qp(t.\u0275providers,e):e(t)}function Ht(n,e){let t;n instanceof wa?(ma(n),t=n):t=new ll(n);let r,i=kn(t),o=St(void 0);try{return e()}finally{kn(i),St(o)}}function AD(){return yD()!==void 0||aa()!=null}function RD(n){if(!AD())throw new K(-203,!1)}function nN(n){return typeof n=="function"}var Un=0,le=1,ae=2,Et=3,Yt=4,Jt=5,Ea=6,xI=7,_t=8,Ia=9,fr=10,Ut=11,Da=12,NI=13,Ma=14,Zt=15,_o=16,po=17,wo=18,Fl=19,MD=20,hr=21,Rp=22,pl=23,Bt=24,Mp=25,$t=26,xD=1;var oi=7,gl=8,ml=9,wt=10;function ni(n){return Array.isArray(n)&&typeof n[xD]=="object"}function $n(n){return Array.isArray(n)&&n[xD]===!0}function ND(n){return(n.flags&4)!==0}function Ll(n){return n.componentOffset>-1}function PD(n){return(n.flags&1)===1}function li(n){return!!n.template}function yl(n){return(n[ae]&512)!==0}function To(n){return(n[ae]&256)===256}var zp=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function kD(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var bg=(()=>{let n=()=>OD;return n.ngInherit=!0,n})();function OD(n){return n.type.prototype.ngOnChanges&&(n.setInput=iN),rN}function rN(){let n=LD(this),e=n?.current;if(e){let t=n.previous;if(t===yo)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function iN(n,e,t,r,i){let o=this.declaredInputs[r],s=LD(n)||oN(n,{previous:yo,current:null}),a=s.current||(s.current={}),c=s.previous,l=c[o];a[o]=new zp(l&&l.currentValue,t,c===yo),kD(n,e,i,t)}var FD="__ngSimpleChanges__";function LD(n){return n[FD]||null}function oN(n,e){return n[FD]=e}var PI=null;var Re=function(n,e=null,t){PI?.(n,e,t)},sN="svg",aN="math";function jn(n){for(;Array.isArray(n);)n=n[Un];return n}function uN(n,e){return jn(e[n])}function di(n,e){return jn(e[n.index])}function VD(n,e){return n.data[e]}function cN(n,e){return n[e]}function si(n,e){let t=e[n];return ni(t)?t:t[Un]}function Sg(n){return(n[ae]&128)===128}function lN(n){return $n(n[Et])}function Ta(n,e){return e==null?null:n[e]}function jD(n){n[po]=0}function BD(n){n[ae]&1024||(n[ae]|=1024,Sg(n)&&jl(n))}function Vl(n){return!!(n[ae]&9216||n[Bt]?.dirty)}function Gp(n){n[fr].changeDetectionScheduler?.notify(8),n[ae]&64&&(n[ae]|=1024),Vl(n)&&jl(n)}function jl(n){n[fr].changeDetectionScheduler?.notify(0);let e=ai(n);for(;e!==null&&!(e[ae]&8192||(e[ae]|=8192,!Sg(e)));)e=ai(e)}function UD(n,e){if(To(n))throw new K(911,!1);n[hr]===null&&(n[hr]=[]),n[hr].push(e)}function dN(n,e){if(n[hr]===null)return;let t=n[hr].indexOf(e);t!==-1&&n[hr].splice(t,1)}function ai(n){let e=n[Et];return $n(e)?e[Et]:e}var ye={lFrame:QD(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Wp=!1;function hN(){return ye.lFrame.elementDepthCount}function fN(){ye.lFrame.elementDepthCount++}function pN(){ye.lFrame.elementDepthCount--}function $D(){return ye.bindingsEnabled}function gN(){return ye.skipHydrationRootTNode!==null}function mN(n){return ye.skipHydrationRootTNode===n}function yN(){ye.skipHydrationRootTNode=null}function rt(){return ye.lFrame.lView}function Co(){return ye.lFrame.tView}function hi(){let n=HD();for(;n!==null&&n.type===64;)n=n.parent;return n}function HD(){return ye.lFrame.currentTNode}function vN(){let n=ye.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function xa(n,e){let t=ye.lFrame;t.currentTNode=n,t.isParent=e}function qD(){return ye.lFrame.isParent}function _N(){ye.lFrame.isParent=!1}function zD(){return Wp}function kI(n){let e=Wp;return Wp=n,e}function wN(){let n=ye.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function EN(){return ye.lFrame.bindingIndex}function IN(n){return ye.lFrame.bindingIndex=n}function DN(){return ye.lFrame.bindingIndex++}function TN(n){let e=ye.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function CN(){return ye.lFrame.inI18n}function bN(n,e){let t=ye.lFrame;t.bindingIndex=t.bindingRootIndex=n,Kp(e)}function SN(){return ye.lFrame.currentDirectiveIndex}function Kp(n){ye.lFrame.currentDirectiveIndex=n}function GD(n){ye.lFrame.currentQueryIndex=n}function AN(n){let e=n[le];return e.type===2?e.declTNode:e.type===1?n[Jt]:null}function WD(n,e,t){if(t&oe.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&oe.Host);)if(i=AN(o),i===null||(o=o[Ma],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=ye.lFrame=KD();return r.currentTNode=e,r.lView=n,!0}function Ag(n){let e=KD(),t=n[le];ye.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function KD(){let n=ye.lFrame,e=n===null?null:n.child;return e===null?QD(n):e}function QD(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function YD(){let n=ye.lFrame;return ye.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var ZD=YD;function Rg(){let n=YD();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Bl(){return ye.lFrame.selectedIndex}function ui(n){ye.lFrame.selectedIndex=n}function RN(){return ye.lFrame.currentNamespace}var JD=!0;function Mg(){return JD}function xg(n){JD=n}function MN(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=OD(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function XD(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:h}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function ol(n,e,t){eT(n,e,3,t)}function sl(n,e,t,r){(n[ae]&3)===t&&eT(n,e,t,r)}function xp(n,e){let t=n[ae];(t&3)===e&&(t&=16383,t+=1,n[ae]=t)}function eT(n,e,t,r){let i=r!==void 0?n[po]&65535:0,o=r??-1,s=e.length-1,a=0;for(let c=i;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[po]+=65536),(a<o||o==-1)&&(xN(n,t,e,c),n[po]=(n[po]&4294901760)+c+2),c++}function OI(n,e){Re(4,n,e);let t=he(null);try{e.call(n)}finally{he(t),Re(5,n,e)}}function xN(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[ae]>>14<n[po]>>16&&(n[ae]&3)===e&&(n[ae]+=16384,OI(a,o)):OI(a,o)}var mo=-1,Ca=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=r}};function NN(n){return(n.flags&8)!==0}function PN(n){return(n.flags&16)!==0}function kN(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];FN(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function ON(n){return n===3||n===4||n===6}function FN(n){return n.charCodeAt(0)===64}function Ng(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?FI(n,t,i,null,e[++r]):FI(n,t,i,null,null))}}return n}function FI(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){i!==null&&(n[o+1]=i);return}o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),i!==null&&n.splice(o++,0,i)}function tT(n){return n!==mo}function vl(n){return n&32767}function LN(n){return n>>16}function _l(n,e){let t=LN(n),r=e;for(;t>0;)r=r[Ma],t--;return r}var Qp=!0;function wl(n){let e=Qp;return Qp=n,e}var VN=256,nT=VN-1,rT=5,jN=0,gn={};function BN(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(va)&&(r=t[va]),r==null&&(r=t[va]=jN++);let i=r&nT,o=1<<i;e.data[n+(i>>rT)]|=o}function iT(n,e){let t=oT(n,e);if(t!==-1)return t;let r=e[le];r.firstCreatePass&&(n.injectorIndex=e.length,Np(r.data,n),Np(e,null),Np(r.blueprint,null));let i=Pg(n,e),o=n.injectorIndex;if(tT(i)){let s=vl(i),a=_l(i,e),c=a[le].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|c[s+l]}return e[o+8]=i,o}function Np(n,e){n.push(0,0,0,0,0,0,0,0,e)}function oT(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Pg(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=lT(i),r===null)return mo;if(t++,i=i[Ma],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return mo}function UN(n,e,t){BN(n,e,t)}function sT(n,e,t){if(t&oe.Optional||n!==void 0)return n;Eg(e,"NodeInjector")}function aT(n,e,t,r){if(t&oe.Optional&&r===void 0&&(r=null),(t&(oe.Self|oe.Host))===0){let i=n[Ia],o=St(void 0);try{return i?i.get(e,r,t&oe.Optional):vD(e,r,t&oe.Optional)}finally{St(o)}}return sT(r,e,t)}function uT(n,e,t,r=oe.Default,i){if(n!==null){if(e[ae]&2048&&!(r&oe.Self)){let s=GN(n,e,t,r,gn);if(s!==gn)return s}let o=cT(n,e,t,r,gn);if(o!==gn)return o}return aT(e,t,r,i)}function cT(n,e,t,r,i){let o=qN(t);if(typeof o=="function"){if(!WD(e,n,r))return r&oe.Host?sT(i,t,r):aT(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&oe.Optional))Eg(t);else return s}finally{ZD()}}else if(typeof o=="number"){let s=null,a=oT(n,e),c=mo,l=r&oe.Host?e[Zt][Jt]:null;for((a===-1||r&oe.SkipSelf)&&(c=a===-1?Pg(n,e):e[a+8],c===mo||!VI(r,!1)?a=-1:(s=e[le],a=vl(c),e=_l(c,e)));a!==-1;){let h=e[le];if(LI(o,a,h.data)){let p=$N(a,e,t,s,r,l);if(p!==gn)return p}c=e[a+8],c!==mo&&VI(r,e[le].data[a+8]===l)&&LI(o,a,e)?(s=h,a=vl(c),e=_l(c,e)):a=-1}}return i}function $N(n,e,t,r,i,o){let s=e[le],a=s.data[n+8],c=r==null?Ll(a)&&Qp:r!=s&&(a.type&3)!==0,l=i&oe.Host&&o===a,h=HN(a,s,t,c,l);return h!==null?Yp(e,s,h,a,i):gn}function HN(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,c=n.directiveStart,l=n.directiveEnd,h=o>>20,p=r?a:a+h,m=i?a+h:l;for(let y=p;y<m;y++){let T=s[y];if(y<c&&t===T||y>=c&&T.type===t)return y}if(i){let y=s[c];if(y&&li(y)&&y.type===t)return c}return null}function Yp(n,e,t,r,i){let o=n[t],s=e.data;if(o instanceof Ca){let a=o;a.resolving&&mD(Ox(s[t]));let c=wl(a.canSeeViewProviders);a.resolving=!0;let l,h=a.injectImpl?St(a.injectImpl):null,p=WD(n,r,oe.Default);try{o=n[t]=a.factory(void 0,i,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&MN(t,s[t],e)}finally{h!==null&&St(h),wl(c),a.resolving=!1,ZD()}}return o}function qN(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(va)?n[va]:void 0;return typeof e=="number"?e>=0?e&nT:zN:e}function LI(n,e,t){let r=1<<n;return!!(t[e+(n>>rT)]&r)}function VI(n,e){return!(n&oe.Self)&&!(n&oe.Host&&e)}var ri=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return uT(this._tNode,this._lView,e,kl(r),t)}};function zN(){return new ri(hi(),rt())}function kg(n){return Ra(()=>{let e=n.prototype.constructor,t=e[cl]||Zp(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[cl]||Zp(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function Zp(n){return dD(n)?()=>{let e=Zp(jt(n));return e&&e()}:ii(n)}function GN(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[ae]&2048&&!yl(s);){let a=cT(o,s,t,r|oe.Self,gn);if(a!==gn)return a;let c=o.parent;if(!c){let l=s[MD];if(l){let h=l.get(t,gn,r);if(h!==gn)return h}c=lT(s),s=s[Ma]}o=c}return i}function lT(n){let e=n[le],t=e.type;return t===2?e.declTNode:t===1?n[Jt]:null}function jI(n,e=null,t=null,r){let i=dT(n,e,t,r);return i.resolveInjectorInitializers(),i}function dT(n,e=null,t=null,r,i=new Set){let o=[t||pn,Dg(n)];return r=r||(typeof n=="object"?void 0:Pt(n)),new wa(o,e||Cg(),r||null,i)}var mn=class n{static THROW_IF_NOT_FOUND=ti;static NULL=new fl;static create(e,t){if(Array.isArray(e))return jI({name:""},t,e,"");{let r=e.name??"";return jI({name:r},e.parent,e.providers,r)}}static \u0275prov=Q({token:n,providedIn:"any",factory:()=>U(ED)});static __NG_ELEMENT_ID__=-1};var WN=new G("");WN.__NG_ELEMENT_ID__=n=>{let e=hi();if(e===null)throw new K(204,!1);if(e.type&2)return e.value;if(n&oe.Optional)return null;throw new K(204,!1)};var hT=!1,Na=(()=>{class n{static __NG_ELEMENT_ID__=KN;static __NG_ENV_ID__=t=>t}return n})(),Jp=class extends Na{_lView;constructor(e){super(),this._lView=e}onDestroy(e){let t=this._lView;return To(t)?(e(),()=>{}):(UD(t,e),()=>dN(t,e))}};function KN(){return new Jp(rt())}var Eo=class{},fT=new G("",{providedIn:"root",factory:()=>!1});var pT=new G(""),gT=new G(""),fi=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new tt(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=Q({token:n,providedIn:"root",factory:()=>new n})}return n})(),Og=(()=>{class n{internalPendingTasks=O(fi);scheduler=O(Eo);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){return x(this,null,function*(){let r=this.add();try{return yield t()}finally{r()}})}static \u0275prov=Q({token:n,providedIn:"root",factory:()=>new n})}return n})(),Xp=class extends Ne{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,AD()&&(this.destroyRef=O(Na,{optional:!0})??void 0,this.pendingTasks=O(fi,{optional:!0})??void 0)}emit(e){let t=he(null);try{super.next(e)}finally{he(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof Le&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},At=Xp;function El(...n){}function mT(n){let e,t;function r(){n=El;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function BI(n){return queueMicrotask(()=>n()),()=>{n=El}}var Fg="isAngularZone",Il=Fg+"_ID",QN=0,Te=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new At(!1);onMicrotaskEmpty=new At(!1);onStable=new At(!1);onError=new At(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=hT}=e;if(typeof Zone>"u")throw new K(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,JN(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Fg)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new K(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new K(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,YN,El,El);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},YN={};function Lg(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function ZN(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){mT(()=>{n.callbackScheduled=!1,eg(n),n.isCheckStableRunning=!0,Lg(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),eg(n)}function JN(n){let e=()=>{ZN(n)},t=QN++;n._inner=n._inner.fork({name:"angular",properties:{[Fg]:!0,[Il]:t,[Il+t]:!0},onInvokeTask:(r,i,o,s,a,c)=>{if(XN(c))return r.invokeTask(o,s,a,c);try{return UI(n),r.invokeTask(o,s,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),$I(n)}},onInvoke:(r,i,o,s,a,c,l)=>{try{return UI(n),r.invoke(o,s,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!eP(c)&&e(),$I(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,eg(n),Lg(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function eg(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function UI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function $I(n){n._nesting--,Lg(n)}var tg=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new At;onMicrotaskEmpty=new At;onStable=new At;onError=new At;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function XN(n){return yT(n,"__ignore_ng_zone__")}function eP(n){return yT(n,"__scheduler_tick__")}function yT(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var pr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},tP=new G("",{providedIn:"root",factory:()=>{let n=O(Te),e=O(pr);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function HI(n,e){return cD(n,e)}function nP(n){return cD(uD,n)}var vT=(HI.required=nP,HI);function rP(){return Vg(hi(),rt())}function Vg(n,e){return new _T(di(n,e))}var _T=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=rP}return n})();function wT(n){return(n.flags&128)===128}var ET=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(ET||{}),IT=new Map,iP=0;function oP(){return iP++}function sP(n){IT.set(n[Fl],n)}function ng(n){IT.delete(n[Fl])}var qI="__ngContext__";function Pa(n,e){ni(e)?(n[qI]=e[Fl],sP(e)):n[qI]=e}function DT(n){return CT(n[Da])}function TT(n){return CT(n[Yt])}function CT(n){for(;n!==null&&!$n(n);)n=n[Yt];return n}var rg;function bT(n){rg=n}function aP(){if(rg!==void 0)return rg;if(typeof document<"u")return document;throw new K(210,!1)}var jg=new G("",{providedIn:"root",factory:()=>uP}),uP="ng",Bg=new G(""),Xt=new G("",{providedIn:"platform",factory:()=>"unknown"});var Ug=new G("",{providedIn:"root",factory:()=>aP().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var cP="h",lP="b";var ST=!1,dP=new G("",{providedIn:"root",factory:()=>ST});var AT=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(AT||{}),Ul=new G(""),zI=new Set;function $g(n){zI.has(n)||(zI.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var hP=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=Q({token:n,providedIn:"root",factory:()=>new n})}return n})();var fP=()=>null;function RT(n,e,t=!1){return fP(n,e,t)}function MT(n,e){let t=n.contentQueries;if(t!==null){let r=he(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];GD(o),a.contentQueries(2,e[s],s)}}}finally{he(r)}}}function ig(n,e,t){GD(0);let r=he(null);try{e(n,t)}finally{he(r)}}function xT(n,e,t){if(ND(e)){let r=he(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{he(r)}}}var yn=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(yn||{});function NT(n){return n instanceof Function?n():n}function pP(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}var PT="ng-template";function gP(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&pP(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Hg(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function Hg(n){return n.type===4&&n.value!==PT}function mP(n,e,t){let r=n.type===4&&!t?PT:n.value;return e===r}function yP(n,e,t){let r=4,i=n.attrs,o=i!==null?wP(i):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!Qt(r)&&!Qt(c))return!1;if(s&&Qt(c))continue;s=!1,r=c|r&1;continue}if(!s)if(r&4){if(r=2|r&1,c!==""&&!mP(n,c,t)||c===""&&e.length===1){if(Qt(r))return!1;s=!0}}else if(r&8){if(i===null||!gP(n,i,c,t)){if(Qt(r))return!1;s=!0}}else{let l=e[++a],h=vP(c,i,Hg(n),t);if(h===-1){if(Qt(r))return!1;s=!0;continue}if(l!==""){let p;if(h>o?p="":p=i[h+1].toLowerCase(),r&2&&l!==p){if(Qt(r))return!1;s=!0}}}}return Qt(r)||s}function Qt(n){return(n&1)===0}function vP(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return EP(e,n)}function _P(n,e,t=!1){for(let r=0;r<e.length;r++)if(yP(n,e[r],t))return!0;return!1}function wP(n){for(let e=0;e<n.length;e++){let t=n[e];if(ON(t))return e}return n.length}function EP(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function GI(n,e){return n?":not("+e.trim()+")":e}function IP(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Qt(s)&&(e+=GI(o,i),i=""),r=s,o=o||!Qt(r);t++}return i!==""&&(e+=GI(o,i)),e}function DP(n){return n.map(IP).join(",")}function TP(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Qt(i))break;i=o}r++}return t.length&&e.push(1,...t),e}var ka={};function CP(n,e){return n.createText(e)}function bP(n,e,t){n.setValue(e,t)}function kT(n,e,t){return n.createElement(e,t)}function Dl(n,e,t,r,i){n.insertBefore(e,t,r,i)}function OT(n,e,t){n.appendChild(e,t)}function WI(n,e,t,r,i){r!==null?Dl(n,e,t,r,i):OT(n,e,t)}function SP(n,e,t){n.removeChild(null,e,t)}function AP(n,e,t){n.setAttribute(e,"style",t)}function RP(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function FT(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&kN(n,e,r),i!==null&&RP(n,e,i),o!==null&&AP(n,e,o)}function qg(n,e,t,r,i,o,s,a,c,l,h){let p=$t+r,m=p+i,y=MP(p,m),T=typeof l=="function"?l():l;return y[le]={type:n,blueprint:y,template:t,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:T,incompleteFirstPass:!1,ssrId:h}}function MP(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:ka);return t}function xP(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=qg(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function zg(n,e,t,r,i,o,s,a,c,l,h){let p=e.blueprint.slice();return p[Un]=i,p[ae]=r|4|128|8|64|1024,(l!==null||n&&n[ae]&2048)&&(p[ae]|=2048),jD(p),p[Et]=p[Ma]=n,p[_t]=t,p[fr]=s||n&&n[fr],p[Ut]=a||n&&n[Ut],p[Ia]=c||n&&n[Ia]||null,p[Jt]=o,p[Fl]=oP(),p[Ea]=h,p[MD]=l,p[Zt]=e.type==2?n[Zt]:p,p}function NP(n,e,t){let r=di(e,n),i=xP(t),o=n[fr].rendererFactory,s=Gg(n,zg(n,i,null,LT(t),r,e,null,o.createRenderer(r,t),null,null,null));return n[e.index]=s}function LT(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function VT(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function Gg(n,e){return n[Da]?n[NI][Yt]=e:n[Da]=e,n[NI]=e,e}function Wg(n=1){jT(Co(),rt(),Bl()+n,!1)}function jT(n,e,t,r){if(!r)if((e[ae]&3)===3){let o=n.preOrderCheckHooks;o!==null&&ol(e,o,t)}else{let o=n.preOrderHooks;o!==null&&sl(e,o,0,t)}ui(t)}var $l=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}($l||{});function og(n,e,t,r){let i=he(null);try{let[o,s,a]=n.inputs[t],c=null;(s&$l.SignalBased)!==0&&(c=e[o][Ji]),c!==null&&c.transformFn!==void 0?r=c.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,c,r,t,o):kD(e,c,o,r)}finally{he(i)}}function BT(n,e,t,r,i){let o=Bl(),s=r&2;try{ui(-1),s&&e.length>$t&&jT(n,e,$t,!1),Re(s?2:0,i),t(r,i)}finally{ui(o),Re(s?3:1,i)}}function Kg(n,e,t){FP(n,e,t),(t.flags&64)===64&&LP(n,e,t)}function UT(n,e,t=di){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function PP(n,e,t,r){let o=r.get(dP,ST)||t===yn.ShadowDom,s=n.selectRootElement(e,o);return kP(s),s}function kP(n){OP(n)}var OP=()=>null;function FP(n,e,t){let r=t.directiveStart,i=t.directiveEnd;Ll(t)&&NP(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||iT(t,e);let o=t.initialInputs;for(let s=r;s<i;s++){let a=n.data[s],c=Yp(e,n,s,t);if(Pa(c,e),o!==null&&jP(e,s-r,c,a,t,o),li(a)){let l=si(t.index,e);l[_t]=Yp(e,n,s,t)}}}function LP(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=SN();try{ui(o);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];Kp(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&VP(c,l)}}finally{ui(-1),Kp(s)}}function VP(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function $T(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let o=t[i];_P(e,o.selectors,!1)&&(r??=[],li(o)?r.unshift(o):r.push(o))}return r}function jP(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let c=s[a],l=s[a+1];og(r,t,c,l)}}function BP(n,e){let t=n[Ia],r=t?t.get(pr,null):null;r&&r.handleError(e)}function HT(n,e,t,r,i){let o=n.inputs?.[r],s=n.hostDirectiveInputs?.[r],a=!1;if(s)for(let c=0;c<s.length;c+=2){let l=s[c],h=s[c+1],p=e.data[l];og(p,t[l],h,i),a=!0}if(o)for(let c of o){let l=t[c],h=e.data[c];og(h,l,r,i),a=!0}return a}function UP(n,e){let t=si(e,n),r=t[le];$P(r,t);let i=t[Un];i!==null&&t[Ea]===null&&(t[Ea]=RT(i,t[Ia])),Re(18),Qg(r,t,t[_t]),Re(19,t[_t])}function $P(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function Qg(n,e,t){Ag(e);try{let r=n.viewQuery;r!==null&&ig(1,r,t);let i=n.template;i!==null&&BT(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[wo]?.finishViewCreation(n),n.staticContentQueries&&MT(n,e),n.staticViewQueries&&ig(2,n.viewQuery,t);let o=n.components;o!==null&&HP(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ae]&=-5,Rg()}}function HP(n,e){for(let t=0;t<e.length;t++)UP(n,e[t])}function qT(n,e,t,r){let i=he(null);try{let o=e.tView,a=n[ae]&4096?4096:16,c=zg(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[_o]=l;let h=n[wo];return h!==null&&(c[wo]=h.createEmbeddedView(o)),Qg(o,c,t),c}finally{he(i)}}function Tl(n,e){return!e||e.firstChild===null||wT(n)}var qP;function Yg(n,e){return qP(n,e)}var pi=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(pi||{});function zT(n){return(n.flags&32)===32}function go(n,e,t,r,i){if(r!=null){let o,s=!1;$n(r)?o=r:ni(r)&&(s=!0,r=r[Un]);let a=jn(r);n===0&&t!==null?i==null?OT(e,t,a):Dl(e,t,a,i||null,!0):n===1&&t!==null?Dl(e,t,a,i||null,!0):n===2?SP(e,a,s):n===3&&e.destroyNode(a),o!=null&&nk(e,n,o,t,i)}}function zP(n,e){GT(n,e),e[Un]=null,e[Jt]=null}function GP(n,e,t,r,i,o){r[Un]=i,r[Jt]=e,ql(n,r,t,1,i,o)}function GT(n,e){e[fr].changeDetectionScheduler?.notify(9),ql(n,e,e[Ut],2,null,null)}function WP(n){let e=n[Da];if(!e)return Pp(n[le],n);for(;e;){let t=null;if(ni(e))t=e[Da];else{let r=e[wt];r&&(t=r)}if(!t){for(;e&&!e[Yt]&&e!==n;)ni(e)&&Pp(e[le],e),e=e[Et];e===null&&(e=n),ni(e)&&Pp(e[le],e),t=e&&e[Yt]}e=t}}function Zg(n,e){let t=n[ml],r=t.indexOf(e);t.splice(r,1)}function Hl(n,e){if(To(e))return;let t=e[Ut];t.destroyNode&&ql(n,e,t,3,null,null),WP(e)}function Pp(n,e){if(To(e))return;let t=he(null);try{e[ae]&=-129,e[ae]|=256,e[Bt]&&op(e[Bt]),QP(n,e),KP(n,e),e[le].type===1&&e[Ut].destroy();let r=e[_o];if(r!==null&&$n(e[Et])){r!==e[Et]&&Zg(r,e);let i=e[wo];i!==null&&i.detachView(n)}ng(e)}finally{he(t)}}function KP(n,e){let t=n.cleanup,r=e[xI];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[xI]=null);let i=e[hr];if(i!==null){e[hr]=null;for(let s=0;s<i.length;s++){let a=i[s];a()}}let o=e[pl];if(o!==null){e[pl]=null;for(let s of o)s.destroy()}}function QP(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Ca)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],c=o[s+1];Re(4,a,c);try{c.call(a)}finally{Re(5,a,c)}}else{Re(4,i,o);try{o.call(i)}finally{Re(5,i,o)}}}}}function YP(n,e,t){return ZP(n,e.parent,t)}function ZP(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[Un];if(Ll(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===yn.None||i===yn.Emulated)return null}return di(r,t)}function JP(n,e,t){return ek(n,e,t)}function XP(n,e,t){return n.type&40?di(n,t):null}var ek=XP,KI;function Jg(n,e,t,r){let i=YP(n,r,e),o=e[Ut],s=r.parent||e[Jt],a=JP(s,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)WI(o,i,t[c],a,!1);else WI(o,i,t,a,!1);KI!==void 0&&KI(o,r,e,t,i)}function ya(n,e){if(e!==null){let t=e.type;if(t&3)return di(e,n);if(t&4)return sg(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return ya(n,r);{let i=n[e.index];return $n(i)?sg(-1,i):jn(i)}}else{if(t&128)return ya(n,e.next);if(t&32)return Yg(e,n)()||jn(n[e.index]);{let r=WT(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=ai(n[Zt]);return ya(i,r)}else return ya(n,e.next)}}}return null}function WT(n,e){if(e!==null){let r=n[Zt][Jt],i=e.projection;return r.projection[i]}return null}function sg(n,e){let t=wt+n+1;if(t<e.length){let r=e[t],i=r[le].firstChild;if(i!==null)return ya(r,i)}return e[oi]}function Xg(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(s&&e===0&&(a&&Pa(jn(a),r),t.flags|=2),!zT(t))if(c&8)Xg(n,e,t.child,r,i,o,!1),go(e,n,i,a,o);else if(c&32){let l=Yg(t,r),h;for(;h=l();)go(e,n,i,h,o);go(e,n,i,a,o)}else c&16?tk(n,e,r,t,i,o):go(e,n,i,a,o);t=s?t.projectionNext:t.next}}function ql(n,e,t,r,i,o){Xg(t,r,n.firstChild,e,i,o,!1)}function tk(n,e,t,r,i,o){let s=t[Zt],c=s[Jt].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let h=c[l];go(e,n,i,h,o)}else{let l=c,h=s[Et];wT(r)&&(l.flags|=128),Xg(n,e,l,h,i,o,!0)}}function nk(n,e,t,r,i){let o=t[oi],s=jn(t);o!==s&&go(e,n,r,o,i);for(let a=wt;a<t.length;a++){let c=t[a];ql(c[le],c,n,e,r,o)}}function Cl(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(jn(o)),$n(o)&&rk(o,r);let s=t.type;if(s&8)Cl(n,e,t.child,r);else if(s&32){let a=Yg(t,e),c;for(;c=a();)r.push(c)}else if(s&16){let a=WT(e,t);if(Array.isArray(a))r.push(...a);else{let c=ai(e[Zt]);Cl(c[le],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function rk(n,e){for(let t=wt;t<n.length;t++){let r=n[t],i=r[le].firstChild;i!==null&&Cl(r[le],r,i,e)}n[oi]!==n[Un]&&e.push(n[oi])}function KT(n){if(n[Mp]!==null){for(let e of n[Mp])e.impl.addSequence(e);n[Mp].length=0}}var QT=[];function ik(n){return n[Bt]??ok(n)}function ok(n){let e=QT.pop()??Object.create(ak);return e.lView=n,e}function sk(n){n.lView[Bt]!==n&&(n.lView=null,QT.push(n))}var ak=Ee(q({},Rc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{jl(n.lView)},consumerOnSignalRead(){this.lView[Bt]=this}});function uk(n){let e=n[Bt]??Object.create(ck);return e.lView=n,e}var ck=Ee(q({},Rc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=ai(n.lView);for(;e&&!YT(e[le]);)e=ai(e);e&&BD(e)},consumerOnSignalRead(){this.lView[Bt]=this}});function YT(n){return n.type!==2}function ZT(n){if(n[pl]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[pl])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[ae]&8192)}}var lk=100;function JT(n,e=!0,t=0){let i=n[fr].rendererFactory,o=!1;o||i.begin?.();try{dk(n,t)}catch(s){throw e&&BP(n,s),s}finally{o||i.end?.()}}function dk(n,e){let t=zD();try{kI(!0),ag(n,e);let r=0;for(;Vl(n);){if(r===lk)throw new K(103,!1);r++,ag(n,1)}}finally{kI(t)}}function hk(n,e,t,r){if(To(e))return;let i=e[ae],o=!1,s=!1;Ag(e);let a=!0,c=null,l=null;o||(YT(n)?(l=ik(e),c=rp(l)):ep()===null?(a=!1,l=uk(e),c=rp(l)):e[Bt]&&(op(e[Bt]),e[Bt]=null));try{jD(e),IN(n.bindingStartIndex),t!==null&&BT(n,e,t,2,r);let h=(i&3)===3;if(!o)if(h){let y=n.preOrderCheckHooks;y!==null&&ol(e,y,null)}else{let y=n.preOrderHooks;y!==null&&sl(e,y,0,null),xp(e,0)}if(s||fk(e),ZT(e),XT(e,0),n.contentQueries!==null&&MT(n,e),!o)if(h){let y=n.contentCheckHooks;y!==null&&ol(e,y)}else{let y=n.contentHooks;y!==null&&sl(e,y,1),xp(e,1)}gk(n,e);let p=n.components;p!==null&&tC(e,p,0);let m=n.viewQuery;if(m!==null&&ig(2,m,r),!o)if(h){let y=n.viewCheckHooks;y!==null&&ol(e,y)}else{let y=n.viewHooks;y!==null&&sl(e,y,2),xp(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Rp]){for(let y of e[Rp])y();e[Rp]=null}o||(KT(e),e[ae]&=-73)}catch(h){throw o||jl(e),h}finally{l!==null&&(KE(l,c),a&&sk(l)),Rg()}}function XT(n,e){for(let t=DT(n);t!==null;t=TT(t))for(let r=wt;r<t.length;r++){let i=t[r];eC(i,e)}}function fk(n){for(let e=DT(n);e!==null;e=TT(e)){if(!(e[ae]&2))continue;let t=e[ml];for(let r=0;r<t.length;r++){let i=t[r];BD(i)}}}function pk(n,e,t){Re(18);let r=si(e,n);eC(r,t),Re(19,r[_t])}function eC(n,e){Sg(n)&&ag(n,e)}function ag(n,e){let r=n[le],i=n[ae],o=n[Bt],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&ip(o)),s||=!1,o&&(o.dirty=!1),n[ae]&=-9217,s)hk(r,n,r.template,n[_t]);else if(i&8192){ZT(n),XT(n,1);let a=r.components;a!==null&&tC(n,a,1),KT(n)}}function tC(n,e,t){for(let r=0;r<e.length;r++)pk(n,e[r],t)}function gk(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)ui(~i);else{let o=i,s=t[++r],a=t[++r];bN(s,o);let c=e[o];Re(24,c),a(2,c),Re(25,c)}}}finally{ui(-1)}}function nC(n,e){let t=zD()?64:1088;for(n[fr].changeDetectionScheduler?.notify(e);n;){n[ae]|=t;let r=ai(n);if(yl(n)&&!r)return n;n=r}return null}function rC(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function mk(n,e){let t=wt+e;if(t<n.length)return n[t]}function em(n,e,t,r=!0){let i=e[le];if(vk(i,e,n,t),r){let s=sg(t,n),a=e[Ut],c=a.parentNode(n[oi]);c!==null&&GP(i,n[Jt],a,e,c,s)}let o=e[Ea];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function yk(n,e){let t=ba(n,e);return t!==void 0&&Hl(t[le],t),t}function ba(n,e){if(n.length<=wt)return;let t=wt+e,r=n[t];if(r){let i=r[_o];i!==null&&i!==n&&Zg(i,r),e>0&&(n[t-1][Yt]=r[Yt]);let o=hl(n,wt+e);zP(r[le],r);let s=o[wo];s!==null&&s.detachView(o[le]),r[Et]=null,r[Yt]=null,r[ae]&=-129}return r}function vk(n,e,t,r){let i=wt+r,o=t.length;r>0&&(t[i-1][Yt]=e),r<o-wt?(e[Yt]=t[i],wD(t,wt+r,e)):(t.push(e),e[Yt]=null),e[Et]=t;let s=e[_o];s!==null&&t!==s&&iC(s,e);let a=e[wo];a!==null&&a.insertView(n),Gp(e),e[ae]|=128}function iC(n,e){let t=n[ml],r=e[Et];if(ni(r))n[ae]|=2;else{let i=r[Et][Zt];e[Zt]!==i&&(n[ae]|=2)}t===null?n[ml]=[e]:t.push(e)}var bl=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let e=this._lView,t=e[le];return Cl(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r}get context(){return this._lView[_t]}set context(e){this._lView[_t]=e}get destroyed(){return To(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Et];if($n(e)){let t=e[gl],r=t?t.indexOf(this):-1;r>-1&&(ba(e,r),hl(t,r))}this._attachedToViewContainer=!1}Hl(this._lView[le],this._lView)}onDestroy(e){UD(this._lView,e)}markForCheck(){nC(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ae]&=-129}reattach(){Gp(this._lView),this._lView[ae]|=128}detectChanges(){this._lView[ae]|=1024,JT(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new K(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=yl(this._lView),t=this._lView[_o];t!==null&&!e&&Zg(t,this._lView),GT(this._lView[le],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new K(902,!1);this._appRef=e;let t=yl(this._lView),r=this._lView[_o];r!==null&&!t&&iC(r,this._lView),Gp(this._lView)}};function tm(n,e,t,r,i){let o=n.data[e];if(o===null)o=_k(n,e,t,r,i),CN()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=vN();o.injectorIndex=s===null?-1:s.injectorIndex}return xa(o,!0),o}function _k(n,e,t,r,i){let o=HD(),s=qD(),a=s?o:o&&o.parent,c=n.data[e]=Ek(n,a,t,e,r,i);return wk(n,c,o,s),c}function wk(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function Ek(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return gN()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var G4=new RegExp(`^(\\d+)*(${lP}|${cP})*(.*)`);var Ik=()=>null;function Sl(n,e){return Ik(n,e)}var Dk=class{},oC=class{},ug=class{resolveComponentFactory(e){throw Error(`No component factory found for ${Pt(e)}.`)}},zl=class{static NULL=new ug},Io=class{};var Tk=(()=>{class n{static \u0275prov=Q({token:n,providedIn:"root",factory:()=>null})}return n})();var kp={},cg=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=kl(r);let i=this.injector.get(e,kp,r);return i!==kp||t===kp?i:this.parentInjector.get(e,t,r)}};function QI(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=TI(i,a);else if(o==2){let c=a,l=e[++s];r=TI(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function Gl(n,e=oe.Default){let t=rt();if(t===null)return U(n,e);let r=hi();return uT(r,t,jt(n),e)}function sC(n,e,t,r,i){let o=r===null?null:{"":-1},s=i(n,t);if(s!==null){let a,c=null,l=null,h=bk(s);h===null?a=s:[a,c,l]=h,Rk(n,e,t,a,o,c,l)}o!==null&&r!==null&&Ck(t,r,o)}function Ck(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new K(-301,!1);r.push(e[i],o)}}function bk(n){let e=null,t=!1;for(let s=0;s<n.length;s++){let a=n[s];if(s===0&&li(a)&&(e=a),a.findHostDirectiveDefs!==null){t=!0;break}}if(!t)return null;let r=null,i=null,o=null;for(let s of n)s.findHostDirectiveDefs!==null&&(r??=[],i??=new Map,o??=new Map,Sk(s,r,o,i)),s===e&&(r??=[],r.push(s));return r!==null?(r.push(...e===null?n:n.slice(1)),[r,i,o]):null}function Sk(n,e,t,r){let i=e.length;n.findHostDirectiveDefs(n,e,r),t.set(n,[i,e.length-1])}function Ak(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function Rk(n,e,t,r,i,o,s){let a=r.length,c=!1;for(let m=0;m<a;m++){let y=r[m];!c&&li(y)&&(c=!0,Ak(n,t,m)),UN(iT(t,e),n,y.type)}Ok(t,n.data.length,a);for(let m=0;m<a;m++){let y=r[m];y.providersResolver&&y.providersResolver(y)}let l=!1,h=!1,p=VT(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let m=0;m<a;m++){let y=r[m];if(t.mergedAttrs=Ng(t.mergedAttrs,y.hostAttrs),xk(n,t,e,p,y),kk(p,y,i),s!==null&&s.has(y)){let[A,N]=s.get(y);t.directiveToIndex.set(y.type,[p,A+t.directiveStart,N+t.directiveStart])}else(o===null||!o.has(y))&&t.directiveToIndex.set(y.type,p);y.contentQueries!==null&&(t.flags|=4),(y.hostBindings!==null||y.hostAttrs!==null||y.hostVars!==0)&&(t.flags|=64);let T=y.type.prototype;!l&&(T.ngOnChanges||T.ngOnInit||T.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),l=!0),!h&&(T.ngOnChanges||T.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),h=!0),p++}Mk(n,t,o)}function Mk(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))YI(0,e,i,r),YI(1,e,i,r),JI(e,r,!1);else{let o=t.get(i);ZI(0,e,o,r),ZI(1,e,o,r),JI(e,r,!0)}}}function YI(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(r),aC(e,o)}}function ZI(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s=i[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(r,o),aC(e,s)}}function aC(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function JI(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:o}=n;if(r===null||!t&&i===null||t&&o===null||Hg(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<r.length;){let c=r[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!t&&i.hasOwnProperty(c)){let l=i[c];for(let h of l)if(h===e){s??=[],s.push(c,r[a+1]);break}}else if(t&&o.hasOwnProperty(c)){let l=o[c];for(let h=0;h<l.length;h+=2)if(l[h]===e){s??=[],s.push(l[h+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function xk(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=ii(i.type,!0)),s=new Ca(o,li(i),Gl);n.blueprint[r]=s,t[r]=s,Nk(n,e,r,VT(n,t,i.hostVars,ka),i)}function Nk(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;Pk(s)!=a&&s.push(a),s.push(t,r,o)}}function Pk(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function kk(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;li(e)&&(t[""]=n)}}function Ok(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function uC(n,e,t,r,i,o,s,a){let c=e.consts,l=Ta(c,s),h=tm(e,n,2,r,l);return o&&sC(e,t,h,Ta(c,a),i),h.mergedAttrs=Ng(h.mergedAttrs,h.attrs),h.attrs!==null&&QI(h,h.attrs,!1),h.mergedAttrs!==null&&QI(h,h.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,h),h}function cC(n,e){XD(n,e),ND(e)&&n.queries.elementEnd(e)}var Al=class extends zl{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=vo(e);return new Sa(t,this.ngModule)}};function Fk(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],o={propName:t,templateName:e,isSignal:(r&$l.SignalBased)!==0};return i&&(o.transform=i),o})}function Lk(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function Vk(n,e,t){let r=e instanceof Ye?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new cg(t,r):t}function jk(n){let e=n.get(Io,null);if(e===null)throw new K(407,!1);let t=n.get(Tk,null),r=n.get(Eo,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r}}function Bk(n,e){let t=(n.selectors[0][0]||"div").toLowerCase();return kT(e,t,t==="svg"?sN:t==="math"?aN:null)}var Sa=class extends oC{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=Fk(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=Lk(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=DP(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i){Re(22);let o=he(null);try{let s=this.componentDef,a=r?["ng-version","19.2.11"]:TP(this.componentDef.selectors[0]),c=qg(0,null,null,1,0,null,null,null,null,[a],null),l=Vk(s,i||this.ngModule,e),h=jk(l),p=h.rendererFactory.createRenderer(null,s),m=r?PP(p,r,s.encapsulation,l):Bk(s,p),y=zg(null,c,null,512|LT(s),null,null,h,p,l,null,RT(m,l,!0));y[$t]=m,Ag(y);let T=null;try{let A=uC($t,c,y,"#host",()=>[this.componentDef],!0,0);m&&(FT(p,m,A),Pa(m,y)),Kg(c,y,A),xT(c,A,y),cC(c,A),t!==void 0&&Uk(A,this.ngContentSelectors,t),T=si(A.index,y),y[_t]=T[_t],Qg(c,y,null)}catch(A){throw T!==null&&ng(T),ng(y),A}finally{Re(23),Rg()}return new lg(this.componentType,y)}finally{he(o)}}},lg=class extends Dk{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t){super(),this._rootLView=t,this._tNode=VD(t[le],$t),this.location=Vg(this._tNode,t),this.instance=si(this._tNode.index,t)[_t],this.hostView=this.changeDetectorRef=new bl(t,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,o=HT(r,i[le],i,e,t);this.previousInputValues.set(e,t);let s=si(r.index,i);nC(s,1)}get injector(){return new ri(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function Uk(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null&&o.length?Array.from(o):null)}}var Wl=(()=>{class n{static __NG_ELEMENT_ID__=$k}return n})();function $k(){let n=hi();return qk(n,rt())}var Hk=Wl,lC=class extends Hk{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Vg(this._hostTNode,this._hostLView)}get injector(){return new ri(this._hostTNode,this._hostLView)}get parentInjector(){let e=Pg(this._hostTNode,this._hostLView);if(tT(e)){let t=_l(e,this._hostLView),r=vl(e),i=t[le].data[r+8];return new ri(i,t)}else return new ri(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=XI(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-wt}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=Sl(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,Tl(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!nN(e),a;if(s)a=t;else{let T=t||{};a=T.index,r=T.injector,i=T.projectableNodes,o=T.environmentInjector||T.ngModuleRef}let c=s?e:new Sa(vo(e)),l=r||this.parentInjector;if(!o&&c.ngModule==null){let A=(s?l:this.parentInjector).get(Ye,null);A&&(o=A)}let h=vo(c.componentType??{}),p=Sl(this._lContainer,h?.id??null),m=p?.firstChild??null,y=c.create(l,i,m,o);return this.insertImpl(y.hostView,a,Tl(this._hostTNode,p)),y}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(lN(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Et],l=new lC(c,c[Jt],c[Et]);l.detach(l.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return em(s,i,o,r),e.attachToViewContainerRef(),wD(Op(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=XI(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=ba(this._lContainer,t);r&&(hl(Op(this._lContainer),t),Hl(r[le],r))}detach(e){let t=this._adjustIndex(e,-1),r=ba(this._lContainer,t);return r&&hl(Op(this._lContainer),t)!=null?new bl(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function XI(n){return n[gl]}function Op(n){return n[gl]||(n[gl]=[])}function qk(n,e){let t,r=e[n.index];return $n(r)?t=r:(t=rC(r,e,null,n),e[n.index]=t,Gg(e,t)),Gk(t,e,n,r),new lC(t,n,e)}function zk(n,e){let t=n[Ut],r=t.createComment(""),i=di(e,n),o=t.parentNode(i);return Dl(t,o,r,t.nextSibling(i),!1),r}var Gk=Qk,Wk=()=>!1;function Kk(n,e,t){return Wk(n,e,t)}function Qk(n,e,t,r){if(n[oi])return;let i;t.type&8?i=jn(r):i=zk(e,t),n[oi]=i}var Do=class{},nm=class{};var dg=class extends Do{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Al(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let o=DD(e);this._bootstrapComponents=NT(o.bootstrap),this._r3Injector=dT(e,t,[{provide:Do,useValue:this},{provide:zl,useValue:this.componentFactoryResolver},...r],Pt(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},hg=class extends nm{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new dg(this.moduleType,e,[])}};var Rl=class extends Do{injector;componentFactoryResolver=new Al(this);instance=null;constructor(e){super();let t=new wa([...e.providers,{provide:Do,useValue:this},{provide:zl,useValue:this.componentFactoryResolver}],e.parent||Cg(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Kl(n,e,t=null){return new Rl({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var Yk=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=CD(!1,t.type),i=r.length>0?Kl([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Q({token:n,providedIn:"environment",factory:()=>new n(U(Ye))})}return n})();function Ql(n){return Ra(()=>{let e=hC(n),t=Ee(q({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===ET.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(Yk).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||yn.Emulated,styles:n.styles||pn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&$g("NgStandalone"),fC(t);let r=n.dependencies;return t.directiveDefs=eD(r,!1),t.pipeDefs=eD(r,!0),t.id=tO(t),t})}function Zk(n){return vo(n)||zx(n)}function Jk(n){return n!==null}function Hn(n){return Ra(()=>({type:n.type,bootstrap:n.bootstrap||pn,declarations:n.declarations||pn,imports:n.imports||pn,exports:n.exports||pn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Xk(n,e){if(n==null)return yo;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a,c;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o,c=i[3]||null):(o=i,s=i,a=$l.None,c=null),t[o]=[r,a,c],e[o]=s}return t}function eO(n){if(n==null)return yo;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function rm(n){return Ra(()=>{let e=hC(n);return fC(e),e})}function dC(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function hC(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||yo,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||pn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Xk(n.inputs,e),outputs:eO(n.outputs),debugInfo:null}}function fC(n){n.features?.forEach(e=>e(n))}function eD(n,e){if(!n)return null;let t=e?Gx:Zk;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(Jk)}function tO(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function nO(n,e,t){return n[e]=t}function Ml(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function rO(n,e,t,r){let i=Ml(n,e,t);return Ml(n,e+1,r)||i}function iO(n,e,t,r,i,o,s,a,c){let l=e.consts,h=tm(e,n,4,s||null,a||null);$D()&&sC(e,t,h,Ta(l,c),$T),h.mergedAttrs=Ng(h.mergedAttrs,h.attrs),XD(e,h);let p=h.tView=qg(2,h,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,h),p.queries=e.queries.embeddedTView(h)),h}function tD(n,e,t,r,i,o,s,a,c,l){let h=t+$t,p=e.firstCreatePass?iO(h,e,n,r,i,o,s,a,c):e.data[h];xa(p,!1);let m=oO(e,n,p,t);Mg()&&Jg(e,n,m,p),Pa(m,n);let y=rC(m,n,m,p);return n[h]=y,Gg(n,y),Kk(y,p,n),PD(p)&&Kg(e,n,p),c!=null&&UT(n,p,l),p}var oO=sO;function sO(n,e,t,r){return xg(!0),e[Ut].createComment("")}var pC=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var gC=new G("");var aO=(()=>{class n{static \u0275prov=Q({token:n,providedIn:"root",factory:()=>new fg})}return n})(),fg=class{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),this.queuedEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}};function bo(n){return!!n&&typeof n.then=="function"}function im(n){return!!n&&typeof n.subscribe=="function"}var uO=new G("");var mC=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=O(uO,{optional:!0})??[];injector=O(mn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=Ht(this.injector,i);if(bo(o))t.push(o);else if(im(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),om=new G("");function cO(){sp(()=>{throw new K(600,!1)})}function lO(n){return n.isBoundToModule}var dO=10;var ci=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=O(tP);afterRenderManager=O(hP);zonelessEnabled=O(fT);rootEffectScheduler=O(aO);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new Ne;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=O(fi).hasPendingTasks.pipe(X(t=>!t));constructor(){O(Ul,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=O(Ye);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=mn.NULL){Re(10);let o=t instanceof oC;if(!this._injector.get(mC).done){let y="";throw new K(405,y)}let a;o?a=t:a=this._injector.get(zl).resolveComponentFactory(t),this.componentTypes.push(a.componentType);let c=lO(a)?void 0:this._injector.get(Do),l=r||a.selector,h=a.create(i,[],l,c),p=h.location.nativeElement,m=h.injector.get(gC,null);return m?.registerApplication(p),h.onDestroy(()=>{this.detachView(h.hostView),al(this.components,h),m?.unregisterApplication(p)}),this._loadComponent(h),Re(11,h),h}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){Re(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(AT.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new K(101,!1);let t=he(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,he(t),this.afterTick.next(),Re(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Io,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<dO;)Re(14),this.synchronizeOnce(),Re(15)}synchronizeOnce(){if(this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let t=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:i}of this.allViews)hO(r,i,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Vl(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;al(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(om,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>al(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new K(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function al(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function hO(n,e,t,r){if(!t&&!Vl(n))return;JT(n,e,t&&!r?0:1)}function fO(n,e,t,r,i,o){let s=EN(),a=rO(n,s,t,i);return TN(2),a?e+Lp(t)+r+Lp(i)+o:ka}function nD(n,e,t,r,i){HT(e,n,t,i?"class":"style",r)}var pg=class{destroy(e){}updateValue(e,t){}swap(e,t){let r=Math.min(e,t),i=Math.max(e,t),o=this.detach(i);if(i-r>1){let s=this.detach(r);this.attach(r,o),this.attach(i,s)}else this.attach(r,o)}move(e,t){this.attach(t,this.detach(e))}};function Fp(n,e,t,r,i){return n===t&&Object.is(e,r)?1:Object.is(i(n,e),i(t,r))?-1:0}function pO(n,e,t){let r,i,o=0,s=n.length-1,a=void 0;if(Array.isArray(e)){let c=e.length-1;for(;o<=s&&o<=c;){let l=n.at(o),h=e[o],p=Fp(o,l,o,h,t);if(p!==0){p<0&&n.updateValue(o,h),o++;continue}let m=n.at(s),y=e[c],T=Fp(s,m,c,y,t);if(T!==0){T<0&&n.updateValue(s,y),s--,c--;continue}let A=t(o,l),N=t(s,m),V=t(o,h);if(Object.is(V,N)){let H=t(c,y);Object.is(H,A)?(n.swap(o,s),n.updateValue(s,y),c--,s--):n.move(s,o),n.updateValue(o,h),o++;continue}if(r??=new xl,i??=iD(n,o,s,t),gg(n,r,o,V))n.updateValue(o,h),o++,s++;else if(i.has(V))r.set(A,n.detach(o)),s--;else{let H=n.create(o,e[o]);n.attach(o,H),o++,s++}}for(;o<=c;)rD(n,r,t,o,e[o]),o++}else if(e!=null){let c=e[Symbol.iterator](),l=c.next();for(;!l.done&&o<=s;){let h=n.at(o),p=l.value,m=Fp(o,h,o,p,t);if(m!==0)m<0&&n.updateValue(o,p),o++,l=c.next();else{r??=new xl,i??=iD(n,o,s,t);let y=t(o,p);if(gg(n,r,o,y))n.updateValue(o,p),o++,s++,l=c.next();else if(!i.has(y))n.attach(o,n.create(o,p)),o++,s++,l=c.next();else{let T=t(o,h);r.set(T,n.detach(o)),s--}}}for(;!l.done;)rD(n,r,t,n.length,l.value),l=c.next()}for(;o<=s;)n.destroy(n.detach(s--));r?.forEach(c=>{n.destroy(c)})}function gg(n,e,t,r){return e!==void 0&&e.has(r)?(n.attach(t,e.get(r)),e.delete(r),!0):!1}function rD(n,e,t,r,i){if(gg(n,e,r,t(r,i)))n.updateValue(r,i);else{let o=n.create(r,i);n.attach(r,o)}}function iD(n,e,t,r){let i=new Set;for(let o=e;o<=t;o++)i.add(r(o,n.at(o)));return i}var xl=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,r]of this.kvMap)if(e(r,t),this._vMap!==void 0){let i=this._vMap;for(;i.has(r);)r=i.get(r),e(r,t)}}};var mg=class{lContainer;$implicit;$index;constructor(e,t,r){this.lContainer=e,this.$implicit=t,this.$index=r}get $count(){return this.lContainer.length-wt}};function yC(n,e){return e}var yg=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,r){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=r}};function vC(n,e,t,r,i,o,s,a,c,l,h,p,m){$g("NgControlFlow");let y=rt(),T=Co(),A=c!==void 0,N=rt(),V=a?s.bind(N[Zt][_t]):s,H=new yg(A,V);N[$t+n]=H,tD(y,T,n+1,e,t,r,i,Ta(T.consts,o)),A&&tD(y,T,n+2,c,l,h,p,Ta(T.consts,m))}var vg=class extends pg{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,r){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=r}get length(){return this.lContainer.length-wt}at(e){return this.getLView(e)[_t].$implicit}attach(e,t){let r=t[Ea];this.needsIndexUpdate||=e!==this.length,em(this.lContainer,t,e,Tl(this.templateTNode,r))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,gO(this.lContainer,e)}create(e,t){let r=Sl(this.lContainer,this.templateTNode.tView.ssrId),i=qT(this.hostLView,this.templateTNode,new mg(this.lContainer,t,e),{dehydratedView:r});return this.operationsCounter?.recordCreate(),i}destroy(e){Hl(e[le],e),this.operationsCounter?.recordDestroy()}updateValue(e,t){this.getLView(e)[_t].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[_t].$index=e}getLView(e){return mO(this.lContainer,e)}};function _C(n){let e=he(null),t=Bl();try{let r=rt(),i=r[le],o=r[t],s=t+1,a=oD(r,s);if(o.liveCollection===void 0){let l=sD(i,s);o.liveCollection=new vg(a,r,l)}else o.liveCollection.reset();let c=o.liveCollection;if(pO(c,n,o.trackByFn),c.updateIndexes(),o.hasEmptyBlock){let l=DN(),h=c.length===0;if(Ml(r,l,h)){let p=t+2,m=oD(r,p);if(h){let y=sD(i,p),T=Sl(m,y.tView.ssrId),A=qT(r,y,void 0,{dehydratedView:T});em(m,A,0,Tl(y,T))}else yk(m,0)}}}finally{he(e)}}function oD(n,e){return n[e]}function gO(n,e){return ba(n,e)}function mO(n,e){return mk(n,e)}function sD(n,e){return VD(n,e)}function Oa(n,e,t,r){let i=rt(),o=Co(),s=$t+n,a=i[Ut],c=o.firstCreatePass?uC(s,o,i,e,$T,$D(),t,r):o.data[s],l=yO(o,i,c,a,e,n);i[s]=l;let h=PD(c);return xa(c,!0),FT(a,l,c),!zT(c)&&Mg()&&Jg(o,i,l,c),(hN()===0||h)&&Pa(l,i),fN(),h&&(Kg(o,i,c),xT(o,c,i)),r!==null&&UT(i,c),Oa}function Fa(){let n=hi();qD()?_N():(n=n.parent,xa(n,!1));let e=n;mN(e)&&yN(),pN();let t=Co();return t.firstCreatePass&&cC(t,e),e.classesWithoutHost!=null&&NN(e)&&nD(t,e,rt(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&PN(e)&&nD(t,e,rt(),e.stylesWithoutHost,!1),Fa}function So(n,e,t,r){return Oa(n,e,t,r),Fa(),So}var yO=(n,e,t,r,i,o)=>(xg(!0),kT(r,i,RN()));var Nl="en-US";var vO=Nl;function _O(n){typeof n=="string"&&(vO=n.toLowerCase().replace(/_/g,"-"))}function wO(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function sm(n,e=""){let t=rt(),r=Co(),i=n+$t,o=r.firstCreatePass?tm(r,i,1,e,null):r.data[i],s=EO(r,t,o,e,n);t[i]=s,Mg()&&Jg(r,t,s,o),xa(o,!1)}var EO=(n,e,t,r,i)=>(xg(!0),CP(e[Ut],r));function am(n,e,t,r,i){let o=rt(),s=fO(o,n,e,t,r,i);return s!==ka&&IO(o,Bl(),s),am}function IO(n,e,t){let r=uN(e,n);bP(n[Ut],r,t)}function DO(n,e){let t=n[e];return t===ka?void 0:t}function TO(n,e,t,r,i,o){let s=e+t;return Ml(n,s,i)?nO(n,s+1,o?r.call(o,i):r(i)):DO(n,s+1)}function wC(n,e){let t=Co(),r,i=n+$t;t.firstCreatePass?(r=CO(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let o=r.factory||(r.factory=ii(r.type,!0)),s,a=St(Gl);try{let c=wl(!1),l=o();return wl(c),wO(t,rt(),i,l),l}finally{St(a)}}function CO(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function EC(n,e,t){let r=n+$t,i=rt(),o=cN(i,r);return bO(i,r)?TO(i,wN(),e,o.transform,t,o):o.transform(t)}function bO(n,e){return n[le].data[e].pure}var Aa=class{full;major;minor;patch;constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},IC=new Aa("19.2.11"),_g=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},DC=(()=>{class n{compileModuleSync(t){return new hg(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=DD(t),o=NT(i.declarations).reduce((s,a)=>{let c=vo(a);return c&&s.push(new Sa(c)),s},[]);return new _g(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var SO=(()=>{class n{zone=O(Te);changeDetectionScheduler=O(Eo);applicationRef=O(ci);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function AO({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new Te(Ee(q({},RO()),{scheduleInRootZone:t})),[{provide:Te,useFactory:n},{provide:_a,multi:!0,useFactory:()=>{let r=O(SO,{optional:!0});return()=>r.initialize()}},{provide:_a,multi:!0,useFactory:()=>{let r=O(MO);return()=>{r.initialize()}}},e===!0?{provide:pT,useValue:!0}:[],{provide:gT,useValue:t??hT}]}function RO(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var MO=(()=>{class n{subscription=new Le;initialized=!1;zone=O(Te);pendingTasks=O(fi);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Te.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Te.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var xO=(()=>{class n{appRef=O(ci);taskService=O(fi);ngZone=O(Te);zonelessEnabled=O(fT);tracing=O(Ul,{optional:!0});disableScheduling=O(pT,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Le;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Il):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(O(gT,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof tg||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let r=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{this.appRef.dirtyFlags|=16,r=!0;break}case 13:{this.appRef.dirtyFlags|=2,r=!0;break}case 11:{r=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?BI:mT;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Il+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,BI(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function NO(){return typeof $localize<"u"&&$localize.locale||Nl}var um=new G("",{providedIn:"root",factory:()=>O(um,oe.Optional|oe.SkipSelf)||NO()});var wg=new G(""),PO=new G("");function ga(n){return!n.moduleRef}function kO(n){let e=ga(n)?n.r3Injector:n.moduleRef.injector,t=e.get(Te);return t.run(()=>{ga(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(pr,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),ga(n)){let o=()=>e.destroy(),s=n.platformInjector.get(wg);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(wg);s.add(o),n.moduleRef.onDestroy(()=>{al(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return FO(r,t,()=>{let o=e.get(mC);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(um,Nl);if(_O(s||Nl),!e.get(PO,!0))return ga(n)?e.get(ci):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(ga(n)){let c=e.get(ci);return n.rootComponent!==void 0&&c.bootstrap(n.rootComponent),c}else return OO(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function OO(n,e){let t=n.injector.get(ci);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new K(-403,!1);e.push(n)}function FO(n,e,t){try{let r=t();return bo(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var ul=null;function LO(n=[],e){return mn.create({name:e,providers:[{provide:Ol,useValue:"platform"},{provide:wg,useValue:new Set([()=>ul=null])},...n]})}function VO(n=[]){if(ul)return ul;let e=LO(n);return ul=e,cO(),jO(e),e}function jO(n){let e=n.get(Bg,null);Ht(n,()=>{e?.forEach(t=>t())})}function La(){return!1}var Yl=(()=>{class n{static __NG_ELEMENT_ID__=BO}return n})();function BO(n){return UO(hi(),rt(),(n&16)===16)}function UO(n,e,t){if(Ll(n)&&!t){let r=si(n.index,e);return new bl(r,r)}else if(n.type&175){let r=e[Zt];return new bl(r,e)}return null}function TC(n){Re(8);try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=VO(r),o=[AO({}),{provide:Eo,useExisting:xO},...t||[]],s=new Rl({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return kO({r3Injector:s.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}finally{Re(9)}}function Zl(n){return cp(n)}var aD=class{[Ji];constructor(e){this[Ji]=e}destroy(){this[Ji].destroy()}};var ht=new G("");var SC=null;function qn(){return SC}function cm(n){SC??=n}var Va=class{},lm=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>O(AC),providedIn:"platform"})}return n})();var AC=(()=>{class n extends lm{_location;_history;_doc=O(ht);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return qn().getBaseHref(this._doc)}onPopState(t){let r=qn().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=qn().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function RC(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function CC(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function gr(n){return n&&n[0]!=="?"?`?${n}`:n}var Jl=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>O(xC),providedIn:"root"})}return n})(),MC=new G(""),xC=(()=>{class n extends Jl{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??O(ht).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return RC(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+gr(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+gr(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+gr(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(U(lm),U(MC,8))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ao=(()=>{class n{_subject=new Ne;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=qO(CC(bC(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+gr(r))}normalize(t){return n.stripTrailingSlash(HO(this._basePath,bC(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+gr(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+gr(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=gr;static joinWithSlash=RC;static stripTrailingSlash=CC;static \u0275fac=function(r){return new(r||n)(U(Jl))};static \u0275prov=Q({token:n,factory:()=>$O(),providedIn:"root"})}return n})();function $O(){return new Ao(U(Jl))}function HO(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function bC(n){return n.replace(/\/index.html$/,"")}function qO(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function zO(n,e){return new K(2100,!1)}var dm=class{createSubscription(e,t){return Zl(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){Zl(()=>e.unsubscribe())}},hm=class{createSubscription(e,t){return e.then(r=>t?.(r),r=>{throw r}),{unsubscribe:()=>{t=null}}}dispose(e){e.unsubscribe()}},GO=new hm,WO=new dm,fm=(()=>{class n{_ref;_latestValue=null;markForCheckOnValueUpdate=!0;_subscription=null;_obj=null;_strategy=null;constructor(t){this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,r=>this._updateLatestValue(t,r))}_selectStrategy(t){if(bo(t))return GO;if(im(t))return WO;throw zO(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,r){t===this._obj&&(this._latestValue=r,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static \u0275fac=function(r){return new(r||n)(Gl(Yl,16))};static \u0275pipe=dC({name:"async",type:n,pure:!1})}return n})();var Xl=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Hn({type:n});static \u0275inj=Bn({})}return n})();function pm(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var gm="browser",NC="server";function mr(n){return n===NC}var ja=class{};var nd=new G(""),_m=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,o){return this._findPluginFor(r).addEventListener(t,r,i,o)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new K(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(U(nd),U(Te))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),Ba=class{_doc;constructor(e){this._doc=e}manager},ed="ng-app-id";function PC(n){for(let e of n)e.remove()}function kC(n,e){let t=e.createElement("style");return t.textContent=n,t}function YO(n,e,t,r){let i=n.head?.querySelectorAll(`style[${ed}="${e}"],link[${ed}="${e}"]`);if(i)for(let o of i)o.removeAttribute(ed),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function ym(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var wm=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=mr(o),YO(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,kC);r?.forEach(i=>this.addUsage(i,this.external,ym))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let o=r.get(t);o?o.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(PC(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])PC(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,kC(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,ym(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(ed,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(U(ht),U(jg),U(Ug,8),U(Xt))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),mm={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Em=/%COMP%/g;var FC="%COMP%",ZO=`_nghost-${FC}`,JO=`_ngcontent-${FC}`,XO=!0,e1=new G("",{providedIn:"root",factory:()=>XO});function t1(n){return JO.replace(Em,n)}function n1(n){return ZO.replace(Em,n)}function LC(n,e){return e.map(t=>t.replace(Em,n))}var Im=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,o,s,a,c,l=null,h=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=l,this.tracingService=h,this.platformIsServer=mr(a),this.defaultRenderer=new Ua(t,s,c,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===yn.ShadowDom&&(r=Ee(q({},r),{encapsulation:yn.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof td?i.applyToHost(t):i instanceof $a&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer,m=this.tracingService;switch(r.encapsulation){case yn.Emulated:o=new td(c,l,r,this.appId,h,s,a,p,m);break;case yn.ShadowDom:return new vm(c,l,t,r,s,a,this.nonce,p,m);default:o=new $a(c,l,r,h,s,a,p,m);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(U(_m),U(wm),U(jg),U(e1),U(ht),U(Xt),U(Te),U(Ug),U(Ul,8))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),Ua=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,o){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(mm[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(OC(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(OC(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new K(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=mm[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=mm[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(pi.DashCase|pi.Important)?e.style.setProperty(t,r,i&pi.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&pi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=qn().getGlobalEventTarget(this.doc,e),!e))throw new K(5102,!1);let o=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function OC(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var vm=class extends Ua{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,o,s,a,c,l){super(e,o,s,c,l),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let h=i.styles;h=LC(i.id,h);for(let m of h){let y=document.createElement("style");a&&y.setAttribute("nonce",a),y.textContent=m,this.shadowRoot.appendChild(y)}let p=i.getExternalStyles?.();if(p)for(let m of p){let y=ym(m,o);a&&y.setAttribute("nonce",a),this.shadowRoot.appendChild(y)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},$a=class extends Ua{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,o,s,a,c,l){super(e,o,s,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let h=r.styles;this.styles=l?LC(l,h):h,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},td=class extends $a{contentAttr;hostAttr;constructor(e,t,r,i,o,s,a,c,l){let h=i+"-"+r.id;super(e,t,r,o,s,a,c,l,h),this.contentAttr=t1(h),this.hostAttr=n1(h)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var rd=class n extends Va{supportsDOMEvents=!0;static makeCurrent(){cm(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=r1();return t==null?null:i1(t)}resetBaseElement(){Ha=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return pm(document.cookie,e)}},Ha=null;function r1(){return Ha=Ha||document.querySelector("base"),Ha?Ha.getAttribute("href"):null}function i1(n){return new URL(n,document.baseURI).pathname}var o1=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),jC=(()=>{class n extends Ba{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,o){return t.addEventListener(r,i,o),()=>this.removeEventListener(t,r,i,o)}removeEventListener(t,r,i,o){return t.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||n)(U(ht))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),VC=["alt","control","meta","shift"],s1={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},a1={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},BC=(()=>{class n extends Ba{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,o){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>qn().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),VC.forEach(l=>{let h=r.indexOf(l);h>-1&&(r.splice(h,1),s+=l+".")}),s+=o,r.length!=0||o.length===0)return null;let c={};return c.domEventName=i,c.fullKey=s,c}static matchEventFullKeyCode(t,r){let i=s1[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),VC.forEach(s=>{if(s!==i){let a=a1[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(U(ht))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})();function Dm(n,e){return TC(q({rootComponent:n},u1(e)))}function u1(n){return{appProviders:[...f1,...n?.providers??[]],platformProviders:h1}}function c1(){rd.makeCurrent()}function l1(){return new pr}function d1(){return bT(document),document}var h1=[{provide:Xt,useValue:gm},{provide:Bg,useValue:c1,multi:!0},{provide:ht,useFactory:d1}];var f1=[{provide:Ol,useValue:"root"},{provide:pr,useFactory:l1},{provide:nd,useClass:jC,multi:!0,deps:[ht]},{provide:nd,useClass:BC,multi:!0,deps:[ht]},Im,wm,_m,{provide:Io,useExisting:Im},{provide:ja,useClass:o1},[]];var UC=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(U(ht))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var re="primary",ru=Symbol("RouteTitle"),Am=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function yi(n){return new Am(n)}function QC(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function g1(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!vn(n[t],e[t]))return!1;return!0}function vn(n,e){let t=n?Rm(n):void 0,r=e?Rm(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!YC(n[i],e[i]))return!1;return!0}function Rm(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function YC(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function ZC(n){return n.length>0?n[n.length-1]:null}function _r(n){return Ip(n)?n:bo(n)?_e(Promise.resolve(n)):Y(n)}var m1={exact:XC,subset:eb},JC={exact:y1,subset:v1,ignored:()=>!0};function $C(n,e,t){return m1[t.paths](n.root,e.root,t.matrixParams)&&JC[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function y1(n,e){return vn(n,e)}function XC(n,e,t){if(!gi(n.segments,e.segments)||!sd(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!XC(n.children[r],e.children[r],t))return!1;return!0}function v1(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>YC(n[t],e[t]))}function eb(n,e,t){return tb(n,e,e.segments,t)}function tb(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!gi(i,t)||e.hasChildren()||!sd(i,t,r))}else if(n.segments.length===t.length){if(!gi(n.segments,t)||!sd(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!eb(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!gi(n.segments,i)||!sd(n.segments,i,r)||!n.children[re]?!1:tb(n.children[re],e,o,r)}}function sd(n,e,t){return e.every((r,i)=>JC[t](n[i].parameters,r.parameters))}var wn=class{root;queryParams;fragment;_queryParamMap;constructor(e=new ve([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=yi(this.queryParams),this._queryParamMap}toString(){return E1.serialize(this)}},ve=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ad(this)}},yr=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=yi(this.parameters),this._parameterMap}toString(){return rb(this)}};function _1(n,e){return gi(n,e)&&n.every((t,r)=>vn(t.parameters,e[r].parameters))}function gi(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function w1(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===re&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==re&&(t=t.concat(e(i,r)))}),t}var iu=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>new vi,providedIn:"root"})}return n})(),vi=class{parse(e){let t=new xm(e);return new wn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${qa(e.root,!0)}`,r=T1(e.queryParams),i=typeof e.fragment=="string"?`#${I1(e.fragment)}`:"";return`${t}${r}${i}`}},E1=new vi;function ad(n){return n.segments.map(e=>rb(e)).join("/")}function qa(n,e){if(!n.hasChildren())return ad(n);if(e){let t=n.children[re]?qa(n.children[re],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==re&&r.push(`${i}:${qa(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=w1(n,(r,i)=>i===re?[qa(n.children[re],!1)]:[`${i}:${qa(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[re]!=null?`${ad(n)}/${t[0]}`:`${ad(n)}/(${t.join("//")})`}}function nb(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function id(n){return nb(n).replace(/%3B/gi,";")}function I1(n){return encodeURI(n)}function Mm(n){return nb(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ud(n){return decodeURIComponent(n)}function HC(n){return ud(n.replace(/\+/g,"%20"))}function rb(n){return`${Mm(n.path)}${D1(n.parameters)}`}function D1(n){return Object.entries(n).map(([e,t])=>`;${Mm(e)}=${Mm(t)}`).join("")}function T1(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${id(t)}=${id(i)}`).join("&"):`${id(t)}=${id(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var C1=/^[^\/()?;#]+/;function Tm(n){let e=n.match(C1);return e?e[0]:""}var b1=/^[^\/()?;=#]+/;function S1(n){let e=n.match(b1);return e?e[0]:""}var A1=/^[^=?&#]+/;function R1(n){let e=n.match(A1);return e?e[0]:""}var M1=/^[^&#]+/;function x1(n){let e=n.match(M1);return e?e[0]:""}var xm=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ve([],{}):new ve([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[re]=new ve(e,t)),r}parseSegment(){let e=Tm(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new K(4009,!1);return this.capture(e),new yr(ud(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=S1(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Tm(this.remaining);i&&(r=i,this.capture(r))}e[ud(t)]=ud(r)}parseQueryParam(e){let t=R1(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=x1(this.remaining);s&&(r=s,this.capture(r))}let i=HC(t),o=HC(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Tm(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new K(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=re);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[re]:new ve([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new K(4011,!1)}};function ib(n){return n.segments.length>0?new ve([],{[re]:n}):n}function ob(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=ob(i);if(r===re&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new ve(n.segments,e);return N1(t)}function N1(n){if(n.numberOfChildren===1&&n.children[re]){let e=n.children[re];return new ve(n.segments.concat(e.segments),e.children)}return n}function Po(n){return n instanceof wn}function sb(n,e,t=null,r=null){let i=ab(n);return ub(i,e,t,r)}function ab(n){let e;function t(o){let s={};for(let c of o.children){let l=t(c);s[c.outlet]=l}let a=new ve(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=ib(r);return e??i}function ub(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Cm(i,i,i,t,r);let o=P1(e);if(o.toRoot())return Cm(i,i,new ve([],{}),t,r);let s=k1(o,i,n),a=s.processChildren?Ga(s.segmentGroup,s.index,o.commands):lb(s.segmentGroup,s.index,o.commands);return Cm(i,s.segmentGroup,a,t,r)}function ld(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Ka(n){return typeof n=="object"&&n!=null&&n.outlets}function Cm(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(h=>`${h}`):`${l}`});let s;n===e?s=t:s=cb(n,e,t);let a=ib(ob(s));return new wn(a,o,i)}function cb(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=cb(o,e,t)}),new ve(n.segments,r)}var dd=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&ld(r[0]))throw new K(4003,!1);let i=r.find(Ka);if(i&&i!==ZC(r))throw new K(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function P1(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new dd(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new dd(t,e,r)}var xo=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function k1(n,e,t){if(n.isAbsolute)return new xo(e,!0,0);if(!t)return new xo(e,!1,NaN);if(t.parent===null)return new xo(t,!0,0);let r=ld(n.commands[0])?0:1,i=t.segments.length-1+r;return O1(t,i,n.numberOfDoubleDots)}function O1(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new K(4005,!1);i=r.segments.length}return new xo(r,!1,i-o)}function F1(n){return Ka(n[0])?n[0].outlets:{[re]:n}}function lb(n,e,t){if(n??=new ve([],{}),n.segments.length===0&&n.hasChildren())return Ga(n,e,t);let r=L1(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new ve(n.segments.slice(0,r.pathIndex),{});return o.children[re]=new ve(n.segments.slice(r.pathIndex),n.children),Ga(o,0,i)}else return r.match&&i.length===0?new ve(n.segments,{}):r.match&&!n.hasChildren()?Nm(n,e,t):r.match?Ga(n,0,i):Nm(n,e,t)}function Ga(n,e,t){if(t.length===0)return new ve(n.segments,{});{let r=F1(t),i={};if(Object.keys(r).some(o=>o!==re)&&n.children[re]&&n.numberOfChildren===1&&n.children[re].segments.length===0){let o=Ga(n.children[re],e,t);return new ve(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=lb(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new ve(n.segments,i)}}function L1(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(Ka(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!zC(c,l,s))return o;r+=2}else{if(!zC(c,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Nm(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Ka(o)){let c=V1(o.outlets);return new ve(r,c)}if(i===0&&ld(t[0])){let c=n.segments[e];r.push(new yr(c.path,qC(t[0]))),i++;continue}let s=Ka(o)?o.outlets[re]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&ld(a)?(r.push(new yr(s,qC(a))),i+=2):(r.push(new yr(s,{})),i++)}return new ve(r,{})}function V1(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Nm(new ve([],{}),0,r))}),e}function qC(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function zC(n,e,t){return n==t.path&&vn(e,t.parameters)}var cd="imperative",Xe=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Xe||{}),Ot=class{id;url;constructor(e,t){this.id=e,this.url=t}},_i=class extends Ot{type=Xe.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},zn=class extends Ot{urlAfterRedirects;type=Xe.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Rt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Rt||{}),Qa=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Qa||{}),_n=class extends Ot{reason;code;type=Xe.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Gn=class extends Ot{reason;code;type=Xe.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},ko=class extends Ot{error;target;type=Xe.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Ya=class extends Ot{urlAfterRedirects;state;type=Xe.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},hd=class extends Ot{urlAfterRedirects;state;type=Xe.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fd=class extends Ot{urlAfterRedirects;state;shouldActivate;type=Xe.GuardsCheckEnd;constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},pd=class extends Ot{urlAfterRedirects;state;type=Xe.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},gd=class extends Ot{urlAfterRedirects;state;type=Xe.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},md=class{route;type=Xe.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},yd=class{route;type=Xe.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},vd=class{snapshot;type=Xe.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},_d=class{snapshot;type=Xe.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},wd=class{snapshot;type=Xe.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ed=class{snapshot;type=Xe.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Za=class{},Oo=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function j1(n,e){return n.providers&&!n._injector&&(n._injector=Kl(n.providers,e,`Route: ${n.path}`)),n._injector??e}function tn(n){return n.outlet||re}function B1(n,e){let t=n.filter(r=>tn(r)===e);return t.push(...n.filter(r=>tn(r)!==e)),t}function ou(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Id=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return ou(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Vo(this.rootInjector)}},Vo=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Id(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(U(Ye))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Dd=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Pm(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Pm(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=km(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return km(e,this._root).map(t=>t.value)}};function Pm(n,e){if(n===e.value)return e;for(let t of e.children){let r=Pm(n,t);if(r)return r}return null}function km(n,e){if(n===e.value)return[e];for(let t of e.children){let r=km(n,t);if(r.length)return r.unshift(e),r}return[]}var kt=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Mo(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Ja=class extends Dd{snapshot;constructor(e,t){super(e),this.snapshot=t,$m(this,e)}toString(){return this.snapshot.toString()}};function db(n){let e=U1(n),t=new tt([new yr("",{})]),r=new tt({}),i=new tt({}),o=new tt({}),s=new tt(""),a=new vr(t,r,o,s,i,re,n,e.root);return a.snapshot=e.root,new Ja(new kt(a,[]),e)}function U1(n){let e={},t={},r={},i="",o=new mi([],e,r,i,t,re,n,null,{});return new Xa("",new kt(o,[]))}var vr=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(X(l=>l[ru]))??Y(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(X(e=>yi(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(X(e=>yi(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Td(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:q(q({},e.params),n.params),data:q(q({},e.data),n.data),resolve:q(q(q(q({},n.data),e.data),i?.data),n._resolvedData)}:r={params:q({},n.params),data:q({},n.data),resolve:q(q({},n.data),n._resolvedData??{})},i&&fb(i)&&(r.resolve[ru]=i.title),r}var mi=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[ru]}constructor(e,t,r,i,o,s,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=yi(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=yi(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Xa=class extends Dd{url;constructor(e,t){super(t),this.url=e,$m(this,t)}toString(){return hb(this._root)}};function $m(n,e){e.value._routerState=n,e.children.forEach(t=>$m(n,t))}function hb(n){let e=n.children.length>0?` { ${n.children.map(hb).join(", ")} } `:"";return`${n.value}${e}`}function bm(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,vn(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),vn(e.params,t.params)||n.paramsSubject.next(t.params),g1(e.url,t.url)||n.urlSubject.next(t.url),vn(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Om(n,e){let t=vn(n.params,e.params)&&_1(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Om(n.parent,e.parent))}function fb(n){return typeof n.title=="string"||n.title===null}var pb=new G(""),su=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=re;activateEvents=new At;deactivateEvents=new At;attachEvents=new At;detachEvents=new At;routerOutletData=vT(void 0);parentContexts=O(Vo);location=O(Wl);changeDetector=O(Yl);inputBinder=O(Ad,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new K(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new K(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new K(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new K(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new Fm(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(s,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=rm({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[bg]})}return n})(),Fm=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===vr?this.route:e===Vo?this.childContexts:e===pb?this.outletData:this.parent.get(e,t)}},Ad=new G("");var Hm=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Ql({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&So(0,"router-outlet")},dependencies:[su],encapsulation:2})}return n})();function qm(n){let e=n.children&&n.children.map(qm),t=e?Ee(q({},n),{children:e}):q({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==re&&(t.component=Hm),t}function $1(n,e,t){let r=eu(n,e._root,t?t._root:void 0);return new Ja(r,e)}function eu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=H1(n,e,t);return new kt(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>eu(n,a)),s}}let r=q1(e.value),i=e.children.map(o=>eu(n,o));return new kt(r,i)}}function H1(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return eu(n,r,i);return eu(n,r)})}function q1(n){return new vr(new tt(n.url),new tt(n.params),new tt(n.queryParams),new tt(n.fragment),new tt(n.data),n.outlet,n.component,n)}var Fo=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},gb="ngNavigationCancelingError";function Cd(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Po(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=mb(!1,Rt.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function mb(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[gb]=!0,t.cancellationCode=e,t}function z1(n){return yb(n)&&Po(n.url)}function yb(n){return!!n&&n[gb]}var G1=(n,e,t,r)=>X(i=>(new Lm(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Lm=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),bm(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Mo(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=Mo(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=Mo(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Mo(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new Ed(o.value.snapshot))}),e.children.length&&this.forwardEvent(new _d(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(bm(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),bm(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},bd=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},No=class{component;route;constructor(e,t){this.component=e,this.route=t}};function W1(n,e,t){let r=n._root,i=e?e._root:null;return za(r,i,t,[r.value])}function K1(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function jo(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!hD(n)?n:e.get(n):r}function za(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=Mo(e);return n.children.forEach(s=>{Q1(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Wa(a,t.getContext(s),i)),i}function Q1(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=Y1(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new bd(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?za(n,e,a?a.children:null,r,i):za(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new No(a.outlet.component,s))}else s&&Wa(e,a,i),i.canActivateChecks.push(new bd(r)),o.component?za(n,null,a?a.children:null,r,i):za(n,null,t,r,i);return i}function Y1(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!gi(n.url,e.url);case"pathParamsOrQueryParamsChange":return!gi(n.url,e.url)||!vn(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Om(n,e)||!vn(n.queryParams,e.queryParams);case"paramsChange":default:return!Om(n,e)}}function Wa(n,e,t){let r=Mo(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?Wa(s,e.children.getContext(o),t):Wa(s,null,t):Wa(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new No(e.outlet.component,i)):t.canDeactivateChecks.push(new No(null,i)):t.canDeactivateChecks.push(new No(null,i))}function au(n){return typeof n=="function"}function Z1(n){return typeof n=="boolean"}function J1(n){return n&&au(n.canLoad)}function X1(n){return n&&au(n.canActivate)}function eF(n){return n&&au(n.canActivateChild)}function tF(n){return n&&au(n.canDeactivate)}function nF(n){return n&&au(n.canMatch)}function vb(n){return n instanceof Ln||n?.name==="EmptyError"}var od=Symbol("INITIAL_VALUE");function Lo(){return je(n=>Zc(n.map(e=>e.pipe(Vn(1),ei(od)))).pipe(X(e=>{for(let t of e)if(t!==!0){if(t===od)return od;if(t===!1||rF(t))return t}return!0}),dt(e=>e!==od),Vn(1)))}function rF(n){return Po(n)||n instanceof Fo}function iF(n,e){return Qe(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?Y(Ee(q({},t),{guardsResult:!0})):oF(s,r,i,n).pipe(Qe(a=>a&&Z1(a)?sF(r,o,n,e):Y(a)),X(a=>Ee(q({},t),{guardsResult:a})))})}function oF(n,e,t,r){return _e(n).pipe(Qe(i=>dF(i.component,i.route,t,e,r)),Kt(i=>i!==!0,!0))}function sF(n,e,t,r){return _e(e).pipe(lo(i=>co(uF(i.route.parent,r),aF(i.route,r),lF(n,i.path,t),cF(n,i.route,t))),Kt(i=>i!==!0,!0))}function aF(n,e){return n!==null&&e&&e(new wd(n)),Y(!0)}function uF(n,e){return n!==null&&e&&e(new vd(n)),Y(!0)}function cF(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return Y(!0);let i=r.map(o=>Xc(()=>{let s=ou(e)??t,a=jo(o,s),c=X1(a)?a.canActivate(e,n):Ht(s,()=>a(e,n));return _r(c).pipe(Kt())}));return Y(i).pipe(Lo())}function lF(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>K1(s)).filter(s=>s!==null).map(s=>Xc(()=>{let a=s.guards.map(c=>{let l=ou(s.node)??t,h=jo(c,l),p=eF(h)?h.canActivateChild(r,n):Ht(l,()=>h(r,n));return _r(p).pipe(Kt())});return Y(a).pipe(Lo())}));return Y(o).pipe(Lo())}function dF(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return Y(!0);let s=o.map(a=>{let c=ou(e)??i,l=jo(a,c),h=tF(l)?l.canDeactivate(n,e,t,r):Ht(c,()=>l(n,e,t,r));return _r(h).pipe(Kt())});return Y(s).pipe(Lo())}function hF(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return Y(!0);let o=i.map(s=>{let a=jo(s,n),c=J1(a)?a.canLoad(e,t):Ht(n,()=>a(e,t));return _r(c)});return Y(o).pipe(Lo(),_b(r))}function _b(n){return mp(nt(e=>{if(typeof e!="boolean")throw Cd(n,e)}),X(e=>e===!0))}function fF(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return Y(!0);let o=i.map(s=>{let a=jo(s,n),c=nF(a)?a.canMatch(e,t):Ht(n,()=>a(e,t));return _r(c)});return Y(o).pipe(Lo(),_b(r))}var tu=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},nu=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function Ro(n){return uo(new tu(n))}function pF(n){return uo(new K(4e3,!1))}function gF(n){return uo(mb(!1,Rt.GuardRejected))}var Vm=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return Y(r);if(i.numberOfChildren>1||!i.children[re])return pF(`${e.redirectTo}`);i=i.children[re]}}applyRedirectCommands(e,t,r,i,o){if(typeof t!="string"){let a=t,{queryParams:c,fragment:l,routeConfig:h,url:p,outlet:m,params:y,data:T,title:A}=i,N=Ht(o,()=>a({params:y,data:T,queryParams:c,fragment:l,routeConfig:h,url:p,outlet:m,title:A}));if(N instanceof wn)throw new nu(N);t=N}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new nu(s);return s}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new wn(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,r,i)}),new ve(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new K(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},jm={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function mF(n,e,t,r,i){let o=wb(n,e,t);return o.matched?(r=j1(e,r),fF(r,e,t,i).pipe(X(s=>s===!0?o:q({},jm)))):Y(o)}function wb(n,e,t){if(e.path==="**")return yF(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?q({},jm):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||QC)(t,n,e);if(!i)return q({},jm);let o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=i.consumed.length>0?q(q({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function yF(n){return{matched:!0,parameters:n.length>0?ZC(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function GC(n,e,t,r){return t.length>0&&wF(n,t,r)?{segmentGroup:new ve(e,_F(r,new ve(t,n.children))),slicedSegments:[]}:t.length===0&&EF(n,t,r)?{segmentGroup:new ve(n.segments,vF(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new ve(n.segments,n.children),slicedSegments:t}}function vF(n,e,t,r){let i={};for(let o of t)if(Rd(n,e,o)&&!r[tn(o)]){let s=new ve([],{});i[tn(o)]=s}return q(q({},r),i)}function _F(n,e){let t={};t[re]=e;for(let r of n)if(r.path===""&&tn(r)!==re){let i=new ve([],{});t[tn(r)]=i}return t}function wF(n,e,t){return t.some(r=>Rd(n,e,r)&&tn(r)!==re)}function EF(n,e,t){return t.some(r=>Rd(n,e,r))}function Rd(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function IF(n,e,t){return e.length===0&&!n.children[t]}var Bm=class{};function DF(n,e,t,r,i,o,s="emptyOnly"){return new Um(n,e,t,r,i,s,o).recognize()}var TF=31,Um=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new Vm(this.urlSerializer,this.urlTree)}noMatchError(e){return new K(4002,`'${e.segmentGroup}'`)}recognize(){let e=GC(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(X(({children:t,rootSnapshot:r})=>{let i=new kt(r,t),o=new Xa("",i),s=sb(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new mi([],Object.freeze({}),Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),re,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,re,t).pipe(X(r=>({children:r,rootSnapshot:t})),lr(r=>{if(r instanceof nu)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof tu?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(X(s=>s instanceof kt?[s]:[]))}processChildren(e,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return _e(o).pipe(lo(s=>{let a=r.children[s],c=B1(t,s);return this.processSegmentGroup(e,c,a,s,i)}),Xr((s,a)=>(s.push(...a),s)),dr(null),Cp(),Qe(s=>{if(s===null)return Ro(r);let a=Eb(s);return CF(a),Y(a)}))}processSegment(e,t,r,i,o,s,a){return _e(t).pipe(lo(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,o,s,a).pipe(lr(l=>{if(l instanceof tu)return Y(null);throw l}))),Kt(c=>!!c),lr(c=>{if(vb(c))return IF(r,i,o)?Y(new Bm):Ro(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,o,s,a,c){return tn(r)!==s&&(s===re||!Rd(i,o,r))?Ro(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,c):Ro(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:c,parameters:l,consumedSegments:h,positionalParamSegments:p,remainingSegments:m}=wb(t,i,o);if(!c)return Ro(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>TF&&(this.allowRedirects=!1));let y=new mi(o,l,Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,WC(i),tn(i),i.component??i._loadedComponent??null,i,KC(i)),T=Td(y,a,this.paramsInheritanceStrategy);y.params=Object.freeze(T.params),y.data=Object.freeze(T.data);let A=this.applyRedirects.applyRedirectCommands(h,i.redirectTo,p,y,e);return this.applyRedirects.lineralizeSegments(i,A).pipe(Qe(N=>this.processSegment(e,r,t,N.concat(m),s,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,o,s){let a=mF(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(je(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(je(({routes:l})=>{let h=r._loadedInjector??e,{parameters:p,consumedSegments:m,remainingSegments:y}=c,T=new mi(m,p,Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,WC(r),tn(r),r.component??r._loadedComponent??null,r,KC(r)),A=Td(T,s,this.paramsInheritanceStrategy);T.params=Object.freeze(A.params),T.data=Object.freeze(A.data);let{segmentGroup:N,slicedSegments:V}=GC(t,m,y,l);if(V.length===0&&N.hasChildren())return this.processChildren(h,l,N,T).pipe(X(F=>new kt(T,F)));if(l.length===0&&V.length===0)return Y(new kt(T,[]));let H=tn(r)===o;return this.processSegment(h,l,N,V,H?re:o,!0,T).pipe(X(F=>new kt(T,F instanceof kt?[F]:[])))}))):Ro(t)))}getChildConfig(e,t,r){return t.children?Y({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Y({routes:t._loadedRoutes,injector:t._loadedInjector}):hF(e,t,r,this.urlSerializer).pipe(Qe(i=>i?this.configLoader.loadChildren(e,t).pipe(nt(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):gF(t))):Y({routes:[],injector:e})}};function CF(n){n.sort((e,t)=>e.value.outlet===re?-1:t.value.outlet===re?1:e.value.outlet.localeCompare(t.value.outlet))}function bF(n){let e=n.value.routeConfig;return e&&e.path===""}function Eb(n){let e=[],t=new Set;for(let r of n){if(!bF(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=Eb(r.children);e.push(new kt(r.value,i))}return e.filter(r=>!t.has(r))}function WC(n){return n.data||{}}function KC(n){return n.resolve||{}}function SF(n,e,t,r,i,o){return Qe(s=>DF(n,e,t,r,s.extractedUrl,i,o).pipe(X(({state:a,tree:c})=>Ee(q({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function AF(n,e){return Qe(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Y(t);let o=new Set(i.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let l of Ib(c))s.add(l);let a=0;return _e(s).pipe(lo(c=>o.has(c)?RF(c,r,n,e):(c.data=Td(c,c.parent,n).resolve,Y(void 0))),nt(()=>a++),ho(1),Qe(c=>a===s.size?Y(t):lt))})}function Ib(n){let e=n.children.map(t=>Ib(t)).flat();return[n,...e]}function RF(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!fb(i)&&(o[ru]=i.title),MF(o,n,e,r).pipe(X(s=>(n._resolvedData=s,n.data=Td(n,n.parent,t).resolve,null)))}function MF(n,e,t,r){let i=Rm(n);if(i.length===0)return Y({});let o={};return _e(i).pipe(Qe(s=>xF(n[s],e,t,r).pipe(Kt(),nt(a=>{if(a instanceof Fo)throw Cd(new vi,a);o[s]=a}))),ho(1),X(()=>o),lr(s=>vb(s)?lt:uo(s)))}function xF(n,e,t,r){let i=ou(e)??r,o=jo(n,i),s=o.resolve?o.resolve(e,t):Ht(i,()=>o(e,t));return _r(s)}function Sm(n){return je(e=>{let t=n(e);return t?_e(t).pipe(X(()=>e)):Y(e)})}var zm=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===re);return r}getResolvedTitleForRoute(t){return t.data[ru]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>O(Db),providedIn:"root"})}return n})(),Db=(()=>{class n extends zm{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(U(UC))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),uu=new G("",{providedIn:"root",factory:()=>({})}),cu=new G(""),Tb=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=O(DC);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Y(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=_r(t.loadComponent()).pipe(X(bb),nt(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),fa(()=>{this.componentLoaders.delete(t)})),i=new io(r,()=>new Ne).pipe(ro());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Y({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=Cb(r,this.compiler,t,this.onLoadEndListener).pipe(fa(()=>{this.childrenLoaders.delete(r)})),s=new io(o,()=>new Ne).pipe(ro());return this.childrenLoaders.set(r,s),s}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Cb(n,e,t,r){return _r(n.loadChildren()).pipe(X(bb),Qe(i=>i instanceof nm||Array.isArray(i)?Y(i):_e(e.compileModuleAsync(i))),X(i=>{r&&r(n);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(cu,[],{optional:!0,self:!0}).flat()),{routes:s.map(qm),injector:o}}))}function NF(n){return n&&typeof n=="object"&&"default"in n}function bb(n){return NF(n)?n.default:n}var Md=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>O(PF),providedIn:"root"})}return n})(),PF=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Sb=new G("");var Ab=new G(""),Rb=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new Ne;transitionAbortSubject=new Ne;configLoader=O(Tb);environmentInjector=O(Ye);destroyRef=O(Na);urlSerializer=O(iu);rootContexts=O(Vo);location=O(Ao);inputBindingEnabled=O(Ad,{optional:!0})!==null;titleStrategy=O(zm);options=O(uu,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=O(Md);createViewTransition=O(Sb,{optional:!0});navigationErrorHandler=O(Ab,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>Y(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new md(i)),r=i=>this.events.next(new yd(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(Ee(q({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))}setupNavigations(t){return this.transitions=new tt(null),this.transitions.pipe(dt(r=>r!==null),je(r=>{let i=!1,o=!1;return Y(r).pipe(je(s=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",Rt.SupersededByNewNavigation),lt;this.currentTransition=r,this.currentNavigation={id:s.id,initialUrl:s.rawUrl,extractedUrl:s.extractedUrl,targetBrowserUrl:typeof s.extras.browserUrl=="string"?this.urlSerializer.parse(s.extras.browserUrl):s.extras.browserUrl,trigger:s.source,extras:s.extras,previousNavigation:this.lastSuccessfulNavigation?Ee(q({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let a=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),c=s.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!a&&c!=="reload"){let l="";return this.events.next(new Gn(s.id,this.urlSerializer.serialize(s.rawUrl),l,Qa.IgnoredSameUrlNavigation)),s.resolve(!1),lt}if(this.urlHandlingStrategy.shouldProcessUrl(s.rawUrl))return Y(s).pipe(je(l=>(this.events.next(new _i(l.id,this.urlSerializer.serialize(l.extractedUrl),l.source,l.restoredState)),l.id!==this.navigationId?lt:Promise.resolve(l))),SF(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),nt(l=>{r.targetSnapshot=l.targetSnapshot,r.urlAfterRedirects=l.urlAfterRedirects,this.currentNavigation=Ee(q({},this.currentNavigation),{finalUrl:l.urlAfterRedirects});let h=new Ya(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}));if(a&&this.urlHandlingStrategy.shouldProcessUrl(s.currentRawUrl)){let{id:l,extractedUrl:h,source:p,restoredState:m,extras:y}=s,T=new _i(l,this.urlSerializer.serialize(h),p,m);this.events.next(T);let A=db(this.rootComponentType).snapshot;return this.currentTransition=r=Ee(q({},s),{targetSnapshot:A,urlAfterRedirects:h,extras:Ee(q({},y),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=h,Y(r)}else{let l="";return this.events.next(new Gn(s.id,this.urlSerializer.serialize(s.extractedUrl),l,Qa.IgnoredByUrlHandlingStrategy)),s.resolve(!1),lt}}),nt(s=>{let a=new hd(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}),X(s=>(this.currentTransition=r=Ee(q({},s),{guards:W1(s.targetSnapshot,s.currentSnapshot,this.rootContexts)}),r)),iF(this.environmentInjector,s=>this.events.next(s)),nt(s=>{if(r.guardsResult=s.guardsResult,s.guardsResult&&typeof s.guardsResult!="boolean")throw Cd(this.urlSerializer,s.guardsResult);let a=new fd(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot,!!s.guardsResult);this.events.next(a)}),dt(s=>s.guardsResult?!0:(this.cancelNavigationTransition(s,"",Rt.GuardRejected),!1)),Sm(s=>{if(s.guards.canActivateChecks.length!==0)return Y(s).pipe(nt(a=>{let c=new pd(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),je(a=>{let c=!1;return Y(a).pipe(AF(this.paramsInheritanceStrategy,this.environmentInjector),nt({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(a,"",Rt.NoDataFromResolver)}}))}),nt(a=>{let c=new gd(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}))}),Sm(s=>{let a=c=>{let l=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&l.push(this.configLoader.loadComponent(c.routeConfig).pipe(nt(h=>{c.component=h}),X(()=>{})));for(let h of c.children)l.push(...a(h));return l};return Zc(a(s.targetSnapshot.root)).pipe(dr(null),Vn(1))}),Sm(()=>this.afterPreactivation()),je(()=>{let{currentSnapshot:s,targetSnapshot:a}=r,c=this.createViewTransition?.(this.environmentInjector,s.root,a.root);return c?_e(c).pipe(X(()=>r)):Y(r)}),X(s=>{let a=$1(t.routeReuseStrategy,s.targetSnapshot,s.currentRouterState);return this.currentTransition=r=Ee(q({},s),{targetRouterState:a}),this.currentNavigation.targetRouterState=a,r}),nt(()=>{this.events.next(new Za)}),G1(this.rootContexts,t.routeReuseStrategy,s=>this.events.next(s),this.inputBindingEnabled),Vn(1),nt({next:s=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new zn(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects))),this.titleStrategy?.updateTitle(s.targetRouterState.snapshot),s.resolve(!0)},complete:()=>{i=!0}}),Sp(this.transitionAbortSubject.pipe(nt(s=>{throw s}))),fa(()=>{!i&&!o&&this.cancelNavigationTransition(r,"",Rt.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation=null,this.currentTransition=null)}),lr(s=>{if(this.destroyed)return r.resolve(!1),lt;if(o=!0,yb(s))this.events.next(new _n(r.id,this.urlSerializer.serialize(r.extractedUrl),s.message,s.cancellationCode)),z1(s)?this.events.next(new Oo(s.url,s.navigationBehaviorOptions)):r.resolve(!1);else{let a=new ko(r.id,this.urlSerializer.serialize(r.extractedUrl),s,r.targetSnapshot??void 0);try{let c=Ht(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(c instanceof Fo){let{message:l,cancellationCode:h}=Cd(this.urlSerializer,c);this.events.next(new _n(r.id,this.urlSerializer.serialize(r.extractedUrl),l,h)),this.events.next(new Oo(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(a),s}catch(c){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(c)}}return lt}))}))}cancelNavigationTransition(t,r,i){let o=new _n(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function kF(n){return n!==cd}var Mb=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>O(OF),providedIn:"root"})}return n})(),Sd=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},OF=(()=>{class n extends Sd{static \u0275fac=(()=>{let t;return function(i){return(t||(t=kg(n)))(i||n)}})();static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),xb=(()=>{class n{urlSerializer=O(iu);options=O(uu,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=O(Ao);urlHandlingStrategy=O(Md);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new wn;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,s=i??o;return s instanceof wn?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=db(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>O(FF),providedIn:"root"})}return n})(),FF=(()=>{class n extends xb{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof _i?this.updateStateMemento():t instanceof Gn?this.commitTransition(r):t instanceof Ya?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof Za?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof _n&&(t.code===Rt.GuardRejected||t.code===Rt.NoDataFromResolver)?this.restoreHistory(r):t instanceof ko?this.restoreHistory(r,!0):t instanceof zn&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:o,state:s}=r;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,c=q(q({},s),this.generateNgRouterState(i,a));this.location.replaceState(t,"",c)}else{let a=q(q({},s),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=kg(n)))(i||n)}})();static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Gm(n,e){n.events.pipe(dt(t=>t instanceof zn||t instanceof _n||t instanceof ko||t instanceof Gn),X(t=>t instanceof zn||t instanceof Gn?0:(t instanceof _n?t.code===Rt.Redirect||t.code===Rt.SupersededByNewNavigation:!1)?2:1),dt(t=>t!==2),Vn(1)).subscribe(()=>{e()})}var LF={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},VF={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},xd=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=O(pC);stateManager=O(xb);options=O(uu,{optional:!0})||{};pendingTasks=O(fi);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=O(Rb);urlSerializer=O(iu);location=O(Ao);urlHandlingStrategy=O(Md);_events=new Ne;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=O(Mb);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=O(cu,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!O(Ad,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Le;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof _n&&r.code!==Rt.Redirect&&r.code!==Rt.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof zn)this.navigated=!0;else if(r instanceof Oo){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=q({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||kF(i.source)},s);this.scheduleNavigation(a,cd,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}BF(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),cd,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let c=q({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(qm),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:s,h=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":h=q(q({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let m=i?i.snapshot:this.routerState.snapshot.root;p=ab(m)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return ub(p,t,h,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Po(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,cd,null,r)}navigate(t,r={skipLocationChange:!1}){return jF(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=q({},LF):r===!1?i=q({},VF):i=r,Po(t))return $C(this.currentUrlTree,t,i);let o=this.parseUrl(t);return $C(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,l;s?(a=s.resolve,c=s.reject,l=s.promise):l=new Promise((p,m)=>{a=p,c=m});let h=this.pendingTasks.add();return Gm(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(p=>Promise.reject(p))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function jF(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new K(4008,!1)}function BF(n){return!(n instanceof Za)&&!(n instanceof Oo)}var $F=new G("");function Wm(n,...e){return TD([{provide:cu,multi:!0,useValue:n},[],{provide:vr,useFactory:HF,deps:[xd]},{provide:om,multi:!0,useFactory:qF},e.map(t=>t.\u0275providers)])}function HF(n){return n.routerState.root}function qF(){let n=O(mn);return e=>{let t=n.get(ci);if(e!==t.components[0])return;let r=n.get(xd),i=n.get(zF);n.get(GF)===1&&r.initialNavigation(),n.get(WF,null,oe.Optional)?.setUpPreloading(),n.get($F,null,oe.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var zF=new G("",{factory:()=>new Ne}),GF=new G("",{providedIn:"root",factory:()=>1});var WF=new G("");var QF="firebase",YF="11.7.3";cr(QF,YF,"app");function It(n){n===void 0&&(RD(It),n=O(mn));let e=n.get(Og);return t=>new ce(r=>{let i=e.add(),o=!1;function s(){o||(i(),o=!0)}let a=t.subscribe({next:c=>{r.next(c),s()},complete:()=>{r.complete(),s()},error:c=>{r.error(c),s()}});return a.add(()=>{r.unsubscribe(),s()}),a})}var Bo=new Aa("ANGULARFIRE2_VERSION");var Nb=(n,e)=>{let t=e?[e]:HE(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},Km=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(Km||{}),G8=La()&&typeof Zone<"u"?Km.WARN:Km.SILENT;var Nd=class{zone;delegate;constructor(e,t=wp){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i?i.runGuarded(()=>{e.apply(this,[s])}):e.apply(this,[s])};return this.delegate.schedule(o,t,r)}},lu=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=O(Te);this.outsideAngular=t.runOutsideAngular(()=>new Nd(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new Nd(typeof Zone>"u"?void 0:Zone.current,ha))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var XF=new Map,eL={activated:!1,tokenObservers:[]},tL={initialized:!1,enabled:!1};function nn(n){return XF.get(n)||Object.assign({},eL)}function Lb(){return tL}var nL="https://content-firebaseappcheck.googleapis.com/v1";var rL="exchangeDebugToken",kb={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},X8=24*60*60*1e3;var Zm=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return x(this,null,function*(){this.stop();try{this.pending=new Kf,this.pending.promise.catch(t=>{}),yield iL(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Kf,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function iL(n){return new Promise(e=>{setTimeout(e,n)})}var oL={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},wr=new BE("appCheck","AppCheck",oL);function Vb(n){if(!nn(n).activated)throw wr.create("use-before-activation",{appName:n.name})}function jb(r,i){return x(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let y=yield s.getHeartbeatsHeader();y&&(o["X-Firebase-Client"]=y)}let a={method:"POST",body:JSON.stringify(e),headers:o},c;try{c=yield fetch(n,a)}catch(y){throw wr.create("fetch-network-error",{originalErrorMessage:y?.message})}if(c.status!==200)throw wr.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(y){throw wr.create("fetch-parse-error",{originalErrorMessage:y?.message})}let h=l.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw wr.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let p=Number(h[1])*1e3,m=Date.now();return{token:l.token,expireTimeMillis:m+p,issuedAtTimeMillis:m}})}function Bb(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${nL}/projects/${t}/apps/${r}:${rL}?key=${i}`,body:{debug_token:e}}}var sL="firebase-app-check-database",aL=1,Jm="firebase-app-check-store";var Pd=null;function uL(){return Pd||(Pd=new Promise((n,e)=>{try{let t=indexedDB.open(sL,aL);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(wr.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Jm,{keyPath:"compositeKey"})}}}catch(t){e(wr.create("storage-open",{originalErrorMessage:t?.message}))}}),Pd)}function cL(n,e){return lL(dL(n),e)}function lL(n,e){return x(this,null,function*(){let r=(yield uL()).transaction(Jm,"readwrite"),o=r.objectStore(Jm).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=c=>{s()},r.onerror=c=>{var l;a(wr.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function dL(n){return`${n.options.appId}-${n.name}`}var du=new Sc("@firebase/app-check");function Qm(n,e){return Cc()?cL(n,e).catch(t=>{du.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Ub(){return Lb().enabled}function $b(){return x(this,null,function*(){let n=Lb();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var hL={error:"UNKNOWN_ERROR"};function fL(n){return FE.encodeString(JSON.stringify(n),!1)}function Xm(n,e=!1,t=!1){return x(this,null,function*(){let r=n.app;Vb(r);let i=nn(r),o=i.token,s;if(o&&!hu(o)&&(i.token=void 0,o=void 0),!o){let l=yield i.cachedTokenPromise;l&&(hu(l)?o=l:yield Qm(r,void 0))}if(!e&&o&&hu(o))return{token:o.token};let a=!1;if(Ub())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=jb(Bb(r,yield $b()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),a=!0);let l=yield i.exchangeTokenPromise;return yield Qm(r,l),i.token=l,{token:l.token}}catch(l){return l.code==="appCheck/throttled"||l.code==="appCheck/initial-throttle"?du.warn(l.message):t&&du.error(l),Ym(l)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),a=!0),o=yield nn(r).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"||l.code==="appCheck/initial-throttle"?du.warn(l.message):t&&du.error(l),s=l}let c;return o?s?hu(o)?c={token:o.token,internalError:s}:c=Ym(s):(c={token:o.token},i.token=o,yield Qm(r,o)):c=Ym(s),a&&yL(r,c),c})}function pL(n){return x(this,null,function*(){let e=n.app;Vb(e);let{provider:t}=nn(e);if(Ub()){let r=yield $b(),{token:i}=yield jb(Bb(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function gL(n,e,t,r){let{app:i}=n,o=nn(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&hu(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),Ob(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>Ob(n))}function Hb(n,e){let t=nn(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function Ob(n){let{app:e}=n,t=nn(e),r=t.tokenRefresher;r||(r=mL(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function mL(n){let{app:e}=n;return new Zm(()=>x(null,null,function*(){let t=nn(e),r;if(t.token?r=yield Xm(n,!0):r=yield Xm(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=nn(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},kb.RETRIAL_MIN_WAIT,kb.RETRIAL_MAX_WAIT)}function yL(n,e){let t=nn(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function hu(n){return n.expireTimeMillis-Date.now()>0}function Ym(n){return{token:fL(hL),error:n}}var ey=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=nn(this.app);for(let t of e)Hb(this.app,t.next);return Promise.resolve()}};function vL(n,e){return new ey(n,e)}function _L(n){return{getToken:e=>Xm(n,e),getLimitedUseToken:()=>pL(n),addTokenListener:e=>gL(n,"INTERNAL",e),removeTokenListener:e=>Hb(n.app,e)}}var wL="@firebase/app-check",EL="0.9.3";var IL="app-check",Fb="app-check-internal";function DL(){oa(new Qr(IL,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return vL(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Fb).initialize()})),oa(new Qr(Fb,n=>{let e=n.getProvider("app-check").getImmediate();return _L(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),cr(wL,EL)}DL();var TL="app-check";var Uo=class{constructor(){return Nb(TL)}};var CL=["localhost","0.0.0.0","127.0.0.1"],p6=typeof window<"u"&&CL.includes(window.location.hostname);var bL="firebase",SL="11.7.3";Ct.registerVersion(bL,SL,"app-compat");var AL=["ngOnDestroy"],Gb=(n,e,t,r={})=>new Proxy(n,{get:(i,o)=>t.runOutsideAngular(()=>{if(n[o])return r?.spy?.get&&r.spy.get(o,n[o]),n[o];if(AL.indexOf(o)>-1)return()=>{};let s=e.toPromise().then(a=>{let c=a?.[o];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>t.run(()=>l)):t.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>s[c],apply:(a,c,l)=>s.then(h=>{let p=h?.(...l);return r?.spy?.apply&&r.spy.apply(o,l,p),p})})})});var kd=class{constructor(e){return e}},$o=new G("angularfire2.app.options"),Ho=new G("angularfire2.app.name");function fu(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let s=Ct.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Ct.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(s.options)){let a=!!module.hot;RL("error",`${s.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new kd(s)}var RL=(n,...e)=>{La()&&typeof console<"u"&&console[n](...e)},ML={provide:kd,useFactory:fu,deps:[$o,Te,[new _D,Ho]]},Wb=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:$o,useValue:t},{provide:Ho,useValue:r}]}}constructor(t){Ct.registerVersion("angularfire",Bo.full,"core"),Ct.registerVersion("angularfire",Bo.full,"app-compat"),Ct.registerVersion("angular",IC.full,t.toString())}static \u0275fac=function(r){return new(r||n)(U(Xt))};static \u0275mod=Hn({type:n});static \u0275inj=Bn({providers:[ML]})}return n})();function Od(n,e,t,r,i){let[,o,s]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(o)return xL(i,s)||(zb("error",`${e} was already initialized on the ${t} Firebase App with different settings.${NL?" You may need to reload as Firebase is not HMR aware.":""}`),zb("warn",{is:i,was:s})),o;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function xL(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var NL=typeof module<"u"&&!!module.hot,zb=(n,...e)=>{La()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var ty=new G("angularfire2.auth.use-emulator"),ny=new G("angularfire2.auth.settings"),ry=new G("angularfire2.auth.tenant-id"),iy=new G("angularfire2.auth.langugage-code"),oy=new G("angularfire2.auth.use-device-language"),sy=new G("angularfire.auth.persistence"),ay=(n,e,t,r,i,o,s,a)=>Od(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=e.runOutsideAngular(()=>n.auth());if(t&&c.useEmulator(...t),r&&(c.tenantId=r),c.languageCode=i,o&&c.useDeviceLanguage(),s)for(let[l,h]of Object.entries(s))c.settings[l]=h;return a&&c.setPersistence(a),c},[t,r,i,o,s,a]),Kb=(()=>{class n{injector=O(Ye);authState;idToken;user;idTokenResult;credential;constructor(t,r,i,o,s,a,c,l,h,p,m,y){let T=new Ne,A=Y(void 0).pipe(fn(s.outsideAngular),je(()=>o.runOutsideAngular(()=>import("./chunk-QMNOUEYC.js"))),X(()=>fu(t,o,r)),X(N=>ay(N,o,a,l,h,p,c,m)),tl({bufferSize:1,refCount:!1}));if(mr(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Y(null);else{A.pipe(Kt()).subscribe();let N=A.pipe(je(F=>F.getRedirectResult().then(Z=>Z,()=>null)),It(this.injector),tl({bufferSize:1,refCount:!1})),V=A.pipe(je(F=>new ce(Z=>({unsubscribe:o.runOutsideAngular(()=>F.onAuthStateChanged(te=>Z.next(te),te=>Z.error(te),()=>Z.complete()))})))),H=A.pipe(je(F=>new ce(Z=>({unsubscribe:o.runOutsideAngular(()=>F.onIdTokenChanged(te=>Z.next(te),te=>Z.error(te),()=>Z.complete()))}))));this.authState=N.pipe(nl(V),Fn(s.outsideAngular),fn(s.insideAngular)),this.user=N.pipe(nl(H),Fn(s.outsideAngular),fn(s.insideAngular)),this.idToken=this.user.pipe(je(F=>F?_e(F.getIdToken()):Y(null))),this.idTokenResult=this.user.pipe(je(F=>F?_e(F.getIdTokenResult()):Y(null))),this.credential=Dp(N,T,this.authState.pipe(dt(F=>!F))).pipe(X(F=>F?.user?F:null),Fn(s.outsideAngular),fn(s.insideAngular))}return Gb(this,A,o,{spy:{apply:(N,V,H)=>{(N.startsWith("signIn")||N.startsWith("createUser"))&&H.then(F=>T.next(F))}}})}static \u0275fac=function(r){return new(r||n)(U($o),U(Ho,8),U(Xt),U(Te),U(lu),U(ty,8),U(ny,8),U(ry,8),U(iy,8),U(oy,8),U(sy,8),U(Uo,8))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var Qb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Yb={};var Wn,uy;(function(){var n;function e(E,v){function w(){}w.prototype=v.prototype,E.D=v.prototype,E.prototype=new w,E.prototype.constructor=E,E.C=function(I,D,b){for(var _=Array(arguments.length-2),xn=2;xn<arguments.length;xn++)_[xn-2]=arguments[xn];return v.prototype[D].apply(I,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,v,w){w||(w=0);var I=Array(16);if(typeof v=="string")for(var D=0;16>D;++D)I[D]=v.charCodeAt(w++)|v.charCodeAt(w++)<<8|v.charCodeAt(w++)<<16|v.charCodeAt(w++)<<24;else for(D=0;16>D;++D)I[D]=v[w++]|v[w++]<<8|v[w++]<<16|v[w++]<<24;v=E.g[0],w=E.g[1],D=E.g[2];var b=E.g[3],_=v+(b^w&(D^b))+I[0]+3614090360&4294967295;v=w+(_<<7&4294967295|_>>>25),_=b+(D^v&(w^D))+I[1]+3905402710&4294967295,b=v+(_<<12&4294967295|_>>>20),_=D+(w^b&(v^w))+I[2]+606105819&4294967295,D=b+(_<<17&4294967295|_>>>15),_=w+(v^D&(b^v))+I[3]+3250441966&4294967295,w=D+(_<<22&4294967295|_>>>10),_=v+(b^w&(D^b))+I[4]+4118548399&4294967295,v=w+(_<<7&4294967295|_>>>25),_=b+(D^v&(w^D))+I[5]+1200080426&4294967295,b=v+(_<<12&4294967295|_>>>20),_=D+(w^b&(v^w))+I[6]+2821735955&4294967295,D=b+(_<<17&4294967295|_>>>15),_=w+(v^D&(b^v))+I[7]+4249261313&4294967295,w=D+(_<<22&4294967295|_>>>10),_=v+(b^w&(D^b))+I[8]+1770035416&4294967295,v=w+(_<<7&4294967295|_>>>25),_=b+(D^v&(w^D))+I[9]+2336552879&4294967295,b=v+(_<<12&4294967295|_>>>20),_=D+(w^b&(v^w))+I[10]+4294925233&4294967295,D=b+(_<<17&4294967295|_>>>15),_=w+(v^D&(b^v))+I[11]+2304563134&4294967295,w=D+(_<<22&4294967295|_>>>10),_=v+(b^w&(D^b))+I[12]+1804603682&4294967295,v=w+(_<<7&4294967295|_>>>25),_=b+(D^v&(w^D))+I[13]+4254626195&4294967295,b=v+(_<<12&4294967295|_>>>20),_=D+(w^b&(v^w))+I[14]+2792965006&4294967295,D=b+(_<<17&4294967295|_>>>15),_=w+(v^D&(b^v))+I[15]+1236535329&4294967295,w=D+(_<<22&4294967295|_>>>10),_=v+(D^b&(w^D))+I[1]+4129170786&4294967295,v=w+(_<<5&4294967295|_>>>27),_=b+(w^D&(v^w))+I[6]+3225465664&4294967295,b=v+(_<<9&4294967295|_>>>23),_=D+(v^w&(b^v))+I[11]+643717713&4294967295,D=b+(_<<14&4294967295|_>>>18),_=w+(b^v&(D^b))+I[0]+3921069994&4294967295,w=D+(_<<20&4294967295|_>>>12),_=v+(D^b&(w^D))+I[5]+3593408605&4294967295,v=w+(_<<5&4294967295|_>>>27),_=b+(w^D&(v^w))+I[10]+38016083&4294967295,b=v+(_<<9&4294967295|_>>>23),_=D+(v^w&(b^v))+I[15]+3634488961&4294967295,D=b+(_<<14&4294967295|_>>>18),_=w+(b^v&(D^b))+I[4]+3889429448&4294967295,w=D+(_<<20&4294967295|_>>>12),_=v+(D^b&(w^D))+I[9]+568446438&4294967295,v=w+(_<<5&4294967295|_>>>27),_=b+(w^D&(v^w))+I[14]+3275163606&4294967295,b=v+(_<<9&4294967295|_>>>23),_=D+(v^w&(b^v))+I[3]+4107603335&4294967295,D=b+(_<<14&4294967295|_>>>18),_=w+(b^v&(D^b))+I[8]+1163531501&4294967295,w=D+(_<<20&4294967295|_>>>12),_=v+(D^b&(w^D))+I[13]+2850285829&4294967295,v=w+(_<<5&4294967295|_>>>27),_=b+(w^D&(v^w))+I[2]+4243563512&4294967295,b=v+(_<<9&4294967295|_>>>23),_=D+(v^w&(b^v))+I[7]+1735328473&4294967295,D=b+(_<<14&4294967295|_>>>18),_=w+(b^v&(D^b))+I[12]+2368359562&4294967295,w=D+(_<<20&4294967295|_>>>12),_=v+(w^D^b)+I[5]+4294588738&4294967295,v=w+(_<<4&4294967295|_>>>28),_=b+(v^w^D)+I[8]+2272392833&4294967295,b=v+(_<<11&4294967295|_>>>21),_=D+(b^v^w)+I[11]+1839030562&4294967295,D=b+(_<<16&4294967295|_>>>16),_=w+(D^b^v)+I[14]+4259657740&4294967295,w=D+(_<<23&4294967295|_>>>9),_=v+(w^D^b)+I[1]+2763975236&4294967295,v=w+(_<<4&4294967295|_>>>28),_=b+(v^w^D)+I[4]+1272893353&4294967295,b=v+(_<<11&4294967295|_>>>21),_=D+(b^v^w)+I[7]+4139469664&4294967295,D=b+(_<<16&4294967295|_>>>16),_=w+(D^b^v)+I[10]+3200236656&4294967295,w=D+(_<<23&4294967295|_>>>9),_=v+(w^D^b)+I[13]+681279174&4294967295,v=w+(_<<4&4294967295|_>>>28),_=b+(v^w^D)+I[0]+3936430074&4294967295,b=v+(_<<11&4294967295|_>>>21),_=D+(b^v^w)+I[3]+3572445317&4294967295,D=b+(_<<16&4294967295|_>>>16),_=w+(D^b^v)+I[6]+76029189&4294967295,w=D+(_<<23&4294967295|_>>>9),_=v+(w^D^b)+I[9]+3654602809&4294967295,v=w+(_<<4&4294967295|_>>>28),_=b+(v^w^D)+I[12]+3873151461&4294967295,b=v+(_<<11&4294967295|_>>>21),_=D+(b^v^w)+I[15]+530742520&4294967295,D=b+(_<<16&4294967295|_>>>16),_=w+(D^b^v)+I[2]+3299628645&4294967295,w=D+(_<<23&4294967295|_>>>9),_=v+(D^(w|~b))+I[0]+4096336452&4294967295,v=w+(_<<6&4294967295|_>>>26),_=b+(w^(v|~D))+I[7]+1126891415&4294967295,b=v+(_<<10&4294967295|_>>>22),_=D+(v^(b|~w))+I[14]+2878612391&4294967295,D=b+(_<<15&4294967295|_>>>17),_=w+(b^(D|~v))+I[5]+4237533241&4294967295,w=D+(_<<21&4294967295|_>>>11),_=v+(D^(w|~b))+I[12]+1700485571&4294967295,v=w+(_<<6&4294967295|_>>>26),_=b+(w^(v|~D))+I[3]+2399980690&4294967295,b=v+(_<<10&4294967295|_>>>22),_=D+(v^(b|~w))+I[10]+4293915773&4294967295,D=b+(_<<15&4294967295|_>>>17),_=w+(b^(D|~v))+I[1]+2240044497&4294967295,w=D+(_<<21&4294967295|_>>>11),_=v+(D^(w|~b))+I[8]+1873313359&4294967295,v=w+(_<<6&4294967295|_>>>26),_=b+(w^(v|~D))+I[15]+4264355552&4294967295,b=v+(_<<10&4294967295|_>>>22),_=D+(v^(b|~w))+I[6]+2734768916&4294967295,D=b+(_<<15&4294967295|_>>>17),_=w+(b^(D|~v))+I[13]+1309151649&4294967295,w=D+(_<<21&4294967295|_>>>11),_=v+(D^(w|~b))+I[4]+4149444226&4294967295,v=w+(_<<6&4294967295|_>>>26),_=b+(w^(v|~D))+I[11]+3174756917&4294967295,b=v+(_<<10&4294967295|_>>>22),_=D+(v^(b|~w))+I[2]+718787259&4294967295,D=b+(_<<15&4294967295|_>>>17),_=w+(b^(D|~v))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+v&4294967295,E.g[1]=E.g[1]+(D+(_<<21&4294967295|_>>>11))&4294967295,E.g[2]=E.g[2]+D&4294967295,E.g[3]=E.g[3]+b&4294967295}r.prototype.u=function(E,v){v===void 0&&(v=E.length);for(var w=v-this.blockSize,I=this.B,D=this.h,b=0;b<v;){if(D==0)for(;b<=w;)i(this,E,b),b+=this.blockSize;if(typeof E=="string"){for(;b<v;)if(I[D++]=E.charCodeAt(b++),D==this.blockSize){i(this,I),D=0;break}}else for(;b<v;)if(I[D++]=E[b++],D==this.blockSize){i(this,I),D=0;break}}this.h=D,this.o+=v},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var v=1;v<E.length-8;++v)E[v]=0;var w=8*this.o;for(v=E.length-8;v<E.length;++v)E[v]=w&255,w/=256;for(this.u(E),E=Array(16),v=w=0;4>v;++v)for(var I=0;32>I;I+=8)E[w++]=this.g[v]>>>I&255;return E};function o(E,v){var w=a;return Object.prototype.hasOwnProperty.call(w,E)?w[E]:w[E]=v(E)}function s(E,v){this.h=v;for(var w=[],I=!0,D=E.length-1;0<=D;D--){var b=E[D]|0;I&&b==v||(w[D]=b,I=!1)}this.g=w}var a={};function c(E){return-128<=E&&128>E?o(E,function(v){return new s([v|0],0>v?-1:0)}):new s([E|0],0>E?-1:0)}function l(E){if(isNaN(E)||!isFinite(E))return p;if(0>E)return N(l(-E));for(var v=[],w=1,I=0;E>=w;I++)v[I]=E/w|0,w*=4294967296;return new s(v,0)}function h(E,v){if(E.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(E.charAt(0)=="-")return N(h(E.substring(1),v));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=l(Math.pow(v,8)),I=p,D=0;D<E.length;D+=8){var b=Math.min(8,E.length-D),_=parseInt(E.substring(D,D+b),v);8>b?(b=l(Math.pow(v,b)),I=I.j(b).add(l(_))):(I=I.j(w),I=I.add(l(_)))}return I}var p=c(0),m=c(1),y=c(16777216);n=s.prototype,n.m=function(){if(A(this))return-N(this).m();for(var E=0,v=1,w=0;w<this.g.length;w++){var I=this.i(w);E+=(0<=I?I:4294967296+I)*v,v*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(T(this))return"0";if(A(this))return"-"+N(this).toString(E);for(var v=l(Math.pow(E,6)),w=this,I="";;){var D=Z(w,v).g;w=V(w,D.j(v));var b=((0<w.g.length?w.g[0]:w.h)>>>0).toString(E);if(w=D,T(w))return b+I;for(;6>b.length;)b="0"+b;I=b+I}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function T(E){if(E.h!=0)return!1;for(var v=0;v<E.g.length;v++)if(E.g[v]!=0)return!1;return!0}function A(E){return E.h==-1}n.l=function(E){return E=V(this,E),A(E)?-1:T(E)?0:1};function N(E){for(var v=E.g.length,w=[],I=0;I<v;I++)w[I]=~E.g[I];return new s(w,~E.h).add(m)}n.abs=function(){return A(this)?N(this):this},n.add=function(E){for(var v=Math.max(this.g.length,E.g.length),w=[],I=0,D=0;D<=v;D++){var b=I+(this.i(D)&65535)+(E.i(D)&65535),_=(b>>>16)+(this.i(D)>>>16)+(E.i(D)>>>16);I=_>>>16,b&=65535,_&=65535,w[D]=_<<16|b}return new s(w,w[w.length-1]&-2147483648?-1:0)};function V(E,v){return E.add(N(v))}n.j=function(E){if(T(this)||T(E))return p;if(A(this))return A(E)?N(this).j(N(E)):N(N(this).j(E));if(A(E))return N(this.j(N(E)));if(0>this.l(y)&&0>E.l(y))return l(this.m()*E.m());for(var v=this.g.length+E.g.length,w=[],I=0;I<2*v;I++)w[I]=0;for(I=0;I<this.g.length;I++)for(var D=0;D<E.g.length;D++){var b=this.i(I)>>>16,_=this.i(I)&65535,xn=E.i(D)>>>16,js=E.i(D)&65535;w[2*I+2*D]+=_*js,H(w,2*I+2*D),w[2*I+2*D+1]+=b*js,H(w,2*I+2*D+1),w[2*I+2*D+1]+=_*xn,H(w,2*I+2*D+1),w[2*I+2*D+2]+=b*xn,H(w,2*I+2*D+2)}for(I=0;I<v;I++)w[I]=w[2*I+1]<<16|w[2*I];for(I=v;I<2*v;I++)w[I]=0;return new s(w,0)};function H(E,v){for(;(E[v]&65535)!=E[v];)E[v+1]+=E[v]>>>16,E[v]&=65535,v++}function F(E,v){this.g=E,this.h=v}function Z(E,v){if(T(v))throw Error("division by zero");if(T(E))return new F(p,p);if(A(E))return v=Z(N(E),v),new F(N(v.g),N(v.h));if(A(v))return v=Z(E,N(v)),new F(N(v.g),v.h);if(30<E.g.length){if(A(E)||A(v))throw Error("slowDivide_ only works with positive integers.");for(var w=m,I=v;0>=I.l(E);)w=te(w),I=te(I);var D=ne(w,1),b=ne(I,1);for(I=ne(I,2),w=ne(w,2);!T(I);){var _=b.add(I);0>=_.l(E)&&(D=D.add(w),b=_),I=ne(I,1),w=ne(w,1)}return v=V(E,D.j(v)),new F(D,v)}for(D=p;0<=E.l(v);){for(w=Math.max(1,Math.floor(E.m()/v.m())),I=Math.ceil(Math.log(w)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),b=l(w),_=b.j(v);A(_)||0<_.l(E);)w-=I,b=l(w),_=b.j(v);T(b)&&(b=m),D=D.add(b),E=V(E,_)}return new F(D,E)}n.A=function(E){return Z(this,E).h},n.and=function(E){for(var v=Math.max(this.g.length,E.g.length),w=[],I=0;I<v;I++)w[I]=this.i(I)&E.i(I);return new s(w,this.h&E.h)},n.or=function(E){for(var v=Math.max(this.g.length,E.g.length),w=[],I=0;I<v;I++)w[I]=this.i(I)|E.i(I);return new s(w,this.h|E.h)},n.xor=function(E){for(var v=Math.max(this.g.length,E.g.length),w=[],I=0;I<v;I++)w[I]=this.i(I)^E.i(I);return new s(w,this.h^E.h)};function te(E){for(var v=E.g.length+1,w=[],I=0;I<v;I++)w[I]=E.i(I)<<1|E.i(I-1)>>>31;return new s(w,E.h)}function ne(E,v){var w=v>>5;v%=32;for(var I=E.g.length-w,D=[],b=0;b<I;b++)D[b]=0<v?E.i(b+w)>>>v|E.i(b+w+1)<<32-v:E.i(b+w);return new s(D,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,uy=Yb.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=h,Wn=Yb.Integer=s}).apply(typeof Qb<"u"?Qb:typeof self<"u"?self:typeof window<"u"?window:{});var Fd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Kn={};var cy,kL,qo,ly,pu,Ld,dy,hy,fy;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,d,f){return u==Array.prototype||u==Object.prototype||(u[d]=f.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fd=="object"&&Fd];for(var d=0;d<u.length;++d){var f=u[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(u,d){if(d)e:{var f=r;u=u.split(".");for(var g=0;g<u.length-1;g++){var C=u[g];if(!(C in f))break e;f=f[C]}u=u[u.length-1],g=f[u],d=d(g),d!=g&&d!=null&&e(f,u,{configurable:!0,writable:!0,value:d})}}function o(u,d){u instanceof String&&(u+="");var f=0,g=!1,C={next:function(){if(!g&&f<u.length){var M=f++;return{value:d(M,u[M]),done:!1}}return g=!0,{done:!0,value:void 0}}};return C[Symbol.iterator]=function(){return C},C}i("Array.prototype.values",function(u){return u||function(){return o(this,function(d,f){return f})}});var s=s||{},a=this||self;function c(u){var d=typeof u;return d=d!="object"?d:u?Array.isArray(u)?"array":d:"null",d=="array"||d=="object"&&typeof u.length=="number"}function l(u){var d=typeof u;return d=="object"&&u!=null||d=="function"}function h(u,d,f){return u.call.apply(u.bind,arguments)}function p(u,d,f){if(!u)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var C=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(C,g),u.apply(d,C)}}return function(){return u.apply(d,arguments)}}function m(u,d,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,m.apply(null,arguments)}function y(u,d){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),u.apply(this,g)}}function T(u,d){function f(){}f.prototype=d.prototype,u.aa=d.prototype,u.prototype=new f,u.prototype.constructor=u,u.Qb=function(g,C,M){for(var L=Array(arguments.length-2),De=2;De<arguments.length;De++)L[De-2]=arguments[De];return d.prototype[C].apply(g,L)}}function A(u){let d=u.length;if(0<d){let f=Array(d);for(let g=0;g<d;g++)f[g]=u[g];return f}return[]}function N(u,d){for(let f=1;f<arguments.length;f++){let g=arguments[f];if(c(g)){let C=u.length||0,M=g.length||0;u.length=C+M;for(let L=0;L<M;L++)u[C+L]=g[L]}else u.push(g)}}class V{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function H(u){return/^[\s\xa0]*$/.test(u)}function F(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function Z(u){return Z[" "](u),u}Z[" "]=function(){};var te=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function ne(u,d,f){for(let g in u)d.call(f,u[g],g,u)}function E(u,d){for(let f in u)d.call(void 0,u[f],f,u)}function v(u){let d={};for(let f in u)d[f]=u[f];return d}let w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(u,d){let f,g;for(let C=1;C<arguments.length;C++){g=arguments[C];for(f in g)u[f]=g[f];for(let M=0;M<w.length;M++)f=w[M],Object.prototype.hasOwnProperty.call(g,f)&&(u[f]=g[f])}}function D(u){var d=1;u=u.split(":");let f=[];for(;0<d&&u.length;)f.push(u.shift()),d--;return u.length&&f.push(u.join(":")),f}function b(u){a.setTimeout(()=>{throw u},0)}function _(){var u=Ef;let d=null;return u.g&&(d=u.g,u.g=u.g.next,u.g||(u.h=null),d.next=null),d}class xn{constructor(){this.h=this.g=null}add(d,f){let g=js.get();g.set(d,f),this.h?this.h.next=g:this.g=g,this.h=g}}var js=new V(()=>new lM,u=>u.reset());class lM{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Bs,Us=!1,Ef=new xn,Nw=()=>{let u=a.Promise.resolve(void 0);Bs=()=>{u.then(dM)}};var dM=()=>{for(var u;u=_();){try{u.h.call(u.g)}catch(f){b(f)}var d=js;d.j(u),100>d.h&&(d.h++,u.next=d.g,d.g=u)}Us=!1};function or(){this.s=this.s,this.C=this.C}or.prototype.s=!1,or.prototype.ma=function(){this.s||(this.s=!0,this.N())},or.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function st(u,d){this.type=u,this.g=this.target=d,this.defaultPrevented=!1}st.prototype.h=function(){this.defaultPrevented=!0};var hM=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,d=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let f=()=>{};a.addEventListener("test",f,d),a.removeEventListener("test",f,d)}catch{}return u}();function $s(u,d){if(st.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var f=this.type=u.type,g=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=d,d=u.relatedTarget){if(te){e:{try{Z(d.nodeName);var C=!0;break e}catch{}C=!1}C||(d=null)}}else f=="mouseover"?d=u.fromElement:f=="mouseout"&&(d=u.toElement);this.relatedTarget=d,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:fM[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&$s.aa.h.call(this)}}T($s,st);var fM={2:"touch",3:"pen",4:"mouse"};$s.prototype.h=function(){$s.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Hs="closure_listenable_"+(1e6*Math.random()|0),pM=0;function gM(u,d,f,g,C){this.listener=u,this.proxy=null,this.src=d,this.type=f,this.capture=!!g,this.ha=C,this.key=++pM,this.da=this.fa=!1}function ac(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function uc(u){this.src=u,this.g={},this.h=0}uc.prototype.add=function(u,d,f,g,C){var M=u.toString();u=this.g[M],u||(u=this.g[M]=[],this.h++);var L=Df(u,d,g,C);return-1<L?(d=u[L],f||(d.fa=!1)):(d=new gM(d,this.src,M,!!g,C),d.fa=f,u.push(d)),d};function If(u,d){var f=d.type;if(f in u.g){var g=u.g[f],C=Array.prototype.indexOf.call(g,d,void 0),M;(M=0<=C)&&Array.prototype.splice.call(g,C,1),M&&(ac(d),u.g[f].length==0&&(delete u.g[f],u.h--))}}function Df(u,d,f,g){for(var C=0;C<u.length;++C){var M=u[C];if(!M.da&&M.listener==d&&M.capture==!!f&&M.ha==g)return C}return-1}var Tf="closure_lm_"+(1e6*Math.random()|0),Cf={};function Pw(u,d,f,g,C){if(g&&g.once)return Ow(u,d,f,g,C);if(Array.isArray(d)){for(var M=0;M<d.length;M++)Pw(u,d[M],f,g,C);return null}return f=Rf(f),u&&u[Hs]?u.K(d,f,l(g)?!!g.capture:!!g,C):kw(u,d,f,!1,g,C)}function kw(u,d,f,g,C,M){if(!d)throw Error("Invalid event type");var L=l(C)?!!C.capture:!!C,De=Sf(u);if(De||(u[Tf]=De=new uc(u)),f=De.add(d,f,g,L,M),f.proxy)return f;if(g=mM(),f.proxy=g,g.src=u,g.listener=f,u.addEventListener)hM||(C=L),C===void 0&&(C=!1),u.addEventListener(d.toString(),g,C);else if(u.attachEvent)u.attachEvent(Lw(d.toString()),g);else if(u.addListener&&u.removeListener)u.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function mM(){function u(f){return d.call(u.src,u.listener,f)}let d=yM;return u}function Ow(u,d,f,g,C){if(Array.isArray(d)){for(var M=0;M<d.length;M++)Ow(u,d[M],f,g,C);return null}return f=Rf(f),u&&u[Hs]?u.L(d,f,l(g)?!!g.capture:!!g,C):kw(u,d,f,!0,g,C)}function Fw(u,d,f,g,C){if(Array.isArray(d))for(var M=0;M<d.length;M++)Fw(u,d[M],f,g,C);else g=l(g)?!!g.capture:!!g,f=Rf(f),u&&u[Hs]?(u=u.i,d=String(d).toString(),d in u.g&&(M=u.g[d],f=Df(M,f,g,C),-1<f&&(ac(M[f]),Array.prototype.splice.call(M,f,1),M.length==0&&(delete u.g[d],u.h--)))):u&&(u=Sf(u))&&(d=u.g[d.toString()],u=-1,d&&(u=Df(d,f,g,C)),(f=-1<u?d[u]:null)&&bf(f))}function bf(u){if(typeof u!="number"&&u&&!u.da){var d=u.src;if(d&&d[Hs])If(d.i,u);else{var f=u.type,g=u.proxy;d.removeEventListener?d.removeEventListener(f,g,u.capture):d.detachEvent?d.detachEvent(Lw(f),g):d.addListener&&d.removeListener&&d.removeListener(g),(f=Sf(d))?(If(f,u),f.h==0&&(f.src=null,d[Tf]=null)):ac(u)}}}function Lw(u){return u in Cf?Cf[u]:Cf[u]="on"+u}function yM(u,d){if(u.da)u=!0;else{d=new $s(d,this);var f=u.listener,g=u.ha||u.src;u.fa&&bf(u),u=f.call(g,d)}return u}function Sf(u){return u=u[Tf],u instanceof uc?u:null}var Af="__closure_events_fn_"+(1e9*Math.random()>>>0);function Rf(u){return typeof u=="function"?u:(u[Af]||(u[Af]=function(d){return u.handleEvent(d)}),u[Af])}function at(){or.call(this),this.i=new uc(this),this.M=this,this.F=null}T(at,or),at.prototype[Hs]=!0,at.prototype.removeEventListener=function(u,d,f,g){Fw(this,u,d,f,g)};function mt(u,d){var f,g=u.F;if(g)for(f=[];g;g=g.F)f.push(g);if(u=u.M,g=d.type||d,typeof d=="string")d=new st(d,u);else if(d instanceof st)d.target=d.target||u;else{var C=d;d=new st(g,u),I(d,C)}if(C=!0,f)for(var M=f.length-1;0<=M;M--){var L=d.g=f[M];C=cc(L,g,!0,d)&&C}if(L=d.g=u,C=cc(L,g,!0,d)&&C,C=cc(L,g,!1,d)&&C,f)for(M=0;M<f.length;M++)L=d.g=f[M],C=cc(L,g,!1,d)&&C}at.prototype.N=function(){if(at.aa.N.call(this),this.i){var u=this.i,d;for(d in u.g){for(var f=u.g[d],g=0;g<f.length;g++)ac(f[g]);delete u.g[d],u.h--}}this.F=null},at.prototype.K=function(u,d,f,g){return this.i.add(String(u),d,!1,f,g)},at.prototype.L=function(u,d,f,g){return this.i.add(String(u),d,!0,f,g)};function cc(u,d,f,g){if(d=u.i.g[String(d)],!d)return!0;d=d.concat();for(var C=!0,M=0;M<d.length;++M){var L=d[M];if(L&&!L.da&&L.capture==f){var De=L.listener,et=L.ha||L.src;L.fa&&If(u.i,L),C=De.call(et,g)!==!1&&C}}return C&&!g.defaultPrevented}function Vw(u,d,f){if(typeof u=="function")f&&(u=m(u,f));else if(u&&typeof u.handleEvent=="function")u=m(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(u,d||0)}function jw(u){u.g=Vw(()=>{u.g=null,u.i&&(u.i=!1,jw(u))},u.l);let d=u.h;u.h=null,u.m.apply(null,d)}class vM extends or{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:jw(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qs(u){or.call(this),this.h=u,this.g={}}T(qs,or);var Bw=[];function Uw(u){ne(u.g,function(d,f){this.g.hasOwnProperty(f)&&bf(d)},u),u.g={}}qs.prototype.N=function(){qs.aa.N.call(this),Uw(this)},qs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Mf=a.JSON.stringify,_M=a.JSON.parse,wM=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function xf(){}xf.prototype.h=null;function $w(u){return u.h||(u.h=u.i())}function Hw(){}var zs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Nf(){st.call(this,"d")}T(Nf,st);function Pf(){st.call(this,"c")}T(Pf,st);var zr={},qw=null;function lc(){return qw=qw||new at}zr.La="serverreachability";function zw(u){st.call(this,zr.La,u)}T(zw,st);function Gs(u){let d=lc();mt(d,new zw(d))}zr.STAT_EVENT="statevent";function Gw(u,d){st.call(this,zr.STAT_EVENT,u),this.stat=d}T(Gw,st);function yt(u){let d=lc();mt(d,new Gw(d,u))}zr.Ma="timingevent";function Ww(u,d){st.call(this,zr.Ma,u),this.size=d}T(Ww,st);function Ws(u,d){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},d)}function Ks(){this.g=!0}Ks.prototype.xa=function(){this.g=!1};function EM(u,d,f,g,C,M){u.info(function(){if(u.g)if(M)for(var L="",De=M.split("&"),et=0;et<De.length;et++){var me=De[et].split("=");if(1<me.length){var ut=me[0];me=me[1];var ct=ut.split("_");L=2<=ct.length&&ct[1]=="type"?L+(ut+"="+me+"&"):L+(ut+"=redacted&")}}else L=null;else L=M;return"XMLHTTP REQ ("+g+") [attempt "+C+"]: "+d+`
`+f+`
`+L})}function IM(u,d,f,g,C,M,L){u.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+C+"]: "+d+`
`+f+`
`+M+" "+L})}function Ki(u,d,f,g){u.info(function(){return"XMLHTTP TEXT ("+d+"): "+TM(u,f)+(g?" "+g:"")})}function DM(u,d){u.info(function(){return"TIMEOUT: "+d})}Ks.prototype.info=function(){};function TM(u,d){if(!u.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(u=0;u<f.length;u++)if(Array.isArray(f[u])){var g=f[u];if(!(2>g.length)){var C=g[1];if(Array.isArray(C)&&!(1>C.length)){var M=C[0];if(M!="noop"&&M!="stop"&&M!="close")for(var L=1;L<C.length;L++)C[L]=""}}}}return Mf(f)}catch{return d}}var dc={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Kw={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},kf;function hc(){}T(hc,xf),hc.prototype.g=function(){return new XMLHttpRequest},hc.prototype.i=function(){return{}},kf=new hc;function sr(u,d,f,g){this.j=u,this.i=d,this.l=f,this.R=g||1,this.U=new qs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qw}function Qw(){this.i=null,this.g="",this.h=!1}var Yw={},Of={};function Ff(u,d,f){u.L=1,u.v=mc(Nn(d)),u.m=f,u.P=!0,Zw(u,null)}function Zw(u,d){u.F=Date.now(),fc(u),u.A=Nn(u.v);var f=u.A,g=u.R;Array.isArray(g)||(g=[String(g)]),dE(f.i,"t",g),u.C=0,f=u.j.J,u.h=new Qw,u.g=RE(u.j,f?d:null,!u.m),0<u.O&&(u.M=new vM(m(u.Y,u,u.g),u.O)),d=u.U,f=u.g,g=u.ca;var C="readystatechange";Array.isArray(C)||(C&&(Bw[0]=C.toString()),C=Bw);for(var M=0;M<C.length;M++){var L=Pw(f,C[M],g||d.handleEvent,!1,d.h||d);if(!L)break;d.g[L.key]=L}d=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,d)):(u.u="GET",u.g.ea(u.A,u.u,null,d)),Gs(),EM(u.i,u.u,u.A,u.l,u.R,u.m)}sr.prototype.ca=function(u){u=u.target;let d=this.M;d&&Pn(u)==3?d.j():this.Y(u)},sr.prototype.Y=function(u){try{if(u==this.g)e:{let ct=Pn(this.g);var d=this.g.Ba();let Zi=this.g.Z();if(!(3>ct)&&(ct!=3||this.g&&(this.h.h||this.g.oa()||vE(this.g)))){this.J||ct!=4||d==7||(d==8||0>=Zi?Gs(3):Gs(2)),Lf(this);var f=this.g.Z();this.X=f;t:if(Jw(this)){var g=vE(this.g);u="";var C=g.length,M=Pn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gr(this),Qs(this);var L="";break t}this.h.i=new a.TextDecoder}for(d=0;d<C;d++)this.h.h=!0,u+=this.h.i.decode(g[d],{stream:!(M&&d==C-1)});g.length=0,this.h.g+=u,this.C=0,L=this.h.g}else L=this.g.oa();if(this.o=f==200,IM(this.i,this.u,this.A,this.l,this.R,ct,f),this.o){if(this.T&&!this.K){t:{if(this.g){var De,et=this.g;if((De=et.g?et.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(De)){var me=De;break t}}me=null}if(f=me)Ki(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Vf(this,f);else{this.o=!1,this.s=3,yt(12),Gr(this),Qs(this);break e}}if(this.P){f=!0;let Gt;for(;!this.J&&this.C<L.length;)if(Gt=CM(this,L),Gt==Of){ct==4&&(this.s=4,yt(14),f=!1),Ki(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==Yw){this.s=4,yt(15),Ki(this.i,this.l,L,"[Invalid Chunk]"),f=!1;break}else Ki(this.i,this.l,Gt,null),Vf(this,Gt);if(Jw(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ct!=4||L.length!=0||this.h.h||(this.s=1,yt(16),f=!1),this.o=this.o&&f,!f)Ki(this.i,this.l,L,"[Invalid Chunked Response]"),Gr(this),Qs(this);else if(0<L.length&&!this.W){this.W=!0;var ut=this.j;ut.g==this&&ut.ba&&!ut.M&&(ut.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),qf(ut),ut.M=!0,yt(11))}}else Ki(this.i,this.l,L,null),Vf(this,L);ct==4&&Gr(this),this.o&&!this.J&&(ct==4?CE(this.j,this):(this.o=!1,fc(this)))}else $M(this.g),f==400&&0<L.indexOf("Unknown SID")?(this.s=3,yt(12)):(this.s=0,yt(13)),Gr(this),Qs(this)}}}catch{}finally{}};function Jw(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function CM(u,d){var f=u.C,g=d.indexOf(`
`,f);return g==-1?Of:(f=Number(d.substring(f,g)),isNaN(f)?Yw:(g+=1,g+f>d.length?Of:(d=d.slice(g,g+f),u.C=g+f,d)))}sr.prototype.cancel=function(){this.J=!0,Gr(this)};function fc(u){u.S=Date.now()+u.I,Xw(u,u.I)}function Xw(u,d){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ws(m(u.ba,u),d)}function Lf(u){u.B&&(a.clearTimeout(u.B),u.B=null)}sr.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(DM(this.i,this.A),this.L!=2&&(Gs(),yt(17)),Gr(this),this.s=2,Qs(this)):Xw(this,this.S-u)};function Qs(u){u.j.G==0||u.J||CE(u.j,u)}function Gr(u){Lf(u);var d=u.M;d&&typeof d.ma=="function"&&d.ma(),u.M=null,Uw(u.U),u.g&&(d=u.g,u.g=null,d.abort(),d.ma())}function Vf(u,d){try{var f=u.j;if(f.G!=0&&(f.g==u||jf(f.h,u))){if(!u.K&&jf(f.h,u)&&f.G==3){try{var g=f.Da.g.parse(d)}catch{g=null}if(Array.isArray(g)&&g.length==3){var C=g;if(C[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<u.F)Ec(f),_c(f);else break e;Hf(f),yt(18)}}else f.za=C[1],0<f.za-f.T&&37500>C[2]&&f.F&&f.v==0&&!f.C&&(f.C=Ws(m(f.Za,f),6e3));if(1>=nE(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Kr(f,11)}else if((u.K||f.g==u)&&Ec(f),!H(d))for(C=f.Da.g.parse(d),d=0;d<C.length;d++){let me=C[d];if(f.T=me[0],me=me[1],f.G==2)if(me[0]=="c"){f.K=me[1],f.ia=me[2];let ut=me[3];ut!=null&&(f.la=ut,f.j.info("VER="+f.la));let ct=me[4];ct!=null&&(f.Aa=ct,f.j.info("SVER="+f.Aa));let Zi=me[5];Zi!=null&&typeof Zi=="number"&&0<Zi&&(g=1.5*Zi,f.L=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;let Gt=u.g;if(Gt){let Dc=Gt.g?Gt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Dc){var M=g.h;M.g||Dc.indexOf("spdy")==-1&&Dc.indexOf("quic")==-1&&Dc.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Bf(M,M.h),M.h=null))}if(g.D){let zf=Gt.g?Gt.g.getResponseHeader("X-HTTP-Session-Id"):null;zf&&(g.ya=zf,Se(g.I,g.D,zf))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-u.F,f.j.info("Handshake RTT: "+f.R+"ms")),g=f;var L=u;if(g.qa=AE(g,g.J?g.ia:null,g.W),L.K){rE(g.h,L);var De=L,et=g.L;et&&(De.I=et),De.B&&(Lf(De),fc(De)),g.g=L}else DE(g);0<f.i.length&&wc(f)}else me[0]!="stop"&&me[0]!="close"||Kr(f,7);else f.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?Kr(f,7):$f(f):me[0]!="noop"&&f.l&&f.l.ta(me),f.v=0)}}Gs(4)}catch{}}var bM=class{constructor(u,d){this.g=u,this.map=d}};function eE(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function tE(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function nE(u){return u.h?1:u.g?u.g.size:0}function jf(u,d){return u.h?u.h==d:u.g?u.g.has(d):!1}function Bf(u,d){u.g?u.g.add(d):u.h=d}function rE(u,d){u.h&&u.h==d?u.h=null:u.g&&u.g.has(d)&&u.g.delete(d)}eE.prototype.cancel=function(){if(this.i=iE(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function iE(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let d=u.i;for(let f of u.g.values())d=d.concat(f.D);return d}return A(u.i)}function SM(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var d=[],f=u.length,g=0;g<f;g++)d.push(u[g]);return d}d=[],f=0;for(g in u)d[f++]=u[g];return d}function AM(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var d=[];u=u.length;for(var f=0;f<u;f++)d.push(f);return d}d=[],f=0;for(let g in u)d[f++]=g;return d}}}function oE(u,d){if(u.forEach&&typeof u.forEach=="function")u.forEach(d,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,d,void 0);else for(var f=AM(u),g=SM(u),C=g.length,M=0;M<C;M++)d.call(void 0,g[M],f&&f[M],u)}var sE=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function RM(u,d){if(u){u=u.split("&");for(var f=0;f<u.length;f++){var g=u[f].indexOf("="),C=null;if(0<=g){var M=u[f].substring(0,g);C=u[f].substring(g+1)}else M=u[f];d(M,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function Wr(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Wr){this.h=u.h,pc(this,u.j),this.o=u.o,this.g=u.g,gc(this,u.s),this.l=u.l;var d=u.i,f=new Js;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),aE(this,f),this.m=u.m}else u&&(d=String(u).match(sE))?(this.h=!1,pc(this,d[1]||"",!0),this.o=Ys(d[2]||""),this.g=Ys(d[3]||"",!0),gc(this,d[4]),this.l=Ys(d[5]||"",!0),aE(this,d[6]||"",!0),this.m=Ys(d[7]||"")):(this.h=!1,this.i=new Js(null,this.h))}Wr.prototype.toString=function(){var u=[],d=this.j;d&&u.push(Zs(d,uE,!0),":");var f=this.g;return(f||d=="file")&&(u.push("//"),(d=this.o)&&u.push(Zs(d,uE,!0),"@"),u.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&u.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&u.push("/"),u.push(Zs(f,f.charAt(0)=="/"?NM:xM,!0))),(f=this.i.toString())&&u.push("?",f),(f=this.m)&&u.push("#",Zs(f,kM)),u.join("")};function Nn(u){return new Wr(u)}function pc(u,d,f){u.j=f?Ys(d,!0):d,u.j&&(u.j=u.j.replace(/:$/,""))}function gc(u,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);u.s=d}else u.s=null}function aE(u,d,f){d instanceof Js?(u.i=d,OM(u.i,u.h)):(f||(d=Zs(d,PM)),u.i=new Js(d,u.h))}function Se(u,d,f){u.i.set(d,f)}function mc(u){return Se(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Ys(u,d){return u?d?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Zs(u,d,f){return typeof u=="string"?(u=encodeURI(u).replace(d,MM),f&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function MM(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var uE=/[#\/\?@]/g,xM=/[#\?:]/g,NM=/[#\?]/g,PM=/[#\?@]/g,kM=/#/g;function Js(u,d){this.h=this.g=null,this.i=u||null,this.j=!!d}function ar(u){u.g||(u.g=new Map,u.h=0,u.i&&RM(u.i,function(d,f){u.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}n=Js.prototype,n.add=function(u,d){ar(this),this.i=null,u=Qi(this,u);var f=this.g.get(u);return f||this.g.set(u,f=[]),f.push(d),this.h+=1,this};function cE(u,d){ar(u),d=Qi(u,d),u.g.has(d)&&(u.i=null,u.h-=u.g.get(d).length,u.g.delete(d))}function lE(u,d){return ar(u),d=Qi(u,d),u.g.has(d)}n.forEach=function(u,d){ar(this),this.g.forEach(function(f,g){f.forEach(function(C){u.call(d,C,g,this)},this)},this)},n.na=function(){ar(this);let u=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let g=0;g<d.length;g++){let C=u[g];for(let M=0;M<C.length;M++)f.push(d[g])}return f},n.V=function(u){ar(this);let d=[];if(typeof u=="string")lE(this,u)&&(d=d.concat(this.g.get(Qi(this,u))));else{u=Array.from(this.g.values());for(let f=0;f<u.length;f++)d=d.concat(u[f])}return d},n.set=function(u,d){return ar(this),this.i=null,u=Qi(this,u),lE(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[d]),this.h+=1,this},n.get=function(u,d){return u?(u=this.V(u),0<u.length?String(u[0]):d):d};function dE(u,d,f){cE(u,d),0<f.length&&(u.i=null,u.g.set(Qi(u,d),A(f)),u.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var g=d[f];let M=encodeURIComponent(String(g)),L=this.V(g);for(g=0;g<L.length;g++){var C=M;L[g]!==""&&(C+="="+encodeURIComponent(String(L[g]))),u.push(C)}}return this.i=u.join("&")};function Qi(u,d){return d=String(d),u.j&&(d=d.toLowerCase()),d}function OM(u,d){d&&!u.j&&(ar(u),u.i=null,u.g.forEach(function(f,g){var C=g.toLowerCase();g!=C&&(cE(this,g),dE(this,C,f))},u)),u.j=d}function FM(u,d){let f=new Ks;if(a.Image){let g=new Image;g.onload=y(ur,f,"TestLoadImage: loaded",!0,d,g),g.onerror=y(ur,f,"TestLoadImage: error",!1,d,g),g.onabort=y(ur,f,"TestLoadImage: abort",!1,d,g),g.ontimeout=y(ur,f,"TestLoadImage: timeout",!1,d,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=u}else d(!1)}function LM(u,d){let f=new Ks,g=new AbortController,C=setTimeout(()=>{g.abort(),ur(f,"TestPingServer: timeout",!1,d)},1e4);fetch(u,{signal:g.signal}).then(M=>{clearTimeout(C),M.ok?ur(f,"TestPingServer: ok",!0,d):ur(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(C),ur(f,"TestPingServer: error",!1,d)})}function ur(u,d,f,g,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),g(f)}catch{}}function VM(){this.g=new wM}function jM(u,d,f){let g=f||"";try{oE(u,function(C,M){let L=C;l(C)&&(L=Mf(C)),d.push(g+M+"="+encodeURIComponent(L))})}catch(C){throw d.push(g+"type="+encodeURIComponent("_badmap")),C}}function Xs(u){this.l=u.Ub||null,this.j=u.eb||!1}T(Xs,xf),Xs.prototype.g=function(){return new yc(this.l,this.j)},Xs.prototype.i=function(u){return function(){return u}}({});function yc(u,d){at.call(this),this.D=u,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(yc,at),n=yc.prototype,n.open=function(u,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=d,this.readyState=1,ta(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(d.body=u),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ea(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,ta(this)),this.g&&(this.readyState=3,ta(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;hE(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function hE(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var d=u.value?u.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!u.done}))&&(this.response=this.responseText+=d)}u.done?ea(this):ta(this),this.readyState==3&&hE(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,ea(this))},n.Qa=function(u){this.g&&(this.response=u,ea(this))},n.ga=function(){this.g&&ea(this)};function ea(u){u.readyState=4,u.l=null,u.j=null,u.v=null,ta(u)}n.setRequestHeader=function(u,d){this.u.append(u,d)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,u.push(f[0]+": "+f[1]),f=d.next();return u.join(`\r
`)};function ta(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(yc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function fE(u){let d="";return ne(u,function(f,g){d+=g,d+=":",d+=f,d+=`\r
`}),d}function Uf(u,d,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=fE(f),typeof u=="string"?f!=null&&encodeURIComponent(String(f)):Se(u,d,f))}function Fe(u){at.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(Fe,at);var BM=/^https?$/i,UM=["POST","PUT"];n=Fe.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,d,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);d=d?d.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():kf.g(),this.v=this.o?$w(this.o):$w(kf),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(u),!0),this.B=!1}catch(M){pE(this,M);return}if(u=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var C in g)f.set(C,g[C]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let M of g.keys())f.set(M,g.get(M));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(M=>M.toLowerCase()=="content-type"),C=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(UM,d,void 0))||g||C||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[M,L]of f)this.g.setRequestHeader(M,L);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{yE(this),this.u=!0,this.g.send(u),this.u=!1}catch(M){pE(this,M)}};function pE(u,d){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=d,u.m=5,gE(u),vc(u)}function gE(u){u.A||(u.A=!0,mt(u,"complete"),mt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,mt(this,"complete"),mt(this,"abort"),vc(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vc(this,!0)),Fe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?mE(this):this.bb())},n.bb=function(){mE(this)};function mE(u){if(u.h&&typeof s<"u"&&(!u.v[1]||Pn(u)!=4||u.Z()!=2)){if(u.u&&Pn(u)==4)Vw(u.Ea,0,u);else if(mt(u,"readystatechange"),Pn(u)==4){u.h=!1;try{let L=u.Z();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var g;if(g=L===0){var C=String(u.D).match(sE)[1]||null;!C&&a.self&&a.self.location&&(C=a.self.location.protocol.slice(0,-1)),g=!BM.test(C?C.toLowerCase():"")}f=g}if(f)mt(u,"complete"),mt(u,"success");else{u.m=6;try{var M=2<Pn(u)?u.g.statusText:""}catch{M=""}u.l=M+" ["+u.Z()+"]",gE(u)}}finally{vc(u)}}}}function vc(u,d){if(u.g){yE(u);let f=u.g,g=u.v[0]?()=>{}:null;u.g=null,u.v=null,d||mt(u,"ready");try{f.onreadystatechange=g}catch{}}}function yE(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Pn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Pn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var d=this.g.responseText;return u&&d.indexOf(u)==0&&(d=d.substring(u.length)),_M(d)}};function vE(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function $M(u){let d={};u=(u.g&&2<=Pn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<u.length;g++){if(H(u[g]))continue;var f=D(u[g]);let C=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let M=d[C]||[];d[C]=M,M.push(f)}E(d,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function na(u,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[u]||d}function _E(u){this.Aa=0,this.i=[],this.j=new Ks,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=na("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=na("baseRetryDelayMs",5e3,u),this.cb=na("retryDelaySeedMs",1e4,u),this.Wa=na("forwardChannelMaxRetries",2,u),this.wa=na("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new eE(u&&u.concurrentRequestLimit),this.Da=new VM,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=_E.prototype,n.la=8,n.G=1,n.connect=function(u,d,f,g){yt(0),this.W=u,this.H=d||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.I=AE(this,null,this.W),wc(this)};function $f(u){if(wE(u),u.G==3){var d=u.U++,f=Nn(u.I);if(Se(f,"SID",u.K),Se(f,"RID",d),Se(f,"TYPE","terminate"),ra(u,f),d=new sr(u,u.j,d),d.L=2,d.v=mc(Nn(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=d.v,f=!0),f||(d.g=RE(d.j,null),d.g.ea(d.v)),d.F=Date.now(),fc(d)}SE(u)}function _c(u){u.g&&(qf(u),u.g.cancel(),u.g=null)}function wE(u){_c(u),u.u&&(a.clearTimeout(u.u),u.u=null),Ec(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function wc(u){if(!tE(u.h)&&!u.s){u.s=!0;var d=u.Ga;Bs||Nw(),Us||(Bs(),Us=!0),Ef.add(d,u),u.B=0}}function HM(u,d){return nE(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=d.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ws(m(u.Ga,u,d),bE(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let C=new sr(this,this.j,u),M=this.o;if(this.S&&(M?(M=v(M),I(M,this.S)):M=this.S),this.m!==null||this.O||(C.H=M,M=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(d+=g,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=IE(this,C,d),f=Nn(this.I),Se(f,"RID",u),Se(f,"CVER",22),this.D&&Se(f,"X-HTTP-Session-Id",this.D),ra(this,f),M&&(this.O?d="headers="+encodeURIComponent(String(fE(M)))+"&"+d:this.m&&Uf(f,this.m,M)),Bf(this.h,C),this.Ua&&Se(f,"TYPE","init"),this.P?(Se(f,"$req",d),Se(f,"SID","null"),C.T=!0,Ff(C,f,null)):Ff(C,f,d),this.G=2}}else this.G==3&&(u?EE(this,u):this.i.length==0||tE(this.h)||EE(this))};function EE(u,d){var f;d?f=d.l:f=u.U++;let g=Nn(u.I);Se(g,"SID",u.K),Se(g,"RID",f),Se(g,"AID",u.T),ra(u,g),u.m&&u.o&&Uf(g,u.m,u.o),f=new sr(u,u.j,f,u.B+1),u.m===null&&(f.H=u.o),d&&(u.i=d.D.concat(u.i)),d=IE(u,f,1e3),f.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Bf(u.h,f),Ff(f,g,d)}function ra(u,d){u.H&&ne(u.H,function(f,g){Se(d,g,f)}),u.l&&oE({},function(f,g){Se(d,g,f)})}function IE(u,d,f){f=Math.min(u.i.length,f);var g=u.l?m(u.l.Na,u.l,u):null;e:{var C=u.i;let M=-1;for(;;){let L=["count="+f];M==-1?0<f?(M=C[0].g,L.push("ofs="+M)):M=0:L.push("ofs="+M);let De=!0;for(let et=0;et<f;et++){let me=C[et].g,ut=C[et].map;if(me-=M,0>me)M=Math.max(0,C[et].g-100),De=!1;else try{jM(ut,L,"req"+me+"_")}catch{g&&g(ut)}}if(De){g=L.join("&");break e}}}return u=u.i.splice(0,f),d.D=u,g}function DE(u){if(!u.g&&!u.u){u.Y=1;var d=u.Fa;Bs||Nw(),Us||(Bs(),Us=!0),Ef.add(d,u),u.v=0}}function Hf(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ws(m(u.Fa,u),bE(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,TE(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ws(m(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yt(10),_c(this),TE(this))};function qf(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function TE(u){u.g=new sr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var d=Nn(u.qa);Se(d,"RID","rpc"),Se(d,"SID",u.K),Se(d,"AID",u.T),Se(d,"CI",u.F?"0":"1"),!u.F&&u.ja&&Se(d,"TO",u.ja),Se(d,"TYPE","xmlhttp"),ra(u,d),u.m&&u.o&&Uf(d,u.m,u.o),u.L&&(u.g.I=u.L);var f=u.g;u=u.ia,f.L=1,f.v=mc(Nn(d)),f.m=null,f.P=!0,Zw(f,u)}n.Za=function(){this.C!=null&&(this.C=null,_c(this),Hf(this),yt(19))};function Ec(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function CE(u,d){var f=null;if(u.g==d){Ec(u),qf(u),u.g=null;var g=2}else if(jf(u.h,d))f=d.D,rE(u.h,d),g=1;else return;if(u.G!=0){if(d.o)if(g==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var C=u.B;g=lc(),mt(g,new Ww(g,f)),wc(u)}else DE(u);else if(C=d.s,C==3||C==0&&0<d.X||!(g==1&&HM(u,d)||g==2&&Hf(u)))switch(f&&0<f.length&&(d=u.h,d.i=d.i.concat(f)),C){case 1:Kr(u,5);break;case 4:Kr(u,10);break;case 3:Kr(u,6);break;default:Kr(u,2)}}}function bE(u,d){let f=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(f*=2),f*d}function Kr(u,d){if(u.j.info("Error code "+d),d==2){var f=m(u.fb,u),g=u.Xa;let C=!g;g=new Wr(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||pc(g,"https"),mc(g),C?FM(g.toString(),f):LM(g.toString(),f)}else yt(2);u.G=0,u.l&&u.l.sa(d),SE(u),wE(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function SE(u){if(u.G=0,u.ka=[],u.l){let d=iE(u.h);(d.length!=0||u.i.length!=0)&&(N(u.ka,d),N(u.ka,u.i),u.h.i.length=0,A(u.i),u.i.length=0),u.l.ra()}}function AE(u,d,f){var g=f instanceof Wr?Nn(f):new Wr(f);if(g.g!="")d&&(g.g=d+"."+g.g),gc(g,g.s);else{var C=a.location;g=C.protocol,d=d?d+"."+C.hostname:C.hostname,C=+C.port;var M=new Wr(null);g&&pc(M,g),d&&(M.g=d),C&&gc(M,C),f&&(M.l=f),g=M}return f=u.D,d=u.ya,f&&d&&Se(g,f,d),Se(g,"VER",u.la),ra(u,g),g}function RE(u,d,f){if(d&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=u.Ca&&!u.pa?new Fe(new Xs({eb:f})):new Fe(u.pa),d.Ha(u.J),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ME(){}n=ME.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ic(){}Ic.prototype.g=function(u,d){return new Nt(u,d)};function Nt(u,d){at.call(this),this.g=new _E(d),this.l=u,this.h=d&&d.messageUrlParams||null,u=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(u?u["X-WebChannel-Content-Type"]=d.messageContentType:u={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(u?u["X-WebChannel-Client-Profile"]=d.va:u={"X-WebChannel-Client-Profile":d.va}),this.g.S=u,(u=d&&d.Sb)&&!H(u)&&(this.g.m=u),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!H(d)&&(this.g.D=d,u=this.h,u!==null&&d in u&&(u=this.h,d in u&&delete u[d])),this.j=new Yi(this)}T(Nt,at),Nt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Nt.prototype.close=function(){$f(this.g)},Nt.prototype.o=function(u){var d=this.g;if(typeof u=="string"){var f={};f.__data__=u,u=f}else this.u&&(f={},f.__data__=Mf(u),u=f);d.i.push(new bM(d.Ya++,u)),d.G==3&&wc(d)},Nt.prototype.N=function(){this.g.l=null,delete this.j,$f(this.g),delete this.g,Nt.aa.N.call(this)};function xE(u){Nf.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var d=u.__sm__;if(d){e:{for(let f in d){u=f;break e}u=void 0}(this.i=u)&&(u=this.i,d=d!==null&&u in d?d[u]:void 0),this.data=d}else this.data=u}T(xE,Nf);function NE(){Pf.call(this),this.status=1}T(NE,Pf);function Yi(u){this.g=u}T(Yi,ME),Yi.prototype.ua=function(){mt(this.g,"a")},Yi.prototype.ta=function(u){mt(this.g,new xE(u))},Yi.prototype.sa=function(u){mt(this.g,new NE)},Yi.prototype.ra=function(){mt(this.g,"b")},Ic.prototype.createWebChannel=Ic.prototype.g,Nt.prototype.send=Nt.prototype.o,Nt.prototype.open=Nt.prototype.m,Nt.prototype.close=Nt.prototype.close,fy=Kn.createWebChannelTransport=function(){return new Ic},hy=Kn.getStatEventTarget=function(){return lc()},dy=Kn.Event=zr,Ld=Kn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},dc.NO_ERROR=0,dc.TIMEOUT=8,dc.HTTP_ERROR=6,pu=Kn.ErrorCode=dc,Kw.COMPLETE="complete",ly=Kn.EventType=Kw,Hw.EventType=zs,zs.OPEN="a",zs.CLOSE="b",zs.ERROR="c",zs.MESSAGE="d",at.prototype.listen=at.prototype.K,qo=Kn.WebChannel=Hw,kL=Kn.FetchXmlHttpFactory=Xs,Fe.prototype.listenOnce=Fe.prototype.L,Fe.prototype.getLastError=Fe.prototype.Ka,Fe.prototype.getLastErrorCode=Fe.prototype.Ba,Fe.prototype.getStatus=Fe.prototype.Z,Fe.prototype.getResponseJson=Fe.prototype.Oa,Fe.prototype.getResponseText=Fe.prototype.oa,Fe.prototype.send=Fe.prototype.ea,Fe.prototype.setWithCredentials=Fe.prototype.Ha,cy=Kn.XhrIo=Fe}).apply(typeof Fd<"u"?Fd:typeof self<"u"?self:typeof window<"u"?window:{});var Zb="@firebase/firestore",Jb="4.7.14";var Ge=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ge.UNAUTHENTICATED=new Ge(null),Ge.GOOGLE_CREDENTIALS=new Ge("google-credentials-uid"),Ge.FIRST_PARTY=new Ge("first-party-uid"),Ge.MOCK_USER=new Ge("mock-user");var Rs="11.7.3";var Rr=new Sc("@firebase/firestore");function Zo(){return Rr.logLevel}function h0(n){Rr.setLogLevel(n)}function k(n,...e){if(Rr.logLevel<=dn.DEBUG){let t=e.map(S_);Rr.debug(`Firestore (${Rs}): ${n}`,...t)}}function Be(n,...e){if(Rr.logLevel<=dn.ERROR){let t=e.map(S_);Rr.error(`Firestore (${Rs}): ${n}`,...t)}}function on(n,...e){if(Rr.logLevel<=dn.WARN){let t=e.map(S_);Rr.warn(`Firestore (${Rs}): ${n}`,...t)}}function S_(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function $(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,f0(n,r,t)}function f0(n,e,t){let r=`FIRESTORE (${Rs}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Be(r),new Error(r)}function z(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||f0(e,i,r)}function p0(n,e){n||$(57014,e)}function j(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},P=class extends jE{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Ze=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Yd=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Ey=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ge.UNAUTHENTICATED))}shutdown(){}},Iy=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Dy=class{constructor(e){this.t=e,this.currentUser=Ge.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){z(this.o===void 0,42304);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),o=new Ze;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ze,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let c=o;e.enqueueRetryable(()=>x(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ze)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(z(typeof r.accessToken=="string",31837,{l:r}),new Yd(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return z(e===null||typeof e=="string",2055,{h:e}),new Ge(e)}},Ty=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ge.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},Cy=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Ty(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ge.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Zd=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},by=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,UE(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){z(this.o===void 0,3512);let r=o=>{o.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,k("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Zd(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(z(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Zd(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function OL(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function A_(){return new TextEncoder}var Jd=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=OL(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function J(n,e){return n<e?-1:n>e?1:0}function Sy(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return J(r,i);{let o=A_(),s=FL(o.encode(Xb(n,t)),o.encode(Xb(e,t)));return s!==0?s:J(r,i)}}t+=r>65535?2:1}return J(n.length,e.length)}function Xb(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function FL(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return J(n[t],e[t]);return J(n.length,e.length)}function ss(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function g0(n){return n+"\0"}var eS=-62135596800,tS=1e6,ke=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*tS);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new P(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new P(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<eS)throw new P(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/tS}_compareTo(e){return this.seconds===e.seconds?J(this.nanoseconds,e.nanoseconds):J(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-eS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var W=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new ke(0,0))}static max(){return new n(new ke(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var nS="__name__",Xd=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&$(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&$(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return J(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):Sy(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Wn.fromString(e.substring(4,e.length-2))}},pe=class n extends Xd{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new P(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},LL=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ue=class n extends Xd{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return LL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nS}static keyField(){return new n([nS])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new P(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new P(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new P(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new P(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(pe.fromString(e))}static fromName(e){return new n(pe.fromString(e).popFirst(5))}static empty(){return new n(pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new pe(e.slice()))}};var as=-1,us=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function Ay(n){return n.fields.find(e=>e.kind===2)}function Ei(n){return n.fields.filter(e=>e.kind!==2)}us.UNKNOWN_ID=-1;var rs=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Su=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,qt.min())}};function m0(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=W.fromTimestamp(r===1e9?new ke(t+1,0):new ke(t,r));return new qt(i,B.empty(),e)}function y0(n){return new qt(n.readTime,n.key,as)}var qt=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(W.min(),B.empty(),as)}static max(){return new n(W.max(),B.empty(),as)}};function R_(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:J(n.largestBatchId,e.largestBatchId))}var v0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",eh=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Br(n){return x(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==v0)throw n;k("LocalStore","Unexpectedly lost primary lease")})}var S=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>r(c))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let c=0;c<o;c++){let l=c;t(e[l]).next(h=>{s[l]=h,++a,a===o&&r(s)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};var Ft="SimpleDb",th=class n{static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(o){throw new Ri(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ze,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Ri(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{let i=M_(r.target.error);this.S.reject(new Ri(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(k(Ft,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new My(t)}},Mr=class n{static delete(e){return k(Ft,"Removing database:",e),Di(Wf().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!Cc())return!1;if(n.F())return!0;let e=ia(),t=n.M(e),r=0<t&&t<10,i=_0(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,n.M(ia())===12.2&&Be("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}k(e){return x(this,null,function*(){return this.db||(k(Ft,"Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{r(new Ri(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?r(new P(R.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new P(R.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new Ri(e,s))},i.onupgradeneeded=o=>{k(Ft,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;if(this.L!==null&&this.L!==o.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${o.oldVersion}, event.newVersion=${o.newVersion}, db.version=${s.version}`);this.B.q(s,i.transaction,o.oldVersion,this.version).next(()=>{k(Ft,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{let r=t.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=t=>this.$(t)),this.db})}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return x(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.k(e);let a=th.open(this.db,e,o?"readonly":"readwrite",r),c=i(a).next(l=>(a.v(),l)).catch(l=>(a.abort(l),S.reject(l))).toPromise();return c.catch(()=>{}),yield a.D,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&s<3;if(k(Ft,"Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function _0(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var Ry=class{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return Di(this.K.delete())}},Ri=class extends P{constructor(e,t){super(R.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Ur(n){return n.name==="IndexedDbTransactionError"}var My=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(k(Ft,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(k(Ft,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Di(r)}add(e){return k(Ft,"ADD",this.store.name,e,e),Di(this.store.add(e))}get(e){return Di(this.store.get(e)).next(t=>(t===void 0&&(t=null),k(Ft,"GET",this.store.name,e,t),t))}delete(e){return k(Ft,"DELETE",this.store.name,e),Di(this.store.delete(e))}count(){return k(Ft,"COUNT",this.store.name),Di(this.store.count())}J(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(r.range);return new S((s,a)=>{o.onerror=c=>{a(c.target.error)},o.onsuccess=c=>{s(c.target.result)}})}{let o=this.cursor(r),s=[];return this.Y(o,(a,c)=>{s.push(c)}).next(()=>s)}}Z(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new S((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}X(e,t){k(Ft,"DELETE ALL",this.store.name);let r=this.options(e,t);r.ee=!1;let i=this.cursor(r);return this.Y(i,(o,s,a)=>a.delete())}te(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.Y(i,t)}ne(e){let t=this.cursor({});return new S((r,i)=>{t.onerror=o=>{let s=M_(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}Y(e,t){let r=[];return new S((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let a=s.target.result;if(!a)return void i();let c=new Ry(a),l=t(a.primaryKey,a.value,c);if(l instanceof S){let h=l.catch(p=>(c.done(),S.reject(p)));r.push(h)}c.isDone?i():c.j===null?a.continue():a.continue(c.j)}}).next(()=>S.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Di(n){return new S((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=M_(r.target.error);t(i)}})}var rS=!1;function M_(n){let e=Mr.M(ia());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new P("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return rS||(rS=!0,setTimeout(()=>{throw r},0)),r}}return n}var Eu="IndexBackfiller",xy=class{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){k(Eu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>x(this,null,function*(){this.task=null;try{let t=yield this.re.se();k(Eu,`Documents written: ${t}`)}catch(t){Ur(t)?k(Eu,"Ignoring IndexedDB error during index backfill: ",t):yield Br(t)}yield this.ie(6e4)}))}},Ny=class{constructor(e,t){this.localStore=e,this.persistence=t}se(e=50){return x(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.oe(t,e))})}oe(e,t){let r=new Set,i=t,o=!0;return S.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return k(Eu,`Processing collection: ${s}`),this._e(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}_e(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.ae(i,o)).next(a=>(k(Eu,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}ae(e,t){let r=e;return t.changes.forEach((i,o)=>{let s=y0(o);R_(s,r)>0&&(r=s)}),new qt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Lt=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>r.writeSequenceNumber(i))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ce&&this.ce(t),t}}n.le=-1;return n})(),Sr=-1;function Ju(n){return n==null}function Au(n){return n===0&&1/n==-1/0}function w0(n){return typeof n=="number"&&Number.isInteger(n)&&!Au(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var nh="";function gt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=iS(e)),e=VL(n.get(t),e);return iS(e)}function VL(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case nh:t+="";break;default:t+=o}}return t}function iS(n){return n+nh+""}function In(n){let e=n.length;if(z(e>=2,64408,{path:n}),e===2)return z(n.charAt(0)===nh&&n.charAt(1)==="",56145,{path:n}),pe.emptyPath();let t=e-2,r=[],i="";for(let o=0;o<e;){let s=n.indexOf(nh,o);switch((s<0||s>t)&&$(50515,{path:n}),n.charAt(s+1)){case"":let a=n.substring(o,s),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:$(61167,{path:n})}o=s+2}return new pe(r)}var Ii="remoteDocuments",Xu="owner",zo="owner",Ru="mutationQueues",jL="userId",rn="mutations",oS="batchId",Si="userMutationsIndex",sS=["userId","batchId"];function Hd(n,e){return[n,gt(e)]}function E0(n,e,t){return[n,gt(e),t]}var BL={},cs="documentMutations",rh="remoteDocumentsV14",UL=["prefixPath","collectionGroup","readTime","documentId"],qd="documentKeyIndex",$L=["prefixPath","collectionGroup","documentId"],I0="collectionGroupIndex",HL=["collectionGroup","readTime","prefixPath","documentId"],Mu="remoteDocumentGlobal",Py="remoteDocumentGlobalKey",ls="targets",D0="queryTargetsIndex",qL=["canonicalId","targetId"],ds="targetDocuments",zL=["targetId","path"],x_="documentTargetsIndex",GL=["path","targetId"],ih="targetGlobalKey",Mi="targetGlobal",xu="collectionParents",WL=["collectionId","parent"],hs="clientMetadata",KL="clientId",ef="bundles",QL="bundleId",tf="namedQueries",YL="name",N_="indexConfiguration",ZL="indexId",ky="collectionGroupIndex",JL="collectionGroup",oh="indexState",XL=["indexId","uid"],T0="sequenceNumberIndex",eV=["uid","sequenceNumber"],sh="indexEntries",tV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],C0="documentKeyIndex",nV=["indexId","uid","orderedDocumentKey"],nf="documentOverlays",rV=["userId","collectionPath","documentId"],Oy="collectionPathOverlayIndex",iV=["userId","collectionPath","largestBatchId"],b0="collectionGroupOverlayIndex",oV=["userId","collectionGroup","largestBatchId"],P_="globals",sV="name",S0=[Ru,rn,cs,Ii,ls,Xu,Mi,ds,hs,Mu,xu,ef,tf],aV=[...S0,nf],A0=[Ru,rn,cs,rh,ls,Xu,Mi,ds,hs,Mu,xu,ef,tf,nf],R0=A0,k_=[...R0,N_,oh,sh],uV=k_,cV=[...k_,P_];var Nu=class extends eh{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}};function Je(n,e){let t=j(n);return Mr.N(t.he,e)}function aS(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function $r(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function M0(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ae=class n{constructor(e,t){this.comparator=e,this.root=t||Tn.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Tn.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Tn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ns(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ns(this.root,e,this.comparator,!1)}getReverseIterator(){return new ns(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ns(this.root,e,this.comparator,!0)}},ns=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Tn=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw $(43730,{key:this.key,value:this.value});if(this.right.isRed())throw $(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw $(27949);return e+(this.isRed()?0:1)}};Tn.EMPTY=null,Tn.RED=!0,Tn.BLACK=!1;Tn.EMPTY=new class{constructor(){this.size=0}get key(){throw $(57766)}get value(){throw $(16141)}get color(){throw $(16727)}get left(){throw $(29726)}get right(){throw $(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new Tn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ie=class n{constructor(e){this.comparator=e,this.data=new Ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ah(this.data.getIterator())}getIteratorFrom(e){return new ah(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},ah=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Go(n){return n.hasNext()?n.getNext():void 0}var Vt=class n{constructor(e){this.fields=e,e.sort(Ue.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ie(Ue.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ss(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var uh=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function x0(){return typeof atob<"u"}var He=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new uh("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return J(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};He.EMPTY_BYTE_STRING=new He("");var lV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zn(n){if(z(!!n,39018),typeof n=="string"){let e=0,t=lV.exec(n);if(z(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Me(n.seconds),nanos:Me(n.nanos)}}function Me(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Jn(n){return typeof n=="string"?He.fromBase64String(n):He.fromUint8Array(n)}var N0="server_timestamp",P0="__type__",k0="__previous_value__",O0="__local_write_time__";function rf(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[P0])===null||t===void 0?void 0:t.stringValue)===N0}function of(n){let e=n.mapValue.fields[k0];return rf(e)?of(e):e}function Pu(n){let e=Zn(n.mapValue.fields[O0].timestampValue);return new ke(e.seconds,e.nanos)}var Fy=class{constructor(e,t,r,i,o,s,a,c,l,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=h}},Ly="(default)",xr=class n{constructor(e,t){this.projectId=e,this.database=t||Ly}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Ly}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var O_="__type__",F0="__max__",Cr={mapValue:{fields:{__type__:{stringValue:F0}}}},F_="__vector__",fs="value",zd={nullValue:"NULL_VALUE"};function Nr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?rf(n)?4:L0(n)?9007199254740991:sf(n)?10:11:$(28295,{value:n})}function Sn(n,e){if(n===e)return!0;let t=Nr(n);if(t!==Nr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Pu(n).isEqual(Pu(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=Zn(i.timestampValue),a=Zn(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Jn(i.bytesValue).isEqual(Jn(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return Me(i.geoPointValue.latitude)===Me(o.geoPointValue.latitude)&&Me(i.geoPointValue.longitude)===Me(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Me(i.integerValue)===Me(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=Me(i.doubleValue),a=Me(o.doubleValue);return s===a?Au(s)===Au(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return ss(n.arrayValue.values||[],e.arrayValue.values||[],Sn);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(aS(s)!==aS(a))return!1;for(let c in s)if(s.hasOwnProperty(c)&&(a[c]===void 0||!Sn(s[c],a[c])))return!1;return!0}(n,e);default:return $(52216,{left:n})}}function ku(n,e){return(n.values||[]).find(t=>Sn(t,e))!==void 0}function Pr(n,e){if(n===e)return 0;let t=Nr(n),r=Nr(e);if(t!==r)return J(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return J(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=Me(o.integerValue||o.doubleValue),c=Me(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return uS(n.timestampValue,e.timestampValue);case 4:return uS(Pu(n),Pu(e));case 5:return Sy(n.stringValue,e.stringValue);case 6:return function(o,s){let a=Jn(o),c=Jn(s);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),c=s.split("/");for(let l=0;l<a.length&&l<c.length;l++){let h=J(a[l],c[l]);if(h!==0)return h}return J(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=J(Me(o.latitude),Me(s.latitude));return a!==0?a:J(Me(o.longitude),Me(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return cS(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,c,l,h;let p=o.fields||{},m=s.fields||{},y=(a=p[fs])===null||a===void 0?void 0:a.arrayValue,T=(c=m[fs])===null||c===void 0?void 0:c.arrayValue,A=J(((l=y?.values)===null||l===void 0?void 0:l.length)||0,((h=T?.values)===null||h===void 0?void 0:h.length)||0);return A!==0?A:cS(y,T)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===Cr.mapValue&&s===Cr.mapValue)return 0;if(o===Cr.mapValue)return 1;if(s===Cr.mapValue)return-1;let a=o.fields||{},c=Object.keys(a),l=s.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){let m=Sy(c[p],h[p]);if(m!==0)return m;let y=Pr(a[c[p]],l[h[p]]);if(y!==0)return y}return J(c.length,h.length)}(n.mapValue,e.mapValue);default:throw $(23264,{Pe:t})}}function uS(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return J(n,e);let t=Zn(n),r=Zn(e),i=J(t.seconds,r.seconds);return i!==0?i:J(t.nanos,r.nanos)}function cS(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Pr(t[i],r[i]);if(o)return o}return J(t.length,r.length)}function ps(n){return Vy(n)}function Vy(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Zn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Jn(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return B.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=Vy(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${Vy(t.fields[s])}`;return i+"}"}(n.mapValue):$(61005,{value:n})}function Gd(n){switch(Nr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=of(n);return e?16+Gd(e):16;case 5:return 2*n.stringValue.length;case 6:return Jn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,o)=>i+Gd(o),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return $r(r.fields,(o,s)=>{i+=o.length+Gd(s)}),i}(n.mapValue);default:throw $(13486,{value:n})}}function xi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function jy(n){return!!n&&"integerValue"in n}function Ou(n){return!!n&&"arrayValue"in n}function lS(n){return!!n&&"nullValue"in n}function dS(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Wd(n){return!!n&&"mapValue"in n}function sf(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[O_])===null||t===void 0?void 0:t.stringValue)===F_}function Iu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return $r(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Iu(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Iu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function L0(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===F0}var V0={mapValue:{fields:{[O_]:{stringValue:F_},[fs]:{arrayValue:{}}}}};function dV(n){return"nullValue"in n?zd:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?xi(xr.empty(),B.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?sf(n)?V0:{mapValue:{}}:$(35942,{value:n})}function hV(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?xi(xr.empty(),B.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?V0:"mapValue"in n?sf(n)?{mapValue:{}}:Cr:$(61959,{value:n})}function hS(n,e){let t=Pr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function fS(n,e){let t=Pr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var pt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Wd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Iu(t)}setAll(e){let t=Ue.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=Iu(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Wd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Sn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Wd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){$r(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Iu(this.value))}};function j0(n){let e=[];return $r(n.fields,(t,r)=>{let i=new Ue([t]);if(Wd(r)){let o=j0(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new Vt(e)}var We=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,W.min(),W.min(),W.min(),pt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,W.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,W.min(),W.min(),pt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,W.min(),W.min(),pt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var An=class{constructor(e,t){this.position=e,this.inclusive=t}};function pS(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=B.comparator(B.fromName(s.referenceValue),t.key):r=Pr(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function gS(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Sn(n.position[t],e.position[t]))return!1;return!0}var Ni=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function fV(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var ch=class{},de=class n extends ch{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new $y(e,t,r):t==="array-contains"?new zy(e,r):t==="in"?new lh(e,r):t==="not-in"?new Gy(e,r):t==="array-contains-any"?new Wy(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Hy(e,r):new qy(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Pr(t,this.value)):t!==null&&Nr(this.value)===Nr(t)&&this.matchesComparison(Pr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},we=class n extends ch{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new n(e,t)}matches(e){return gs(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}};function gs(n){return n.op==="and"}function By(n){return n.op==="or"}function L_(n){return B0(n)&&gs(n)}function B0(n){for(let e of n.filters)if(e instanceof we)return!1;return!0}function Uy(n){if(n instanceof de)return n.field.canonicalString()+n.op.toString()+ps(n.value);if(L_(n))return n.filters.map(e=>Uy(e)).join(",");{let e=n.filters.map(t=>Uy(t)).join(",");return`${n.op}(${e})`}}function U0(n,e){return n instanceof de?function(r,i){return i instanceof de&&r.op===i.op&&r.field.isEqual(i.field)&&Sn(r.value,i.value)}(n,e):n instanceof we?function(r,i){return i instanceof we&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&U0(s,i.filters[a]),!0):!1}(n,e):void $(19439)}function $0(n,e){let t=n.filters.concat(e);return we.create(t,n.op)}function H0(n){return n instanceof de?function(t){return`${t.field.canonicalString()} ${t.op} ${ps(t.value)}`}(n):n instanceof we?function(t){return t.op.toString()+" {"+t.getFilters().map(H0).join(" ,")+"}"}(n):"Filter"}var $y=class extends de{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},Hy=class extends de{constructor(e,t){super(e,"in",t),this.keys=q0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},qy=class extends de{constructor(e,t){super(e,"not-in",t),this.keys=q0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function q0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var zy=class extends de{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ou(t)&&ku(t.arrayValue,this.value)}},lh=class extends de{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&ku(this.value.arrayValue,t)}},Gy=class extends de{constructor(e,t){super(e,"not-in",t)}matches(e){if(ku(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ku(this.value.arrayValue,t)}},Wy=class extends de{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ou(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>ku(this.value.arrayValue,r))}};var Ky=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.Ie=null}};function Qy(n,e=null,t=[],r=[],i=null,o=null,s=null){return new Ky(n,e,t,r,i,o,s)}function Pi(n){let e=j(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Uy(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Ju(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ps(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ps(r)).join(",")),e.Ie=t}return e.Ie}function ec(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!fV(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!U0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!gS(n.startAt,e.startAt)&&gS(n.endAt,e.endAt)}function dh(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function hh(n,e){return n.filters.filter(t=>t instanceof de&&t.field.isEqual(e))}function mS(n,e,t){let r=zd,i=!0;for(let o of hh(n,e)){let s=zd,a=!0;switch(o.op){case"<":case"<=":s=dV(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=zd}hS({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];hS({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function yS(n,e,t){let r=Cr,i=!0;for(let o of hh(n,e)){let s=Cr,a=!0;switch(o.op){case">=":case">":s=hV(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=Cr}fS({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];fS({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}var sn=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}};function z0(n,e,t,r,i,o,s,a){return new sn(n,e,t,r,i,o,s,a)}function Ms(n){return new sn(n)}function vS(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function V_(n){return n.collectionGroup!==null}function is(n){let e=j(n);if(e.Ee===null){e.Ee=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ee.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Ie(Ue.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ee.push(new Ni(o,r))}),t.has(Ue.keyField().canonicalString())||e.Ee.push(new Ni(Ue.keyField(),r))}return e.Ee}function Dt(n){let e=j(n);return e.de||(e.de=pV(e,is(n))),e.de}function pV(n,e){if(n.limitType==="F")return Qy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Ni(i.field,o)});let t=n.endAt?new An(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new An(n.startAt.position,n.startAt.inclusive):null;return Qy(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Yy(n,e){let t=n.filters.concat([e]);return new sn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function fh(n,e,t){return new sn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function tc(n,e){return ec(Dt(n),Dt(e))&&n.limitType===e.limitType}function G0(n){return`${Pi(Dt(n))}|lt:${n.limitType}`}function Jo(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>H0(i)).join(", ")}]`),Ju(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ps(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ps(i)).join(",")),`Target(${r})`}(Dt(n))}; limitType=${n.limitType})`}function nc(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):B.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of is(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,c){let l=pS(s,a,c);return s.inclusive?l<=0:l<0}(r.startAt,is(r),i)||r.endAt&&!function(s,a,c){let l=pS(s,a,c);return s.inclusive?l>=0:l>0}(r.endAt,is(r),i))}(n,e)}function W0(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function K0(n){return(e,t)=>{let r=!1;for(let i of is(n)){let o=gV(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function gV(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):function(o,s,a){let c=s.data.field(o),l=a.data.field(o);return c!==null&&l!==null?Pr(c,l):$(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return $(19790,{direction:n.dir})}}var an=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){$r(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return M0(this.inner)}size(){return this.innerSize}};var mV=new Ae(B.comparator);function xt(){return mV}var Q0=new Ae(B.comparator);function _u(...n){let e=Q0;for(let t of n)e=e.insert(t.key,t);return e}function Y0(n){let e=Q0;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Dn(){return Du()}function Z0(){return Du()}function Du(){return new an(n=>n.toString(),(n,e)=>n.isEqual(e))}var yV=new Ae(B.comparator),vV=new Ie(B.comparator);function ie(...n){let e=vV;for(let t of n)e=e.add(t);return e}var _V=new Ie(J);function j_(){return _V}function B_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Au(e)?"-0":e}}function J0(n){return{integerValue:""+n}}function X0(n,e){return w0(e)?J0(e):B_(n,e)}var ms=class{constructor(){this._=void 0}};function wV(n,e,t){return n instanceof kr?function(i,o){let s={fields:{[P0]:{stringValue:N0},[O0]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&rf(o)&&(o=of(o)),o&&(s.fields[k0]=o),{mapValue:s}}(t,e):n instanceof Xn?tA(n,e):n instanceof er?nA(n,e):function(i,o){let s=eA(i,o),a=_S(s)+_S(i.Re);return jy(s)&&jy(i.Re)?J0(a):B_(i.serializer,a)}(n,e)}function EV(n,e,t){return n instanceof Xn?tA(n,e):n instanceof er?nA(n,e):t}function eA(n,e){return n instanceof Or?function(r){return jy(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var kr=class extends ms{},Xn=class extends ms{constructor(e){super(),this.elements=e}};function tA(n,e){let t=rA(e);for(let r of n.elements)t.some(i=>Sn(i,r))||t.push(r);return{arrayValue:{values:t}}}var er=class extends ms{constructor(e){super(),this.elements=e}};function nA(n,e){let t=rA(e);for(let r of n.elements)t=t.filter(i=>!Sn(i,r));return{arrayValue:{values:t}}}var Or=class extends ms{constructor(e,t){super(),this.serializer=e,this.Re=t}};function _S(n){return Me(n.integerValue||n.doubleValue)}function rA(n){return Ou(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var ki=class{constructor(e,t){this.field=e,this.transform=t}};function IV(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Xn&&i instanceof Xn||r instanceof er&&i instanceof er?ss(r.elements,i.elements,Sn):r instanceof Or&&i instanceof Or?Sn(r.Re,i.Re):r instanceof kr&&i instanceof kr}(n.transform,e.transform)}var Zy=class{constructor(e,t){this.version=e,this.transformResults=t}},Ve=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Kd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var ys=class{};function iA(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Lr(n.key,Ve.none()):new Fr(n.key,n.data,Ve.none());{let t=n.data,r=pt.empty(),i=new Ie(Ue.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new un(n.key,r,new Vt(i.toArray()),Ve.none())}}function DV(n,e,t){n instanceof Fr?function(i,o,s){let a=i.value.clone(),c=ES(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof un?function(i,o,s){if(!Kd(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=ES(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(oA(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function Tu(n,e,t,r){return n instanceof Fr?function(o,s,a,c){if(!Kd(o.precondition,s))return a;let l=o.value.clone(),h=IS(o.fieldTransforms,c,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof un?function(o,s,a,c){if(!Kd(o.precondition,s))return a;let l=IS(o.fieldTransforms,c,s),h=s.data;return h.setAll(oA(o)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(o,s,a){return Kd(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function TV(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=eA(r.transform,i||null);o!=null&&(t===null&&(t=pt.empty()),t.set(r.field,o))}return t||null}function wS(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ss(r,i,(o,s)=>IV(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Fr=class extends ys{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},un=class extends ys{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function oA(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function ES(n,e,t){let r=new Map;z(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,EV(s,a,t[i]))}return r}function IS(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,wV(o,s,e))}return r}var Lr=class extends ys{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Fu=class extends ys{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Lu=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&DV(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Tu(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Tu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Z0();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let c=iA(s,a);c!==null&&r.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ie())}isEqual(e){return this.batchId===e.batchId&&ss(this.mutations,e.mutations,(t,r)=>wS(t,r))&&ss(this.baseMutations,e.baseMutations,(t,r)=>wS(t,r))}},Jy=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){z(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let i=function(){return yV}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var Vu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Xy=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var qe,fe;function sA(n){switch(n){case R.OK:return $(64938);case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0;default:return $(15467,{code:n})}}function aA(n){if(n===void 0)return Be("GRPC error has no .code"),R.UNKNOWN;switch(n){case qe.OK:return R.OK;case qe.CANCELLED:return R.CANCELLED;case qe.UNKNOWN:return R.UNKNOWN;case qe.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case qe.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case qe.INTERNAL:return R.INTERNAL;case qe.UNAVAILABLE:return R.UNAVAILABLE;case qe.UNAUTHENTICATED:return R.UNAUTHENTICATED;case qe.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case qe.NOT_FOUND:return R.NOT_FOUND;case qe.ALREADY_EXISTS:return R.ALREADY_EXISTS;case qe.PERMISSION_DENIED:return R.PERMISSION_DENIED;case qe.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case qe.ABORTED:return R.ABORTED;case qe.OUT_OF_RANGE:return R.OUT_OF_RANGE;case qe.UNIMPLEMENTED:return R.UNIMPLEMENTED;case qe.DATA_LOSS:return R.DATA_LOSS;default:return $(39323,{code:n})}}(fe=qe||(qe={}))[fe.OK=0]="OK",fe[fe.CANCELLED=1]="CANCELLED",fe[fe.UNKNOWN=2]="UNKNOWN",fe[fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fe[fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fe[fe.NOT_FOUND=5]="NOT_FOUND",fe[fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",fe[fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",fe[fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",fe[fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fe[fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fe[fe.ABORTED=10]="ABORTED",fe[fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",fe[fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",fe[fe.INTERNAL=13]="INTERNAL",fe[fe.UNAVAILABLE=14]="UNAVAILABLE",fe[fe.DATA_LOSS=15]="DATA_LOSS";var DS=null;var CV=new Wn([4294967295,4294967295],0);function TS(n){let e=A_().encode(n),t=new uy;return t.update(e),new Uint8Array(t.digest())}function CS(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Wn([t,r],0),new Wn([i,o],0)]}var ev=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ai(`Invalid padding: ${t}`);if(r<0)throw new Ai(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ai(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ai(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Wn.fromNumber(this.pe)}we(e,t,r){let i=e.add(t.multiply(Wn.fromNumber(r)));return i.compare(CV)===1&&(i=new Wn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;let t=TS(e),[r,i]=CS(t);for(let o=0;o<this.hashCount;o++){let s=this.we(r,i,o);if(!this.be(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.pe===0)return;let t=TS(e),[r,i]=CS(t);for(let o=0;o<this.hashCount;o++){let s=this.we(r,i,o);this.Se(s)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Ai=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ju=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Bu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(W.min(),i,new Ae(J),xt(),ie())}},Bu=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ie(),ie(),ie())}};var os=class{constructor(e,t,r,i){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=i}},ph=class{constructor(e,t){this.targetId=e,this.Ce=t}},gh=class{constructor(e,t,r=He.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},mh=class{constructor(){this.Fe=0,this.Me=bS(),this.xe=He.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=ie(),t=ie(),r=ie();return this.Me.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:$(38017,{changeType:o})}}),new Bu(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=bS()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,z(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}},tv=class{constructor(e){this.ze=e,this.je=new Map,this.He=xt(),this.Je=Vd(),this.Ye=Vd(),this.Ze=new Ae(J)}Xe(e){for(let t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(let t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{let r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:$(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,i)=>{this.it(i)&&t(i)})}ot(e){let t=e.targetId,r=e.Ce.count,i=this._t(t);if(i){let o=i.target;if(dh(o))if(r===0){let s=new B(o.path);this.tt(t,s,We.newNoDocument(s,W.min()))}else z(r===1,20013,{expectedCount:r});else{let s=this.ut(t);if(s!==r){let a=this.ct(e),c=a?this.lt(a,e,s):1;if(c!==0){this.st(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,l)}DS?.ht(function(h,p,m,y,T){var A,N,V,H,F,Z;let te={localCacheCount:h,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},ne=p.unchangedNames;return ne&&(te.bloomFilter={applied:T===0,hashCount:(A=ne?.hashCount)!==null&&A!==void 0?A:0,bitmapLength:(H=(V=(N=ne?.bits)===null||N===void 0?void 0:N.bitmap)===null||V===void 0?void 0:V.length)!==null&&H!==void 0?H:0,padding:(Z=(F=ne?.bits)===null||F===void 0?void 0:F.padding)!==null&&Z!==void 0?Z:0,mightContain:E=>{var v;return(v=y?.mightContain(E))!==null&&v!==void 0&&v}}),te}(s,e.Ce,this.ze.Pt(),a,c))}}}}ct(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=Jn(r).toUint8Array()}catch(c){if(c instanceof uh)return on("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new ev(s,i,o)}catch(c){return on(c instanceof Ai?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.pe===0?null:a}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){let r=this.ze.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.ze.Pt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.tt(t,o,null),i++)}),i}It(e){let t=new Map;this.je.forEach((o,s)=>{let a=this._t(s);if(a){if(o.current&&dh(a.target)){let c=new B(a.target.path);this.Et(c).has(s)||this.dt(s,c)||this.tt(s,c,We.newNoDocument(c,e))}o.Le&&(t.set(s,o.qe()),o.Qe())}});let r=ie();this.Ye.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{let l=this._t(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.He.forEach((o,s)=>s.setReadTime(e));let i=new ju(e,t,this.Ze,this.He,r);return this.He=xt(),this.Je=Vd(),this.Ye=Vd(),this.Ze=new Ae(J),i}et(e,t){if(!this.it(e))return;let r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;let i=this.rt(e);this.dt(e,t)?i.$e(t,1):i.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){let t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new mh,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Ie(J),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Ie(J),this.Je=this.Je.insert(e,t)),t}it(e){let t=this._t(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}_t(e){let t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new mh),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}};function Vd(){return new Ae(B.comparator)}function bS(){return new Ae(B.comparator)}var bV={asc:"ASCENDING",desc:"DESCENDING"},SV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},AV={and:"AND",or:"OR"},nv=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function rv(n,e){return n.useProto3Json||Ju(e)?e:{value:e}}function vs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function uA(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function RV(n,e){return vs(n,e.toTimestamp())}function $e(n){return z(!!n,49232),W.fromTimestamp(function(t){let r=Zn(t);return new ke(r.seconds,r.nanos)}(n))}function U_(n,e){return iv(n,e).canonicalString()}function iv(n,e){let t=function(i){return new pe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function cA(n){let e=pe.fromString(n);return z(_A(e),10190,{key:e.toString()}),e}function Uu(n,e){return U_(n.databaseId,e.path)}function Cn(n,e){let t=cA(e);if(t.get(1)!==n.databaseId.projectId)throw new P(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new P(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(hA(t))}function lA(n,e){return U_(n.databaseId,e)}function dA(n){let e=cA(n);return e.length===4?pe.emptyPath():hA(e)}function ov(n){return new pe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function hA(n){return z(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function SS(n,e,t){return{name:Uu(n,e),fields:t.value.mapValue.fields}}function fA(n,e,t){let r=Cn(n,e.name),i=$e(e.updateTime),o=e.createTime?$e(e.createTime):W.min(),s=new pt({mapValue:{fields:e.fields}}),a=We.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function MV(n,e){return"found"in e?function(r,i){z(!!i.found,43571),i.found.name,i.found.updateTime;let o=Cn(r,i.found.name),s=$e(i.found.updateTime),a=i.found.createTime?$e(i.found.createTime):W.min(),c=new pt({mapValue:{fields:i.found.fields}});return We.newFoundDocument(o,s,a,c)}(n,e):"missing"in e?function(r,i){z(!!i.missing,3894),z(!!i.readTime,22933);let o=Cn(r,i.missing),s=$e(i.readTime);return We.newNoDocument(o,s)}(n,e):$(7234,{result:e})}function xV(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:$(39313,{state:l})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(l,h){return l.useProto3Json?(z(h===void 0||typeof h=="string",58123),He.fromBase64String(h||"")):(z(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),He.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(l){let h=l.code===void 0?R.UNKNOWN:aA(l.code);return new P(h,l.message||"")}(s);t=new gh(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Cn(n,r.document.name),o=$e(r.document.updateTime),s=r.document.createTime?$e(r.document.createTime):W.min(),a=new pt({mapValue:{fields:r.document.fields}}),c=We.newFoundDocument(i,o,s,a),l=r.targetIds||[],h=r.removedTargetIds||[];t=new os(l,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Cn(n,r.document),o=r.readTime?$e(r.readTime):W.min(),s=We.newNoDocument(i,o),a=r.removedTargetIds||[];t=new os([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Cn(n,r.document),o=r.removedTargetIds||[];t=new os([],o,i,null)}else{if(!("filter"in e))return $(11601,{Vt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new Xy(i,o),a=r.targetId;t=new ph(a,s)}}return t}function $u(n,e){let t;if(e instanceof Fr)t={update:SS(n,e.key,e.value)};else if(e instanceof Lr)t={delete:Uu(n,e.key)};else if(e instanceof un)t={update:SS(n,e.key,e.data),updateMask:LV(e.fieldMask)};else{if(!(e instanceof Fu))return $(16599,{ft:e.type});t={verify:Uu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof kr)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Xn)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof er)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Or)return{fieldPath:s.field.canonicalString(),increment:a.Re};throw $(20930,{transform:s.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:RV(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:$(27497)}(n,e.precondition)),t}function sv(n,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?Ve.updateTime($e(o.updateTime)):o.exists!==void 0?Ve.exists(o.exists):Ve.none()}(e.currentDocument):Ve.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let c=null;if("setToServerValue"in a)z(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new kr;else if("appendMissingElements"in a){let h=a.appendMissingElements.values||[];c=new Xn(h)}else if("removeAllFromArray"in a){let h=a.removeAllFromArray.values||[];c=new er(h)}else"increment"in a?c=new Or(s,a.increment):$(16584,{proto:a});let l=Ue.fromServerFormat(a.fieldPath);return new ki(l,c)}(n,i)):[];if(e.update){e.update.name;let i=Cn(n,e.update.name),o=new pt({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(c){let l=c.fieldPaths||[];return new Vt(l.map(h=>Ue.fromServerFormat(h)))}(e.updateMask);return new un(i,o,s,t,r)}return new Fr(i,o,t,r)}if(e.delete){let i=Cn(n,e.delete);return new Lr(i,t)}if(e.verify){let i=Cn(n,e.verify);return new Fu(i,t)}return $(1463,{proto:e})}function NV(n,e){return n&&n.length>0?(z(e!==void 0,14353),n.map(t=>function(i,o){let s=i.updateTime?$e(i.updateTime):$e(o);return s.isEqual(W.min())&&(s=$e(o)),new Zy(s,i.transformResults||[])}(t,e))):[]}function pA(n,e){return{documents:[lA(n,e.path)]}}function gA(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=lA(n,i);let o=function(l){if(l.length!==0)return vA(we.create(l,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(l){if(l.length!==0)return l.map(h=>function(m){return{field:Xo(m.field),direction:kV(m.dir)}}(h))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=rv(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{gt:t,parent:i}}function mA(n){let e=dA(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){z(r===1,65062);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=function(p){let m=yA(p);return m instanceof we&&L_(m)?m.getFilters():[m]}(t.where));let s=[];t.orderBy&&(s=function(p){return p.map(m=>function(T){return new Ni(es(T.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,Ju(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(p){let m=!!p.before,y=p.values||[];return new An(y,m)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let m=!p.before,y=p.values||[];return new An(y,m)}(t.endAt)),z0(e,i,s,o,a,"F",c,l)}function PV(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function yA(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=es(t.unaryFilter.field);return de.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=es(t.unaryFilter.field);return de.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=es(t.unaryFilter.field);return de.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=es(t.unaryFilter.field);return de.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return $(61313);default:return $(60726)}}(n):n.fieldFilter!==void 0?function(t){return de.create(es(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return $(58110);default:return $(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return we.create(t.compositeFilter.filters.map(r=>yA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return $(1026)}}(t.compositeFilter.op))}(n):$(30097,{filter:n})}function kV(n){return bV[n]}function OV(n){return SV[n]}function FV(n){return AV[n]}function Xo(n){return{fieldPath:n.canonicalString()}}function es(n){return Ue.fromServerFormat(n.fieldPath)}function vA(n){return n instanceof de?function(t){if(t.op==="=="){if(dS(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NAN"}};if(lS(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(dS(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NAN"}};if(lS(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xo(t.field),op:OV(t.op),value:t.value}}}(n):n instanceof we?function(t){let r=t.getFilters().map(i=>vA(i));return r.length===1?r[0]:{compositeFilter:{op:FV(t.op),filters:r}}}(n):$(54877,{filter:n})}function LV(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function _A(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var _s=class n{constructor(e,t,r,i,o=W.min(),s=W.min(),a=He.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var yh=class{constructor(e){this.wt=e}};function VV(n,e){let t;if(e.document)t=fA(n.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=B.fromSegments(e.noDocument.path),i=Fi(e.noDocument.readTime);t=We.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return $(56709);{let r=B.fromSegments(e.unknownDocument.path),i=Fi(e.unknownDocument.version);t=We.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let o=new ke(i[0],i[1]);return W.fromTimestamp(o)}(e.readTime)),t}function AS(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:vh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:Uu(o,s.key),fields:s.data.value.mapValue.fields,updateTime:vs(o,s.version.toTimestamp()),createTime:vs(o,s.createTime.toTimestamp())}}(n.wt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Oi(e.version)};else{if(!e.isUnknownDocument())return $(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Oi(e.version)}}return r}function vh(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Oi(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Fi(n){let e=new ke(n.seconds,n.nanoseconds);return W.fromTimestamp(e)}function Ti(n,e){let t=(e.baseMutations||[]).map(o=>sv(n.wt,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let r=e.mutations.map(o=>sv(n.wt,o)),i=ke.fromMillis(e.localWriteTimeMs);return new Lu(e.batchId,i,t,r)}function wu(n){let e=Fi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Fi(n.lastLimboFreeSnapshotVersion):W.min(),r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){let s=o.documents.length;return z(s===1,1966,{count:s}),Dt(Ms(dA(o.documents[0])))}(n.query):function(o){return Dt(mA(o))}(n.query),new _s(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,He.fromBase64String(n.resumeToken))}function wA(n,e){let t=Oi(e.snapshotVersion),r=Oi(e.lastLimboFreeSnapshotVersion),i;i=dh(e.target)?pA(n.wt,e.target):gA(n.wt,e.target).gt;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Pi(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function $_(n){let e=mA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?fh(e,e.limit,"L"):e}function py(n,e){return new Vu(e.largestBatchId,sv(n.wt,e.overlayMutation))}function RS(n,e){let t=e.path.lastSegment();return[n,gt(e.path.popLast()),t]}function MS(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Oi(r.readTime),documentKey:gt(r.documentKey.path),largestBatchId:r.largestBatchId}}var av=class{getBundleMetadata(e,t){return xS(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:Fi(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return xS(e).put(function(i){return{bundleId:i.id,createTime:Oi($e(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return NS(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:$_(o.bundledQuery),readTime:Fi(o.readTime)}}(r)})}saveNamedQuery(e,t){return NS(e).put(function(i){return{name:i.name,readTime:Oi($e(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function xS(n){return Je(n,ef)}function NS(n){return Je(n,tf)}var _h=class n{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return gu(e).get(RS(this.userId,t)).next(r=>r?py(this.serializer,r):null)}getOverlays(e,t){let r=Dn();return S.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((o,s)=>{let a=new Vu(t,s);i.push(this.St(e,a))}),S.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(s=>i.add(gt(s.getCollectionPath())));let o=[];return i.forEach(s=>{let a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(gu(e).X(Oy,a))}),S.waitFor(o)}getOverlaysForCollection(e,t,r){let i=Dn(),o=gt(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return gu(e).J(Oy,s).next(a=>{for(let c of a){let l=py(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let o=Dn(),s,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return gu(e).te({index:b0,range:a},(c,l,h)=>{let p=py(this.serializer,l);o.size()<i||p.largestBatchId===s?(o.set(p.getKey(),p),s=p.largestBatchId):h.done()}).next(()=>o)}St(e,t){return gu(e).put(function(i,o,s){let[a,c,l]=RS(o,s.mutation.key);return{userId:o,collectionPath:c,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:$u(i.wt,s.mutation)}}(this.serializer,this.userId,t))}};function gu(n){return Je(n,nf)}var uv=class{Dt(e){return Je(e,P_)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(t=>{let r=t?.value;return r?He.fromUint8Array(r):He.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var Qn=class{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(Me(e.integerValue));else if("doubleValue"in e){let r=Me(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),Au(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),typeof r=="string"&&(r=Zn(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(Jn(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?L0(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):sf(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):$(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){let r=e.fields||{};this.Mt(t,55);for(let i of Object.keys(r))this.Nt(i,t),this.Ct(r[i],t)}qt(e,t){var r,i;let o=e.fields||{};this.Mt(t,53);let s=fs,a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Mt(t,15),t.xt(Me(a)),this.Nt(s,t),this.Ct(o[s],t)}$t(e,t){let r=e.values||[];this.Mt(t,50);for(let i of r)this.Ct(i,t)}kt(e,t){this.Mt(t,37),B.fromName(e).path.forEach(r=>{this.Mt(t,60),this.Kt(r,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}};Qn.Wt=new Qn;var Wo=255;function jV(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function PS(n){let e=64-function(r){let i=0;for(let o=0;o<8;++o){let s=jV(255&r[o]);if(i+=s,s!==8)break}return i}(n);return Math.ceil(e/8)}var cv=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.zt(r.value),r=t.next();this.jt()}Ht(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Yt()}Zt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{let i=t.codePointAt(0);this.zt(240|i>>>18),this.zt(128|63&i>>>12),this.zt(128|63&i>>>6),this.zt(128|63&i)}}this.jt()}Xt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{let i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Yt()}en(e){let t=this.tn(e),r=PS(t);this.nn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}rn(e){let t=this.tn(e),r=PS(t);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}sn(){this._n(Wo),this._n(255)}an(){this.un(Wo),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}zt(e){let t=255&e;t===0?(this._n(0),this._n(255)):t===Wo?(this._n(Wo),this._n(0)):this._n(t)}Jt(e){let t=255&e;t===0?(this.un(0),this.un(255)):t===Wo?(this.un(Wo),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},lv=class{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}},dv=class{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}},Ci=class{constructor(){this.ln=new cv,this.hn=new lv(this.ln),this.Pn=new dv(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}};var bi=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}In(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function Er(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=kS(n.arrayValue,e.arrayValue),t!==0?t:(t=kS(n.directionalValue,e.directionalValue),t!==0?t:B.comparator(n.documentKey,e.documentKey)))}function kS(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var wh=class{constructor(e){this.En=new Ie((t,r)=>Ue.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.An=[];for(let t of e.filters){let r=t;r.isInequality()?this.En=this.En.add(r):this.An.push(r)}}get Rn(){return this.En.size>1}Vn(e){if(z(e.collectionGroup===this.collectionId,49279),this.Rn)return!1;let t=Ay(e);if(t!==void 0&&!this.mn(t))return!1;let r=Ei(e),i=new Set,o=0,s=0;for(;o<r.length&&this.mn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.En.size>0){let a=this.En.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[o];if(!this.fn(a,c)||!this.gn(this.dn[s++],c))return!1}++o}for(;o<r.length;++o){let a=r[o];if(s>=this.dn.length||!this.gn(this.dn[s++],a))return!1}return!0}pn(){if(this.Rn)return null;let e=new Ie(Ue.comparator),t=[];for(let r of this.An)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new rs(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new rs(r.field,0))}for(let r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new rs(r.field,r.dir==="asc"?0:1)));return new us(us.UNKNOWN_ID,this.collectionId,t,Su.empty())}mn(e){for(let t of this.An)if(this.fn(t,e))return!0;return!1}fn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}gn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function EA(n){var e,t;if(z(n instanceof de||n instanceof we,20012),n instanceof de){if(n instanceof lh){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>de.create(n.field,"==",o)))||[];return we.create(i,"or")}return n}let r=n.filters.map(i=>EA(i));return we.create(r,n.op)}function BV(n){if(n.getFilters().length===0)return[];let e=pv(EA(n));return z(IA(e),7391),hv(e)||fv(e)?[e]:e.getFilters()}function hv(n){return n instanceof de}function fv(n){return n instanceof we&&L_(n)}function IA(n){return hv(n)||fv(n)||function(t){if(t instanceof we&&By(t)){for(let r of t.getFilters())if(!hv(r)&&!fv(r))return!1;return!0}return!1}(n)}function pv(n){if(z(n instanceof de||n instanceof we,34018),n instanceof de)return n;if(n.filters.length===1)return pv(n.filters[0]);let e=n.filters.map(r=>pv(r)),t=we.create(e,n.op);return t=Eh(t),IA(t)?t:(z(t instanceof we,64498),z(gs(t),40251),z(t.filters.length>1,57927),t.filters.reduce((r,i)=>H_(r,i)))}function H_(n,e){let t;return z(n instanceof de||n instanceof we,38388),z(e instanceof de||e instanceof we,25473),t=n instanceof de?e instanceof de?function(i,o){return we.create([i,o],"and")}(n,e):OS(n,e):e instanceof de?OS(e,n):function(i,o){if(z(i.filters.length>0&&o.filters.length>0,48005),gs(i)&&gs(o))return $0(i,o.getFilters());let s=By(i)?i:o,a=By(i)?o:i,c=s.filters.map(l=>H_(l,a));return we.create(c,"or")}(n,e),Eh(t)}function OS(n,e){if(gs(e))return $0(e,n.getFilters());{let t=e.filters.map(r=>H_(n,r));return we.create(t,"or")}}function Eh(n){if(z(n instanceof de||n instanceof we,11850),n instanceof de)return n;let e=n.getFilters();if(e.length===1)return Eh(e[0]);if(B0(n))return n;let t=e.map(i=>Eh(i)),r=[];return t.forEach(i=>{i instanceof de?r.push(i):i instanceof we&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:we.create(r,n.op)}var gv=class{constructor(){this.yn=new Hu}addToCollectionParentIndex(e,t){return this.yn.add(t),S.resolve()}getCollectionParents(e,t){return S.resolve(this.yn.getEntries(t))}addFieldIndex(e,t){return S.resolve()}deleteFieldIndex(e,t){return S.resolve()}deleteAllFieldIndexes(e){return S.resolve()}createTargetIndexes(e,t){return S.resolve()}getDocumentsMatchingTarget(e,t){return S.resolve(null)}getIndexType(e,t){return S.resolve(0)}getFieldIndexes(e,t){return S.resolve([])}getNextCollectionGroupToUpdate(e){return S.resolve(null)}getMinOffset(e,t){return S.resolve(qt.min())}getMinOffsetFromCollectionGroup(e,t){return S.resolve(qt.min())}updateCollectionGroup(e,t,r){return S.resolve()}updateIndexEntries(e,t){return S.resolve()}},Hu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ie(pe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ie(pe.comparator)).toArray()}};var FS="IndexedDbIndexManager",jd=new Uint8Array(0),mv=class{constructor(e,t){this.databaseId=t,this.wn=new Hu,this.bn=new an(r=>Pi(r),(r,i)=>ec(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.wn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.wn.add(t)});let o={collectionId:r,parent:gt(i)};return LS(e).put(o)}return S.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[g0(t),""],!1,!0);return LS(e).J(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;r.push(In(s.parent))}return r})}addFieldIndex(e,t){let r=mu(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let o=r.add(i);if(t.indexState){let s=Qo(e);return o.next(a=>{s.put(MS(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let r=mu(e),i=Qo(e),o=Ko(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=mu(e),r=Ko(e),i=Qo(e);return t.X().next(()=>r.X()).next(()=>i.X())}createTargetIndexes(e,t){return S.forEach(this.Sn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let o=new wh(r).pn();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let r=Ko(e),i=!0,o=new Map;return S.forEach(this.Sn(t),s=>this.Dn(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=ie(),a=[];return S.forEach(o,(c,l)=>{k(FS,`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(Z=>`${Z.fieldPath}:${Z.kind}`).join(",")}`}(c)} to execute ${Pi(t)}`);let h=function(F,Z){let te=Ay(Z);if(te===void 0)return null;for(let ne of hh(F,te.fieldPath))switch(ne.op){case"array-contains-any":return ne.value.arrayValue.values||[];case"array-contains":return[ne.value]}return null}(l,c),p=function(F,Z){let te=new Map;for(let ne of Ei(Z))for(let E of hh(F,ne.fieldPath))switch(E.op){case"==":case"in":te.set(ne.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return te.set(ne.fieldPath.canonicalString(),E.value),Array.from(te.values())}return null}(l,c),m=function(F,Z){let te=[],ne=!0;for(let E of Ei(Z)){let v=E.kind===0?mS(F,E.fieldPath,F.startAt):yS(F,E.fieldPath,F.startAt);te.push(v.value),ne&&(ne=v.inclusive)}return new An(te,ne)}(l,c),y=function(F,Z){let te=[],ne=!0;for(let E of Ei(Z)){let v=E.kind===0?yS(F,E.fieldPath,F.endAt):mS(F,E.fieldPath,F.endAt);te.push(v.value),ne&&(ne=v.inclusive)}return new An(te,ne)}(l,c),T=this.vn(c,l,m),A=this.vn(c,l,y),N=this.Cn(c,l,p),V=this.Fn(c.indexId,h,T,m.inclusive,A,y.inclusive,N);return S.forEach(V,H=>r.Z(H,t.limit).next(F=>{F.forEach(Z=>{let te=B.fromSegments(Z.documentKey);s.has(te)||(s=s.add(te),a.push(te))})}))}).next(()=>a)}return S.resolve(null)})}Sn(e){let t=this.bn.get(e);return t||(e.filters.length===0?t=[e]:t=BV(we.create(e.filters,"and")).map(r=>Qy(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.bn.set(e,t),t)}Fn(e,t,r,i,o,s,a){let c=(t!=null?t.length:1)*Math.max(r.length,o.length),l=c/(t!=null?t.length:1),h=[];for(let p=0;p<c;++p){let m=t?this.Mn(t[p/l]):jd,y=this.xn(e,m,r[p%l],i),T=this.On(e,m,o[p%l],s),A=a.map(N=>this.xn(e,m,N,!0));h.push(...this.createRange(y,T,A))}return h}xn(e,t,r,i){let o=new bi(e,B.empty(),t,r);return i?o:o.In()}On(e,t,r,i){let o=new bi(e,B.empty(),t,r);return i?o.In():o}Dn(e,t){let r=new wh(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let a of o)r.Vn(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2,i=this.Sn(t);return S.forEach(i,o=>this.Dn(e,o).next(s=>{s?r!==0&&s.fields.length<function(c){let l=new Ie(Ue.comparator),h=!1;for(let p of c.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:l=l.add(m.field));for(let p of c.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(h?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}Nn(e,t){let r=new Ci;for(let i of Ei(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=r.Tn(i.kind);Qn.Wt.vt(o,s)}return r.cn()}Mn(e){let t=new Ci;return Qn.Wt.vt(e,t.Tn(0)),t.cn()}Bn(e,t){let r=new Ci;return Qn.Wt.vt(xi(this.databaseId,t),r.Tn(function(o){let s=Ei(o);return s.length===0?0:s[s.length-1].kind}(e))),r.cn()}Cn(e,t,r){if(r===null)return[];let i=[];i.push(new Ci);let o=0;for(let s of Ei(e)){let a=r[o++];for(let c of i)if(this.Ln(t,s.fieldPath)&&Ou(a))i=this.kn(i,s,a);else{let l=c.Tn(s.kind);Qn.Wt.vt(a,l)}}return this.qn(i)}vn(e,t,r){return this.Cn(e,t,r.position)}qn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].cn();return t}kn(e,t,r){let i=[...e],o=[];for(let s of r.arrayValue.values||[])for(let a of i){let c=new Ci;c.seed(a.cn()),Qn.Wt.vt(s,c.Tn(t.kind)),o.push(c)}return o}Ln(e,t){return!!e.filters.find(r=>r instanceof de&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=mu(e),i=Qo(e);return(t?r.J(ky,IDBKeyRange.bound(t,t)):r.J()).next(o=>{let s=[];return S.forEach(o,a=>i.get([a.indexId,this.uid]).next(c=>{s.push(function(h,p){let m=p?new Su(p.sequenceNumber,new qt(Fi(p.readTime),new B(In(p.documentKey)),p.largestBatchId)):Su.empty(),y=h.fields.map(([T,A])=>new rs(Ue.fromServerFormat(T),A));return new us(h.indexId,h.collectionGroup,y,m)}(a,c))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:J(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=mu(e),o=Qo(e);return this.Qn(e).next(s=>i.J(ky,IDBKeyRange.bound(t,t)).next(a=>S.forEach(a,c=>o.put(MS(c.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){let r=new Map;return S.forEach(t,(i,o)=>{let s=r.get(i.collectionGroup);return(s?S.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),S.forEach(a,c=>this.$n(e,i,c).next(l=>{let h=this.Un(o,c);return l.isEqual(h)?S.resolve():this.Kn(e,o,c,l,h)}))))})}Wn(e,t,r,i){return Ko(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Bn(r,t.key),documentKey:t.key.path.toArray()})}Gn(e,t,r,i){return Ko(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Bn(r,t.key),t.key.path.toArray()])}$n(e,t,r){let i=Ko(e),o=new Ie(Er);return i.te({index:C0,range:IDBKeyRange.only([r.indexId,this.uid,this.Bn(r,t)])},(s,a)=>{o=o.add(new bi(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>o)}Un(e,t){let r=new Ie(Er),i=this.Nn(t,e);if(i==null)return r;let o=Ay(t);if(o!=null){let s=e.data.field(o.fieldPath);if(Ou(s))for(let a of s.arrayValue.values||[])r=r.add(new bi(t.indexId,e.key,this.Mn(a),i))}else r=r.add(new bi(t.indexId,e.key,jd,i));return r}Kn(e,t,r,i,o){k(FS,"Updating index entries for document '%s'",t.key);let s=[];return function(c,l,h,p,m){let y=c.getIterator(),T=l.getIterator(),A=Go(y),N=Go(T);for(;A||N;){let V=!1,H=!1;if(A&&N){let F=h(A,N);F<0?H=!0:F>0&&(V=!0)}else A!=null?H=!0:V=!0;V?(p(N),N=Go(T)):H?(m(A),A=Go(y)):(A=Go(y),N=Go(T))}}(i,o,Er,a=>{s.push(this.Wn(e,t,r,a))},a=>{s.push(this.Gn(e,t,r,a))}),S.waitFor(s)}Qn(e){let t=1;return Qo(e).te({index:T0,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>Er(s,a)).filter((s,a,c)=>!a||Er(s,c[a-1])!==0);let i=[];i.push(e);for(let s of r){let a=Er(s,e),c=Er(s,t);if(a===0)i[0]=e.In();else if(a>0&&c<0)i.push(s),i.push(s.In());else if(c>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.zn(i[s],i[s+1]))return[];let a=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,jd,[]],c=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,jd,[]];o.push(IDBKeyRange.bound(a,c))}return o}zn(e,t){return Er(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(VS)}getMinOffset(e,t){return S.mapArray(this.Sn(t),r=>this.Dn(e,r).next(i=>i||$(44426))).next(VS)}};function LS(n){return Je(n,xu)}function Ko(n){return Je(n,sh)}function mu(n){return Je(n,N_)}function Qo(n){return Je(n,oh)}function VS(n){z(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;R_(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new qt(e.readTime,e.documentKey,t)}var jS={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},DA=41943040,Mt=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};function TA(n,e,t){let r=n.store(rn),i=n.store(cs),o=[],s=IDBKeyRange.only(t.batchId),a=0,c=r.te({range:s},(h,p,m)=>(a++,m.delete()));o.push(c.next(()=>{z(a===1,47070,{batchId:t.batchId})}));let l=[];for(let h of t.mutations){let p=E0(e,h.key.path,t.batchId);o.push(i.delete(p)),l.push(h.key)}return S.waitFor(o).next(()=>l)}function Ih(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw $(14731);e=n.noDocument}return JSON.stringify(e).length}Mt.DEFAULT_COLLECTION_PERCENTILE=10,Mt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mt.DEFAULT=new Mt(DA,Mt.DEFAULT_COLLECTION_PERCENTILE,Mt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mt.DISABLED=new Mt(-1,0,0);var Dh=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.jn={}}static bt(e,t,r,i){z(e.uid!=="",64387);let o=e.isAuthenticated()?e.uid:"";return new n(o,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ir(e).te({index:Si,range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let o=ts(e),s=Ir(e);return s.add({}).next(a=>{z(typeof a=="number",49019);let c=new Lu(a,t,r,i),l=function(y,T,A){let N=A.baseMutations.map(H=>$u(y.wt,H)),V=A.mutations.map(H=>$u(y.wt,H));return{userId:T,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:N,mutations:V}}(this.serializer,this.userId,c),h=[],p=new Ie((m,y)=>J(m.canonicalString(),y.canonicalString()));for(let m of i){let y=E0(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),h.push(s.put(l)),h.push(o.put(y,BL))}return p.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.jn[a]=c.keys()}),S.waitFor(h).next(()=>c)})}lookupMutationBatch(e,t){return Ir(e).get(t).next(r=>r?(z(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Ti(this.serializer,r)):null)}Hn(e,t){return this.jn[t]?S.resolve(this.jn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.jn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ir(e).te({index:Si,range:i},(s,a,c)=>{a.userId===this.userId&&(z(a.batchId>=r,47524,{Jn:r}),o=Ti(this.serializer,a)),c.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=Sr;return Ir(e).te({index:Si,range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,Sr],[this.userId,Number.POSITIVE_INFINITY]);return Ir(e).J(Si,t).next(r=>r.map(i=>Ti(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Hd(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return ts(e).te({range:i},(s,a,c)=>{let[l,h,p]=s,m=In(h);if(l===this.userId&&t.path.isEqual(m))return Ir(e).get(p).next(y=>{if(!y)throw $(61480,{Yn:s,batchId:p});z(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:p}),o.push(Ti(this.serializer,y))});c.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ie(J),i=[];return t.forEach(o=>{let s=Hd(this.userId,o.path),a=IDBKeyRange.lowerBound(s),c=ts(e).te({range:a},(l,h,p)=>{let[m,y,T]=l,A=In(y);m===this.userId&&o.path.isEqual(A)?r=r.add(T):p.done()});i.push(c)}),S.waitFor(i).next(()=>this.Zn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=Hd(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Ie(J);return ts(e).te({range:s},(c,l,h)=>{let[p,m,y]=c,T=In(m);p===this.userId&&r.isPrefixOf(T)?T.length===i&&(a=a.add(y)):h.done()}).next(()=>this.Zn(e,a))}Zn(e,t){let r=[],i=[];return t.forEach(o=>{i.push(Ir(e).get(o).next(s=>{if(s===null)throw $(35274,{batchId:o});z(s.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:s.userId,batchId:o}),r.push(Ti(this.serializer,s))}))}),S.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return TA(e.he,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Xn(t.batchId)}),S.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Xn(e){delete this.jn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return S.resolve();let r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return ts(e).te({range:r},(o,s,a)=>{if(o[0]===this.userId){let c=In(o[1]);i.push(c)}else a.done()}).next(()=>{z(i.length===0,56720,{er:i.map(o=>o.canonicalString())})})})}containsKey(e,t){return CA(e,this.userId,t)}tr(e){return bA(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Sr,lastStreamToken:""})}};function CA(n,e,t){let r=Hd(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return ts(n).te({range:o,ee:!0},(a,c,l)=>{let[h,p,m]=a;h===e&&p===i&&(s=!0),l.done()}).next(()=>s)}function Ir(n){return Je(n,rn)}function ts(n){return Je(n,cs)}function bA(n){return Je(n,Ru)}var ws=class n{constructor(e){this.nr=e}next(){return this.nr+=2,this.nr}static rr(){return new n(0)}static ir(){return new n(-1)}};var yv=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.sr(e).next(t=>{let r=new ws(t.highestTargetId);return t.highestTargetId=r.next(),this._r(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.sr(e).next(t=>W.fromTimestamp(new ke(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.sr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.sr(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this._r(e,i)))}addTargetData(e,t){return this.ar(e,t).next(()=>this.sr(e).next(r=>(r.targetCount+=1,this.ur(t,r),this._r(e,r))))}updateTargetData(e,t){return this.ar(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Yo(e).delete(t.targetId)).next(()=>this.sr(e)).next(r=>(z(r.targetCount>0,8065),r.targetCount-=1,this._r(e,r)))}removeTargets(e,t,r){let i=0,o=[];return Yo(e).te((s,a)=>{let c=wu(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,o.push(this.removeTargetData(e,c)))}).next(()=>S.waitFor(o)).next(()=>i)}forEachTarget(e,t){return Yo(e).te((r,i)=>{let o=wu(i);t(o)})}sr(e){return BS(e).get(ih).next(t=>(z(t!==null,2888),t))}_r(e,t){return BS(e).put(ih,t)}ar(e,t){return Yo(e).put(wA(this.serializer,t))}ur(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.sr(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Pi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Yo(e).te({range:i,index:D0},(s,a,c)=>{let l=wu(a);ec(t,l.target)&&(o=l,c.done())}).next(()=>o)}addMatchingKeys(e,t,r){let i=[],o=Tr(e);return t.forEach(s=>{let a=gt(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),S.waitFor(i)}removeMatchingKeys(e,t,r){let i=Tr(e);return S.forEach(t,o=>{let s=gt(o.path);return S.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){let r=Tr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Tr(e),o=ie();return i.te({range:r,ee:!0},(s,a,c)=>{let l=In(s[1]),h=new B(l);o=o.add(h)}).next(()=>o)}containsKey(e,t){let r=gt(t.path),i=IDBKeyRange.bound([r],[g0(r)],!1,!0),o=0;return Tr(e).te({index:x_,ee:!0,range:i},([s,a],c,l)=>{s!==0&&(o++,l.done())}).next(()=>o>0)}Rt(e,t){return Yo(e).get(t).next(r=>r?wu(r):null)}};function Yo(n){return Je(n,ls)}function BS(n){return Je(n,Mi)}function Tr(n){return Je(n,ds)}var US="LruGarbageCollector",UV=1048576;function $S([n,e],[t,r]){let i=J(n,t);return i===0?J(e,r):i}var vv=class{constructor(e){this.cr=e,this.buffer=new Ie($S),this.lr=0}hr(){return++this.lr}Pr(e){let t=[e,this.hr()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();$S(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Th=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Tr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ir(6e4)}stop(){this.Tr&&(this.Tr.cancel(),this.Tr=null)}get started(){return this.Tr!==null}Ir(e){k(US,`Garbage collection scheduled in ${e}ms`),this.Tr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>x(this,null,function*(){this.Tr=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ur(t)?k(US,"Ignoring IndexedDB error during garbage collection: ",t):yield Br(t)}yield this.Ir(3e5)}))}},_v=class{constructor(e,t){this.Er=e,this.params=t}calculateTargetCount(e,t){return this.Er.dr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return S.resolve(Lt.le);let r=new vv(t);return this.Er.forEachTarget(e,i=>r.Pr(i.sequenceNumber)).next(()=>this.Er.Ar(e,i=>r.Pr(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Er.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Er.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),S.resolve(jS)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jS):this.Rr(e,t))}getCacheSize(e){return this.Er.getCacheSize(e)}Rr(e,t){let r,i,o,s,a,c,l,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(o=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),Zo()<=dn.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(c-a)+`ms
	Removed ${p} documents in `+(l-c)+`ms
Total Duration: ${l-h}ms`),S.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}};function SA(n,e){return new _v(n,e)}var wv=class{constructor(e,t){this.db=e,this.garbageCollector=SA(this,t)}dr(e){let t=this.Vr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Vr(e){let t=0;return this.Ar(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Ar(e,t){return this.mr(e,(r,i)=>t(i))}addReference(e,t,r){return Bd(e,r)}removeReference(e,t,r){return Bd(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Bd(e,t)}gr(e,t){return function(i,o){let s=!1;return bA(i).ne(a=>CA(i,a,o).next(c=>(c&&(s=!0),S.resolve(!c)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.mr(e,(s,a)=>{if(a<=t){let c=this.gr(e,s).next(l=>{if(!l)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,W.min()),Tr(e).delete(function(p){return[0,gt(p.path)]}(s))))});i.push(c)}}).next(()=>S.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Bd(e,t)}mr(e,t){let r=Tr(e),i,o=Lt.le;return r.te({index:x_},([s,a],{path:c,sequenceNumber:l})=>{s===0?(o!==Lt.le&&t(new B(In(i)),o),o=l,i=c):o=Lt.le}).next(()=>{o!==Lt.le&&t(new B(In(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Bd(n,e){return Tr(n).put(function(r,i){return{targetId:0,path:gt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var Ch=class{constructor(){this.changes=new an(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,We.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?S.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ev=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return wi(e).put(r)}removeEntry(e,t,r){return wi(e).delete(function(o,s){let a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],vh(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.pr(e,r)))}getEntry(e,t){let r=We.newInvalidDocument(t);return wi(e).te({index:qd,range:IDBKeyRange.only(yu(t))},(i,o)=>{r=this.yr(t,o)}).next(()=>r)}wr(e,t){let r={size:0,document:We.newInvalidDocument(t)};return wi(e).te({index:qd,range:IDBKeyRange.only(yu(t))},(i,o)=>{r={document:this.yr(t,o),size:Ih(o)}}).next(()=>r)}getEntries(e,t){let r=xt();return this.br(e,t,(i,o)=>{let s=this.yr(i,o);r=r.insert(i,s)}).next(()=>r)}Sr(e,t){let r=xt(),i=new Ae(B.comparator);return this.br(e,t,(o,s)=>{let a=this.yr(o,s);r=r.insert(o,a),i=i.insert(o,Ih(s))}).next(()=>({documents:r,Dr:i}))}br(e,t,r){if(t.isEmpty())return S.resolve();let i=new Ie(zS);t.forEach(c=>i=i.add(c));let o=IDBKeyRange.bound(yu(i.first()),yu(i.last())),s=i.getIterator(),a=s.getNext();return wi(e).te({index:qd,range:o},(c,l,h)=>{let p=B.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&zS(a,p)<0;)r(a,null),a=s.getNext();a&&a.isEqual(p)&&(r(a,l),a=s.hasNext()?s.getNext():null),a?h.H(yu(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),vh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return wi(e).J(IDBKeyRange.bound(a,c,!0)).next(l=>{o?.incrementDocumentReadCount(l.length);let h=xt();for(let p of l){let m=this.yr(B.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(nc(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,t,r,i){let o=xt(),s=qS(t,r),a=qS(t,qt.max());return wi(e).te({index:I0,range:IDBKeyRange.bound(s,a,!0)},(c,l,h)=>{let p=this.yr(B.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);o=o.insert(p.key,p),o.size===i&&h.done()}).next(()=>o)}newChangeBuffer(e){return new Iv(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return HS(e).get(Py).next(t=>(z(!!t,20021),t))}pr(e,t){return HS(e).put(Py,t)}yr(e,t){if(t){let r=VV(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(W.min())))return r}return We.newInvalidDocument(e)}};function AA(n){return new Ev(n)}var Iv=class extends Ch{constructor(e,t){super(),this.vr=e,this.trackRemovals=t,this.Cr=new an(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Ie((o,s)=>J(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let a=this.Cr.get(o);if(t.push(this.vr.removeEntry(e,o,a.readTime)),s.isValidDocument()){let c=AS(this.vr.serializer,s);i=i.add(o.path.popLast());let l=Ih(c);r+=l-a.size,t.push(this.vr.addEntry(e,o,c))}else if(r-=a.size,this.trackRemovals){let c=AS(this.vr.serializer,s.convertToNoDocument(W.min()));t.push(this.vr.addEntry(e,o,c))}}),i.forEach(o=>{t.push(this.vr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.vr.updateMetadata(e,r)),S.waitFor(t)}getFromCache(e,t){return this.vr.wr(e,t).next(r=>(this.Cr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.vr.Sr(e,t).next(({documents:r,Dr:i})=>(i.forEach((o,s)=>{this.Cr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}};function HS(n){return Je(n,Mu)}function wi(n){return Je(n,rh)}function yu(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function qS(n,e){let t=e.documentKey.path.toArray();return[n,vh(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function zS(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=J(t[o],r[o]),i)return i;return i=J(t.length,r.length),i||(i=J(t[t.length-2],r[r.length-2]),i||J(t[t.length-1],r[r.length-1]))}var Dv=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var bh=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Tu(r.mutation,i,Vt.empty(),ke.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ie()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ie()){let i=Dn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=_u();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=Dn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ie()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=xt(),s=Du(),a=function(){return Du()}();return t.forEach((c,l)=>{let h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof un)?o=o.insert(l.key,l):h!==void 0?(s.set(l.key,h.mutation.getFieldMask()),Tu(h.mutation,l,h.mutation.getFieldMask(),ke.now())):s.set(l.key,Vt.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((l,h)=>s.set(l,h)),t.forEach((l,h)=>{var p;return a.set(l,new Dv(h,(p=s.get(l))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Du(),i=new Ae((s,a)=>s-a),o=ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let h=r.get(c)||Vt.empty();h=a.applyToLocalView(l,h),r.set(c,h);let p=(i.get(a.batchId)||ie()).add(c);i=i.insert(a.batchId,p)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,h=c.value,p=Z0();h.forEach(m=>{if(!o.has(m)){let y=iA(t.get(m),r.get(m));y!==null&&p.set(m,y),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,p))}return S.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return B.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):V_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):S.resolve(Dn()),a=as,c=o;return s.next(l=>S.forEach(l,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),o.get(h)?S.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,c,l,ie())).next(h=>({batchId:a,changes:Y0(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=_u();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=_u();return this.indexManager.getCollectionParents(e,o).next(a=>S.forEach(a,c=>{let l=function(p,m){return new sn(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(h=>{h.forEach((p,m)=>{s=s.insert(p,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((c,l)=>{let h=l.getKey();s.get(h)===null&&(s=s.insert(h,We.newInvalidDocument(h)))});let a=_u();return s.forEach((c,l)=>{let h=o.get(c);h!==void 0&&Tu(h.mutation,l,Vt.empty(),ke.now()),nc(t,l)&&(a=a.insert(c,l))}),a})}};var Tv=class{constructor(e){this.serializer=e,this.Fr=new Map,this.Mr=new Map}getBundleMetadata(e,t){return S.resolve(this.Fr.get(t))}saveBundleMetadata(e,t){return this.Fr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:$e(i.createTime)}}(t)),S.resolve()}getNamedQuery(e,t){return S.resolve(this.Mr.get(t))}saveNamedQuery(e,t){return this.Mr.set(t.name,function(i){return{name:i.name,query:$_(i.bundledQuery),readTime:$e(i.readTime)}}(t)),S.resolve()}};var Cv=class{constructor(){this.overlays=new Ae(B.comparator),this.Or=new Map}getOverlay(e,t){return S.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Dn();return S.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.St(e,t,o)}),S.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Or.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Or.delete(r)),S.resolve()}getOverlaysForCollection(e,t,r){let i=Dn(),o=t.length+1,s=new B(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&c.largestBatchId>r&&i.set(c.getKey(),c)}return S.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Ae((l,h)=>l-h),s=this.overlays.getIterator();for(;s.hasNext();){let l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=o.get(l.largestBatchId);h===null&&(h=Dn(),o=o.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let a=Dn(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>a.set(l,h)),!(a.size()>=i)););return S.resolve(a)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.Or.get(i.largestBatchId).delete(r.key);this.Or.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new Vu(t,r));let o=this.Or.get(t);o===void 0&&(o=ie(),this.Or.set(t,o)),this.Or.set(t,o.add(r.key))}};var bv=class{constructor(){this.sessionToken=He.EMPTY_BYTE_STRING}getSessionToken(e){return S.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,S.resolve()}};var qu=class{constructor(){this.Nr=new Ie(ze.Br),this.Lr=new Ie(ze.kr)}isEmpty(){return this.Nr.isEmpty()}addReference(e,t){let r=new ze(e,t);this.Nr=this.Nr.add(r),this.Lr=this.Lr.add(r)}qr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Qr(new ze(e,t))}$r(e,t){e.forEach(r=>this.removeReference(r,t))}Ur(e){let t=new B(new pe([])),r=new ze(t,e),i=new ze(t,e+1),o=[];return this.Lr.forEachInRange([r,i],s=>{this.Qr(s),o.push(s.key)}),o}Kr(){this.Nr.forEach(e=>this.Qr(e))}Qr(e){this.Nr=this.Nr.delete(e),this.Lr=this.Lr.delete(e)}Wr(e){let t=new B(new pe([])),r=new ze(t,e),i=new ze(t,e+1),o=ie();return this.Lr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new ze(e,0),r=this.Nr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ze=class{constructor(e,t){this.key=e,this.Gr=t}static Br(e,t){return B.comparator(e.key,t.key)||J(e.Gr,t.Gr)}static kr(e,t){return J(e.Gr,t.Gr)||B.comparator(e.key,t.key)}};var Sv=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Jn=1,this.zr=new Ie(ze.Br)}checkEmpty(e){return S.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Jn;this.Jn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Lu(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.zr=this.zr.add(new ze(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return S.resolve(s)}lookupMutationBatch(e,t){return S.resolve(this.jr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Hr(r),o=i<0?0:i;return S.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return S.resolve(this.mutationQueue.length===0?Sr:this.Jn-1)}getAllMutationBatches(e){return S.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ze(t,0),i=new ze(t,Number.POSITIVE_INFINITY),o=[];return this.zr.forEachInRange([r,i],s=>{let a=this.jr(s.Gr);o.push(a)}),S.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ie(J);return t.forEach(i=>{let o=new ze(i,0),s=new ze(i,Number.POSITIVE_INFINITY);this.zr.forEachInRange([o,s],a=>{r=r.add(a.Gr)})}),S.resolve(this.Jr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;B.isDocumentKey(o)||(o=o.child(""));let s=new ze(new B(o),0),a=new Ie(J);return this.zr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.Gr)),!0)},s),S.resolve(this.Jr(a))}Jr(e){let t=[];return e.forEach(r=>{let i=this.jr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){z(this.Yr(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.zr;return S.forEach(t.mutations,i=>{let o=new ze(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.zr=r})}Xn(e){}containsKey(e,t){let r=new ze(t,0),i=this.zr.firstAfterOrEqual(r);return S.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,S.resolve()}Yr(e,t){return this.Hr(e)}Hr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}jr(e){let t=this.Hr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Av=class{constructor(e){this.Zr=e,this.docs=function(){return new Ae(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Zr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return S.resolve(r?r.document.mutableCopy():We.newInvalidDocument(t))}getEntries(e,t){let r=xt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():We.newInvalidDocument(i))}),S.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=xt(),s=t.path,a=new B(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:h}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||R_(y0(h),r)<=0||(i.has(h.key)||nc(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return S.resolve(o)}getAllFromCollectionGroup(e,t,r,i){$(9500)}Xr(e,t){return S.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Rv(this)}getSize(e){return S.resolve(this.size)}},Rv=class extends Ch{constructor(e){super(),this.vr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.vr.addEntry(e,i)):this.vr.removeEntry(r)}),S.waitFor(t)}getFromCache(e,t){return this.vr.getEntry(e,t)}getAllFromCache(e,t){return this.vr.getEntries(e,t)}};var Mv=class{constructor(e){this.persistence=e,this.ei=new an(t=>Pi(t),ec),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.ti=0,this.ni=new qu,this.targetCount=0,this.ri=ws.rr()}forEachTarget(e,t){return this.ei.forEach((r,i)=>t(i)),S.resolve()}getLastRemoteSnapshotVersion(e){return S.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return S.resolve(this.ti)}allocateTargetId(e){return this.highestTargetId=this.ri.next(),S.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ti&&(this.ti=t),S.resolve()}ar(e){this.ei.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ri=new ws(t),this.highestTargetId=t),e.sequenceNumber>this.ti&&(this.ti=e.sequenceNumber)}addTargetData(e,t){return this.ar(t),this.targetCount+=1,S.resolve()}updateTargetData(e,t){return this.ar(t),S.resolve()}removeTargetData(e,t){return this.ei.delete(t.target),this.ni.Ur(t.targetId),this.targetCount-=1,S.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.ei.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ei.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),S.waitFor(o).next(()=>i)}getTargetCount(e){return S.resolve(this.targetCount)}getTargetData(e,t){let r=this.ei.get(t)||null;return S.resolve(r)}addMatchingKeys(e,t,r){return this.ni.qr(t,r),S.resolve()}removeMatchingKeys(e,t,r){this.ni.$r(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),S.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.ni.Ur(t),S.resolve()}getMatchingKeysForTargetId(e,t){let r=this.ni.Wr(t);return S.resolve(r)}containsKey(e,t){return S.resolve(this.ni.containsKey(t))}};var zu=class{constructor(e,t){this.ii={},this.overlays={},this.si=new Lt(0),this.oi=!1,this.oi=!0,this._i=new bv,this.referenceDelegate=e(this),this.ai=new Mv(this),this.indexManager=new gv,this.remoteDocumentCache=function(i){return new Av(i)}(r=>this.referenceDelegate.ui(r)),this.serializer=new yh(t),this.ci=new Tv(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.oi=!1,Promise.resolve()}get started(){return this.oi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Cv,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ii[e.toKey()];return r||(r=new Sv(t,this.referenceDelegate),this.ii[e.toKey()]=r),r}getGlobalsCache(){return this._i}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.ci}runTransaction(e,t,r){k("MemoryPersistence","Starting transaction:",e);let i=new xv(this.si.next());return this.referenceDelegate.li(),r(i).next(o=>this.referenceDelegate.hi(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Pi(e,t){return S.or(Object.values(this.ii).map(r=>()=>r.containsKey(e,t)))}},xv=class extends eh{constructor(e){super(),this.currentSequenceNumber=e}},Sh=class n{constructor(e){this.persistence=e,this.Ti=new qu,this.Ii=null}static Ei(e){return new n(e)}get di(){if(this.Ii)return this.Ii;throw $(60996)}addReference(e,t,r){return this.Ti.addReference(r,t),this.di.delete(r.toString()),S.resolve()}removeReference(e,t,r){return this.Ti.removeReference(r,t),this.di.add(r.toString()),S.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),S.resolve()}removeTarget(e,t){this.Ti.Ur(t.targetId).forEach(i=>this.di.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.di.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}li(){this.Ii=new Set}hi(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return S.forEach(this.di,r=>{let i=B.fromPath(r);return this.Ai(e,i).next(o=>{o||t.removeEntry(i,W.min())})}).next(()=>(this.Ii=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ai(e,t).next(r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())})}ui(e){return 0}Ai(e,t){return S.or([()=>S.resolve(this.Ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Pi(e,t)])}},Ah=class n{constructor(e,t){this.persistence=e,this.Ri=new an(r=>gt(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=SA(this,t)}static Ei(e,t){return new n(e,t)}li(){}hi(e){return S.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.Vr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Vr(e){let t=0;return this.Ar(e,r=>{t++}).next(()=>t)}Ar(e,t){return S.forEach(this.Ri,(r,i)=>this.gr(e,r,i).next(o=>o?S.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.Xr(e,s=>this.gr(e,s,t).next(a=>{a||(r++,o.removeEntry(s,W.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.Ri.set(t,e.currentSequenceNumber),S.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.Ri.set(r,e.currentSequenceNumber),S.resolve()}removeReference(e,t,r){return this.Ri.set(r,e.currentSequenceNumber),S.resolve()}updateLimboDocument(e,t){return this.Ri.set(t,e.currentSequenceNumber),S.resolve()}ui(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Gd(e.data.value)),t}gr(e,t,r){return S.or([()=>this.persistence.Pi(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.Ri.get(t);return S.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Nv=class{constructor(e){this.serializer=e}q(e,t,r,i){let o=new th("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore(Xu)}(e),function(c){c.createObjectStore(Ru,{keyPath:jL}),c.createObjectStore(rn,{keyPath:oS,autoIncrement:!0}).createIndex(Si,sS,{unique:!0}),c.createObjectStore(cs)}(e),GS(e),function(c){c.createObjectStore(Ii)}(e));let s=S.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore(ds),c.deleteObjectStore(ls),c.deleteObjectStore(Mi)}(e),GS(e)),s=s.next(()=>function(c){let l=c.store(Mi),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:W.min().toTimestamp(),targetCount:0};return l.put(ih,h)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(c,l){return l.store(rn).J().next(p=>{c.deleteObjectStore(rn),c.createObjectStore(rn,{keyPath:oS,autoIncrement:!0}).createIndex(Si,sS,{unique:!0});let m=l.store(rn),y=p.map(T=>m.put(T));return S.waitFor(y)})}(e,o))),s=s.next(()=>{(function(c){c.createObjectStore(hs,{keyPath:KL})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.Vi(o))),r<6&&i>=6&&(s=s.next(()=>(function(c){c.createObjectStore(Mu)}(e),this.mi(o)))),r<7&&i>=7&&(s=s.next(()=>this.fi(o))),r<8&&i>=8&&(s=s.next(()=>this.gi(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.pi(o))),r<11&&i>=11&&(s=s.next(()=>{(function(c){c.createObjectStore(ef,{keyPath:QL})})(e),function(c){c.createObjectStore(tf,{keyPath:YL})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(c){let l=c.createObjectStore(nf,{keyPath:rV});l.createIndex(Oy,iV,{unique:!1}),l.createIndex(b0,oV,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(c){let l=c.createObjectStore(rh,{keyPath:UL});l.createIndex(qd,$L),l.createIndex(I0,HL)}(e)).next(()=>this.yi(e,o)).next(()=>e.deleteObjectStore(Ii))),r<14&&i>=14&&(s=s.next(()=>this.wi(e,o))),r<15&&i>=15&&(s=s.next(()=>function(c){c.createObjectStore(N_,{keyPath:ZL,autoIncrement:!0}).createIndex(ky,JL,{unique:!1}),c.createObjectStore(oh,{keyPath:XL}).createIndex(T0,eV,{unique:!1}),c.createObjectStore(sh,{keyPath:tV}).createIndex(C0,nV,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore(oh).clear()}).next(()=>{t.objectStore(sh).clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(c){c.createObjectStore(P_,{keyPath:sV})})(e)})),s}mi(e){let t=0;return e.store(Ii).te((r,i)=>{t+=Ih(i)}).next(()=>{let r={byteSize:t};return e.store(Mu).put(Py,r)})}Vi(e){let t=e.store(Ru),r=e.store(rn);return t.J().next(i=>S.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,Sr],[o.userId,o.lastAcknowledgedBatchId]);return r.J(Si,s).next(a=>S.forEach(a,c=>{z(c.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});let l=Ti(this.serializer,c);return TA(e,o.userId,l).next(()=>{})}))}))}fi(e){let t=e.store(ds),r=e.store(Ii);return e.store(Mi).get(ih).next(i=>{let o=[];return r.te((s,a)=>{let c=new pe(s),l=function(p){return[0,gt(p)]}(c);o.push(t.get(l).next(h=>h?S.resolve():(p=>t.put({targetId:0,path:gt(p),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>S.waitFor(o))})}gi(e,t){e.createObjectStore(xu,{keyPath:WL});let r=t.store(xu),i=new Hu,o=s=>{if(i.add(s)){let a=s.lastSegment(),c=s.popLast();return r.put({collectionId:a,parent:gt(c)})}};return t.store(Ii).te({ee:!0},(s,a)=>{let c=new pe(s);return o(c.popLast())}).next(()=>t.store(cs).te({ee:!0},([s,a,c],l)=>{let h=In(a);return o(h.popLast())}))}pi(e){let t=e.store(ls);return t.te((r,i)=>{let o=wu(i),s=wA(this.serializer,o);return t.put(s)})}yi(e,t){let r=t.store(Ii),i=[];return r.te((o,s)=>{let a=t.store(rh),c=function(p){return p.document?new B(pe.fromString(p.document.name).popFirst(5)):p.noDocument?B.fromSegments(p.noDocument.path):p.unknownDocument?B.fromSegments(p.unknownDocument.path):$(36783)}(s).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(l))}).next(()=>S.waitFor(i))}wi(e,t){let r=t.store(rn),i=AA(this.serializer),o=new zu(Sh.Ei,this.serializer.wt);return r.J().next(s=>{let a=new Map;return s.forEach(c=>{var l;let h=(l=a.get(c.userId))!==null&&l!==void 0?l:ie();Ti(this.serializer,c).keys().forEach(p=>h=h.add(p)),a.set(c.userId,h)}),S.forEach(a,(c,l)=>{let h=new Ge(l),p=_h.bt(this.serializer,h),m=o.getIndexManager(h),y=Dh.bt(h,this.serializer,m,o.referenceDelegate);return new bh(i,y,p,m).recalculateAndSaveOverlaysForDocumentKeys(new Nu(t,Lt.le),c).next()})})}};function GS(n){n.createObjectStore(ds,{keyPath:zL}).createIndex(x_,GL,{unique:!0}),n.createObjectStore(ls,{keyPath:"targetId"}).createIndex(D0,qL,{unique:!0}),n.createObjectStore(Mi)}var Dr="IndexedDbPersistence",gy=18e5,my=5e3,yy="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",RA="main",Pv=class n{constructor(e,t,r,i,o,s,a,c,l,h,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.bi=o,this.window=s,this.document=a,this.Si=l,this.Di=h,this.Ci=p,this.si=null,this.oi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fi=null,this.inForeground=!1,this.Mi=null,this.xi=null,this.Oi=Number.NEGATIVE_INFINITY,this.Ni=m=>Promise.resolve(),!n.C())throw new P(R.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new wv(this,i),this.Bi=t+RA,this.serializer=new yh(c),this.Li=new Mr(this.Bi,this.Ci,new Nv(this.serializer)),this._i=new uv,this.ai=new yv(this.referenceDelegate,this.serializer),this.remoteDocumentCache=AA(this.serializer),this.ci=new av,this.window&&this.window.localStorage?this.ki=this.window.localStorage:(this.ki=null,h===!1&&Be(Dr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.qi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new P(R.FAILED_PRECONDITION,yy);return this.Qi(),this.$i(),this.Ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.ai.getHighestSequenceNumber(e))}).then(e=>{this.si=new Lt(e,this.Si)}).then(()=>{this.oi=!0}).catch(e=>(this.Li&&this.Li.close(),Promise.reject(e)))}Ki(e){return this.Ni=t=>x(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Li.U(t=>x(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.bi.enqueueAndForget(()=>x(this,null,function*(){this.started&&(yield this.qi())})))}qi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ud(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Wi(e).next(t=>{t||(this.isPrimary=!1,this.bi.enqueueRetryable(()=>this.Ni(!1)))})}).next(()=>this.Gi(e)).next(t=>this.isPrimary&&!t?this.zi(e).next(()=>!1):!!t&&this.ji(e).next(()=>!0))).catch(e=>{if(Ur(e))return k(Dr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return k(Dr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.bi.enqueueRetryable(()=>this.Ni(e)),this.isPrimary=e})}Wi(e){return vu(e).get(zo).next(t=>S.resolve(this.Hi(t)))}Ji(e){return Ud(e).delete(this.clientId)}Yi(){return x(this,null,function*(){if(this.isPrimary&&!this.Zi(this.Oi,gy)){this.Oi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Je(t,hs);return r.J().next(i=>{let o=this.Xi(i,gy),s=i.filter(a=>o.indexOf(a)===-1);return S.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.ki)for(let t of e)this.ki.removeItem(this.es(t.clientId))}})}Ui(){this.xi=this.bi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.qi().then(()=>this.Yi()).then(()=>this.Ui()))}Hi(e){return!!e&&e.ownerId===this.clientId}Gi(e){return this.Di?S.resolve(!0):vu(e).get(zo).next(t=>{if(t!==null&&this.Zi(t.leaseTimestampMs,my)&&!this.ts(t.ownerId)){if(this.Hi(t)&&this.networkEnabled)return!0;if(!this.Hi(t)){if(!t.allowTabSynchronization)throw new P(R.FAILED_PRECONDITION,yy);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ud(e).J().next(r=>this.Xi(r,my).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&k(Dr,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return x(this,null,function*(){this.oi=!1,this.ns(),this.xi&&(this.xi.cancel(),this.xi=null),this.rs(),this.ss(),yield this.Li.runTransaction("shutdown","readwrite",[Xu,hs],e=>{let t=new Nu(e,Lt.le);return this.zi(t).next(()=>this.Ji(t))}),this.Li.close(),this._s()})}Xi(e,t){return e.filter(r=>this.Zi(r.updateTimeMs,t)&&!this.ts(r.clientId))}us(){return this.runTransaction("getActiveClients","readonly",e=>Ud(e).J().next(t=>this.Xi(t,gy).map(r=>r.clientId)))}get started(){return this.oi}getGlobalsCache(){return this._i}getMutationQueue(e,t){return Dh.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new mv(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return _h.bt(this.serializer,e)}getBundleCache(){return this.ci}runTransaction(e,t,r){k(Dr,"Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=function(c){return c===17?cV:c===16?uV:c===15?k_:c===14?R0:c===13?A0:c===12?aV:c===11?S0:void $(60245)}(this.Ci),s;return this.Li.runTransaction(e,i,o,a=>(s=new Nu(a,this.si?this.si.next():Lt.le),t==="readwrite-primary"?this.Wi(s).next(c=>!!c||this.Gi(s)).next(c=>{if(!c)throw Be(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.bi.enqueueRetryable(()=>this.Ni(!1)),new P(R.FAILED_PRECONDITION,v0);return r(s)}).next(c=>this.ji(s).next(()=>c)):this.cs(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}cs(e){return vu(e).get(zo).next(t=>{if(t!==null&&this.Zi(t.leaseTimestampMs,my)&&!this.ts(t.ownerId)&&!this.Hi(t)&&!(this.Di||this.allowTabSynchronization&&t.allowTabSynchronization))throw new P(R.FAILED_PRECONDITION,yy)})}ji(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return vu(e).put(zo,t)}static C(){return Mr.C()}zi(e){let t=vu(e);return t.get(zo).next(r=>this.Hi(r)?(k(Dr,"Releasing primary lease."),t.delete(zo)):S.resolve())}Zi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(Be(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Qi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Mi=()=>{this.bi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.qi()))},this.document.addEventListener("visibilitychange",this.Mi),this.inForeground=this.document.visibilityState==="visible")}rs(){this.Mi&&(this.document.removeEventListener("visibilitychange",this.Mi),this.Mi=null)}$i(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Fi=()=>{this.ns();let t=/(?:Version|Mobile)\/1[456]/;Zf()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.bi.enterRestrictedMode(!0),this.bi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Fi))}ss(){this.Fi&&(this.window.removeEventListener("pagehide",this.Fi),this.Fi=null)}ts(e){var t;try{let r=((t=this.ki)===null||t===void 0?void 0:t.getItem(this.es(e)))!==null;return k(Dr,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Be(Dr,"Failed to get zombied client id.",r),!1}}ns(){if(this.ki)try{this.ki.setItem(this.es(this.clientId),String(Date.now()))}catch(e){Be("Failed to set zombie client id.",e)}}_s(){if(this.ki)try{this.ki.removeItem(this.es(this.clientId))}catch{}}es(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function vu(n){return Je(n,Xu)}function Ud(n){return Je(n,hs)}function q_(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var kv=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ls=r,this.hs=i}static Ps(e,t){let r=ie(),i=ie();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var Ov=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Rh=class{constructor(){this.Ts=!1,this.Is=!1,this.Es=100,this.ds=function(){return Zf()?8:_0(ia())>0?6:4}()}initialize(e,t){this.As=e,this.indexManager=t,this.Ts=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Rs(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Vs(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new Ov;return this.fs(e,t,s).next(a=>{if(o.result=a,this.Is)return this.gs(e,t,s,a.size)})}).next(()=>o.result)}gs(e,t,r,i){return r.documentReadCount<this.Es?(Zo()<=dn.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",Jo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Es,"documents"),S.resolve()):(Zo()<=dn.DEBUG&&k("QueryEngine","Query:",Jo(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(Zo()<=dn.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",Jo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Dt(t))):S.resolve())}Rs(e,t){if(vS(t))return S.resolve(null);let r=Dt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=fh(t,null,"F"),r=Dt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=ie(...o);return this.As.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.ps(t,a);return this.ys(t,l,s,c.readTime)?this.Rs(e,fh(t,null,"F")):this.ws(e,l,t,c)}))})))}Vs(e,t,r,i){return vS(t)||i.isEqual(W.min())?S.resolve(null):this.As.getDocuments(e,r).next(o=>{let s=this.ps(t,o);return this.ys(t,s,r,i)?S.resolve(null):(Zo()<=dn.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Jo(t)),this.ws(e,s,t,m0(i,as)).next(a=>a))})}ps(e,t){let r=new Ie(K0(e));return t.forEach((i,o)=>{nc(e,o)&&(r=r.add(o))}),r}ys(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}fs(e,t,r){return Zo()<=dn.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",Jo(t)),this.As.getDocumentsMatchingQuery(e,t,qt.min(),r)}ws(e,t,r,i){return this.As.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var z_="LocalStore",$V=3e8,Fv=class{constructor(e,t,r,i){this.persistence=e,this.bs=t,this.serializer=i,this.Ss=new Ae(J),this.Ds=new an(o=>Pi(o),ec),this.vs=new Map,this.Cs=e.getRemoteDocumentCache(),this.ai=e.getTargetCache(),this.ci=e.getBundleCache(),this.Fs(r)}Fs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bh(this.Cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Cs.setIndexManager(this.indexManager),this.bs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ss))}};function MA(n,e,t,r){return new Fv(n,e,t,r)}function xA(n,e){return x(this,null,function*(){let t=j(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Fs(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],c=ie();for(let l of i){s.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}for(let l of o){a.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}return t.localDocuments.getDocuments(r,c).next(l=>({Ms:l,removedBatchIds:s,addedBatchIds:a}))})})})}function HV(n,e){let t=j(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.Cs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,h){let p=l.batch,m=p.keys(),y=S.resolve();return m.forEach(T=>{y=y.next(()=>h.getEntry(c,T)).next(A=>{let N=l.docVersions.get(T);z(N!==null,48541),A.version.compareTo(N)<0&&(p.applyToRemoteDocument(A,l),A.isValidDocument()&&(A.setReadTime(l.commitVersion),h.addEntry(A)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(c,p))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ie();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function NA(n){let e=j(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.ai.getLastRemoteSnapshotVersion(t))}function qV(n,e){let t=j(n),r=e.snapshotVersion,i=t.Ss;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.Cs.newChangeBuffer({trackRemovals:!0});i=t.Ss;let a=[];e.targetChanges.forEach((h,p)=>{let m=i.get(p);if(!m)return;a.push(t.ai.removeMatchingKeys(o,h.removedDocuments,p).next(()=>t.ai.addMatchingKeys(o,h.addedDocuments,p)));let y=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?y=y.withResumeToken(He.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(p,y),function(A,N,V){return A.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=$V?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0}(m,y,h)&&a.push(t.ai.updateTargetData(o,y))});let c=xt(),l=ie();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))}),a.push(PA(o,s,e.documentUpdates).next(h=>{c=h.xs,l=h.Os})),!r.isEqual(W.min())){let h=t.ai.getLastRemoteSnapshotVersion(o).next(p=>t.ai.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(h)}return S.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,l)).next(()=>c)}).then(o=>(t.Ss=i,o))}function PA(n,e,t){let r=ie(),i=ie();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=xt();return t.forEach((a,c)=>{let l=o.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(W.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):k(z_,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{xs:s,Os:i}})}function zV(n,e){let t=j(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Sr),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Es(n,e){let t=j(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.ai.getTargetData(r,e).next(o=>o?(i=o,S.resolve(i)):t.ai.allocateTargetId(r).next(s=>(i=new _s(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.ai.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ss.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ss=t.Ss.insert(r.targetId,r),t.Ds.set(e,r.targetId)),r})}function Is(n,e,t){return x(this,null,function*(){let r=j(n),i=r.Ss.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!Ur(s))throw s;k(z_,`Failed to update sequence numbers for target ${e}: ${s}`)}r.Ss=r.Ss.remove(e),r.Ds.delete(i.target)})}function Mh(n,e,t){let r=j(n),i=W.min(),o=ie();return r.persistence.runTransaction("Execute query","readwrite",s=>function(c,l,h){let p=j(c),m=p.Ds.get(h);return m!==void 0?S.resolve(p.Ss.get(m)):p.ai.getTargetData(l,h)}(r,s,Dt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.ai.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>r.bs.getDocumentsMatchingQuery(s,e,t?i:W.min(),t?o:ie())).next(a=>(FA(r,W0(e),a),{documents:a,Ns:o})))}function kA(n,e){let t=j(n),r=j(t.ai),i=t.Ss.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.Rt(o,e).next(s=>s?s.target:null))}function OA(n,e){let t=j(n),r=t.vs.get(e)||W.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Cs.getAllFromCollectionGroup(i,e,m0(r,as),Number.MAX_SAFE_INTEGER)).then(i=>(FA(t,e,i),i))}function FA(n,e,t){let r=n.vs.get(e)||W.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.vs.set(e,r)}function GV(n,e,t,r){return x(this,null,function*(){let i=j(n),o=ie(),s=xt();for(let l of t){let h=e.Bs(l.metadata.name);l.document&&(o=o.add(h));let p=e.Ls(l);p.setReadTime(e.ks(l.metadata.readTime)),s=s.insert(h,p)}let a=i.Cs.newChangeBuffer({trackRemovals:!0}),c=yield Es(i,function(h){return Dt(Ms(pe.fromString(`__bundle__/docs/${h}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>PA(l,a,s).next(h=>(a.apply(l),h)).next(h=>i.ai.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.ai.addMatchingKeys(l,o,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,h.xs,h.Os)).next(()=>h.xs)))})}function WV(r,i){return x(this,arguments,function*(n,e,t=ie()){let o=yield Es(n,Dt($_(e.bundledQuery))),s=j(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{let c=$e(e.readTime);if(o.snapshotVersion.compareTo(c)>=0)return s.ci.saveNamedQuery(a,e);let l=o.withResumeToken(He.EMPTY_BYTE_STRING,c);return s.Ss=s.Ss.insert(l.targetId,l),s.ai.updateTargetData(a,l).next(()=>s.ai.removeMatchingKeysForTargetId(a,o.targetId)).next(()=>s.ai.addMatchingKeys(a,t,o.targetId)).next(()=>s.ci.saveNamedQuery(a,e))})})}var LA="firestore_clients";function WS(n,e){return`${LA}_${n}_${e}`}var VA="firestore_mutations";function KS(n,e,t){let r=`${VA}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}var jA="firestore_targets";function vy(n,e){return`${jA}_${n}_${e}`}var En="SharedClientState",xh=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static qs(e,t,r){let i=JSON.parse(r),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new P(i.error.code,i.error.message))),s?new n(e,t,i.state,o):(Be(En,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Qs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Cu=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static qs(e,t){let r=JSON.parse(t),i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new P(r.error.code,r.error.message))),o?new n(e,r.state,i):(Be(En,`Failed to parse target state for ID '${e}': ${t}`),null)}Qs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Nh=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static qs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=j_();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=w0(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new n(e,o):(Be(En,`Failed to parse client data for instance '${e}': ${t}`),null)}},Lv=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static qs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(Be(En,`Failed to parse online state: ${e}`),null)}},Gu=class{constructor(){this.activeTargetIds=j_()}$s(e){this.activeTargetIds=this.activeTargetIds.add(e)}Us(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Qs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},bu=class{constructor(e,t,r,i,o){this.window=e,this.bi=t,this.persistenceKey=r,this.Ks=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ws=this.Gs.bind(this),this.zs=new Ae(J),this.started=!1,this.js=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Hs=WS(this.persistenceKey,this.Ks),this.Js=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.zs=this.zs.insert(this.Ks,new Gu),this.Ys=new RegExp(`^${LA}_${s}_([^_]*)$`),this.Zs=new RegExp(`^${VA}_${s}_(\\d+)(?:_(.*))?$`),this.Xs=new RegExp(`^${jA}_${s}_(\\d+)$`),this.eo=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.no=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ws)}static C(e){return!(!e||!e.localStorage)}start(){return x(this,null,function*(){let e=yield this.syncEngine.us();for(let r of e){if(r===this.Ks)continue;let i=this.getItem(WS(this.persistenceKey,r));if(i){let o=Nh.qs(r,i);o&&(this.zs=this.zs.insert(o.clientId,o))}}this.ro();let t=this.storage.getItem(this.eo);if(t){let r=this.io(t);r&&this.so(r)}for(let r of this.js)this.Gs(r);this.js=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Js,JSON.stringify(e))}getAllActiveQueryTargets(){return this.oo(this.zs)}isActiveQueryTarget(e){let t=!1;return this.zs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this._o(e,"pending")}updateMutationState(e,t,r){this._o(e,t,r),this.ao(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(vy(this.persistenceKey,e));if(i){let o=Cu.qs(e,i);o&&(r=o.state)}}return t&&this.uo.$s(e),this.ro(),r}removeLocalQueryTarget(e){this.uo.Us(e),this.ro()}isLocalQueryTarget(e){return this.uo.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(vy(this.persistenceKey,e))}updateQueryState(e,t,r){this.co(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.ao(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.lo(e)}notifyBundleLoaded(e){this.ho(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ws),this.removeItem(this.Hs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return k(En,"READ",e,t),t}setItem(e,t){k(En,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){k(En,"REMOVE",e),this.storage.removeItem(e)}Gs(e){let t=e;if(t.storageArea===this.storage){if(k(En,"EVENT",t.key,t.newValue),t.key===this.Hs)return void Be("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.bi.enqueueRetryable(()=>x(this,null,function*(){if(this.started){if(t.key!==null){if(this.Ys.test(t.key)){if(t.newValue==null){let r=this.Po(t.key);return this.To(r,null)}{let r=this.Io(t.key,t.newValue);if(r)return this.To(r.clientId,r)}}else if(this.Zs.test(t.key)){if(t.newValue!==null){let r=this.Eo(t.key,t.newValue);if(r)return this.Ao(r)}}else if(this.Xs.test(t.key)){if(t.newValue!==null){let r=this.Ro(t.key,t.newValue);if(r)return this.Vo(r)}}else if(t.key===this.eo){if(t.newValue!==null){let r=this.io(t.newValue);if(r)return this.so(r)}}else if(t.key===this.Js){let r=function(o){let s=Lt.le;if(o!=null)try{let a=JSON.parse(o);z(typeof a=="number",30636,{mo:o}),s=a}catch(a){Be(En,"Failed to read sequence number from WebStorage",a)}return s}(t.newValue);r!==Lt.le&&this.sequenceNumberHandler(r)}else if(t.key===this.no){let r=this.fo(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.po(i)))}}}else this.js.push(t)}))}}get uo(){return this.zs.get(this.Ks)}ro(){this.setItem(this.Hs,this.uo.Qs())}_o(e,t,r){let i=new xh(this.currentUser,e,t,r),o=KS(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Qs())}ao(e){let t=KS(this.persistenceKey,this.currentUser,e);this.removeItem(t)}lo(e){let t={clientId:this.Ks,onlineState:e};this.storage.setItem(this.eo,JSON.stringify(t))}co(e,t,r){let i=vy(this.persistenceKey,e),o=new Cu(e,t,r);this.setItem(i,o.Qs())}ho(e){let t=JSON.stringify(Array.from(e));this.setItem(this.no,t)}Po(e){let t=this.Ys.exec(e);return t?t[1]:null}Io(e,t){let r=this.Po(e);return Nh.qs(r,t)}Eo(e,t){let r=this.Zs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return xh.qs(new Ge(o),i,t)}Ro(e,t){let r=this.Xs.exec(e),i=Number(r[1]);return Cu.qs(i,t)}io(e){return Lv.qs(e)}fo(e){return JSON.parse(e)}Ao(e){return x(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.yo(e.batchId,e.state,e.error);k(En,`Ignoring mutation for non-active user ${e.user.uid}`)})}Vo(e){return this.syncEngine.wo(e.targetId,e.state,e.error)}To(e,t){let r=t?this.zs.insert(e,t):this.zs.remove(e),i=this.oo(this.zs),o=this.oo(r),s=[],a=[];return o.forEach(c=>{i.has(c)||s.push(c)}),i.forEach(c=>{o.has(c)||a.push(c)}),this.syncEngine.bo(s,a).then(()=>{this.zs=r})}so(e){this.zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}oo(e){let t=j_();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Ph=class{constructor(){this.So=new Gu,this.Do={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.So.$s(e),this.Do[e]||"not-current"}updateQueryState(e,t,r){this.Do[e]=t}removeLocalQueryTarget(e){this.So.Us(e)}isLocalQueryTarget(e){return this.So.activeTargetIds.has(e)}clearQueryState(e){delete this.Do[e]}getAllActiveQueryTargets(){return this.So.activeTargetIds}isActiveQueryTarget(e){return this.So.activeTargetIds.has(e)}start(){return this.So=new Gu,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Vv=class{vo(e){}shutdown(){}};var QS="ConnectivityMonitor",kh=class{constructor(){this.Co=()=>this.Fo(),this.Mo=()=>this.xo(),this.Oo=[],this.No()}vo(e){this.Oo.push(e)}shutdown(){window.removeEventListener("online",this.Co),window.removeEventListener("offline",this.Mo)}No(){window.addEventListener("online",this.Co),window.addEventListener("offline",this.Mo)}Fo(){k(QS,"Network connectivity changed: AVAILABLE");for(let e of this.Oo)e(0)}xo(){k(QS,"Network connectivity changed: UNAVAILABLE");for(let e of this.Oo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var $d=null;function jv(){return $d===null?$d=function(){return 268435456+Math.round(2147483648*Math.random())}():$d++,"0x"+$d.toString(16)}var _y="RestConnection",KV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Bv=class{get Bo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Lo=t+"://"+e.host,this.ko=`projects/${r}/databases/${i}`,this.qo=this.databaseId.database===Ly?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Qo(e,t,r,i,o){let s=jv(),a=this.$o(e,t.toUriEncodedString());k(_y,`Sending RPC '${e}' ${s}:`,a,r);let c={"google-cloud-resource-prefix":this.ko,"x-goog-request-params":this.qo};this.Uo(c,i,o);let{host:l}=new URL(a),h=Qf(l);return this.Ko(e,a,c,r,h).then(p=>(k(_y,`Received RPC '${e}' ${s}: `,p),p),p=>{throw on(_y,`RPC '${e}' ${s} failed with error: `,p,"url: ",a,"request:",r),p})}Wo(e,t,r,i,o,s){return this.Qo(e,t,r,i,o)}Uo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Rs}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}$o(e,t){let r=KV[e];return`${this.Lo}/v1/${t}:${r}`}terminate(){}};var Uv=class{constructor(e){this.Go=e.Go,this.zo=e.zo}jo(e){this.Ho=e}Jo(e){this.Yo=e}Zo(e){this.Xo=e}onMessage(e){this.e_=e}close(){this.zo()}send(e){this.Go(e)}t_(){this.Ho()}n_(){this.Yo()}r_(e){this.Xo(e)}i_(e){this.e_(e)}};var ft="WebChannelConnection",$v=class extends Bv{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ko(e,t,r,i,o){let s=jv();return new Promise((a,c)=>{let l=new cy;l.setWithCredentials(!0),l.listenOnce(ly.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case pu.NO_ERROR:let p=l.getResponseJson();k(ft,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case pu.TIMEOUT:k(ft,`RPC '${e}' ${s} timed out`),c(new P(R.DEADLINE_EXCEEDED,"Request time out"));break;case pu.HTTP_ERROR:let m=l.getStatus();if(k(ft,`RPC '${e}' ${s} failed with status:`,m,"response text:",l.getResponseText()),m>0){let y=l.getResponseJson();Array.isArray(y)&&(y=y[0]);let T=y?.error;if(T&&T.status&&T.message){let A=function(V){let H=V.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(H)>=0?H:R.UNKNOWN}(T.status);c(new P(A,T.message))}else c(new P(R.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new P(R.UNAVAILABLE,"Connection failed."));break;default:$(9055,{s_:e,streamId:s,o_:l.getLastErrorCode(),__:l.getLastError()})}}finally{k(ft,`RPC '${e}' ${s} completed.`)}});let h=JSON.stringify(i);k(ft,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",h,r,15)})}a_(e,t,r){let i=jv(),o=[this.Lo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=fy(),a=hy(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Uo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let h=o.join("");k(ft,`Creating RPC '${e}' stream ${i}: ${h}`,c);let p=s.createWebChannel(h,c),m=!1,y=!1,T=new Uv({Go:N=>{y?k(ft,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(m||(k(ft,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),k(ft,`RPC '${e}' stream ${i} sending:`,N),p.send(N))},zo:()=>p.close()}),A=(N,V,H)=>{N.listen(V,F=>{try{H(F)}catch(Z){setTimeout(()=>{throw Z},0)}})};return A(p,qo.EventType.OPEN,()=>{y||(k(ft,`RPC '${e}' stream ${i} transport opened.`),T.t_())}),A(p,qo.EventType.CLOSE,()=>{y||(y=!0,k(ft,`RPC '${e}' stream ${i} transport closed`),T.r_())}),A(p,qo.EventType.ERROR,N=>{y||(y=!0,on(ft,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),T.r_(new P(R.UNAVAILABLE,"The operation could not be completed")))}),A(p,qo.EventType.MESSAGE,N=>{var V;if(!y){let H=N.data[0];z(!!H,16349);let F=H,Z=F?.error||((V=F[0])===null||V===void 0?void 0:V.error);if(Z){k(ft,`RPC '${e}' stream ${i} received error:`,Z);let te=Z.status,ne=function(w){let I=qe[w];if(I!==void 0)return aA(I)}(te),E=Z.message;ne===void 0&&(ne=R.INTERNAL,E="Unknown error status: "+te+" with message "+Z.message),y=!0,T.r_(new P(ne,E)),p.close()}else k(ft,`RPC '${e}' stream ${i} received:`,H),T.i_(H)}}),A(a,dy.STAT_EVENT,N=>{N.stat===Ld.PROXY?k(ft,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Ld.NOPROXY&&k(ft,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{T.n_()},0),T}};function BA(){return typeof window<"u"?window:null}function Qd(){return typeof document<"u"?document:null}function rc(n){return new nv(n,!0)}var Wu=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.bi=e,this.timerId=t,this.u_=r,this.c_=i,this.l_=o,this.h_=0,this.P_=null,this.T_=Date.now(),this.reset()}reset(){this.h_=0}I_(){this.h_=this.l_}E_(e){this.cancel();let t=Math.floor(this.h_+this.d_()),r=Math.max(0,Date.now()-this.T_),i=Math.max(0,t-r);i>0&&k("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.h_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.P_=this.bi.enqueueAfterDelay(this.timerId,i,()=>(this.T_=Date.now(),e())),this.h_*=this.c_,this.h_<this.u_&&(this.h_=this.u_),this.h_>this.l_&&(this.h_=this.l_)}A_(){this.P_!==null&&(this.P_.skipDelay(),this.P_=null)}cancel(){this.P_!==null&&(this.P_.cancel(),this.P_=null)}d_(){return(Math.random()-.5)*this.h_}};var YS="PersistentStream",Oh=class{constructor(e,t,r,i,o,s,a,c){this.bi=e,this.R_=r,this.V_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.m_=0,this.f_=null,this.g_=null,this.stream=null,this.p_=0,this.y_=new Wu(e,t)}w_(){return this.state===1||this.state===5||this.b_()}b_(){return this.state===2||this.state===3}start(){this.p_=0,this.state!==4?this.auth():this.S_()}stop(){return x(this,null,function*(){this.w_()&&(yield this.close(0))})}D_(){this.state=0,this.y_.reset()}v_(){this.b_()&&this.f_===null&&(this.f_=this.bi.enqueueAfterDelay(this.R_,6e4,()=>this.C_()))}F_(e){this.M_(),this.stream.send(e)}C_(){return x(this,null,function*(){if(this.b_())return this.close(0)})}M_(){this.f_&&(this.f_.cancel(),this.f_=null)}x_(){this.g_&&(this.g_.cancel(),this.g_=null)}close(e,t){return x(this,null,function*(){this.M_(),this.x_(),this.y_.cancel(),this.m_++,e!==4?this.y_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(Be(t.toString()),Be("Using maximum backoff delay to prevent overloading the backend."),this.y_.I_()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.O_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Zo(t)})}O_(){}auth(){this.state=1;let e=this.N_(this.m_),t=this.m_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.m_===t&&this.B_(r,i)},r=>{e(()=>{let i=new P(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.L_(i)})})}B_(e,t){let r=this.N_(this.m_);this.stream=this.k_(e,t),this.stream.jo(()=>{r(()=>this.listener.jo())}),this.stream.Jo(()=>{r(()=>(this.state=2,this.g_=this.bi.enqueueAfterDelay(this.V_,1e4,()=>(this.b_()&&(this.state=3),Promise.resolve())),this.listener.Jo()))}),this.stream.Zo(i=>{r(()=>this.L_(i))}),this.stream.onMessage(i=>{r(()=>++this.p_==1?this.q_(i):this.onNext(i))})}S_(){this.state=5,this.y_.E_(()=>x(this,null,function*(){this.state=0,this.start()}))}L_(e){return k(YS,`close with error: ${e}`),this.stream=null,this.close(4,e)}N_(e){return t=>{this.bi.enqueueAndForget(()=>this.m_===e?t():(k(YS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Hv=class extends Oh{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}k_(e,t){return this.connection.a_("Listen",e,t)}q_(e){return this.onNext(e)}onNext(e){this.y_.reset();let t=xV(this.serializer,e),r=function(o){if(!("targetChange"in o))return W.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?W.min():s.readTime?$e(s.readTime):W.min()}(e);return this.listener.Q_(t,r)}U_(e){let t={};t.database=ov(this.serializer),t.addTarget=function(o,s){let a,c=s.target;if(a=dh(c)?{documents:pA(o,c)}:{query:gA(o,c).gt},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=uA(o,s.resumeToken);let l=rv(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(W.min())>0){a.readTime=vs(o,s.snapshotVersion.toTimestamp());let l=rv(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=PV(this.serializer,e);r&&(t.labels=r),this.F_(t)}K_(e){let t={};t.database=ov(this.serializer),t.removeTarget=e,this.F_(t)}},qv=class extends Oh{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get W_(){return this.p_>0}start(){this.lastStreamToken=void 0,super.start()}O_(){this.W_&&this.G_([])}k_(e,t){return this.connection.a_("Write",e,t)}q_(e){return z(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,z(!e.writeResults||e.writeResults.length===0,55816),this.listener.z_()}onNext(e){z(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.y_.reset();let t=NV(e.writeResults,e.commitTime),r=$e(e.commitTime);return this.listener.j_(r,t)}H_(){let e={};e.database=ov(this.serializer),this.F_(e)}G_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>$u(this.serializer,r))};this.F_(t)}};var zv=class{},Gv=class extends zv{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.J_=!1}Y_(){if(this.J_)throw new P(R.FAILED_PRECONDITION,"The client has already been terminated.")}Qo(e,t,r,i){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Qo(e,iv(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new P(R.UNKNOWN,o.toString())})}Wo(e,t,r,i,o){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Wo(e,iv(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new P(R.UNKNOWN,s.toString())})}terminate(){this.J_=!0,this.connection.terminate()}},Wv=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Z_=0,this.X_=null,this.ea=!0}ta(){this.Z_===0&&(this.na("Unknown"),this.X_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.X_=null,this.ra("Backend didn't respond within 10 seconds."),this.na("Offline"),Promise.resolve())))}ia(e){this.state==="Online"?this.na("Unknown"):(this.Z_++,this.Z_>=1&&(this.sa(),this.ra(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.na("Offline")))}set(e){this.sa(),this.Z_=0,e==="Online"&&(this.ea=!1),this.na(e)}na(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ra(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ea?(Be(t),this.ea=!1):k("OnlineStateTracker",t)}sa(){this.X_!==null&&(this.X_.cancel(),this.X_=null)}};var Li="RemoteStore",Kv=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.oa=[],this._a=new Map,this.aa=new Set,this.ua=[],this.ca=o,this.ca.vo(s=>{r.enqueueAndForget(()=>x(this,null,function*(){Hr(this)&&(k(Li,"Restarting streams for network reachability change."),yield function(c){return x(this,null,function*(){let l=j(c);l.aa.add(4),yield xs(l),l.la.set("Unknown"),l.aa.delete(4),yield ic(l)})}(this))}))}),this.la=new Wv(r,i)}};function ic(n){return x(this,null,function*(){if(Hr(n))for(let e of n.ua)yield e(!0)})}function xs(n){return x(this,null,function*(){for(let e of n.ua)yield e(!1)})}function af(n,e){let t=j(n);t._a.has(e.targetId)||(t._a.set(e.targetId,e),K_(t)?W_(t):Ps(t).b_()&&G_(t,e))}function Ds(n,e){let t=j(n),r=Ps(t);t._a.delete(e),r.b_()&&UA(t,e),t._a.size===0&&(r.b_()?r.v_():Hr(t)&&t.la.set("Unknown"))}function G_(n,e){if(n.ha.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ps(n).U_(e)}function UA(n,e){n.ha.Ke(e),Ps(n).K_(e)}function W_(n){n.ha=new tv({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n._a.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),Ps(n).start(),n.la.ta()}function K_(n){return Hr(n)&&!Ps(n).w_()&&n._a.size>0}function Hr(n){return j(n).aa.size===0}function $A(n){n.ha=void 0}function QV(n){return x(this,null,function*(){n.la.set("Online")})}function YV(n){return x(this,null,function*(){n._a.forEach((e,t)=>{G_(n,e)})})}function ZV(n,e){return x(this,null,function*(){$A(n),K_(n)?(n.la.ia(e),W_(n)):n.la.set("Unknown")})}function JV(n,e,t){return x(this,null,function*(){if(n.la.set("Online"),e instanceof gh&&e.state===2&&e.cause)try{yield function(i,o){return x(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i._a.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i._a.delete(a),i.ha.removeTarget(a))})}(n,e)}catch(r){k(Li,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Fh(n,r)}else if(e instanceof os?n.ha.Xe(e):e instanceof ph?n.ha.ot(e):n.ha.nt(e),!t.isEqual(W.min()))try{let r=yield NA(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.ha.It(s);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let h=o._a.get(l);h&&o._a.set(l,h.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,l)=>{let h=o._a.get(c);if(!h)return;o._a.set(c,h.withResumeToken(He.EMPTY_BYTE_STRING,h.snapshotVersion)),UA(o,c);let p=new _s(h.target,c,l,h.sequenceNumber);G_(o,p)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){k(Li,"Failed to raise snapshot:",r),yield Fh(n,r)}})}function Fh(n,e,t){return x(this,null,function*(){if(!Ur(e))throw e;n.aa.add(1),yield xs(n),n.la.set("Offline"),t||(t=()=>NA(n.localStore)),n.asyncQueue.enqueueRetryable(()=>x(null,null,function*(){k(Li,"Retrying IndexedDB access"),yield t(),n.aa.delete(1),yield ic(n)}))})}function HA(n,e){return e().catch(t=>Fh(n,t,e))}function Ns(n){return x(this,null,function*(){let e=j(n),t=Vr(e),r=e.oa.length>0?e.oa[e.oa.length-1].batchId:Sr;for(;XV(e);)try{let i=yield zV(e.localStore,r);if(i===null){e.oa.length===0&&t.v_();break}r=i.batchId,e2(e,i)}catch(i){yield Fh(e,i)}qA(e)&&zA(e)})}function XV(n){return Hr(n)&&n.oa.length<10}function e2(n,e){n.oa.push(e);let t=Vr(n);t.b_()&&t.W_&&t.G_(e.mutations)}function qA(n){return Hr(n)&&!Vr(n).w_()&&n.oa.length>0}function zA(n){Vr(n).start()}function t2(n){return x(this,null,function*(){Vr(n).H_()})}function n2(n){return x(this,null,function*(){let e=Vr(n);for(let t of n.oa)e.G_(t.mutations)})}function r2(n,e,t){return x(this,null,function*(){let r=n.oa.shift(),i=Jy.from(r,e,t);yield HA(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Ns(n)})}function i2(n,e){return x(this,null,function*(){e&&Vr(n).W_&&(yield function(r,i){return x(this,null,function*(){if(function(s){return sA(s)&&s!==R.ABORTED}(i.code)){let o=r.oa.shift();Vr(r).D_(),yield HA(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Ns(r)}})}(n,e)),qA(n)&&zA(n)})}function ZS(n,e){return x(this,null,function*(){let t=j(n);t.asyncQueue.verifyOperationInProgress(),k(Li,"RemoteStore received new credentials");let r=Hr(t);t.aa.add(3),yield xs(t),r&&t.la.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.aa.delete(3),yield ic(t)})}function Qv(n,e){return x(this,null,function*(){let t=j(n);e?(t.aa.delete(2),yield ic(t)):e||(t.aa.add(2),yield xs(t),t.la.set("Unknown"))})}function Ps(n){return n.Pa||(n.Pa=function(t,r,i){let o=j(t);return o.Y_(),new Hv(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{jo:QV.bind(null,n),Jo:YV.bind(null,n),Zo:ZV.bind(null,n),Q_:JV.bind(null,n)}),n.ua.push(e=>x(null,null,function*(){e?(n.Pa.D_(),K_(n)?W_(n):n.la.set("Unknown")):(yield n.Pa.stop(),$A(n))}))),n.Pa}function Vr(n){return n.Ta||(n.Ta=function(t,r,i){let o=j(t);return o.Y_(),new qv(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{jo:()=>Promise.resolve(),Jo:t2.bind(null,n),Zo:i2.bind(null,n),z_:n2.bind(null,n),j_:r2.bind(null,n)}),n.ua.push(e=>x(null,null,function*(){e?(n.Ta.D_(),yield Ns(n)):(yield n.Ta.stop(),n.oa.length>0&&(k(Li,`Stopping write stream with ${n.oa.length} pending writes`),n.oa=[]))}))),n.Ta}var Yv=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Ze,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ks(n,e){if(Be("AsyncQueue",`${e}: ${n}`),Ur(n))return new P(R.UNAVAILABLE,`${e}: ${n}`);throw n}var Lh=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=_u(),this.sortedSet=new Ae(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Vh=class{constructor(){this.Ia=new Ae(B.comparator)}track(e){let t=e.doc.key,r=this.Ia.get(t);r?e.type!==0&&r.type===3?this.Ia=this.Ia.insert(t,e):e.type===3&&r.type!==1?this.Ia=this.Ia.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Ia=this.Ia.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Ia=this.Ia.remove(t):e.type===1&&r.type===2?this.Ia=this.Ia.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):$(63341,{Vt:e,Ea:r}):this.Ia=this.Ia.insert(t,e)}da(){let e=[];return this.Ia.inorderTraversal((t,r)=>{e.push(r)}),e}},Ts=class n{constructor(e,t,r,i,o,s,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Lh.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&tc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Zv=class{constructor(){this.Aa=void 0,this.Ra=[]}Va(){return this.Ra.some(e=>e.ma())}},Jv=class{constructor(){this.queries=JS(),this.onlineState="Unknown",this.fa=new Set}terminate(){(function(t,r){let i=j(t),o=i.queries;i.queries=JS(),o.forEach((s,a)=>{for(let c of a.Ra)c.onError(r)})})(this,new P(R.ABORTED,"Firestore shutting down"))}};function JS(){return new an(n=>G0(n),tc)}function Q_(n,e){return x(this,null,function*(){let t=j(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Va()&&e.ma()&&(r=2):(o=new Zv,r=e.ma()?0:1);try{switch(r){case 0:o.Aa=yield t.onListen(i,!0);break;case 1:o.Aa=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=ks(s,`Initialization of query '${Jo(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.Ra.push(e),e.ga(t.onlineState),o.Aa&&e.pa(o.Aa)&&Z_(t)})}function Y_(n,e){return x(this,null,function*(){let t=j(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.Ra.indexOf(e);s>=0&&(o.Ra.splice(s,1),o.Ra.length===0?i=e.ma()?0:1:!o.Va()&&e.ma()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function o2(n,e){let t=j(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.Ra)a.pa(i)&&(r=!0);s.Aa=i}}r&&Z_(t)}function s2(n,e,t){let r=j(n),i=r.queries.get(e);if(i)for(let o of i.Ra)o.onError(t);r.queries.delete(e)}function Z_(n){n.fa.forEach(e=>{e.next()})}var Xv,XS;(XS=Xv||(Xv={})).ya="default",XS.Cache="cache";var Ku=class{constructor(e,t,r){this.query=e,this.wa=t,this.ba=!1,this.Sa=null,this.onlineState="Unknown",this.options=r||{}}pa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Ts(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ba?this.Da(e)&&(this.wa.next(e),t=!0):this.va(e,this.onlineState)&&(this.Ca(e),t=!0),this.Sa=e,t}onError(e){this.wa.error(e)}ga(e){this.onlineState=e;let t=!1;return this.Sa&&!this.ba&&this.va(this.Sa,e)&&(this.Ca(this.Sa),t=!0),t}va(e,t){if(!e.fromCache||!this.ma())return!0;let r=t!=="Offline";return(!this.options.Fa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Da(e){if(e.docChanges.length>0)return!0;let t=this.Sa&&this.Sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Ca(e){e=Ts.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ba=!0,this.wa.next(e)}ma(){return this.options.source!==Xv.Cache}};var e_=class{constructor(e,t){this.Ma=e,this.byteLength=t}xa(){return"metadata"in this.Ma}};var jh=class{constructor(e){this.serializer=e}Bs(e){return Cn(this.serializer,e)}Ls(e){return e.metadata.exists?fA(this.serializer,e.document,!1):We.newNoDocument(this.Bs(e.metadata.name),this.ks(e.metadata.readTime))}ks(e){return $e(e)}},t_=class{constructor(e,t,r){this.Oa=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=GA(e)}Na(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Ma.namedQuery)this.queries.push(e.Ma.namedQuery);else if(e.Ma.documentMetadata){this.documents.push({metadata:e.Ma.documentMetadata}),e.Ma.documentMetadata.exists||++t;let r=pe.fromString(e.Ma.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Ma.document&&(this.documents[this.documents.length-1].document=e.Ma.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ba(e){let t=new Map,r=new jh(this.serializer);for(let i of e)if(i.metadata.queries){let o=r.Bs(i.metadata.name);for(let s of i.metadata.queries){let a=(t.get(s)||ie()).add(o);t.set(s,a)}}return t}complete(){return x(this,null,function*(){let e=yield GV(this.localStore,new jh(this.serializer),this.documents,this.Oa.id),t=this.Ba(this.documents);for(let r of this.queries)yield WV(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,La:this.collectionGroups,ka:e}})}};function GA(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Bh=class{constructor(e){this.key=e}},Uh=class{constructor(e){this.key=e}},$h=class{constructor(e,t){this.query=e,this.qa=t,this.Qa=null,this.hasCachedResults=!1,this.current=!1,this.$a=ie(),this.mutatedKeys=ie(),this.Ua=K0(e),this.Ka=new Lh(this.Ua)}get Wa(){return this.qa}Ga(e,t){let r=t?t.za:new Vh,i=t?t.Ka:this.Ka,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{let m=i.get(h),y=nc(this.query,p)?p:null,T=!!m&&this.mutatedKeys.has(m.key),A=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),N=!1;m&&y?m.data.isEqual(y.data)?T!==A&&(r.track({type:3,doc:y}),N=!0):this.ja(m,y)||(r.track({type:2,doc:y}),N=!0,(c&&this.Ua(y,c)>0||l&&this.Ua(y,l)<0)&&(a=!0)):!m&&y?(r.track({type:0,doc:y}),N=!0):m&&!y&&(r.track({type:1,doc:m}),N=!0,(c||l)&&(a=!0)),N&&(y?(s=s.add(y),o=A?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Ka:s,za:r,ys:a,mutatedKeys:o}}ja(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ka;this.Ka=e.Ka,this.mutatedKeys=e.mutatedKeys;let s=e.za.da();s.sort((h,p)=>function(y,T){let A=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $(20277,{Vt:N})}};return A(y)-A(T)}(h.type,p.type)||this.Ua(h.doc,p.doc)),this.Ha(r),i=i!=null&&i;let a=t&&!i?this.Ja():[],c=this.$a.size===0&&this.current&&!i?1:0,l=c!==this.Qa;return this.Qa=c,s.length!==0||l?{snapshot:new Ts(this.query,e.Ka,o,s,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ya:a}:{Ya:a}}ga(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ka:this.Ka,za:new Vh,mutatedKeys:this.mutatedKeys,ys:!1},!1)):{Ya:[]}}Za(e){return!this.qa.has(e)&&!!this.Ka.has(e)&&!this.Ka.get(e).hasLocalMutations}Ha(e){e&&(e.addedDocuments.forEach(t=>this.qa=this.qa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.qa=this.qa.delete(t)),this.current=e.current)}Ja(){if(!this.current)return[];let e=this.$a;this.$a=ie(),this.Ka.forEach(r=>{this.Za(r.key)&&(this.$a=this.$a.add(r.key))});let t=[];return e.forEach(r=>{this.$a.has(r)||t.push(new Uh(r))}),this.$a.forEach(r=>{e.has(r)||t.push(new Bh(r))}),t}Xa(e){this.qa=e.Ns,this.$a=ie();let t=this.Ga(e.documents);return this.applyChanges(t,!0)}eu(){return Ts.fromInitialDocuments(this.query,this.Ka,this.mutatedKeys,this.Qa===0,this.hasCachedResults)}},qr="SyncEngine",n_=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},r_=class{constructor(e){this.key=e,this.tu=!1}},i_=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.nu={},this.ru=new an(a=>G0(a),tc),this.iu=new Map,this.su=new Set,this.ou=new Ae(B.comparator),this._u=new Map,this.au=new qu,this.uu={},this.cu=new Map,this.lu=ws.ir(),this.onlineState="Unknown",this.hu=void 0}get isPrimaryClient(){return this.hu===!0}};function a2(n,e,t=!0){return x(this,null,function*(){let r=uf(n),i,o=r.ru.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.eu()):i=yield WA(r,e,t,!0),i})}function u2(n,e){return x(this,null,function*(){let t=uf(n);yield WA(t,e,!0,!1)})}function WA(n,e,t,r){return x(this,null,function*(){let i=yield Es(n.localStore,Dt(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield J_(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&af(n.remoteStore,i),a})}function J_(n,e,t,r,i){return x(this,null,function*(){n.Pu=(p,m,y)=>function(A,N,V,H){return x(this,null,function*(){let F=N.view.Ga(V);F.ys&&(F=yield Mh(A.localStore,N.query,!1).then(({documents:E})=>N.view.Ga(E,F)));let Z=H&&H.targetChanges.get(N.targetId),te=H&&H.targetMismatches.get(N.targetId)!=null,ne=N.view.applyChanges(F,A.isPrimaryClient,Z,te);return o_(A,N.targetId,ne.Ya),ne.snapshot})}(n,p,m,y);let o=yield Mh(n.localStore,e,!0),s=new $h(e,o.Ns),a=s.Ga(o.documents),c=Bu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,c);o_(n,t,l.Ya);let h=new n_(e,t,s);return n.ru.set(e,h),n.iu.has(t)?n.iu.get(t).push(e):n.iu.set(t,[e]),l.snapshot})}function c2(n,e,t){return x(this,null,function*(){let r=j(n),i=r.ru.get(e),o=r.iu.get(i.targetId);if(o.length>1)return r.iu.set(i.targetId,o.filter(s=>!tc(s,e))),void r.ru.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Is(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Ds(r.remoteStore,i.targetId),Cs(r,i.targetId)}).catch(Br))):(Cs(r,i.targetId),yield Is(r.localStore,i.targetId,!0))})}function l2(n,e){return x(this,null,function*(){let t=j(n),r=t.ru.get(e),i=t.iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ds(t.remoteStore,r.targetId))})}function d2(n,e,t){return x(this,null,function*(){let r=nw(n);try{let i=yield function(s,a){let c=j(s),l=ke.now(),h=a.reduce((y,T)=>y.add(T.key),ie()),p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let T=xt(),A=ie();return c.Cs.getEntries(y,h).next(N=>{T=N,T.forEach((V,H)=>{H.isValidDocument()||(A=A.add(V))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,T)).next(N=>{p=N;let V=[];for(let H of a){let F=TV(H,p.get(H.key).overlayedDocument);F!=null&&V.push(new un(H.key,F,j0(F.value.mapValue),Ve.exists(!0)))}return c.mutationQueue.addMutationBatch(y,l,V,a)}).next(N=>{m=N;let V=N.applyToLocalDocumentSet(p,A);return c.documentOverlayCache.saveOverlays(y,N.batchId,V)})}).then(()=>({batchId:m.batchId,changes:Y0(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let l=s.uu[s.currentUser.toKey()];l||(l=new Ae(J)),l=l.insert(a,c),s.uu[s.currentUser.toKey()]=l}(r,i.batchId,t),yield rr(r,i.changes),yield Ns(r.remoteStore)}catch(i){let o=ks(i,"Failed to persist write");t.reject(o)}})}function KA(n,e){return x(this,null,function*(){let t=j(n);try{let r=yield qV(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t._u.get(o);s&&(z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.tu=!0:i.modifiedDocuments.size>0?z(s.tu,14607):i.removedDocuments.size>0&&(z(s.tu,42227),s.tu=!1))}),yield rr(t,r,e)}catch(r){yield Br(r)}})}function e0(n,e,t){let r=j(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ru.forEach((o,s)=>{let a=s.view.ga(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let c=j(s);c.onlineState=a;let l=!1;c.queries.forEach((h,p)=>{for(let m of p.Ra)m.ga(a)&&(l=!0)}),l&&Z_(c)}(r.eventManager,e),i.length&&r.nu.Q_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function h2(n,e,t){return x(this,null,function*(){let r=j(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r._u.get(e),o=i&&i.key;if(o){let s=new Ae(B.comparator);s=s.insert(o,We.newNoDocument(o,W.min()));let a=ie().add(o),c=new ju(W.min(),new Map,new Ae(J),s,a);yield KA(r,c),r.ou=r.ou.remove(o),r._u.delete(e),tw(r)}else yield Is(r.localStore,e,!1).then(()=>Cs(r,e,t)).catch(Br)})}function f2(n,e){return x(this,null,function*(){let t=j(n),r=e.batch.batchId;try{let i=yield HV(t.localStore,e);ew(t,r,null),X_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield rr(t,i)}catch(i){yield Br(i)}})}function p2(n,e,t){return x(this,null,function*(){let r=j(n);try{let i=yield function(s,a){let c=j(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,a).next(p=>(z(p!==null,37113),h=p.keys(),c.mutationQueue.removeMutationBatch(l,p))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(r.localStore,e);ew(r,e,t),X_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield rr(r,i)}catch(i){yield Br(i)}})}function g2(n,e){return x(this,null,function*(){let t=j(n);Hr(t.remoteStore)||k(qr,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(s){let a=j(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===Sr)return void e.resolve();let i=t.cu.get(r)||[];i.push(e),t.cu.set(r,i)}catch(r){let i=ks(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function X_(n,e){(n.cu.get(e)||[]).forEach(t=>{t.resolve()}),n.cu.delete(e)}function ew(n,e,t){let r=j(n),i=r.uu[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.uu[r.currentUser.toKey()]=i}}function Cs(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.iu.get(e))n.ru.delete(r),t&&n.nu.Tu(r,t);n.iu.delete(e),n.isPrimaryClient&&n.au.Ur(e).forEach(r=>{n.au.containsKey(r)||QA(n,r)})}function QA(n,e){n.su.delete(e.path.canonicalString());let t=n.ou.get(e);t!==null&&(Ds(n.remoteStore,t),n.ou=n.ou.remove(e),n._u.delete(t),tw(n))}function o_(n,e,t){for(let r of t)r instanceof Bh?(n.au.addReference(r.key,e),m2(n,r)):r instanceof Uh?(k(qr,"Document no longer in limbo: "+r.key),n.au.removeReference(r.key,e),n.au.containsKey(r.key)||QA(n,r.key)):$(19791,{Iu:r})}function m2(n,e){let t=e.key,r=t.path.canonicalString();n.ou.get(t)||n.su.has(r)||(k(qr,"New document in limbo: "+t),n.su.add(r),tw(n))}function tw(n){for(;n.su.size>0&&n.ou.size<n.maxConcurrentLimboResolutions;){let e=n.su.values().next().value;n.su.delete(e);let t=new B(pe.fromString(e)),r=n.lu.next();n._u.set(r,new r_(t)),n.ou=n.ou.insert(t,r),af(n.remoteStore,new _s(Dt(Ms(t.path)),r,"TargetPurposeLimboResolution",Lt.le))}}function rr(n,e,t){return x(this,null,function*(){let r=j(n),i=[],o=[],s=[];r.ru.isEmpty()||(r.ru.forEach((a,c)=>{s.push(r.Pu(c,e,t).then(l=>{var h;if((l||t)&&r.isPrimaryClient){let p=l?!l.fromCache:(h=t?.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(l){i.push(l);let p=kv.Ps(c.targetId,l);o.push(p)}}))}),yield Promise.all(s),r.nu.Q_(i),yield function(c,l){return x(this,null,function*(){let h=j(c);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>S.forEach(l,m=>S.forEach(m.ls,y=>h.persistence.referenceDelegate.addReference(p,m.targetId,y)).next(()=>S.forEach(m.hs,y=>h.persistence.referenceDelegate.removeReference(p,m.targetId,y)))))}catch(p){if(!Ur(p))throw p;k(z_,"Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let y=h.Ss.get(m),T=y.snapshotVersion,A=y.withLastLimboFreeSnapshotVersion(T);h.Ss=h.Ss.insert(m,A)}}})}(r.localStore,o))})}function y2(n,e){return x(this,null,function*(){let t=j(n);if(!t.currentUser.isEqual(e)){k(qr,"User change. New user:",e.toKey());let r=yield xA(t.localStore,e);t.currentUser=e,function(o,s){o.cu.forEach(a=>{a.forEach(c=>{c.reject(new P(R.CANCELLED,s))})}),o.cu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield rr(t,r.Ms)}})}function v2(n,e){let t=j(n),r=t._u.get(e);if(r&&r.tu)return ie().add(r.key);{let i=ie(),o=t.iu.get(e);if(!o)return i;for(let s of o){let a=t.ru.get(s);i=i.unionWith(a.view.Wa)}return i}}function _2(n,e){return x(this,null,function*(){let t=j(n),r=yield Mh(t.localStore,e.query,!0),i=e.view.Xa(r);return t.isPrimaryClient&&o_(t,e.targetId,i.Ya),i})}function w2(n,e){return x(this,null,function*(){let t=j(n);return OA(t.localStore,e).then(r=>rr(t,r))})}function E2(n,e,t,r){return x(this,null,function*(){let i=j(n),o=yield function(a,c){let l=j(a),h=j(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.Hn(p,c).next(m=>m?l.localDocuments.getDocuments(p,m):S.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?yield Ns(i.remoteStore):t==="acknowledged"||t==="rejected"?(ew(i,e,r||null),X_(i,e),function(a,c){j(j(a).mutationQueue).Xn(c)}(i.localStore,e)):$(6720,"Unknown batchState",{Eu:t}),yield rr(i,o)):k(qr,"Cannot apply mutation batch with id: "+e)})}function I2(n,e){return x(this,null,function*(){let t=j(n);if(uf(t),nw(t),e===!0&&t.hu!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield t0(t,r.toArray());t.hu=!0,yield Qv(t.remoteStore,!0);for(let o of i)af(t.remoteStore,o)}else if(e===!1&&t.hu!==!1){let r=[],i=Promise.resolve();t.iu.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then(()=>(Cs(t,s),Is(t.localStore,s,!0))),Ds(t.remoteStore,s)}),yield i,yield t0(t,r),function(s){let a=j(s);a._u.forEach((c,l)=>{Ds(a.remoteStore,l)}),a.au.Kr(),a._u=new Map,a.ou=new Ae(B.comparator)}(t),t.hu=!1,yield Qv(t.remoteStore,!1)}})}function t0(n,e,t){return x(this,null,function*(){let r=j(n),i=[],o=[];for(let s of e){let a,c=r.iu.get(s);if(c&&c.length!==0){a=yield Es(r.localStore,Dt(c[0]));for(let l of c){let h=r.ru.get(l),p=yield _2(r,h);p.snapshot&&o.push(p.snapshot)}}else{let l=yield kA(r.localStore,s);a=yield Es(r.localStore,l),yield J_(r,YA(l),s,!1,a.resumeToken)}i.push(a)}return r.nu.Q_(o),i})}function YA(n){return z0(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function D2(n){return function(t){return j(j(t).persistence).us()}(j(n).localStore)}function T2(n,e,t,r){return x(this,null,function*(){let i=j(n);if(i.hu)return void k(qr,"Ignoring unexpected query state notification.");let o=i.iu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield OA(i.localStore,W0(o[0])),a=ju.createSynthesizedRemoteEventForCurrentChange(e,t==="current",He.EMPTY_BYTE_STRING);yield rr(i,s,a);break}case"rejected":yield Is(i.localStore,e,!0),Cs(i,e,r);break;default:$(64155,t)}})}function C2(n,e,t){return x(this,null,function*(){let r=uf(n);if(r.hu){for(let i of e){if(r.iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){k(qr,"Adding an already active target "+i);continue}let o=yield kA(r.localStore,i),s=yield Es(r.localStore,o);yield J_(r,YA(o),s.targetId,!1,s.resumeToken),af(r.remoteStore,s)}for(let i of t)r.iu.has(i)&&(yield Is(r.localStore,i,!1).then(()=>{Ds(r.remoteStore,i),Cs(r,i)}).catch(Br))}})}function uf(n){let e=j(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=KA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=v2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=h2.bind(null,e),e.nu.Q_=o2.bind(null,e.eventManager),e.nu.Tu=s2.bind(null,e.eventManager),e}function nw(n){let e=j(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=f2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=p2.bind(null,e),e}function b2(n,e,t){let r=j(n);(function(o,s,a){return x(this,null,function*(){try{let c=yield s.getMetadata();if(yield function(y,T){let A=j(y),N=$e(T.createTime);return A.persistence.runTransaction("hasNewerBundle","readonly",V=>A.ci.getBundleMetadata(V,T.id)).then(V=>!!V&&V.createTime.compareTo(N)>=0)}(o.localStore,c))return yield s.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(GA(c));let l=new t_(c,o.localStore,s.serializer),h=yield s.du();for(;h;){let m=yield l.Na(h);m&&a._updateProgress(m),h=yield s.du()}let p=yield l.complete();return yield rr(o,p.ka,void 0),yield function(y,T){let A=j(y);return A.persistence.runTransaction("Save bundle","readwrite",N=>A.ci.saveBundleMetadata(N,T))}(o.localStore,c),a._completeWith(p.progress),Promise.resolve(p.La)}catch(c){return on(qr,`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var rw=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return x(this,null,function*(){this.serializer=rc(t.databaseInfo.databaseId),this.sharedClientState=this.Au(t),this.persistence=this.Ru(t),yield this.persistence.start(),this.localStore=this.Vu(t),this.gcScheduler=this.mu(t,this.localStore),this.indexBackfillerScheduler=this.fu(t,this.localStore)})}mu(t,r){return null}fu(t,r){return null}Vu(t){return MA(this.persistence,new Rh,t.initialUser,this.serializer)}Ru(t){return new zu(Sh.Ei,this.serializer)}Au(t){return new Ph}terminate(){return x(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),s_=class extends rw{constructor(e){super(),this.cacheSizeBytes=e}mu(e,t){z(this.persistence.referenceDelegate instanceof Ah,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Th(r,e.asyncQueue,t)}Ru(e){let t=this.cacheSizeBytes!==void 0?Mt.withCacheSize(this.cacheSizeBytes):Mt.DEFAULT;return new zu(r=>Ah.Ei(r,t),this.serializer)}},Hh=class n extends rw{constructor(e,t,r){super(),this.gu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return x(this,null,function*(){yield Gf(n.prototype,this,"initialize").call(this,e),yield this.gu.initialize(this,e),yield nw(this.gu.syncEngine),yield Ns(this.gu.remoteStore),yield this.persistence.Ki(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}Vu(e){return MA(this.persistence,new Rh,e.initialUser,this.serializer)}mu(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new Th(r,e.asyncQueue,t)}fu(e,t){let r=new Ny(t,this.persistence);return new xy(e.asyncQueue,r)}Ru(e){let t=q_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Mt.withCacheSize(this.cacheSizeBytes):Mt.DEFAULT;return new Pv(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,BA(),Qd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Au(e){return new Ph}},a_=class n extends Hh{constructor(e,t){super(e,t,!1),this.gu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return x(this,null,function*(){yield Gf(n.prototype,this,"initialize").call(this,e);let t=this.gu.syncEngine;this.sharedClientState instanceof bu&&(this.sharedClientState.syncEngine={yo:E2.bind(null,t),wo:T2.bind(null,t),bo:C2.bind(null,t),us:D2.bind(null,t),po:w2.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.Ki(r=>x(this,null,function*(){yield I2(this.gu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}Au(e){let t=BA();if(!bu.C(t))throw new P(R.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=q_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new bu(t,e.asyncQueue,r,e.clientId,e.initialUser)}},iw=(()=>{class n{initialize(t,r){return x(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>e0(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=y2.bind(null,this.syncEngine),yield Qv(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Jv}()}createDatastore(t){let r=rc(t.databaseInfo.databaseId),i=function(s){return new $v(s)}(t.databaseInfo);return function(s,a,c,l){return new Gv(s,a,c,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,s,a,c){return new Kv(i,o,s,a,c)}(this.localStore,this.datastore,t.asyncQueue,r=>e0(this.syncEngine,r,0),function(){return kh.C()?new kh:new Vv}())}createSyncEngine(t,r){return function(o,s,a,c,l,h,p){let m=new i_(o,s,a,c,l,h);return p&&(m.hu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return x(this,null,function*(){var t,r;yield function(o){return x(this,null,function*(){let s=j(o);k(Li,"RemoteStore shutting down."),s.aa.add(5),yield xs(s),s.ca.shutdown(),s.la.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function n0(n,e=10240){let t=0;return{read(){return x(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return x(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var bs=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.pu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.pu(this.observer.error,e):Be("Uncaught Error in snapshot listener:",e.toString()))}yu(){this.muted=!0}pu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var u_=class{constructor(e,t){this.wu=e,this.serializer=t,this.metadata=new Ze,this.buffer=new Uint8Array,this.bu=function(){return new TextDecoder("utf-8")}(),this.Su().then(r=>{r&&r.xa()?this.metadata.resolve(r.Ma.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.Ma)}`))},r=>this.metadata.reject(r))}close(){return this.wu.cancel()}getMetadata(){return x(this,null,function*(){return this.metadata.promise})}du(){return x(this,null,function*(){return yield this.getMetadata(),this.Su()})}Su(){return x(this,null,function*(){let e=yield this.Du();if(e===null)return null;let t=this.bu.decode(e),r=Number(t);isNaN(r)&&this.vu(`length string (${t}) is not valid number`);let i=yield this.Cu(r);return new e_(JSON.parse(i),e.length+r)})}Fu(){return this.buffer.findIndex(e=>e===123)}Du(){return x(this,null,function*(){for(;this.Fu()<0&&!(yield this.Mu()););if(this.buffer.length===0)return null;let e=this.Fu();e<0&&this.vu("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Cu(e){return x(this,null,function*(){for(;this.buffer.length<e;)(yield this.Mu())&&this.vu("Reached the end of bundle when more is expected.");let t=this.bu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}vu(e){throw this.wu.cancel(),new Error(`Invalid bundle format: ${e}`)}Mu(){return x(this,null,function*(){let e=yield this.wu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var c_=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new P(R.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,o){return x(this,null,function*(){let s=j(i),a={documents:o.map(p=>Uu(s.serializer,p))},c=yield s.Wo("BatchGetDocuments",s.serializer.databaseId,pe.emptyPath(),a,o.length),l=new Map;c.forEach(p=>{let m=MV(s.serializer,p);l.set(m.key.toString(),m)});let h=[];return o.forEach(p=>{let m=l.get(p.toString());z(!!m,55234,{key:p}),h.push(m)}),h})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Lr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=B.fromPath(r);this.mutations.push(new Fu(i,this.precondition(i)))}),yield function(r,i){return x(this,null,function*(){let o=j(r),s={writes:i.map(a=>$u(o.serializer,a))};yield o.Qo("Commit",o.serializer.databaseId,pe.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw $(50498,{xu:e.constructor.name});t=W.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new P(R.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(W.min())?Ve.exists(!1):Ve.updateTime(t):Ve.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(W.min()))throw new P(R.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ve.updateTime(t)}return Ve.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var l_=class{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this.Ou=r.maxAttempts,this.y_=new Wu(this.asyncQueue,"transaction_retry")}Nu(){this.Ou-=1,this.Bu()}Bu(){this.y_.E_(()=>x(this,null,function*(){let e=new c_(this.datastore),t=this.Lu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ku(i)}))}).catch(r=>{this.ku(r)})}))}Lu(e){try{let t=this.updateFunction(e);return!Ju(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ku(e){this.Ou>0&&this.qu(e)?(this.Ou-=1,this.asyncQueue.enqueueAndForget(()=>(this.Bu(),Promise.resolve()))):this.deferred.reject(e)}qu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!sA(t)}return!1}};var jr="FirestoreClient",d_=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ge.UNAUTHENTICATED,this.clientId=Jd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>x(this,null,function*(){k(jr,"Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(k(jr,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Ze;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=ks(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function wy(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),k(jr,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>x(null,null,function*(){r.isEqual(i)||(yield xA(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function r0(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield ow(n);k(jr,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>ZS(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>ZS(e.remoteStore,i)),n._onlineComponents=e})}function ow(n){return x(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k(jr,"Using user provided OfflineComponentProvider");try{yield wy(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===R.FAILED_PRECONDITION||i.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;on("Error using user provided cache. Falling back to memory cache: "+t),yield wy(n,new rw)}}else k(jr,"Using default OfflineComponentProvider"),yield wy(n,new s_(void 0));return n._offlineComponents})}function cf(n){return x(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(k(jr,"Using user provided OnlineComponentProvider"),yield r0(n,n._uninitializedComponentsProvider._online)):(k(jr,"Using default OnlineComponentProvider"),yield r0(n,new iw))),n._onlineComponents})}function ZA(n){return ow(n).then(e=>e.persistence)}function sw(n){return ow(n).then(e=>e.localStore)}function JA(n){return cf(n).then(e=>e.remoteStore)}function aw(n){return cf(n).then(e=>e.syncEngine)}function S2(n){return cf(n).then(e=>e.datastore)}function Ss(n){return x(this,null,function*(){let e=yield cf(n),t=e.eventManager;return t.onListen=a2.bind(null,e.syncEngine),t.onUnlisten=c2.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=u2.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=l2.bind(null,e.syncEngine),t})}function A2(n){return n.asyncQueue.enqueue(()=>x(null,null,function*(){let e=yield ZA(n),t=yield JA(n);return e.setNetworkEnabled(!0),function(i){let o=j(i);return o.aa.delete(0),ic(o)}(t)}))}function R2(n){return n.asyncQueue.enqueue(()=>x(null,null,function*(){let e=yield ZA(n),t=yield JA(n);return e.setNetworkEnabled(!1),function(i){return x(this,null,function*(){let o=j(i);o.aa.add(0),yield xs(o),o.la.set("Offline")})}(t)}))}function M2(n,e){let t=new Ze;return n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return function(i,o,s){return x(this,null,function*(){try{let a=yield function(l,h){let p=j(l);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,h))}(i,o);a.isFoundDocument()?s.resolve(a):a.isNoDocument()?s.resolve(null):s.reject(new P(R.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=ks(a,`Failed to get document '${o} from cache`);s.reject(c)}})}(yield sw(n),e,t)})),t.promise}function XA(n,e,t={}){let r=new Ze;return n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return function(o,s,a,c,l){let h=new bs({next:m=>{h.yu(),s.enqueueAndForget(()=>Y_(o,p));let y=m.docs.has(a);!y&&m.fromCache?l.reject(new P(R.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&c&&c.source==="server"?l.reject(new P(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new Ku(Ms(a.path),h,{includeMetadataChanges:!0,Fa:!0});return Q_(o,p)}(yield Ss(n),n.asyncQueue,e,t,r)})),r.promise}function x2(n,e){let t=new Ze;return n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return function(i,o,s){return x(this,null,function*(){try{let a=yield Mh(i,o,!0),c=new $h(o,a.Ns),l=c.Ga(a.documents),h=c.applyChanges(l,!1);s.resolve(h.snapshot)}catch(a){let c=ks(a,`Failed to execute query '${o} against cache`);s.reject(c)}})}(yield sw(n),e,t)})),t.promise}function eR(n,e,t={}){let r=new Ze;return n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return function(o,s,a,c,l){let h=new bs({next:m=>{h.yu(),s.enqueueAndForget(()=>Y_(o,p)),m.fromCache&&c.source==="server"?l.reject(new P(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new Ku(a,h,{includeMetadataChanges:!0,Fa:!0});return Q_(o,p)}(yield Ss(n),n.asyncQueue,e,t,r)})),r.promise}function N2(n,e){let t=new bs(e);return n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return function(i,o){j(i).fa.add(o),o.next()}(yield Ss(n),t)})),()=>{t.yu(),n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return function(i,o){j(i).fa.delete(o)}(yield Ss(n),t)}))}}function P2(n,e,t,r){let i=function(s,a){let c;return c=typeof s=="string"?A_().encode(s):s,function(h,p){return new u_(h,p)}(function(h,p){if(h instanceof Uint8Array)return n0(h,p);if(h instanceof ArrayBuffer)return n0(new Uint8Array(h),p);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,rc(e));n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){b2(yield aw(n),i,r)}))}function k2(n,e){return n.asyncQueue.enqueue(()=>x(null,null,function*(){return function(r,i){let o=j(r);return o.persistence.runTransaction("Get named query","readonly",s=>o.ci.getNamedQuery(s,i))}(yield sw(n),e)}))}function tR(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var i0=new Map;function uw(n,e,t){if(!t)throw new P(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function cw(n,e,t,r){if(e===!0&&r===!0)throw new P(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function o0(n){if(!B.isDocumentKey(n))throw new P(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function s0(n){if(B.isDocumentKey(n))throw new P(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function lf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":$(12329,{type:typeof n})}function ge(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new P(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=lf(n);throw new P(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function nR(n,e){if(e<=0)throw new P(R.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var rR="firestore.googleapis.com",a0=!0,qh=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rR,this.ssl=a0}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:a0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=DA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<UV)throw new P(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cw("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new P(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new P(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new P(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Vi=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new P(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new P(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Ey;switch(r.type){case"firstParty":return new Cy(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new P(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,Yf("Firestore",this._settings.isUsingEmulator),this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return x(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=i0.get(t);r&&(k("ComponentProvider","Removing Datastore"),i0.delete(t),r.terminate())}(this),Promise.resolve()}};function iR(n,e,t,r={}){var i;n=ge(n,Vi);let o=Qf(e),s=n._getSettings(),a=Object.assign(Object.assign({},s),{emulatorOptions:n._getEmulatorOptions()}),c=`${e}:${t}`;s.host!==rR&&s.host!==c&&on("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=Object.assign(Object.assign({},s),{host:c,ssl:o,emulatorOptions:r});if(!bc(l,a)&&(n._setSettings(l),o&&(LE(`https://${c}`),Yf("Firestore",!0)),r.mockUserToken)){let h,p;if(typeof r.mockUserToken=="string")h=r.mockUserToken,p=Ge.MOCK_USER;else{h=VE(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new P(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Ge(m)}n._authCredentials=new Iy(new Yd(h,p))}}var it=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},be=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new bn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},bn=class n extends it{constructor(e,t,r){super(e,t,Ms(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new be(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function lw(n,e,...t){if(n=xe(n),uw("collection","path",e),n instanceof Vi){let r=pe.fromString(e,...t);return s0(r),new bn(n,null,r)}{if(!(n instanceof be||n instanceof bn))throw new P(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return s0(r),new bn(n.firestore,null,r)}}function oR(n,e){if(n=ge(n,Vi),uw("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(R.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new it(n,null,function(r){return new sn(pe.emptyPath(),r)}(e))}function oc(n,e,...t){if(n=xe(n),arguments.length===1&&(e=Jd.newId()),uw("doc","path",e),n instanceof Vi){let r=pe.fromString(e,...t);return o0(r),new be(n,null,new B(r))}{if(!(n instanceof be||n instanceof bn))throw new P(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return o0(r),new be(n.firestore,n instanceof bn?n.converter:null,new B(r))}}function dw(n,e){return n=xe(n),e=xe(e),(n instanceof be||n instanceof bn)&&(e instanceof be||e instanceof bn)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function hw(n,e){return n=xe(n),e=xe(e),n instanceof it&&e instanceof it&&n.firestore===e.firestore&&tc(n._query,e._query)&&n.converter===e.converter}var u0="AsyncQueue",zh=class{constructor(e=Promise.resolve()){this.Qu=[],this.$u=!1,this.Uu=[],this.Ku=null,this.Wu=!1,this.Gu=!1,this.zu=[],this.y_=new Wu(this,"async_queue_retry"),this.ju=()=>{let r=Qd();r&&k(u0,"Visibility state changed to "+r.visibilityState),this.y_.A_()},this.Hu=e;let t=Qd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.ju)}get isShuttingDown(){return this.$u}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ju(),this.Yu(e)}enterRestrictedMode(e){if(!this.$u){this.$u=!0,this.Gu=e||!1;let t=Qd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.ju)}}enqueue(e){if(this.Ju(),this.$u)return new Promise(()=>{});let t=new Ze;return this.Yu(()=>this.$u&&this.Gu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qu.push(e),this.Zu()))}Zu(){return x(this,null,function*(){if(this.Qu.length!==0){try{yield this.Qu[0](),this.Qu.shift(),this.y_.reset()}catch(e){if(!Ur(e))throw e;k(u0,"Operation failed with retryable error: "+e)}this.Qu.length>0&&this.y_.E_(()=>this.Zu())}})}Yu(e){let t=this.Hu.then(()=>(this.Wu=!0,e().catch(r=>{throw this.Ku=r,this.Wu=!1,Be("INTERNAL UNHANDLED ERROR: ",c0(r)),r}).then(r=>(this.Wu=!1,r))));return this.Hu=t,t}enqueueAfterDelay(e,t,r){this.Ju(),this.zu.indexOf(e)>-1&&(t=0);let i=Yv.createAndSchedule(this,e,t,r,o=>this.Xu(o));return this.Uu.push(i),i}Ju(){this.Ku&&$(47125,{ec:c0(this.Ku)})}verifyOperationInProgress(){}tc(){return x(this,null,function*(){let e;do e=this.Hu,yield e;while(e!==this.Hu)})}nc(e){for(let t of this.Uu)if(t.timerId===e)return!0;return!1}rc(e){return this.tc().then(()=>{this.Uu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Uu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.tc()})}sc(e){this.zu.push(e)}Xu(e){let t=this.Uu.indexOf(e);this.Uu.splice(t,1)}};function c0(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function h_(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var f_=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Ze,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var sR=-1,Oe=class extends Vi{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new zh,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return x(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new zh(e),this._firestoreClient=void 0,yield e}})}};function ot(n){if(n._terminated)throw new P(R.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||aR(n),n._firestoreClient}function aR(n){var e,t,r;let i=n._freezeSettings(),o=function(a,c,l,h){return new Fy(a,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,tR(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new d_(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}}(n._componentsProvider))}function uR(n,e){on("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return lR(n,iw.provider,{build:r=>new Hh(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function cR(n){return x(this,null,function*(){on("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();lR(n,iw.provider,{build:t=>new a_(t,e.cacheSizeBytes)})})}function lR(n,e,t){if((n=ge(n,Oe))._firestoreClient||n._terminated)throw new P(R.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new P(R.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},aR(n)}function dR(n){if(n._initialized&&!n._terminated)throw new P(R.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Ze;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>x(null,null,function*(){try{yield function(r){return x(this,null,function*(){if(!Mr.C())return Promise.resolve();let i=r+RA;yield Mr.delete(i)})}(q_(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function hR(n){return function(t){let r=new Ze;return t.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return g2(yield aw(t),r)})),r.promise}(ot(n=ge(n,Oe)))}function fR(n){return A2(ot(n=ge(n,Oe)))}function pR(n){return R2(ot(n=ge(n,Oe)))}function gR(n,e){let t=ot(n=ge(n,Oe)),r=new f_;return P2(t,n._databaseId,e,r),r}function mR(n,e){return k2(ot(n=ge(n,Oe)),e).then(t=>t?new it(n,null,t.query):null)}var Rn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(He.fromBase64String(e))}catch(t){throw new P(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(He.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var cn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new P(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ue(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var tr=class{constructor(e){this._methodName=e}};var ji=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new P(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new P(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return J(this._lat,e._lat)||J(this._long,e._long)}};var Qu=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var O2=/^__.*__$/,p_=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new un(e,this.data,this.fieldMask,t,this.fieldTransforms):new Fr(e,this.data,t,this.fieldTransforms)}},Gh=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new un(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function yR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $(40011,{oc:n})}}var Wh=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this._c(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get oc(){return this.settings.oc}ac(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}uc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ac({path:r,cc:!1});return i.lc(e),i}hc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ac({path:r,cc:!1});return i._c(),i}Pc(e){return this.ac({path:void 0,cc:!0})}Tc(e){return Kh(e,this.settings.methodName,this.settings.Ic||!1,this.path,this.settings.Ec)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}_c(){if(this.path)for(let e=0;e<this.path.length;e++)this.lc(this.path.get(e))}lc(e){if(e.length===0)throw this.Tc("Document fields must not be empty");if(yR(this.oc)&&O2.test(e))throw this.Tc('Document fields cannot begin and end with "__"')}},g_=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||rc(e)}dc(e,t,r,i=!1){return new Wh({oc:e,methodName:t,Ec:r,path:Ue.emptyPath(),cc:!1,Ic:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function $i(n){let e=n._freezeSettings(),t=rc(n._databaseId);return new g_(n._databaseId,!!e.ignoreUndefinedProperties,t)}function df(n,e,t,r,i,o={}){let s=n.dc(o.merge||o.mergeFields?2:0,e,t,i);gw("Data must be an object, but it was:",s,r);let a=wR(r,s),c,l;if(o.merge)c=new Vt(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){let h=[];for(let p of o.mergeFields){let m=w_(e,p,t);if(!s.contains(m))throw new P(R.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);IR(h,m)||h.push(m)}c=new Vt(h),l=s.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,l=s.fieldTransforms;return new p_(new pt(a),c,l)}var Yu=class n extends tr{_toFieldTransform(e){if(e.oc!==2)throw e.oc===1?e.Tc(`${this._methodName}() can only appear at the top level of your update data`):e.Tc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function vR(n,e,t){return new Wh({oc:3,Ec:e.settings.Ec,methodName:n._methodName,cc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var m_=class n extends tr{_toFieldTransform(e){return new ki(e.path,new kr)}isEqual(e){return e instanceof n}},y_=class n extends tr{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){let t=vR(this,e,!0),r=this.Ac.map(o=>Hi(o,t)),i=new Xn(r);return new ki(e.path,i)}isEqual(e){return e instanceof n&&bc(this.Ac,e.Ac)}},v_=class n extends tr{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){let t=vR(this,e,!0),r=this.Ac.map(o=>Hi(o,t)),i=new er(r);return new ki(e.path,i)}isEqual(e){return e instanceof n&&bc(this.Ac,e.Ac)}},__=class n extends tr{constructor(e,t){super(e),this.Rc=t}_toFieldTransform(e){let t=new Or(e.serializer,X0(e.serializer,this.Rc));return new ki(e.path,t)}isEqual(e){return e instanceof n&&this.Rc===e.Rc}};function fw(n,e,t,r){let i=n.dc(1,e,t);gw("Data must be an object, but it was:",i,r);let o=[],s=pt.empty();$r(r,(c,l)=>{let h=mw(e,c,t);l=xe(l);let p=i.hc(h);if(l instanceof Yu)o.push(h);else{let m=Hi(l,p);m!=null&&(o.push(h),s.set(h,m))}});let a=new Vt(o);return new Gh(s,a,i.fieldTransforms)}function pw(n,e,t,r,i,o){let s=n.dc(1,e,t),a=[w_(e,r,t)],c=[i];if(o.length%2!=0)throw new P(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<o.length;m+=2)a.push(w_(e,o[m])),c.push(o[m+1]);let l=[],h=pt.empty();for(let m=a.length-1;m>=0;--m)if(!IR(l,a[m])){let y=a[m],T=c[m];T=xe(T);let A=s.hc(y);if(T instanceof Yu)l.push(y);else{let N=Hi(T,A);N!=null&&(l.push(y),h.set(y,N))}}let p=new Vt(l);return new Gh(h,p,s.fieldTransforms)}function _R(n,e,t,r=!1){return Hi(t,n.dc(r?4:3,e))}function Hi(n,e){if(ER(n=xe(n)))return gw("Unsupported field value:",e,n),wR(n,e);if(n instanceof tr)return function(r,i){if(!yR(i.oc))throw i.Tc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Tc(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.cc&&e.oc!==4)throw e.Tc("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let c=Hi(a,i.Pc(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=xe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return X0(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=ke.fromDate(r);return{timestampValue:vs(i.serializer,o)}}if(r instanceof ke){let o=new ke(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:vs(i.serializer,o)}}if(r instanceof ji)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Rn)return{bytesValue:uA(i.serializer,r._byteString)};if(r instanceof be){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Tc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:U_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Qu)return function(s,a){return{mapValue:{fields:{[O_]:{stringValue:F_},[fs]:{arrayValue:{values:s.toArray().map(l=>{if(typeof l!="number")throw a.Tc("VectorValues must only contain numeric values.");return B_(a.serializer,l)})}}}}}}(r,i);throw i.Tc(`Unsupported field value: ${lf(r)}`)}(n,e)}function wR(n,e){let t={};return M0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$r(n,(r,i)=>{let o=Hi(i,e.uc(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function ER(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ke||n instanceof ji||n instanceof Rn||n instanceof be||n instanceof tr||n instanceof Qu)}function gw(n,e,t){if(!ER(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=lf(t);throw r==="an object"?e.Tc(n+" a custom object"):e.Tc(n+" "+r)}}function w_(n,e,t){if((e=xe(e))instanceof cn)return e._internalPath;if(typeof e=="string")return mw(n,e);throw Kh("Field path arguments must be of type string or ",n,!1,void 0,t)}var F2=new RegExp("[~\\*/\\[\\]]");function mw(n,e,t){if(e.search(F2)>=0)throw Kh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new cn(...e.split("."))._internalPath}catch{throw Kh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Kh(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new P(R.INVALID_ARGUMENT,a+n+c)}function IR(n,e){return n.some(t=>t.isEqual(e))}var Bi=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new be(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new E_(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(hf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},E_=class extends Bi{data(){return super.data()}};function hf(n,e){return typeof e=="string"?mw(n,e):e instanceof cn?e._internalPath:e._delegate._internalPath}function DR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new P(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Zu=class{},Ui=class extends Zu{};function ir(n,e,...t){let r=[];e instanceof Zu&&r.push(e),r=r.concat(t),function(o){let s=o.filter(c=>c instanceof I_).length,a=o.filter(c=>c instanceof Qh).length;if(s>1||s>0&&a>0)throw new P(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Qh=class n extends Ui{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return PR(e._query,t),new it(e.firestore,e.converter,Yy(e._query,t))}_parse(e){let t=$i(e.firestore);return function(o,s,a,c,l,h,p){let m;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new P(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){d0(p,h);let T=[];for(let A of p)T.push(l0(c,o,A));m={arrayValue:{values:T}}}else m=l0(c,o,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||d0(p,h),m=_R(a,s,p,h==="in"||h==="not-in");return de.create(l,h,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function TR(n,e,t){let r=e,i=hf("where",n);return Qh._create(i,r,t)}var I_=class n extends Zu{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:we.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let c of a)PR(s,c),s=Yy(s,c)}(e._query,t),new it(e.firestore,e.converter,Yy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var D_=class n extends Ui{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new P(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new P(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ni(o,s)}(e._query,this._field,this._direction);return new it(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new sn(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function CR(n,e="asc"){let t=e,r=hf("orderBy",n);return D_._create(r,t)}var Yh=class n extends Ui{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new it(e.firestore,e.converter,fh(e._query,this._limit,this._limitType))}};function bR(n){return nR("limit",n),Yh._create("limit",n,"F")}function SR(n){return nR("limitToLast",n),Yh._create("limitToLast",n,"L")}var Zh=class n extends Ui{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=NR(e,this.type,this._docOrFields,this._inclusive);return new it(e.firestore,e.converter,function(i,o){return new sn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}};function AR(...n){return Zh._create("startAt",n,!0)}function RR(...n){return Zh._create("startAfter",n,!1)}var Jh=class n extends Ui{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=NR(e,this.type,this._docOrFields,this._inclusive);return new it(e.firestore,e.converter,function(i,o){return new sn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}};function MR(...n){return Jh._create("endBefore",n,!1)}function xR(...n){return Jh._create("endAt",n,!0)}function NR(n,e,t,r){if(t[0]=xe(t[0]),t[0]instanceof Bi)return function(o,s,a,c,l){if(!c)throw new P(R.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let h=[];for(let p of is(o))if(p.field.isKeyField())h.push(xi(s,c.key));else{let m=c.data.field(p.field);if(rf(m))throw new P(R.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let y=p.field.canonicalString();throw new P(R.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}h.push(m)}return new An(h,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=$i(n.firestore);return function(s,a,c,l,h,p){let m=s.explicitOrderBy;if(h.length>m.length)throw new P(R.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let y=[];for(let T=0;T<h.length;T++){let A=h[T];if(m[T].field.isKeyField()){if(typeof A!="string")throw new P(R.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof A}`);if(!V_(s)&&A.indexOf("/")!==-1)throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${A}' contains a slash.`);let N=s.path.child(pe.fromString(A));if(!B.isDocumentKey(N))throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);let V=new B(N);y.push(xi(a,V))}else{let N=_R(c,l,A);y.push(N)}}return new An(y,p)}(n._query,n.firestore._databaseId,i,e,t,r)}}function l0(n,e,t){if(typeof(t=xe(t))=="string"){if(t==="")throw new P(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!V_(e)&&t.indexOf("/")!==-1)throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(pe.fromString(t));if(!B.isDocumentKey(r))throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xi(n,new B(r))}if(t instanceof be)return xi(n,t._key);throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${lf(t)}.`)}function d0(n,e){if(!Array.isArray(n)||n.length===0)throw new P(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function PR(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new P(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var As=class{convertValue(e,t="none"){switch(Nr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Me(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Jn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw $(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return $r(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[fs].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>Me(s.doubleValue));return new Qu(o)}convertGeoPoint(e){return new ji(Me(e.latitude),Me(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=of(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Pu(e));default:return null}}convertTimestamp(e){let t=Zn(e);return new ke(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=pe.fromString(e);z(_A(r),9688,{name:e});let i=new xr(r.get(1),r.get(3)),o=new B(r.popFirst(5));return i.isEqual(t)||Be(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function ff(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var T_=class extends As{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new be(this.firestore,null,t)}};var Yn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},zt=class extends Bi{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Ar(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(hf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Ar=class extends zt{data(e={}){return super.data(e)}},ln=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Yn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Ar(this._firestore,this._userDataWriter,r.key,r,new Yn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new P(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let c=new Ar(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Yn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let c=new Ar(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Yn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,h=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:L2(a.type),doc:c,oldIndex:l,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function L2(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $(61501,{type:n})}}function yw(n,e){return n instanceof zt&&e instanceof zt?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof ln&&e instanceof ln&&n._firestore===e._firestore&&hw(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function kR(n){n=ge(n,be);let e=ge(n.firestore,Oe);return XA(ot(e),n._key).then(t=>Ew(e,n,t))}var nr=class extends As{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new be(this.firestore,null,t)}};function OR(n){n=ge(n,be);let e=ge(n.firestore,Oe),t=ot(e),r=new nr(e);return M2(t,n._key).then(i=>new zt(e,r,n._key,i,new Yn(i!==null&&i.hasLocalMutations,!0),n.converter))}function FR(n){n=ge(n,be);let e=ge(n.firestore,Oe);return XA(ot(e),n._key,{source:"server"}).then(t=>Ew(e,n,t))}function LR(n){n=ge(n,it);let e=ge(n.firestore,Oe),t=ot(e),r=new nr(e);return DR(n._query),eR(t,n._query).then(i=>new ln(e,r,n,i))}function VR(n){n=ge(n,it);let e=ge(n.firestore,Oe),t=ot(e),r=new nr(e);return x2(t,n._query).then(i=>new ln(e,r,n,i))}function jR(n){n=ge(n,it);let e=ge(n.firestore,Oe),t=ot(e),r=new nr(e);return eR(t,n._query,{source:"server"}).then(i=>new ln(e,r,n,i))}function vw(n,e,t){n=ge(n,be);let r=ge(n.firestore,Oe),i=ff(n.converter,e,t);return Os(r,[df($i(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Ve.none())])}function _w(n,e,t,...r){n=ge(n,be);let i=ge(n.firestore,Oe),o=$i(i),s;return s=typeof(e=xe(e))=="string"||e instanceof cn?pw(o,"updateDoc",n._key,e,t,r):fw(o,"updateDoc",n._key,e),Os(i,[s.toMutation(n._key,Ve.exists(!0))])}function BR(n){return Os(ge(n.firestore,Oe),[new Lr(n._key,Ve.none())])}function UR(n,e){let t=ge(n.firestore,Oe),r=oc(n),i=ff(n.converter,e);return Os(t,[df($i(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Ve.exists(!1))]).then(()=>r)}function ww(n,...e){var t,r,i;n=xe(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||h_(e[s])||(o=e[s],s++);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(h_(e[s])){let p=e[s];e[s]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[s+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[s+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,l,h;if(n instanceof be)l=ge(n.firestore,Oe),h=Ms(n._key.path),c={next:p=>{e[s]&&e[s](Ew(l,n,p))},error:e[s+1],complete:e[s+2]};else{let p=ge(n,it);l=ge(p.firestore,Oe),h=p._query;let m=new nr(l);c={next:y=>{e[s]&&e[s](new ln(l,m,p,y))},error:e[s+1],complete:e[s+2]},DR(n._query)}return function(m,y,T,A){let N=new bs(A),V=new Ku(y,N,T);return m.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return Q_(yield Ss(m),V)})),()=>{N.yu(),m.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return Y_(yield Ss(m),V)}))}}(ot(l),h,a,c)}function $R(n,e){return N2(ot(n=ge(n,Oe)),h_(e)?e:{next:e})}function Os(n,e){return function(r,i){let o=new Ze;return r.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return d2(yield aw(r),i,o)})),o.promise}(ot(n),e)}function Ew(n,e,t){let r=t.docs.get(e._key),i=new nr(n);return new zt(n,i,e._key,r,new Yn(t.hasPendingWrites,t.fromCache),e.converter)}var V2={maxAttempts:5};var Xh=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=$i(e)}set(e,t,r){this._verifyNotCommitted();let i=br(e,this._firestore),o=ff(i.converter,t,r),s=df(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,Ve.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let o=br(e,this._firestore),s;return s=typeof(t=xe(t))=="string"||t instanceof cn?pw(this._dataReader,"WriteBatch.update",o._key,t,r,i):fw(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,Ve.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=br(e,this._firestore);return this._mutations=this._mutations.concat(new Lr(t._key,Ve.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new P(R.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function br(n,e){if((n=xe(n)).firestore!==e)throw new P(R.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var C_=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=$i(e)}get(e){let t=br(e,this._firestore),r=new T_(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||i.length!==1)return $(24041);let o=i[0];if(o.isFoundDocument())return new Bi(this._firestore,r,o.key,o,t.converter);if(o.isNoDocument())return new Bi(this._firestore,r,t._key,null,t.converter);throw $(18433,{doc:o})})}set(e,t,r){let i=br(e,this._firestore),o=ff(i.converter,t,r),s=df(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,r);return this._transaction.set(i._key,s),this}update(e,t,r,...i){let o=br(e,this._firestore),s;return s=typeof(t=xe(t))=="string"||t instanceof cn?pw(this._dataReader,"Transaction.update",o._key,t,r,i):fw(this._dataReader,"Transaction.update",o._key,t),this._transaction.update(o._key,s),this}delete(e){let t=br(e,this._firestore);return this._transaction.delete(t._key),this}};var b_=class extends C_{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=br(e,this._firestore),r=new nr(this._firestore);return super.get(e).then(i=>new zt(this._firestore,r,t._key,i._document,new Yn(!1,!1),t.converter))}};function HR(n,e,t){n=ge(n,Oe);let r=Object.assign(Object.assign({},V2),t);return function(o){if(o.maxAttempts<1)throw new P(R.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,s,a){let c=new Ze;return o.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){let l=yield S2(o);new l_(o.asyncQueue,l,a,s,c).Nu()})),c.promise}(ot(n),i=>e(new b_(n,i)),r)}function qR(){return new Yu("deleteField")}function zR(){return new m_("serverTimestamp")}function GR(...n){return new y_("arrayUnion",n)}function WR(...n){return new v_("arrayRemove",n)}function KR(n){return new __("increment",n)}(function(e,t=!0){(function(i){Rs=i})($E),oa(new Qr("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new Oe(new Dy(r.getProvider("auth-internal")),new by(s,r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new P(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xr(l.options.projectId,h)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),cr(Zb,Jb,e),cr(Zb,Jb,"esm2017")})();var j2="@firebase/firestore-compat",B2="0.3.49";function Sw(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function QR(){if(typeof Uint8Array>"u")throw new P("unimplemented","Uint8Arrays are not available in this environment.")}function YR(){if(!x0())throw new P("unimplemented","Blobs are unavailable in Firestore in this environment.")}var pf=class n{constructor(e){this._delegate=e}static fromBase64String(e){return YR(),new n(Rn.fromBase64String(e))}static fromUint8Array(e){return QR(),new n(Rn.fromUint8Array(e))}toBase64(){return YR(),this._delegate.toBase64()}toUint8Array(){return QR(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Iw(n){return U2(n,["next","error","complete"])}function U2(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var Dw=class{enableIndexedDbPersistence(e,t){return uR(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return cR(e._delegate)}clearIndexedDbPersistence(e){return dR(e._delegate)}},gf=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof xr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&on("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){iR(this._delegate,e,t,r)}enableNetwork(){return fR(this._delegate)}disableNetwork(){return pR(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,cw("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return hR(this._delegate)}onSnapshotsInSync(e){return $R(this._delegate,e)}get app(){if(!this._appCompat)throw new P("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Vs(this,lw(this._delegate,e))}catch(t){throw Tt(t,"collection()","Firestore.collection()")}}doc(e){try{return new Mn(this,oc(this._delegate,e))}catch(t){throw Tt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Wi(this,oR(this._delegate,e))}catch(t){throw Tt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return HR(this._delegate,t=>e(new mf(this,t)))}batch(){return ot(this._delegate),new yf(new Xh(this._delegate,e=>Os(this._delegate,e)))}loadBundle(e){return gR(this._delegate,e)}namedQuery(e){return mR(this._delegate,e).then(t=>t?new Wi(this,t):null)}},Fs=class extends As{constructor(e){super(),this.firestore=e}convertBytes(e){return new pf(new Rn(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Mn.forKey(t,this.firestore,null)}};function $2(n){h0(n)}var mf=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Fs(e)}get(e){let t=qi(e);return this._delegate.get(t).then(r=>new zi(this._firestore,new zt(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=qi(e);return r?(Sw("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=qi(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=qi(e);return this._delegate.delete(t),this}},yf=class{constructor(e){this._delegate=e}set(e,t,r){let i=qi(e);return r?(Sw("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=qi(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=qi(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Ls=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Ar(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Gi(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let o=i.get(t);return o||(o=new n(e,new Fs(e),t),i.set(t,o)),o}};Ls.INSTANCES=new WeakMap;var Mn=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Fs(e)}static forPath(e,t,r){if(e.length%2!==0)throw new P("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new be(t._delegate,r,new B(e)))}static forKey(e,t,r){return new n(t,new be(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Vs(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Vs(this.firestore,lw(this._delegate,e))}catch(t){throw Tt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=xe(e),e instanceof be?dw(this._delegate,e):!1}set(e,t){t=Sw("DocumentReference.set",t);try{return t?vw(this._delegate,e,t):vw(this._delegate,e)}catch(r){throw Tt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?_w(this._delegate,e):_w(this._delegate,e,t,...r)}catch(i){throw Tt(i,"updateDoc()","DocumentReference.update()")}}delete(){return BR(this._delegate)}onSnapshot(...e){let t=ZR(e),r=JR(e,i=>new zi(this.firestore,new zt(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return ww(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=OR(this._delegate):e?.source==="server"?t=FR(this._delegate):t=kR(this._delegate),t.then(r=>new zi(this.firestore,new zt(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ls.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Tt(n,e,t){return n.message=n.message.replace(e,t),n}function ZR(n){for(let e of n)if(typeof e=="object"&&!Iw(e))return e;return{}}function JR(n,e){var t,r;let i;return Iw(n[0])?i=n[0]:Iw(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:o=>{i.next&&i.next(e(o))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var zi=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Mn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return yw(this._delegate,e._delegate)}},Gi=class extends zi{data(e){let t=this._delegate.data(e);return this._delegate._converter||p0(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Wi=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Fs(e)}where(e,t,r){try{return new n(this.firestore,ir(this._delegate,TR(e,t,r)))}catch(i){throw Tt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,ir(this._delegate,CR(e,t)))}catch(r){throw Tt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,ir(this._delegate,bR(e)))}catch(t){throw Tt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,ir(this._delegate,SR(e)))}catch(t){throw Tt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,ir(this._delegate,AR(...e)))}catch(t){throw Tt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,ir(this._delegate,RR(...e)))}catch(t){throw Tt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,ir(this._delegate,MR(...e)))}catch(t){throw Tt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,ir(this._delegate,xR(...e)))}catch(t){throw Tt(t,"endAt()","Query.endAt()")}}isEqual(e){return hw(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=VR(this._delegate):e?.source==="server"?t=jR(this._delegate):t=LR(this._delegate),t.then(r=>new sc(this.firestore,new ln(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=ZR(e),r=JR(e,i=>new sc(this.firestore,new ln(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return ww(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ls.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Tw=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Gi(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},sc=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Wi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Gi(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Tw(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Gi(this._firestore,r))})}isEqual(e){return yw(this._delegate,e._delegate)}},Vs=class n extends Wi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Mn(this.firestore,e):null}doc(e){try{return e===void 0?new Mn(this.firestore,oc(this._delegate)):new Mn(this.firestore,oc(this._delegate,e))}catch(t){throw Tt(t,"doc()","CollectionReference.doc()")}}add(e){return UR(this._delegate,e).then(t=>new Mn(this.firestore,t))}isEqual(e){return dw(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ls.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function qi(n){return ge(n,be)}var Cw=class n{constructor(...e){this._delegate=new cn(...e)}static documentId(){return new n(Ue.keyField().canonicalString())}isEqual(e){return e=xe(e),e instanceof cn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var bw=class n{static serverTimestamp(){let e=zR();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=qR();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=GR(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=WR(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=KR(e);return t._methodName="FieldValue.increment",new n(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}};var H2={Firestore:gf,GeoPoint:ji,Timestamp:ke,Blob:pf,Transaction:mf,WriteBatch:yf,DocumentReference:Mn,DocumentSnapshot:zi,Query:Wi,QueryDocumentSnapshot:Gi,QuerySnapshot:sc,CollectionReference:Vs,FieldPath:Cw,FieldValue:bw,setLogLevel:$2,CACHE_SIZE_UNLIMITED:sR};function q2(n,e){n.INTERNAL.registerComponent(new Qr("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},H2)))}function z2(n){q2(n,(e,t)=>new gf(e,t,new Dw)),n.registerVersion(j2,B2)}z2(Ct);function G2(n,e=ha){return new ce(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function XR(n,e){return G2(n,e)}function W2(n,e){return XR(n,e).pipe(ei(void 0),pa(),X(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function Mw(n,e){return XR(n,e).pipe(X(t=>({payload:t,type:"query"})))}var vf=class{ref;afs;injector=O(Ye);constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:o}=iM(r,t);return new wf(i,o,this.afs)}snapshotChanges(){return W2(this.ref,this.afs.schedulers.outsideAngular).pipe(It(this.injector))}valueChanges(e={}){return this.snapshotChanges().pipe(X(({payload:t})=>e.idField?Ee(q({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return _e(this.ref.get(e)).pipe(It(this.injector))}};function _f(n,e){return Mw(n,e).pipe(ei(void 0),pa(),X(t=>{let[r,i]=t,o=i.payload.docChanges(),s=o.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let l=o.find(p=>p.doc.ref.isEqual(a.ref)),h=r?.payload.docs.find(p=>p.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&h&&JSON.stringify(h.metadata)===JSON.stringify(a.metadata)||s.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),s}))}function eM(n,e,t){return _f(n,t).pipe(Xr((r,i)=>K2(r,i.map(o=>o.payload),e),[]),Tp(),X(r=>r.map(i=>({type:i.type,payload:i}))))}function K2(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=Q2(n,r))}),n}function Aw(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function Q2(n,e){switch(e.type){case"added":if(!n[e.newIndex]?.doc.ref.isEqual(e.doc.ref))return Aw(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return Aw(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]?.doc.ref.isEqual(e.doc.ref))return Aw(n,e.oldIndex,1);break}return n}function tM(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var wf=class{ref;query;afs;injector=O(Ye);constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=_f(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(X(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(ei(void 0),pa(),dt(([r,i])=>i.length>0||!r),X(([,r])=>r),It(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(Xr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=tM(e);return eM(this.query,t,this.afs.schedulers.outsideAngular).pipe(It(this.injector))}valueChanges(e={}){return Mw(this.query,this.afs.schedulers.outsideAngular).pipe(X(t=>t.payload.docs.map(r=>e.idField?Ee(q({},r.data()),{[e.idField]:r.id}):r.data())),It(this.injector))}get(e){return _e(this.query.get(e)).pipe(It(this.injector))}add(e){return this.ref.add(e)}doc(e){return new vf(this.ref.doc(e),this.afs)}},Rw=class{query;afs;injector=O(Ye);constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?_f(this.query,this.afs.schedulers.outsideAngular).pipe(It(this.injector)):_f(this.query,this.afs.schedulers.outsideAngular).pipe(X(t=>t.filter(r=>e.indexOf(r.type)>-1)),dt(t=>t.length>0),It(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(Xr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=tM(e);return eM(this.query,t,this.afs.schedulers.outsideAngular).pipe(It(this.injector))}valueChanges(e={}){return Mw(this.query,this.afs.schedulers.outsideAngular).pipe(X(r=>r.payload.docs.map(i=>e.idField?q({[e.idField]:i.id},i.data()):i.data())),It(this.injector))}get(e){return _e(this.query.get(e)).pipe(It(this.injector))}},nM=new G("angularfire2.enableFirestorePersistence"),rM=new G("angularfire2.firestore.persistenceSettings"),Y2=new G("angularfire2.firestore.settings"),Z2=new G("angularfire2.firestore.use-emulator");function iM(n,e=t=>t){return{query:e(n),ref:n}}var xw=(()=>{class n{schedulers;firestore;persistenceEnabled$;ngZone=O(Te);constructor(t,r,i,o,s,a,c,l,h,p,m,y,T,A,N,V,H){this.schedulers=c;let F=fu(t,a,r),Z=h;p&&ay(F,a,m,T,A,N,y,V),[this.firestore,this.persistenceEnabled$]=Od(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let te=a.runOutsideAngular(()=>F.firestore());if(o&&te.settings(o),Z&&te.useEmulator(...Z),i&&!mr(s)){let ne=()=>{try{return _e(te.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(E){return typeof console<"u"&&console.warn(E),Y(!1)}};return[te,a.runOutsideAngular(ne)]}else return[te,Y(!1)]},[o,Z,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:o,query:s}=iM(i,r),a=this.ngZone.run(()=>o);return new wf(a,s,this)}collectionGroup(t,r){let i=r||(s=>s),o=this.firestore.collectionGroup(t);return new Rw(i(o),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.ngZone.run(()=>r);return new vf(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(U($o),U(Ho,8),U(nM,8),U(Y2,8),U(Xt),U(Te),U(lu),U(rM,8),U(Z2,8),U(Kb,8),U(ty,8),U(ny,8),U(ry,8),U(iy,8),U(oy,8),U(sy,8),U(Uo,8))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),oM=(()=>{class n{constructor(){Ct.registerVersion("angularfire",Bo.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:nM,useValue:!0},{provide:rM,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Hn({type:n});static \u0275inj=Bn({providers:[xw]})}return n})();var sM=[];var aM={production:!1,firebaseConfig:{apiKey:"AIzaSyAYtj6yb97NevfWKPKMCM00tIffPfexTmY",authDomain:"study-platform-4a2ba.firebaseapp.com",projectId:"study-platform-4a2ba",storageBucket:"study-platform-4a2ba.firebasestorage.app",messagingSenderId:"685861735336",appId:"1:685861735336:web:2fe57826d8b92d1355ab9d",measurementId:"G-7J8J9NJTFX"}};var uM={providers:[Wm(sM),Dg([oM,Wb.initializeApp(aM.firebaseConfig)])]};function J2(n,e){if(n&1&&(Oa(0,"div"),sm(1),Fa(),So(2,"br")),n&2){let t=e.$implicit;Wg(),am(" ",t.name," ",t.subjectType," ")}}var cM=(()=>{class n{constructor(){this._client=O(xw),this.subjects$=this.getSubjects()}getSubjects(){return this._client.collection("subjects").valueChanges()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Ql({type:n,selectors:[["app-root"]],decls:6,vars:2,template:function(r,i){r&1&&(So(0,"router-outlet"),Oa(1,"div"),sm(2,"Hello"),Fa(),vC(3,J2,3,2,null,null,yC),wC(5,"async")),r&2&&(Wg(3),_C(EC(5,0,i.subjects$)))},dependencies:[su,Xl,fm],encapsulation:2})}}return n})();Dm(cM,uM).catch(n=>console.error(n));
