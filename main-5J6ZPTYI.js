import{a as z,b as Se,c as Rh,d as N,e as hw,f as Uu,g as fw,h as pw,i as gw,j as Mh,k as mw,l as ks,m as Nh,n as $u,o as yw,p as vw,q as Ph,r as Re,s as Fr,t as sn,u as Hu,v as Os,w as _w,x as ww,y as er,z as wt}from"./chunk-4ZHOUZTK.js";var Oh=null;var kh=1,Iw=Symbol("SIGNAL");function pe(n){let e=Oh;return Oh=n,e}function Ew(){return Oh}var Fh={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function DA(n){if(!(Uh(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===kh)){if(!n.producerMustRecompute(n)&&!Vh(n)){n.dirty=!1,n.lastCleanEpoch=kh;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=kh}}function Lh(n){return n&&(n.nextProducerIndex=0),pe(n)}function Dw(n,e){if(pe(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Uh(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Bh(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Vh(n){$h(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(DA(t),r!==t.version))return!0}return!1}function jh(n){if($h(n),Uh(n))for(let e=0;e<n.producerNode.length;e++)Bh(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Bh(n,e){if(TA(n),n.liveConsumerNode.length===1&&CA(n))for(let r=0;r<n.producerNode.length;r++)Bh(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];$h(i),i.producerIndexOfThis[r]=e}}function Uh(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function $h(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function TA(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function CA(n){return n.producerNode!==void 0}function bA(){throw new Error}var SA=bA;function Tw(n){SA=n}function te(n){return typeof n=="function"}function Fi(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var qu=Fi(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Lr(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Oe=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(te(r))try{r()}catch(o){e=o instanceof qu?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{Cw(o)}catch(s){e=e??[],s instanceof qu?e=[...e,...s.errors]:e.push(s)}}if(e)throw new qu(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Cw(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Lr(t,e)}remove(e){let{_finalizers:t}=this;t&&Lr(t,e),e instanceof n&&e._removeParent(this)}};Oe.EMPTY=(()=>{let n=new Oe;return n.closed=!0,n})();var Hh=Oe.EMPTY;function zu(n){return n instanceof Oe||n&&"closed"in n&&te(n.remove)&&te(n.add)&&te(n.unsubscribe)}function Cw(n){te(n)?n():n.unsubscribe()}var zt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Li={setTimeout(n,e,...t){let{delegate:r}=Li;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Li;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Gu(n){Li.setTimeout(()=>{let{onUnhandledError:e}=zt;if(e)e(n);else throw n})}function Fs(){}var bw=qh("C",void 0,void 0);function Sw(n){return qh("E",void 0,n)}function Aw(n){return qh("N",n,void 0)}function qh(n,e,t){return{kind:n,value:e,error:t}}var Vr=null;function Vi(n){if(zt.useDeprecatedSynchronousErrorHandling){let e=!Vr;if(e&&(Vr={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Vr;if(Vr=null,t)throw r}}else n()}function xw(n){zt.useDeprecatedSynchronousErrorHandling&&Vr&&(Vr.errorThrown=!0,Vr.error=n)}var jr=class extends Oe{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,zu(e)&&e.add(this)):this.destination=RA}static create(e,t,r){return new Cn(e,t,r)}next(e){this.isStopped?Gh(Aw(e),this):this._next(e)}error(e){this.isStopped?Gh(Sw(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Gh(bw,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},AA=Function.prototype.bind;function zh(n,e){return AA.call(n,e)}var Wh=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Wu(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Wu(r)}else Wu(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Wu(t)}}},Cn=class extends jr{constructor(e,t,r){super();let i;if(te(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&zt.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&zh(e.next,o),error:e.error&&zh(e.error,o),complete:e.complete&&zh(e.complete,o)}):i=e}this.destination=new Wh(i)}};function Wu(n){zt.useDeprecatedSynchronousErrorHandling?xw(n):Gu(n)}function xA(n){throw n}function Gh(n,e){let{onStoppedNotification:t}=zt;t&&Li.setTimeout(()=>t(n,e))}var RA={closed:!0,next:Fs,error:xA,complete:Fs};var ji=typeof Symbol=="function"&&Symbol.observable||"@@observable";function ht(n){return n}function Kh(...n){return Qh(n)}function Qh(n){return n.length===0?ht:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var de=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=NA(t)?t:new Cn(t,r,i);return Vi(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=Rw(r),new r((i,o)=>{let s=new Cn({next:a=>{try{t(a)}catch(u){o(u),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[ji](){return this}pipe(...t){return Qh(t)(this)}toPromise(t){return t=Rw(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function Rw(n){var e;return(e=n??zt.Promise)!==null&&e!==void 0?e:Promise}function MA(n){return n&&te(n.next)&&te(n.error)&&te(n.complete)}function NA(n){return n&&n instanceof jr||MA(n)&&zu(n)}function Yh(n){return te(n?.lift)}function se(n){return e=>{if(Yh(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ce(n,e,t,r,i){return new Zh(n,e,t,r,i)}var Zh=class extends jr{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Bi(){return se((n,e)=>{let t=null;n._refCount++;let r=ce(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Ui=class extends de{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Yh(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Oe;let t=this.getSubject();e.add(this.source.subscribe(ce(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Oe.EMPTY)}return e}refCount(){return Bi()(this)}};var Mw=Fi(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Le=(()=>{class n extends de{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Ku(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new Mw}next(t){Vi(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Vi(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Vi(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?Hh:(this.currentObservers=null,o.push(t),new Oe(()=>{this.currentObservers=null,Lr(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new de;return t.source=this,t}}return n.create=(e,t)=>new Ku(e,t),n})(),Ku=class extends Le{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Hh}};var Xe=class extends Le{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Ls={now(){return(Ls.delegate||Date).now()},delegate:void 0};var Qu=class extends Le{constructor(e=1/0,t=1/0,r=Ls){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let u=1;u<r.length&&r[u]<=s;u+=2)a=u;a&&r.splice(0,a+1)}}};var Yu=class extends Oe{constructor(e,t){super()}schedule(e,t=0){return this}};var Vs={setInterval(n,e,...t){let{delegate:r}=Vs;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Vs;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var $i=class extends Yu{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return Vs.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Vs.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Lr(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Hi=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Hi.now=Ls.now;var qi=class extends Hi{constructor(e,t=Hi.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var js=new qi($i);var Zu=class extends $i{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var Ju=class extends qi{};var Jh=new Ju(Zu);var ft=new de(n=>n.complete());function Nw(n){return n&&te(n.schedule)}function Xh(n){return n[n.length-1]}function Pw(n){return te(Xh(n))?n.pop():void 0}function an(n){return Nw(Xh(n))?n.pop():void 0}function kw(n,e){return typeof Xh(n)=="number"?n.pop():e}var Xu=n=>n&&typeof n.length=="number"&&typeof n!="function";function ec(n){return te(n?.then)}function tc(n){return te(n[ji])}function nc(n){return Symbol.asyncIterator&&te(n?.[Symbol.asyncIterator])}function rc(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function PA(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ic=PA();function oc(n){return te(n?.[ic])}function sc(n){return fw(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Uu(t.read());if(i)return yield Uu(void 0);yield yield Uu(r)}}finally{t.releaseLock()}})}function ac(n){return te(n?.getReader)}function Me(n){if(n instanceof de)return n;if(n!=null){if(tc(n))return kA(n);if(Xu(n))return OA(n);if(ec(n))return FA(n);if(nc(n))return Ow(n);if(oc(n))return LA(n);if(ac(n))return VA(n)}throw rc(n)}function kA(n){return new de(e=>{let t=n[ji]();if(te(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function OA(n){return new de(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function FA(n){return new de(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Gu)})}function LA(n){return new de(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function Ow(n){return new de(e=>{jA(n,e).catch(t=>e.error(t))})}function VA(n){return Ow(sc(n))}function jA(n,e){var t,r,i,o;return hw(this,void 0,void 0,function*(){try{for(t=pw(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function It(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function Mt(n,e=0){return se((t,r)=>{t.subscribe(ce(r,i=>It(r,n,()=>r.next(i),e),()=>It(r,n,()=>r.complete(),e),i=>It(r,n,()=>r.error(i),e)))})}function Gt(n,e=0){return se((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function Fw(n,e){return Me(n).pipe(Gt(e),Mt(e))}function Lw(n,e){return Me(n).pipe(Gt(e),Mt(e))}function Vw(n,e){return new de(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function jw(n,e){return new de(t=>{let r;return It(t,e,()=>{r=n[ic](),It(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>te(r?.return)&&r.return()})}function uc(n,e){if(!n)throw new Error("Iterable cannot be null");return new de(t=>{It(t,e,()=>{let r=n[Symbol.asyncIterator]();It(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function Bw(n,e){return uc(sc(n),e)}function Uw(n,e){if(n!=null){if(tc(n))return Fw(n,e);if(Xu(n))return Vw(n,e);if(ec(n))return Lw(n,e);if(nc(n))return uc(n,e);if(oc(n))return jw(n,e);if(ac(n))return Bw(n,e)}throw rc(n)}function _e(n,e){return e?Uw(n,e):Me(n)}function Y(...n){let e=an(n);return _e(n,e)}function zi(n,e){let t=te(n)?n:()=>n,r=i=>i.error(t());return new de(e?i=>e.schedule(r,0,i):r)}function ef(n){return!!n&&(n instanceof de||te(n.lift)&&te(n.subscribe))}var bn=Fi(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Z(n,e){return se((t,r)=>{let i=0;t.subscribe(ce(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:BA}=Array;function UA(n,e){return BA(e)?n(...e):n(e)}function $w(n){return Z(e=>UA(n,e))}var{isArray:$A}=Array,{getPrototypeOf:HA,prototype:qA,keys:zA}=Object;function Hw(n){if(n.length===1){let e=n[0];if($A(e))return{args:e,keys:null};if(GA(e)){let t=zA(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function GA(n){return n&&typeof n=="object"&&HA(n)===qA}function qw(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function cc(...n){let e=an(n),t=Pw(n),{args:r,keys:i}=Hw(n);if(r.length===0)return _e([],e);let o=new de(WA(r,e,i?s=>qw(i,s):ht));return t?o.pipe($w(t)):o}function WA(n,e,t=ht){return r=>{zw(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let u=0;u<i;u++)zw(e,()=>{let l=_e(n[u],e),h=!1;l.subscribe(ce(r,p=>{o[u]=p,h||(h=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function zw(n,e,t){n?It(t,n,e):e()}function Gw(n,e,t,r,i,o,s,a){let u=[],l=0,h=0,p=!1,m=()=>{p&&!u.length&&!l&&e.complete()},y=A=>l<r?C(A):u.push(A),C=A=>{o&&e.next(A),l++;let M=!1;Me(t(A,h++)).subscribe(ce(e,O=>{i?.(O),o?y(O):e.next(O)},()=>{M=!0},void 0,()=>{if(M)try{for(l--;u.length&&l<r;){let O=u.shift();s?It(e,s,()=>C(O)):C(O)}m()}catch(O){e.error(O)}}))};return n.subscribe(ce(e,y,()=>{p=!0,m()})),()=>{a?.()}}function We(n,e,t=1/0){return te(e)?We((r,i)=>Z((o,s)=>e(r,o,i,s))(Me(n(r,i))),t):(typeof e=="number"&&(t=e),se((r,i)=>Gw(r,i,n,t)))}function Bs(n=1/0){return We(ht,n)}function Ww(){return Bs(1)}function Gi(...n){return Ww()(_e(n,an(n)))}function lc(n){return new de(e=>{Me(n()).subscribe(e)})}function tf(...n){let e=an(n),t=kw(n,1/0),r=n;return r.length?r.length===1?Me(r[0]):Bs(t)(_e(r,e)):ft}function at(n,e){return se((t,r)=>{let i=0;t.subscribe(ce(r,o=>n.call(e,o,i++)&&r.next(o)))})}function tr(n){return se((e,t)=>{let r=null,i=!1,o;r=e.subscribe(ce(t,void 0,void 0,s=>{o=Me(n(s,tr(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function Kw(n,e,t,r,i){return(o,s)=>{let a=t,u=e,l=0;o.subscribe(ce(s,h=>{let p=l++;u=a?n(u,h,p):(a=!0,h),r&&s.next(u)},i&&(()=>{a&&s.next(u),s.complete()})))}}function Wi(n,e){return te(e)?We(n,e,1):We(n,1)}function nr(n){return se((e,t)=>{let r=!1;e.subscribe(ce(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Sn(n){return n<=0?()=>ft:se((e,t)=>{let r=0;e.subscribe(ce(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function nf(n){return Z(()=>n)}function rf(n,e=ht){return n=n??KA,se((t,r)=>{let i,o=!0;t.subscribe(ce(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function KA(n,e){return n===e}function dc(n=QA){return se((e,t)=>{let r=!1;e.subscribe(ce(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function QA(){return new bn}function Us(n){return se((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Nt(n,e){let t=arguments.length>=2;return r=>r.pipe(n?at((i,o)=>n(i,o,r)):ht,Sn(1),t?nr(e):dc(()=>new bn))}function Ki(n){return n<=0?()=>ft:se((e,t)=>{let r=[];e.subscribe(ce(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function of(n,e){let t=arguments.length>=2;return r=>r.pipe(n?at((i,o)=>n(i,o,r)):ht,Ki(1),t?nr(e):dc(()=>new bn))}function $s(){return se((n,e)=>{let t,r=!1;n.subscribe(ce(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function Br(n,e){return se(Kw(n,e,arguments.length>=2,!0))}function Qw(n={}){let{connector:e=()=>new Le,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return o=>{let s,a,u,l=0,h=!1,p=!1,m=()=>{a?.unsubscribe(),a=void 0},y=()=>{m(),s=u=void 0,h=p=!1},C=()=>{let A=s;y(),A?.unsubscribe()};return se((A,M)=>{l++,!p&&!h&&m();let O=u=u??e();M.add(()=>{l--,l===0&&!p&&!h&&(a=sf(C,i))}),O.subscribe(M),!s&&l>0&&(s=new Cn({next:B=>O.next(B),error:B=>{p=!0,m(),a=sf(y,t,B),O.error(B)},complete:()=>{h=!0,m(),a=sf(y,r),O.complete()}}),Me(A).subscribe(s))})(o)}}function sf(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new Cn({next:()=>{r.unsubscribe(),n()}});return Me(e(...t)).subscribe(r)}function hc(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,Qw({connector:()=>new Qu(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Ur(...n){let e=an(n);return se((t,r)=>{(e?Gi(n,t,e):Gi(n,t)).subscribe(r)})}function Ve(n,e){return se((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(ce(r,u=>{i?.unsubscribe();let l=0,h=o++;Me(n(u,h)).subscribe(i=ce(r,p=>r.next(e?e(u,p,h,l++):p),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function fc(n,e){return te(e)?Ve(()=>n,e):Ve(()=>n)}function af(n){return se((e,t)=>{Me(n).subscribe(ce(t,()=>t.complete(),Fs)),!t.closed&&e.subscribe(t)})}function Ke(n,e,t){let r=te(n)||e||t?{next:n,error:e,complete:t}:n;return r?se((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(ce(o,u=>{var l;(l=r.next)===null||l===void 0||l.call(r,u),o.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),o.complete()},u=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,u),o.error(u)},()=>{var u,l;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):ht}var ee=class extends Error{constructor(e,t){super(np(e,t)),this.code=e}};function np(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function ra(n){return{toString:n}.toString()}var pc="__parameters__";function YA(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function ZA(n,e,t){return ra(()=>{let r=YA(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(u,l,h){let p=u.hasOwnProperty(pc)?u[pc]:Object.defineProperty(u,pc,{value:[]})[pc];for(;p.length<=h;)p.push(null);return(p[h]=p[h]||[]).push(s),u}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}function De(n){for(let e in n)if(n[e]===De)return e;throw Error("Could not find renamed property on target object.")}function bt(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(bt).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function Yw(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var JA=De({__forward_ref__:De});function NI(n){return n.__forward_ref__=NI,n.toString=function(){return bt(this())},n}function Pt(n){return PI(n)?n():n}function PI(n){return typeof n=="function"&&n.hasOwnProperty(JA)&&n.__forward_ref__===NI}function J(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Mn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Hc(n){return Zw(n,OI)||Zw(n,FI)}function kI(n){return Hc(n)!==null}function Zw(n,e){return n.hasOwnProperty(e)?n[e]:null}function XA(n){let e=n&&(n[OI]||n[FI]);return e||null}function Jw(n){return n&&(n.hasOwnProperty(Xw)||n.hasOwnProperty(ex))?n[Xw]:null}var OI=De({\u0275prov:De}),Xw=De({\u0275inj:De}),FI=De({ngInjectableDef:De}),ex=De({ngInjectorDef:De}),Q=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=J({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function LI(n){return n&&!!n.\u0275providers}var tx=De({\u0275cmp:De}),nx=De({\u0275dir:De}),rx=De({\u0275pipe:De}),ix=De({\u0275mod:De}),Ic=De({\u0275fac:De}),zs=De({__NG_ELEMENT_ID__:De}),eI=De({__NG_ENV_ID__:De});function yf(n){return typeof n=="string"?n:n==null?"":String(n)}function ox(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():yf(n)}function sx(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ee(-200,n)}function rp(n,e){throw new ee(-201,!1)}var ae=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ae||{}),vf;function VI(){return vf}function Et(n){let e=vf;return vf=n,e}function jI(n,e,t){let r=Hc(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ae.Optional)return null;if(e!==void 0)return e;rp(n,"Injector")}var ax={},Gs=ax,_f="__NG_DI_FLAG__",Ec="ngTempTokenPath",ux="ngTokenPath",cx=/\n/gm,lx="\u0275",tI="__source",Ji;function dx(){return Ji}function rr(n){let e=Ji;return Ji=n,e}function hx(n,e=ae.Default){if(Ji===void 0)throw new ee(-203,!1);return Ji===null?jI(n,void 0,e):Ji.get(n,e&ae.Optional?null:void 0,e)}function $(n,e=ae.Default){return(VI()||hx)(Pt(n),e)}function U(n,e=ae.Default){return $(n,qc(e))}function qc(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function wf(n){let e=[];for(let t=0;t<n.length;t++){let r=Pt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new ee(900,!1);let i,o=ae.Default;for(let s=0;s<r.length;s++){let a=r[s],u=px(a);typeof u=="number"?u===-1?i=a.token:o|=u:i=a}e.push($(i,o))}else e.push($(r))}return e}function fx(n,e){return n[_f]=e,n.prototype[_f]=e,n}function px(n){return n[_f]}function gx(n,e,t,r){let i=n[Ec];throw e[tI]&&i.unshift(e[tI]),n.message=mx(`
`+n.message,i,t,r),n[ux]=i,n[Ec]=null,n}function mx(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==lx?n.slice(2):n;let i=bt(e);if(Array.isArray(e))i=e.map(bt).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):bt(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(cx,`
  `)}`}var zc=fx(ZA("Optional"),8);function qr(n,e){let t=n.hasOwnProperty(Ic);return t?n[Ic]:null}function ip(n,e){n.forEach(t=>Array.isArray(t)?ip(t,e):e(t))}function BI(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Dc(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var Ws={},un=[],eo=new Q(""),UI=new Q("",-1),$I=new Q(""),Tc=class{get(e,t=Gs){if(t===Gs){let r=new Error(`NullInjectorError: No provider for ${bt(e)}!`);throw r.name="NullInjectorError",r}return t}},HI=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(HI||{}),ln=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(ln||{}),sr=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(sr||{});function yx(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}function If(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];_x(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function vx(n){return n===3||n===4||n===6}function _x(n){return n.charCodeAt(0)===64}function op(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?nI(n,t,i,null,e[++r]):nI(n,t,i,null,null))}}return n}function nI(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[o+1]=i);return}else if(r===n[o+1]){n[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r),i!==null&&n.splice(o++,0,i)}var qI="ng-template";function wx(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&yx(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(sp(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function sp(n){return n.type===4&&n.value!==qI}function Ix(n,e,t){let r=n.type===4&&!t?qI:n.value;return e===r}function Ex(n,e,t){let r=4,i=n.attrs,o=i!==null?Cx(i):0,s=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!s&&!Wt(r)&&!Wt(u))return!1;if(s&&Wt(u))continue;s=!1,r=u|r&1;continue}if(!s)if(r&4){if(r=2|r&1,u!==""&&!Ix(n,u,t)||u===""&&e.length===1){if(Wt(r))return!1;s=!0}}else if(r&8){if(i===null||!wx(n,i,u,t)){if(Wt(r))return!1;s=!0}}else{let l=e[++a],h=Dx(u,i,sp(n),t);if(h===-1){if(Wt(r))return!1;s=!0;continue}if(l!==""){let p;if(h>o?p="":p=i[h+1].toLowerCase(),r&2&&l!==p){if(Wt(r))return!1;s=!0}}}}return Wt(r)||s}function Wt(n){return(n&1)===0}function Dx(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return bx(e,n)}function Tx(n,e,t=!1){for(let r=0;r<e.length;r++)if(Ex(n,e[r],t))return!0;return!1}function Cx(n){for(let e=0;e<n.length;e++){let t=n[e];if(vx(t))return e}return n.length}function bx(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function rI(n,e){return n?":not("+e.trim()+")":e}function Sx(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Wt(s)&&(e+=rI(o,i),i=""),r=s,o=o||!Wt(r);t++}return i!==""&&(e+=rI(o,i)),e}function Ax(n){return n.map(Sx).join(",")}function xx(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Wt(i))break;i=o}r++}return{attrs:e,classes:t}}function Gc(n){return ra(()=>{let e=YI(n),t=Se(z({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===HI.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||ln.Emulated,styles:n.styles||un,_:null,schemas:n.schemas||null,tView:null,id:""});ZI(t);let r=n.dependencies;return t.directiveDefs=oI(r,!1),t.pipeDefs=oI(r,!0),t.id=Nx(t),t})}function Rx(n){return zr(n)||GI(n)}function Mx(n){return n!==null}function Nn(n){return ra(()=>({type:n.type,bootstrap:n.bootstrap||un,declarations:n.declarations||un,imports:n.imports||un,exports:n.exports||un,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function iI(n,e){if(n==null)return Ws;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a=sr.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(t[o]=a!==sr.None?[r,a]:r,e[o]=s):t[o]=r}return t}function ap(n){return ra(()=>{let e=YI(n);return ZI(e),e})}function zI(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function zr(n){return n[tx]||null}function GI(n){return n[nx]||null}function WI(n){return n[rx]||null}function KI(n){let e=zr(n)||GI(n)||WI(n);return e!==null?e.standalone:!1}function QI(n,e){let t=n[ix]||null;if(!t&&e===!0)throw new Error(`Type ${bt(n)} does not have '\u0275mod' property.`);return t}function YI(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Ws,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||un,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:iI(n.inputs,e),outputs:iI(n.outputs),debugInfo:null}}function ZI(n){n.features?.forEach(e=>e(n))}function oI(n,e){if(!n)return null;let t=e?WI:Rx;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(Mx)}function Nx(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function up(n){return{\u0275providers:n}}function cp(...n){return{\u0275providers:JI(!0,n),\u0275fromNgModule:!0}}function JI(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return ip(e,s=>{let a=s;Ef(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&XI(i,o),t}function XI(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];lp(i,o=>{e(o,r)})}}function Ef(n,e,t,r){if(n=Pt(n),!n)return!1;let i=null,o=Jw(n),s=!o&&zr(n);if(!o&&!s){let u=n.ngModule;if(o=Jw(u),o)i=u;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let u=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of u)Ef(l,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let l;try{ip(o.imports,h=>{Ef(h,e,t,r)&&(l||=[],l.push(h))})}finally{}l!==void 0&&XI(l,e)}if(!a){let l=qr(i)||(()=>new i);e({provide:i,useFactory:l,deps:un},i),e({provide:$I,useValue:i,multi:!0},i),e({provide:eo,useValue:()=>$(i),multi:!0},i)}let u=o.providers;if(u!=null&&!a){let l=n;lp(u,h=>{e(h,l)})}}else return!1;return i!==n&&n.providers!==void 0}function lp(n,e){for(let t of n)LI(t)&&(t=t.\u0275providers),Array.isArray(t)?lp(t,e):e(t)}var Px=De({provide:String,useValue:De});function eE(n){return n!==null&&typeof n=="object"&&Px in n}function kx(n){return!!(n&&n.useExisting)}function Ox(n){return!!(n&&n.useFactory)}function Df(n){return typeof n=="function"}var Wc=new Q(""),mc={},Fx={},uf;function dp(){return uf===void 0&&(uf=new Tc),uf}var Ft=class{},Ks=class extends Ft{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Cf(e,s=>this.processProvider(s)),this.records.set(UI,Qi(void 0,this)),i.has("environment")&&this.records.set(Ft,Qi(void 0,this));let o=this.records.get(Wc);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get($I,un,ae.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=pe(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),pe(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=rr(this),r=Et(void 0),i;try{return e()}finally{rr(t),Et(r)}}get(e,t=Gs,r=ae.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(eI))return e[eI](this);r=qc(r);let i,o=rr(this),s=Et(void 0);try{if(!(r&ae.SkipSelf)){let u=this.records.get(e);if(u===void 0){let l=$x(e)&&Hc(e);l&&this.injectableDefInScope(l)?u=Qi(Tf(e),mc):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&ae.Self?dp():this.parent;return t=r&ae.Optional&&t===Gs?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Ec]=a[Ec]||[]).unshift(bt(e)),o)throw a;return gx(a,e,"R3InjectorError",this.source)}else throw a}finally{Et(s),rr(o)}}resolveInjectorInitializers(){let e=pe(null),t=rr(this),r=Et(void 0),i;try{let o=this.get(eo,un,ae.Self);for(let s of o)s()}finally{rr(t),Et(r),pe(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(bt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ee(205,!1)}processProvider(e){e=Pt(e);let t=Df(e)?e:Pt(e&&e.provide),r=Vx(e);if(!Df(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Qi(void 0,mc,!0),i.factory=()=>wf(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=pe(null);try{return t.value===mc&&(t.value=Fx,t.value=t.factory()),typeof t.value=="object"&&t.value&&Ux(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{pe(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Pt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Tf(n){let e=Hc(n),t=e!==null?e.factory:qr(n);if(t!==null)return t;if(n instanceof Q)throw new ee(204,!1);if(n instanceof Function)return Lx(n);throw new ee(204,!1)}function Lx(n){if(n.length>0)throw new ee(204,!1);let t=XA(n);return t!==null?()=>t.factory(n):()=>new n}function Vx(n){if(eE(n))return Qi(void 0,n.useValue);{let e=jx(n);return Qi(e,mc)}}function jx(n,e,t){let r;if(Df(n)){let i=Pt(n);return qr(i)||Tf(i)}else if(eE(n))r=()=>Pt(n.useValue);else if(Ox(n))r=()=>n.useFactory(...wf(n.deps||[]));else if(kx(n))r=()=>$(Pt(n.useExisting));else{let i=Pt(n&&(n.useClass||n.provide));if(Bx(n))r=()=>new i(...wf(n.deps));else return qr(i)||Tf(i)}return r}function Qi(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Bx(n){return!!n.deps}function Ux(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function $x(n){return typeof n=="function"||typeof n=="object"&&n instanceof Q}function Cf(n,e){for(let t of n)Array.isArray(t)?Cf(t,e):t&&LI(t)?Cf(t.\u0275providers,e):e(t)}function Pn(n,e){n instanceof Ks&&n.assertNotDestroyed();let t,r=rr(n),i=Et(void 0);try{return e()}finally{rr(r),Et(i)}}function Hx(){return VI()!==void 0||dx()!=null}function qx(n){return typeof n=="function"}var kn=0,ue=1,re=2,mt=3,Kt=4,Zt=5,Qs=6,sI=7,kt=8,to=9,An=10,Lt=11,Ys=12,aI=13,ia=14,Qt=15,no=16,Yi=17,ro=18,Kc=19,tE=20,or=21,cf=22,Ot=23,Yt=25,nE=1;var Gr=7,Cc=8,bc=9,gt=10,Sc=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(Sc||{});function $r(n){return Array.isArray(n)&&typeof n[nE]=="object"}function On(n){return Array.isArray(n)&&n[nE]===!0}function rE(n){return(n.flags&4)!==0}function hp(n){return n.componentOffset>-1}function iE(n){return(n.flags&1)===1}function oa(n){return!!n.template}function bf(n){return(n[re]&512)!==0}var Sf=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function oE(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function Qc(){return sE}function sE(n){return n.type.prototype.ngOnChanges&&(n.setInput=Gx),zx}Qc.ngInherit=!0;function zx(){let n=uE(this),e=n?.current;if(e){let t=n.previous;if(t===Ws)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function Gx(n,e,t,r,i){let o=this.declaredInputs[r],s=uE(n)||Wx(n,{previous:Ws,current:null}),a=s.current||(s.current={}),u=s.previous,l=u[o];a[o]=new Sf(l&&l.currentValue,t,u===Ws),oE(n,e,i,t)}var aE="__ngSimpleChanges__";function uE(n){return n[aE]||null}function Wx(n,e){return n[aE]=e}var uI=null;var ir=function(n,e,t){uI?.(n,e,t)},Kx="svg",Qx="math";function xn(n){for(;Array.isArray(n);)n=n[kn];return n}function Yx(n,e){return xn(e[n])}function Fn(n,e){return xn(e[n.index])}function cE(n,e){return n.data[e]}function Zx(n,e){return n[e]}function sa(n,e){let t=e[n];return $r(t)?t:t[kn]}function fp(n){return(n[re]&128)===128}function Jx(n){return On(n[mt])}function Zs(n,e){return e==null?null:n[e]}function lE(n){n[Yi]=0}function dE(n){n[re]&1024||(n[re]|=1024,fp(n)&&Zc(n))}function Yc(n){return!!(n[re]&9216||n[Ot]?.dirty)}function Af(n){n[An].changeDetectionScheduler?.notify(8),n[re]&64&&(n[re]|=1024),Yc(n)&&Zc(n)}function Zc(n){n[An].changeDetectionScheduler?.notify(0);let e=Wr(n);for(;e!==null&&!(e[re]&8192||(e[re]|=8192,!fp(e)));)e=Wr(e)}function hE(n,e){if((n[re]&256)===256)throw new ee(911,!1);n[or]===null&&(n[or]=[]),n[or].push(e)}function Xx(n,e){if(n[or]===null)return;let t=n[or].indexOf(e);t!==-1&&n[or].splice(t,1)}function Wr(n){let e=n[mt];return On(e)?e[mt]:e}var ye={lFrame:IE(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var fE=!1;function eR(){return ye.lFrame.elementDepthCount}function tR(){ye.lFrame.elementDepthCount++}function nR(){ye.lFrame.elementDepthCount--}function pE(){return ye.bindingsEnabled}function rR(){return ye.skipHydrationRootTNode!==null}function iR(n){return ye.skipHydrationRootTNode===n}function oR(){ye.skipHydrationRootTNode=null}function Ze(){return ye.lFrame.lView}function uo(){return ye.lFrame.tView}function Ln(){let n=gE();for(;n!==null&&n.type===64;)n=n.parent;return n}function gE(){return ye.lFrame.currentTNode}function sR(){let n=ye.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function aa(n,e){let t=ye.lFrame;t.currentTNode=n,t.isParent=e}function mE(){return ye.lFrame.isParent}function aR(){ye.lFrame.isParent=!1}function yE(){return fE}function cI(n){fE=n}function uR(){let n=ye.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function cR(){return ye.lFrame.bindingIndex}function lR(n){return ye.lFrame.bindingIndex=n}function dR(){return ye.lFrame.bindingIndex++}function hR(n){let e=ye.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function fR(){return ye.lFrame.inI18n}function pR(n,e){let t=ye.lFrame;t.bindingIndex=t.bindingRootIndex=n,xf(e)}function gR(){return ye.lFrame.currentDirectiveIndex}function xf(n){ye.lFrame.currentDirectiveIndex=n}function vE(n){ye.lFrame.currentQueryIndex=n}function mR(n){let e=n[ue];return e.type===2?e.declTNode:e.type===1?n[Zt]:null}function _E(n,e,t){if(t&ae.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&ae.Host);)if(i=mR(o),i===null||(o=o[ia],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=ye.lFrame=wE();return r.currentTNode=e,r.lView=n,!0}function pp(n){let e=wE(),t=n[ue];ye.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function wE(){let n=ye.lFrame,e=n===null?null:n.child;return e===null?IE(n):e}function IE(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function EE(){let n=ye.lFrame;return ye.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var DE=EE;function gp(){let n=EE();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Jc(){return ye.lFrame.selectedIndex}function Kr(n){ye.lFrame.selectedIndex=n}function yR(){return ye.lFrame.currentNamespace}var TE=!0;function mp(){return TE}function yp(n){TE=n}function vR(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=sE(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function vp(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:h}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),u&&(n.viewHooks??=[]).push(-t,u),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function yc(n,e,t){CE(n,e,3,t)}function vc(n,e,t,r){(n[re]&3)===t&&CE(n,e,t,r)}function lf(n,e){let t=n[re];(t&3)===e&&(t&=16383,t+=1,n[re]=t)}function CE(n,e,t,r){let i=r!==void 0?n[Yi]&65535:0,o=r??-1,s=e.length-1,a=0;for(let u=i;u<s;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(n[Yi]+=65536),(a<o||o==-1)&&(_R(n,t,e,u),n[Yi]=(n[Yi]&4294901760)+u+2),u++}function lI(n,e){ir(4,n,e);let t=pe(null);try{e.call(n)}finally{pe(t),ir(5,n,e)}}function _R(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[re]>>14<n[Yi]>>16&&(n[re]&3)===e&&(n[re]+=16384,lI(a,o)):lI(a,o)}var Xi=-1,Js=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function wR(n){return n instanceof Js}function IR(n){return(n.flags&8)!==0}function ER(n){return(n.flags&16)!==0}var df={},Rf=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=qc(r);let i=this.injector.get(e,df,r);return i!==df||t===df?i:this.parentInjector.get(e,t,r)}};function bE(n){return n!==Xi}function Ac(n){return n&32767}function DR(n){return n>>16}function xc(n,e){let t=DR(n),r=e;for(;t>0;)r=r[ia],t--;return r}var Mf=!0;function Rc(n){let e=Mf;return Mf=n,e}var TR=256,SE=TR-1,AE=5,CR=0,cn={};function bR(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(zs)&&(r=t[zs]),r==null&&(r=t[zs]=CR++);let i=r&SE,o=1<<i;e.data[n+(i>>AE)]|=o}function xE(n,e){let t=RE(n,e);if(t!==-1)return t;let r=e[ue];r.firstCreatePass&&(n.injectorIndex=e.length,hf(r.data,n),hf(e,null),hf(r.blueprint,null));let i=_p(n,e),o=n.injectorIndex;if(bE(i)){let s=Ac(i),a=xc(i,e),u=a[ue].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|u[s+l]}return e[o+8]=i,o}function hf(n,e){n.push(0,0,0,0,0,0,0,0,e)}function RE(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function _p(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=OE(i),r===null)return Xi;if(t++,i=i[ia],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Xi}function SR(n,e,t){bR(n,e,t)}function ME(n,e,t){if(t&ae.Optional||n!==void 0)return n;rp(e,"NodeInjector")}function NE(n,e,t,r){if(t&ae.Optional&&r===void 0&&(r=null),!(t&(ae.Self|ae.Host))){let i=n[to],o=Et(void 0);try{return i?i.get(e,r,t&ae.Optional):jI(e,r,t&ae.Optional)}finally{Et(o)}}return ME(r,e,t)}function PE(n,e,t,r=ae.Default,i){if(n!==null){if(e[re]&2048&&!(r&ae.Self)){let s=NR(n,e,t,r,cn);if(s!==cn)return s}let o=kE(n,e,t,r,cn);if(o!==cn)return o}return NE(e,t,r,i)}function kE(n,e,t,r,i){let o=RR(t);if(typeof o=="function"){if(!_E(e,n,r))return r&ae.Host?ME(i,t,r):NE(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&ae.Optional))rp(t);else return s}finally{DE()}}else if(typeof o=="number"){let s=null,a=RE(n,e),u=Xi,l=r&ae.Host?e[Qt][Zt]:null;for((a===-1||r&ae.SkipSelf)&&(u=a===-1?_p(n,e):e[a+8],u===Xi||!hI(r,!1)?a=-1:(s=e[ue],a=Ac(u),e=xc(u,e)));a!==-1;){let h=e[ue];if(dI(o,a,h.data)){let p=AR(a,e,t,s,r,l);if(p!==cn)return p}u=e[a+8],u!==Xi&&hI(r,e[ue].data[a+8]===l)&&dI(o,a,e)?(s=h,a=Ac(u),e=xc(u,e)):a=-1}}return i}function AR(n,e,t,r,i,o){let s=e[ue],a=s.data[n+8],u=r==null?hp(a)&&Mf:r!=s&&(a.type&3)!==0,l=i&ae.Host&&o===a,h=xR(a,s,t,u,l);return h!==null?Xs(e,s,h,a):cn}function xR(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,u=n.directiveStart,l=n.directiveEnd,h=o>>20,p=r?a:a+h,m=i?a+h:l;for(let y=p;y<m;y++){let C=s[y];if(y<u&&t===C||y>=u&&C.type===t)return y}if(i){let y=s[u];if(y&&oa(y)&&y.type===t)return u}return null}function Xs(n,e,t,r){let i=n[t],o=e.data;if(wR(i)){let s=i;s.resolving&&sx(ox(o[t]));let a=Rc(s.canSeeViewProviders);s.resolving=!0;let u,l=s.injectImpl?Et(s.injectImpl):null,h=_E(n,r,ae.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&vR(t,o[t],e)}finally{l!==null&&Et(l),Rc(a),s.resolving=!1,DE()}}return i}function RR(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(zs)?n[zs]:void 0;return typeof e=="number"?e>=0?e&SE:MR:e}function dI(n,e,t){let r=1<<n;return!!(t[e+(n>>AE)]&r)}function hI(n,e){return!(n&ae.Self)&&!(n&ae.Host&&e)}var Hr=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return PE(this._tNode,this._lView,e,qc(r),t)}};function MR(){return new Hr(Ln(),Ze())}function wp(n){return ra(()=>{let e=n.prototype.constructor,t=e[Ic]||Nf(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[Ic]||Nf(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function Nf(n){return PI(n)?()=>{let e=Nf(Pt(n));return e&&e()}:qr(n)}function NR(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[re]&2048&&!(s[re]&512);){let a=kE(o,s,t,r|ae.Self,cn);if(a!==cn)return a;let u=o.parent;if(!u){let l=s[tE];if(l){let h=l.get(t,cn,r);if(h!==cn)return h}u=OE(s),s=s[ia]}o=u}return i}function OE(n){let e=n[ue],t=e.type;return t===2?e.declTNode:t===1?n[Zt]:null}function fI(n,e=null,t=null,r){let i=FE(n,e,t,r);return i.resolveInjectorInitializers(),i}function FE(n,e=null,t=null,r,i=new Set){let o=[t||un,cp(n)];return r=r||(typeof n=="object"?void 0:bt(n)),new Ks(o,e||dp(),r||null,i)}var Qr=class n{static{this.THROW_IF_NOT_FOUND=Gs}static{this.NULL=new Tc}static create(e,t){if(Array.isArray(e))return fI({name:""},t,e,"");{let r=e.name??"";return fI({name:r},e.parent,e.providers,r)}}static{this.\u0275prov=J({token:n,providedIn:"any",factory:()=>$(UI)})}static{this.__NG_ELEMENT_ID__=-1}};var PR=new Q("");PR.__NG_ELEMENT_ID__=n=>{let e=Ln();if(e===null)throw new ee(204,!1);if(e.type&2)return e.value;if(n&ae.Optional)return null;throw new ee(204,!1)};var kR="ngOriginalError";function ff(n){return n[kR]}var LE=!0,VE=(()=>{class n{static{this.__NG_ELEMENT_ID__=OR}static{this.__NG_ENV_ID__=t=>t}}return n})(),Pf=class extends VE{constructor(e){super(),this._lView=e}onDestroy(e){return hE(this._lView,e),()=>Xx(this._lView,e)}};function OR(){return new Pf(Ze())}var co=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Xe(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=J({token:n,providedIn:"root",factory:()=>new n})}}return n})();var kf=class extends Le{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,Hx()&&(this.destroyRef=U(VE,{optional:!0})??void 0,this.pendingTasks=U(co,{optional:!0})??void 0)}emit(e){let t=pe(null);try{super.next(e)}finally{pe(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),o=u.error?.bind(u),s=u.complete?.bind(u)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof Oe&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},pt=kf;function Mc(...n){}function jE(n){let e,t;function r(){n=Mc;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function pI(n){return queueMicrotask(()=>n()),()=>{n=Mc}}var Ip="isAngularZone",Nc=Ip+"_ID",FR=0,Ee=class n{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new pt(!1),this.onMicrotaskEmpty=new pt(!1),this.onStable=new pt(!1),this.onError=new pt(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=LE}=e;if(typeof Zone>"u")throw new ee(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,jR(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Ip)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ee(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ee(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,LR,Mc,Mc);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},LR={};function Ep(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function VR(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){jE(()=>{n.callbackScheduled=!1,Of(n),n.isCheckStableRunning=!0,Ep(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Of(n)}function jR(n){let e=()=>{VR(n)},t=FR++;n._inner=n._inner.fork({name:"angular",properties:{[Ip]:!0,[Nc]:t,[Nc+t]:!0},onInvokeTask:(r,i,o,s,a,u)=>{if(BR(u))return r.invokeTask(o,s,a,u);try{return gI(n),r.invokeTask(o,s,a,u)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),mI(n)}},onInvoke:(r,i,o,s,a,u,l)=>{try{return gI(n),r.invoke(o,s,a,u,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!UR(u)&&e(),mI(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Of(n),Ep(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Of(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function gI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function mI(n){n._nesting--,Ep(n)}var Ff=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new pt,this.onMicrotaskEmpty=new pt,this.onStable=new pt,this.onError=new pt}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function BR(n){return BE(n,"__ignore_ng_zone__")}function UR(n){return BE(n,"__scheduler_tick__")}function BE(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var Rn=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&ff(e);for(;t&&ff(t);)t=ff(t);return t||null}},$R=new Q("",{providedIn:"root",factory:()=>{let n=U(Ee),e=U(Rn);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function HR(){return Dp(Ln(),Ze())}function Dp(n,e){return new Xc(Fn(n,e))}var Xc=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=HR}}return n})();function UE(n){return(n.flags&128)===128}var $E=new Map,qR=0;function zR(){return qR++}function GR(n){$E.set(n[Kc],n)}function Lf(n){$E.delete(n[Kc])}var yI="__ngContext__";function Yr(n,e){$r(e)?(n[yI]=e[Kc],GR(e)):n[yI]=e}function HE(n){return zE(n[Ys])}function qE(n){return zE(n[Kt])}function zE(n){for(;n!==null&&!On(n);)n=n[Kt];return n}var Vf;function GE(n){Vf=n}function WR(){if(Vf!==void 0)return Vf;if(typeof document<"u")return document;throw new ee(210,!1)}var Tp=new Q("",{providedIn:"root",factory:()=>KR}),KR="ng",Cp=new Q(""),Vt=new Q("",{providedIn:"platform",factory:()=>"unknown"});var bp=new Q("",{providedIn:"root",factory:()=>WR().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var QR="h",YR="b";var ZR=()=>null;function Sp(n,e,t=!1){return ZR(n,e,t)}var WE=!1,JR=new Q("",{providedIn:"root",factory:()=>WE});function KE(n){return n instanceof Function?n():n}var Zr=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Zr||{}),XR;function Ap(n,e){return XR(n,e)}function Zi(n,e,t,r,i){if(r!=null){let o,s=!1;On(r)?o=r:$r(r)&&(s=!0,r=r[kn]);let a=xn(r);n===0&&t!==null?i==null?JE(e,t,a):Pc(e,t,a,i||null,!0):n===1&&t!==null?Pc(e,t,a,i||null,!0):n===2?pM(e,a,s):n===3&&e.destroyNode(a),o!=null&&mM(e,n,o,t,i)}}function eM(n,e){return n.createText(e)}function tM(n,e,t){n.setValue(e,t)}function QE(n,e,t){return n.createElement(e,t)}function nM(n,e){YE(n,e),e[kn]=null,e[Zt]=null}function rM(n,e,t,r,i,o){r[kn]=i,r[Zt]=e,tl(n,r,t,1,i,o)}function YE(n,e){e[An].changeDetectionScheduler?.notify(9),tl(n,e,e[Lt],2,null,null)}function iM(n){let e=n[Ys];if(!e)return pf(n[ue],n);for(;e;){let t=null;if($r(e))t=e[Ys];else{let r=e[gt];r&&(t=r)}if(!t){for(;e&&!e[Kt]&&e!==n;)$r(e)&&pf(e[ue],e),e=e[mt];e===null&&(e=n),$r(e)&&pf(e[ue],e),t=e&&e[Kt]}e=t}}function oM(n,e,t,r){let i=gt+r,o=t.length;r>0&&(t[i-1][Kt]=e),r<o-gt?(e[Kt]=t[i],BI(t,gt+r,e)):(t.push(e),e[Kt]=null),e[mt]=t;let s=e[no];s!==null&&t!==s&&ZE(s,e);let a=e[ro];a!==null&&a.insertView(n),Af(e),e[re]|=128}function ZE(n,e){let t=n[bc],r=e[mt];if($r(r))n[re]|=Sc.HasTransplantedViews;else{let i=r[mt][Qt];e[Qt]!==i&&(n[re]|=Sc.HasTransplantedViews)}t===null?n[bc]=[e]:t.push(e)}function xp(n,e){let t=n[bc],r=t.indexOf(e);t.splice(r,1)}function ea(n,e){if(n.length<=gt)return;let t=gt+e,r=n[t];if(r){let i=r[no];i!==null&&i!==n&&xp(i,r),e>0&&(n[t-1][Kt]=r[Kt]);let o=Dc(n,gt+e);nM(r[ue],r);let s=o[ro];s!==null&&s.detachView(o[ue]),r[mt]=null,r[Kt]=null,r[re]&=-129}return r}function el(n,e){if(!(e[re]&256)){let t=e[Lt];t.destroyNode&&tl(n,e,t,3,null,null),iM(e)}}function pf(n,e){if(e[re]&256)return;let t=pe(null);try{e[re]&=-129,e[re]|=256,e[Ot]&&jh(e[Ot]),aM(n,e),sM(n,e),e[ue].type===1&&e[Lt].destroy();let r=e[no];if(r!==null&&On(e[mt])){r!==e[mt]&&xp(r,e);let i=e[ro];i!==null&&i.detachView(n)}Lf(e)}finally{pe(t)}}function sM(n,e){let t=n.cleanup,r=e[sI];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let s=t[o+3];s>=0?r[s]():r[-s].unsubscribe(),o+=2}else{let s=r[t[o+1]];t[o].call(s)}r!==null&&(e[sI]=null);let i=e[or];if(i!==null){e[or]=null;for(let o=0;o<i.length;o++){let s=i[o];s()}}}function aM(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Js)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],u=o[s+1];ir(4,a,u);try{u.call(a)}finally{ir(5,a,u)}}else{ir(4,i,o);try{o.call(i)}finally{ir(5,i,o)}}}}}function uM(n,e,t){return cM(n,e.parent,t)}function cM(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[kn];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=n.data[r.directiveStart+i];if(o===ln.None||o===ln.Emulated)return null}return Fn(r,t)}}function Pc(n,e,t,r,i){n.insertBefore(e,t,r,i)}function JE(n,e,t){n.appendChild(e,t)}function vI(n,e,t,r,i){r!==null?Pc(n,e,t,r,i):JE(n,e,t)}function XE(n,e){return n.parentNode(e)}function lM(n,e){return n.nextSibling(e)}function dM(n,e,t){return fM(n,e,t)}function hM(n,e,t){return n.type&40?Fn(n,t):null}var fM=hM,_I;function Rp(n,e,t,r){let i=uM(n,r,e),o=e[Lt],s=r.parent||e[Zt],a=dM(s,r,e);if(i!=null)if(Array.isArray(t))for(let u=0;u<t.length;u++)vI(o,i,t[u],a,!1);else vI(o,i,t,a,!1);_I!==void 0&&_I(o,r,e,t,i)}function Hs(n,e){if(e!==null){let t=e.type;if(t&3)return Fn(e,n);if(t&4)return jf(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Hs(n,r);{let i=n[e.index];return On(i)?jf(-1,i):xn(i)}}else{if(t&128)return Hs(n,e.next);if(t&32)return Ap(e,n)()||xn(n[e.index]);{let r=eD(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Wr(n[Qt]);return Hs(i,r)}else return Hs(n,e.next)}}}return null}function eD(n,e){if(e!==null){let r=n[Qt][Zt],i=e.projection;return r.projection[i]}return null}function jf(n,e){let t=gt+n+1;if(t<e.length){let r=e[t],i=r[ue].firstChild;if(i!==null)return Hs(r,i)}return e[Gr]}function pM(n,e,t){n.removeChild(null,e,t)}function Mp(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],u=t.type;if(s&&e===0&&(a&&Yr(xn(a),r),t.flags|=2),(t.flags&32)!==32)if(u&8)Mp(n,e,t.child,r,i,o,!1),Zi(e,n,i,a,o);else if(u&32){let l=Ap(t,r),h;for(;h=l();)Zi(e,n,i,h,o);Zi(e,n,i,a,o)}else u&16?gM(n,e,r,t,i,o):Zi(e,n,i,a,o);t=s?t.projectionNext:t.next}}function tl(n,e,t,r,i,o){Mp(t,r,n.firstChild,e,i,o,!1)}function gM(n,e,t,r,i,o){let s=t[Qt],u=s[Zt].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++){let h=u[l];Zi(e,n,i,h,o)}else{let l=u,h=s[mt];UE(r)&&(l.flags|=128),Mp(n,e,l,h,i,o,!0)}}function mM(n,e,t,r,i){let o=t[Gr],s=xn(t);o!==s&&Zi(e,n,r,o,i);for(let a=gt;a<t.length;a++){let u=t[a];tl(u[ue],u,n,e,r,o)}}function yM(n,e,t){n.setAttribute(e,"style",t)}function tD(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function nD(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&If(n,e,r),i!==null&&tD(n,e,i),o!==null&&yM(n,e,o)}var ua={};function Np(n=1){rD(uo(),Ze(),Jc()+n,!1)}function rD(n,e,t,r){if(!r)if((e[re]&3)===3){let o=n.preOrderCheckHooks;o!==null&&yc(e,o,t)}else{let o=n.preOrderHooks;o!==null&&vc(e,o,0,t)}Kr(t)}function ca(n,e=ae.Default){let t=Ze();if(t===null)return $(n,e);let r=Ln();return PE(r,t,Pt(n),e)}function iD(n,e,t,r,i,o){let s=pe(null);try{let a=null;i&sr.SignalBased&&(a=e[r][Iw]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&sr.HasDecoratorInputTransform&&(o=n.inputTransforms[r].call(e,o)),n.setInput!==null?n.setInput(e,a,o,t,r):oE(e,a,r,o)}finally{pe(s)}}function vM(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Kr(~i);else{let o=i,s=t[++r],a=t[++r];pR(s,o);let u=e[o];a(2,u)}}}finally{Kr(-1)}}function nl(n,e,t,r,i,o,s,a,u,l,h){let p=e.blueprint.slice();return p[kn]=i,p[re]=r|4|128|8|64,(l!==null||n&&n[re]&2048)&&(p[re]|=2048),lE(p),p[mt]=p[ia]=n,p[kt]=t,p[An]=s||n&&n[An],p[Lt]=a||n&&n[Lt],p[to]=u||n&&n[to]||null,p[Zt]=o,p[Kc]=zR(),p[Qs]=h,p[tE]=l,p[Qt]=e.type==2?n[Qt]:p,p}function rl(n,e,t,r,i){let o=n.data[e];if(o===null)o=_M(n,e,t,r,i),fR()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=sR();o.injectorIndex=s===null?-1:s.injectorIndex}return aa(o,!0),o}function _M(n,e,t,r,i){let o=gE(),s=mE(),a=s?o:o&&o.parent,u=n.data[e]=TM(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=u),o!==null&&(s?o.child==null&&u.parent!==null&&(o.child=u):o.next===null&&(o.next=u,u.prev=o)),u}function oD(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function sD(n,e,t,r,i){let o=Jc(),s=r&2;try{Kr(-1),s&&e.length>Yt&&rD(n,e,Yt,!1),ir(s?2:0,i),t(r,i)}finally{Kr(o),ir(s?3:1,i)}}function aD(n,e,t){if(rE(e)){let r=pe(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let u=t[s];a.contentQueries(1,u,s)}}}finally{pe(r)}}}function uD(n,e,t){pE()&&(AM(n,e,t,Fn(t,e)),(t.flags&64)===64&&fD(n,e,t))}function cD(n,e,t=Fn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function lD(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Pp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Pp(n,e,t,r,i,o,s,a,u,l,h){let p=Yt+r,m=p+i,y=wM(p,m),C=typeof l=="function"?l():l;return y[ue]={type:n,blueprint:y,template:t,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:u,consts:C,incompleteFirstPass:!1,ssrId:h}}function wM(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:ua);return t}function IM(n,e,t,r){let o=r.get(JR,WE)||t===ln.ShadowDom,s=n.selectRootElement(e,o);return EM(s),s}function EM(n){DM(n)}var DM=()=>null;function TM(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return rR()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function wI(n,e,t,r,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let s=e[o];if(s===void 0)continue;r??={};let a,u=sr.None;Array.isArray(s)?(a=s[0],u=s[1]):a=s;let l=o;if(i!==null){if(!i.hasOwnProperty(o))continue;l=i[o]}n===0?II(r,t,l,a,u):II(r,t,l,a)}return r}function II(n,e,t,r,i){let o;n.hasOwnProperty(t)?(o=n[t]).push(e,r):o=n[t]=[e,r],i!==void 0&&o.push(i)}function CM(n,e,t){let r=e.directiveStart,i=e.directiveEnd,o=n.data,s=e.attrs,a=[],u=null,l=null;for(let h=r;h<i;h++){let p=o[h],m=t?t.get(p):null,y=m?m.inputs:null,C=m?m.outputs:null;u=wI(0,p.inputs,h,u,y),l=wI(1,p.outputs,h,l,C);let A=u!==null&&s!==null&&!sp(e)?LM(u,h,s):null;a.push(A)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=l}function dD(n,e,t,r){if(pE()){let i=r===null?null:{"":-1},o=RM(n,t),s,a;o===null?s=a=null:[s,a]=o,s!==null&&hD(n,e,t,s,i,a),i&&MM(t,r,i)}t.mergedAttrs=op(t.mergedAttrs,t.attrs)}function hD(n,e,t,r,i,o){for(let l=0;l<r.length;l++)SR(xE(t,e),n,r[l].type);PM(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let h=r[l];h.providersResolver&&h.providersResolver(h)}let s=!1,a=!1,u=oD(n,e,r.length,null);for(let l=0;l<r.length;l++){let h=r[l];t.mergedAttrs=op(t.mergedAttrs,h.hostAttrs),kM(n,t,e,u,h),NM(u,h,i),h.contentQueries!==null&&(t.flags|=4),(h.hostBindings!==null||h.hostAttrs!==null||h.hostVars!==0)&&(t.flags|=64);let p=h.type.prototype;!s&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),s=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),u++}CM(n,t,o)}function bM(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;SM(s)!=a&&s.push(a),s.push(t,r,o)}}function SM(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function AM(n,e,t,r){let i=t.directiveStart,o=t.directiveEnd;hp(t)&&OM(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||xE(t,e),Yr(r,e);let s=t.initialInputs;for(let a=i;a<o;a++){let u=n.data[a],l=Xs(e,n,a,t);if(Yr(l,e),s!==null&&FM(e,a-i,l,u,t,s),oa(u)){let h=sa(t.index,e);h[kt]=Xs(e,n,a,t)}}}function fD(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=gR();try{Kr(o);for(let a=r;a<i;a++){let u=n.data[a],l=e[a];xf(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&xM(u,l)}}finally{Kr(-1),xf(s)}}function xM(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function RM(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let o=0;o<t.length;o++){let s=t[o];if(Tx(e,s.selectors,!1))if(r||(r=[]),oa(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let u=a.length;Bf(n,e,u)}else r.unshift(s),Bf(n,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function Bf(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function MM(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new ee(-301,!1);r.push(e[i],o)}}}function NM(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;oa(e)&&(t[""]=n)}}function PM(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function kM(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=qr(i.type,!0)),s=new Js(o,oa(i),ca);n.blueprint[r]=s,t[r]=s,bM(n,e,r,oD(n,t,i.hostVars,ua),i)}function OM(n,e,t){let r=Fn(e,n),i=lD(t),o=n[An].rendererFactory,s=16;t.signals?s=4096:t.onPush&&(s=64);let a=il(n,nl(n,i,null,s,r,e,null,o.createRenderer(r,t),null,null,null));n[e.index]=a}function FM(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;){let u=s[a++],l=s[a++],h=s[a++],p=s[a++];iD(r,t,u,l,h,p)}}function LM(n,e,t){let r=null,i=0;for(;i<t.length;){let o=t[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(n.hasOwnProperty(o)){r===null&&(r=[]);let s=n[o];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}return r}function pD(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function gD(n,e){let t=n.contentQueries;if(t!==null){let r=pe(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];vE(o),a.contentQueries(2,e[s],s)}}}finally{pe(r)}}}function il(n,e){return n[Ys]?n[aI][Kt]=e:n[Ys]=e,n[aI]=e,e}function Uf(n,e,t){vE(0);let r=pe(null);try{e(n,t)}finally{pe(r)}}function VM(n,e){let t=n[to],r=t?t.get(Rn,null):null;r&&r.handleError(e)}function mD(n,e,t,r,i){for(let o=0;o<t.length;){let s=t[o++],a=t[o++],u=t[o++],l=e[s],h=n.data[s];iD(h,l,r,a,u,i)}}function jM(n,e,t){let r=Yx(e,n);tM(n[Lt],r,t)}function BM(n,e){let t=sa(e,n),r=t[ue];UM(r,t);let i=t[kn];i!==null&&t[Qs]===null&&(t[Qs]=Sp(i,t[to])),kp(r,t,t[kt])}function UM(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function kp(n,e,t){pp(e);try{let r=n.viewQuery;r!==null&&Uf(1,r,t);let i=n.template;i!==null&&sD(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[ro]?.finishViewCreation(n),n.staticContentQueries&&gD(n,e),n.staticViewQueries&&Uf(2,n.viewQuery,t);let o=n.components;o!==null&&$M(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[re]&=-5,gp()}}function $M(n,e){for(let t=0;t<e.length;t++)BM(n,e[t])}function yD(n,e,t,r){let i=pe(null);try{let o=e.tView,a=n[re]&4096?4096:16,u=nl(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];u[no]=l;let h=n[ro];return h!==null&&(u[ro]=h.createEmbeddedView(o)),kp(o,u,t),u}finally{pe(i)}}function HM(n,e){let t=gt+e;if(t<n.length)return n[t]}function kc(n,e){return!e||e.firstChild===null||UE(n)}function Op(n,e,t,r=!0){let i=e[ue];if(oM(i,e,n,t),r){let s=jf(t,n),a=e[Lt],u=XE(a,n[Gr]);u!==null&&rM(i,n[Zt],a,e,u,s)}let o=e[Qs];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function qM(n,e){let t=ea(n,e);return t!==void 0&&el(t[ue],t),t}function Oc(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(xn(o)),On(o)&&zM(o,r);let s=t.type;if(s&8)Oc(n,e,t.child,r);else if(s&32){let a=Ap(t,e),u;for(;u=a();)r.push(u)}else if(s&16){let a=eD(e,t);if(Array.isArray(a))r.push(...a);else{let u=Wr(e[Qt]);Oc(u[ue],u,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function zM(n,e){for(let t=gt;t<n.length;t++){let r=n[t],i=r[ue].firstChild;i!==null&&Oc(r[ue],r,i,e)}n[Gr]!==n[kn]&&e.push(n[Gr])}var vD=[];function GM(n){return n[Ot]??WM(n)}function WM(n){let e=vD.pop()??Object.create(QM);return e.lView=n,e}function KM(n){n.lView[Ot]!==n&&(n.lView=null,vD.push(n))}var QM=Se(z({},Fh),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Zc(n.lView)},consumerOnSignalRead(){this.lView[Ot]=this}});function YM(n){let e=n[Ot]??Object.create(ZM);return e.lView=n,e}var ZM=Se(z({},Fh),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{let e=Wr(n.lView);for(;e&&!_D(e[ue]);)e=Wr(e);e&&dE(e)},consumerOnSignalRead(){this.lView[Ot]=this}});function _D(n){return n.type!==2}var JM=100;function wD(n,e=!0,t=0){let r=n[An],i=r.rendererFactory,o=!1;o||i.begin?.();try{XM(n,t)}catch(s){throw e&&VM(n,s),s}finally{o||(i.end?.(),r.inlineEffectRunner?.flush())}}function XM(n,e){let t=yE();try{cI(!0),$f(n,e);let r=0;for(;Yc(n);){if(r===JM)throw new ee(103,!1);r++,$f(n,1)}}finally{cI(t)}}function eN(n,e,t,r){let i=e[re];if((i&256)===256)return;let o=!1,s=!1;!o&&e[An].inlineEffectRunner?.flush(),pp(e);let a=!0,u=null,l=null;o||(_D(n)?(l=GM(e),u=Lh(l)):Ew()===null?(a=!1,l=YM(e),u=Lh(l)):e[Ot]&&(jh(e[Ot]),e[Ot]=null));try{lE(e),lR(n.bindingStartIndex),t!==null&&sD(n,e,t,2,r);let h=(i&3)===3;if(!o)if(h){let y=n.preOrderCheckHooks;y!==null&&yc(e,y,null)}else{let y=n.preOrderHooks;y!==null&&vc(e,y,0,null),lf(e,0)}if(s||tN(e),ID(e,0),n.contentQueries!==null&&gD(n,e),!o)if(h){let y=n.contentCheckHooks;y!==null&&yc(e,y)}else{let y=n.contentHooks;y!==null&&vc(e,y,1),lf(e,1)}vM(n,e);let p=n.components;p!==null&&DD(e,p,0);let m=n.viewQuery;if(m!==null&&Uf(2,m,r),!o)if(h){let y=n.viewCheckHooks;y!==null&&yc(e,y)}else{let y=n.viewHooks;y!==null&&vc(e,y,2),lf(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[cf]){for(let y of e[cf])y();e[cf]=null}o||(e[re]&=-73)}catch(h){throw o||Zc(e),h}finally{l!==null&&(Dw(l,u),a&&KM(l)),gp()}}function ID(n,e){for(let t=HE(n);t!==null;t=qE(t))for(let r=gt;r<t.length;r++){let i=t[r];ED(i,e)}}function tN(n){for(let e=HE(n);e!==null;e=qE(e)){if(!(e[re]&Sc.HasTransplantedViews))continue;let t=e[bc];for(let r=0;r<t.length;r++){let i=t[r];dE(i)}}}function nN(n,e,t){let r=sa(e,n);ED(r,t)}function ED(n,e){fp(n)&&$f(n,e)}function $f(n,e){let r=n[ue],i=n[re],o=n[Ot],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&Vh(o)),s||=!1,o&&(o.dirty=!1),n[re]&=-9217,s)eN(r,n,r.template,n[kt]);else if(i&8192){ID(n,1);let a=r.components;a!==null&&DD(n,a,1)}}function DD(n,e,t){for(let r=0;r<e.length;r++)nN(n,e[r],t)}function TD(n,e){let t=yE()?64:1088;for(n[An].changeDetectionScheduler?.notify(e);n;){n[re]|=t;let r=Wr(n);if(bf(n)&&!r)return n;n=r}return null}var io=class{get rootNodes(){let e=this._lView,t=e[ue];return Oc(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[kt]}set context(e){this._lView[kt]=e}get destroyed(){return(this._lView[re]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[mt];if(On(e)){let t=e[Cc],r=t?t.indexOf(this):-1;r>-1&&(ea(e,r),Dc(t,r))}this._attachedToViewContainer=!1}el(this._lView[ue],this._lView)}onDestroy(e){hE(this._lView,e)}markForCheck(){TD(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[re]&=-129}reattach(){Af(this._lView),this._lView[re]|=128}detectChanges(){this._lView[re]|=1024,wD(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ee(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=bf(this._lView),t=this._lView[no];t!==null&&!e&&xp(t,this._lView),YE(this._lView[ue],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ee(902,!1);this._appRef=e;let t=bf(this._lView),r=this._lView[no];r!==null&&!t&&ZE(r,this._lView),Af(this._lView)}};var wH=new RegExp(`^(\\d+)*(${YR}|${QR})*(.*)`);var rN=()=>null;function Fc(n,e){return rN(n,e)}var oo=class{},Fp=new Q("",{providedIn:"root",factory:()=>!1});var CD=new Q(""),bD=new Q(""),Hf=class{},Lc=class{};function iN(n){let e=Error(`No component factory found for ${bt(n)}.`);return e[oN]=n,e}var oN="ngComponent";var qf=class{resolveComponentFactory(e){throw iN(e)}},so=class{static{this.NULL=new qf}},ao=class{};var sN=(()=>{class n{static{this.\u0275prov=J({token:n,providedIn:"root",factory:()=>null})}}return n})();function zf(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=Yw(i,a);else if(o==2){let u=a,l=e[++s];r=Yw(r,u+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Vc=class extends so{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=zr(e);return new ta(t,this.ngModule)}};function EI(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,a=o?i[1]:sr.None;e?t.push({propName:s,templateName:r,isSignal:(a&sr.SignalBased)!==0}):t.push({propName:s,templateName:r})}return t}function aN(n){let e=n.toLowerCase();return e==="svg"?Kx:e==="math"?Qx:null}var ta=class extends Lc{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=EI(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return EI(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Ax(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let o=pe(null);try{i=i||this.ngModule;let s=i instanceof Ft?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new Rf(e,s):e,u=a.get(ao,null);if(u===null)throw new ee(407,!1);let l=a.get(sN,null),h=a.get(oo,null),p={rendererFactory:u,sanitizer:l,inlineEffectRunner:null,changeDetectionScheduler:h},m=u.createRenderer(null,this.componentDef),y=this.componentDef.selectors[0][0]||"div",C=r?IM(m,r,this.componentDef.encapsulation,a):QE(m,y,aN(y)),A=512;this.componentDef.signals?A|=4096:this.componentDef.onPush||(A|=16);let M=null;C!==null&&(M=Sp(C,a,!0));let O=Pp(0,null,null,1,0,null,null,null,null,null,null),B=nl(null,O,null,A,null,null,p,m,a,null,M);pp(B);let F,W,X=null;try{let K=this.componentDef,I,v=null;K.findHostDirectiveDefs?(I=[],v=new Map,K.findHostDirectiveDefs(K,I,v),I.push(K)):I=[K];let w=uN(B,C);X=cN(w,C,K,I,B,p,m),W=cE(O,Yt),C&&hN(m,K,C,r),t!==void 0&&fN(W,this.ngContentSelectors,t),F=dN(X,K,I,v,B,[pN]),kp(O,B,null)}catch(K){throw X!==null&&Lf(X),Lf(B),K}finally{gp()}return new Gf(this.componentType,F,Dp(W,B),B,W)}finally{pe(o)}}},Gf=class extends Hf{constructor(e,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new io(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView;mD(o[ue],o,i,e,t),this.previousInputValues.set(e,t);let s=sa(this._tNode.index,o);TD(s,1)}}get injector(){return new Hr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function uN(n,e){let t=n[ue],r=Yt;return n[r]=e,rl(t,r,2,"#host",null)}function cN(n,e,t,r,i,o,s){let a=i[ue];lN(r,n,e,s);let u=null;e!==null&&(u=Sp(e,i[to]));let l=o.rendererFactory.createRenderer(e,t),h=16;t.signals?h=4096:t.onPush&&(h=64);let p=nl(i,lD(t),null,h,i[n.index],n,o,l,null,null,u);return a.firstCreatePass&&Bf(a,n,r.length-1),il(i,p),i[n.index]=p}function lN(n,e,t,r){for(let i of n)e.mergedAttrs=op(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(zf(e,e.mergedAttrs,!0),t!==null&&nD(r,t,e))}function dN(n,e,t,r,i,o){let s=Ln(),a=i[ue],u=Fn(s,i);hD(a,i,s,t,null,r);for(let h=0;h<t.length;h++){let p=s.directiveStart+h,m=Xs(i,a,p,s);Yr(m,i)}fD(a,i,s),u&&Yr(u,i);let l=Xs(i,a,s.directiveStart+s.componentOffset,s);if(n[kt]=i[kt]=l,o!==null)for(let h of o)h(l,e);return aD(a,s,i),l}function hN(n,e,t,r){if(r)If(n,t,["ng-version","18.2.13"]);else{let{attrs:i,classes:o}=xx(e.selectors[0]);i&&If(n,t,i),o&&o.length>0&&tD(n,t,o.join(" "))}}function fN(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null?Array.from(o):null)}}function pN(){let n=Ln();vp(Ze()[ue],n)}var ol=(()=>{class n{static{this.__NG_ELEMENT_ID__=gN}}return n})();function gN(){let n=Ln();return yN(n,Ze())}var mN=ol,SD=class extends mN{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Dp(this._hostTNode,this._hostLView)}get injector(){return new Hr(this._hostTNode,this._hostLView)}get parentInjector(){let e=_p(this._hostTNode,this._hostLView);if(bE(e)){let t=xc(e,this._hostLView),r=Ac(e),i=t[ue].data[r+8];return new Hr(i,t)}else return new Hr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=DI(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-gt}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=Fc(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,kc(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!qx(e),a;if(s)a=t;else{let C=t||{};a=C.index,r=C.injector,i=C.projectableNodes,o=C.environmentInjector||C.ngModuleRef}let u=s?e:new ta(zr(e)),l=r||this.parentInjector;if(!o&&u.ngModule==null){let A=(s?l:this.parentInjector).get(Ft,null);A&&(o=A)}let h=zr(u.componentType??{}),p=Fc(this._lContainer,h?.id??null),m=p?.firstChild??null,y=u.create(l,i,m,o);return this.insertImpl(y.hostView,a,kc(this._hostTNode,p)),y}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(Jx(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[mt],l=new SD(u,u[Zt],u[mt]);l.detach(l.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return Op(s,i,o,r),e.attachToViewContainerRef(),BI(gf(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=DI(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=ea(this._lContainer,t);r&&(Dc(gf(this._lContainer),t),el(r[ue],r))}detach(e){let t=this._adjustIndex(e,-1),r=ea(this._lContainer,t);return r&&Dc(gf(this._lContainer),t)!=null?new io(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function DI(n){return n[Cc]}function gf(n){return n[Cc]||(n[Cc]=[])}function yN(n,e){let t,r=e[n.index];return On(r)?t=r:(t=pD(r,e,null,n),e[n.index]=t,il(e,t)),_N(t,e,n,r),new SD(t,n,e)}function vN(n,e){let t=n[Lt],r=t.createComment(""),i=Fn(e,n),o=XE(t,i);return Pc(t,o,r,lM(t,i),!1),r}var _N=EN,wN=()=>!1;function IN(n,e,t){return wN(n,e,t)}function EN(n,e,t,r){if(n[Gr])return;let i;t.type&8?i=xn(r):i=vN(e,t),n[Gr]=i}var TI=new Set;function Lp(n){TI.has(n)||(TI.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var ar=class{},na=class{};var Wf=class extends ar{constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Vc(this);let o=QI(e);this._bootstrapComponents=KE(o.bootstrap),this._r3Injector=FE(e,t,[{provide:ar,useValue:this},{provide:so,useValue:this.componentFactoryResolver},...r],bt(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Kf=class extends na{constructor(e){super(),this.moduleType=e}create(e){return new Wf(this.moduleType,e,[])}};var jc=class extends ar{constructor(e){super(),this.componentFactoryResolver=new Vc(this),this.instance=null;let t=new Ks([...e.providers,{provide:ar,useValue:this},{provide:so,useValue:this.componentFactoryResolver}],e.parent||dp(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Vp(n,e,t=null){return new jc({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function DN(n,e,t){return n[e]=t}function Bc(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function TN(n,e,t,r){let i=Bc(n,e,t);return Bc(n,e+1,r)||i}function CN(n){return(n.flags&32)===32}function bN(n,e,t,r,i,o,s,a,u){let l=e.consts,h=rl(e,n,4,s||null,a||null);dD(e,t,h,Zs(l,u)),vp(e,h);let p=h.tView=Pp(2,h,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,h),p.queries=e.queries.embeddedTView(h)),h}function CI(n,e,t,r,i,o,s,a,u,l){let h=t+Yt,p=e.firstCreatePass?bN(h,e,n,r,i,o,s,a,u):e.data[h];aa(p,!1);let m=SN(e,n,p,t);mp()&&Rp(e,n,m,p),Yr(m,n);let y=pD(m,n,m,p);return n[h]=y,il(n,y),IN(y,p,n),iE(p)&&uD(e,n,p),u!=null&&cD(n,p,l),p}var SN=AN;function AN(n,e,t,r){return yp(!0),e[Lt].createComment("")}var qs=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(qs||{}),xN=(()=>{class n{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=J({token:n,providedIn:"root",factory:()=>new n})}}return n})(),bI=class n{constructor(){this.ngZone=U(Ee),this.scheduler=U(oo),this.errorHandler=U(Rn,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[qs.EarlyRead,qs.Write,qs.MixedReadWrite,qs.Read]}execute(){this.executing=!0;for(let e of n.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[e]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(r){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&(this.sequences.delete(e),e.destroy());for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=J({token:n,providedIn:"root",factory:()=>new n})}};function RN(n,e,t,r,i,o){let s=cR(),a=TN(n,s,t,i);return hR(2),a?e+yf(t)+r+yf(i)+o:ua}function SI(n,e,t,r,i){let o=e.inputs,s=i?"class":"style";mD(n,t,o[s],s,r)}var Qf=class{destroy(e){}updateValue(e,t){}swap(e,t){let r=Math.min(e,t),i=Math.max(e,t),o=this.detach(i);if(i-r>1){let s=this.detach(r);this.attach(r,o),this.attach(i,s)}else this.attach(r,o)}move(e,t){this.attach(t,this.detach(e))}};function mf(n,e,t,r,i){return n===t&&Object.is(e,r)?1:Object.is(i(n,e),i(t,r))?-1:0}function MN(n,e,t){let r,i,o=0,s=n.length-1,a=void 0;if(Array.isArray(e)){let u=e.length-1;for(;o<=s&&o<=u;){let l=n.at(o),h=e[o],p=mf(o,l,o,h,t);if(p!==0){p<0&&n.updateValue(o,h),o++;continue}let m=n.at(s),y=e[u],C=mf(s,m,u,y,t);if(C!==0){C<0&&n.updateValue(s,y),s--,u--;continue}let A=t(o,l),M=t(s,m),O=t(o,h);if(Object.is(O,M)){let B=t(u,y);Object.is(B,A)?(n.swap(o,s),n.updateValue(s,y),u--,s--):n.move(s,o),n.updateValue(o,h),o++;continue}if(r??=new Uc,i??=xI(n,o,s,t),Yf(n,r,o,O))n.updateValue(o,h),o++,s++;else if(i.has(O))r.set(A,n.detach(o)),s--;else{let B=n.create(o,e[o]);n.attach(o,B),o++,s++}}for(;o<=u;)AI(n,r,t,o,e[o]),o++}else if(e!=null){let u=e[Symbol.iterator](),l=u.next();for(;!l.done&&o<=s;){let h=n.at(o),p=l.value,m=mf(o,h,o,p,t);if(m!==0)m<0&&n.updateValue(o,p),o++,l=u.next();else{r??=new Uc,i??=xI(n,o,s,t);let y=t(o,p);if(Yf(n,r,o,y))n.updateValue(o,p),o++,s++,l=u.next();else if(!i.has(y))n.attach(o,n.create(o,p)),o++,s++,l=u.next();else{let C=t(o,h);r.set(C,n.detach(o)),s--}}}for(;!l.done;)AI(n,r,t,n.length,l.value),l=u.next()}for(;o<=s;)n.destroy(n.detach(s--));r?.forEach(u=>{n.destroy(u)})}function Yf(n,e,t,r){return e!==void 0&&e.has(r)?(n.attach(t,e.get(r)),e.delete(r),!0):!1}function AI(n,e,t,r,i){if(Yf(n,e,r,t(r,i)))n.updateValue(r,i);else{let o=n.create(r,i);n.attach(r,o)}}function xI(n,e,t,r){let i=new Set;for(let o=e;o<=t;o++)i.add(r(o,n.at(o)));return i}var Uc=class{constructor(){this.kvMap=new Map,this._vMap=void 0}has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,r]of this.kvMap)if(e(r,t),this._vMap!==void 0){let i=this._vMap;for(;i.has(r);)r=i.get(r),e(r,t)}}};var Zf=class{constructor(e,t,r){this.lContainer=e,this.$implicit=t,this.$index=r}get $count(){return this.lContainer.length-gt}};function AD(n,e){return e}var Jf=class{constructor(e,t,r){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=r}};function xD(n,e,t,r,i,o,s,a,u,l,h,p,m){Lp("NgControlFlow");let y=Ze(),C=uo(),A=u!==void 0,M=Ze(),O=a?s.bind(M[Qt][kt]):s,B=new Jf(A,O);M[Yt+n]=B,CI(y,C,n+1,e,t,r,i,Zs(C.consts,o)),A&&CI(y,C,n+2,u,l,h,p,Zs(C.consts,m))}var Xf=class extends Qf{constructor(e,t,r){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=r,this.operationsCounter=void 0,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-gt}at(e){return this.getLView(e)[kt].$implicit}attach(e,t){let r=t[Qs];this.needsIndexUpdate||=e!==this.length,Op(this.lContainer,t,e,kc(this.templateTNode,r))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,NN(this.lContainer,e)}create(e,t){let r=Fc(this.lContainer,this.templateTNode.tView.ssrId),i=yD(this.hostLView,this.templateTNode,new Zf(this.lContainer,t,e),{dehydratedView:r});return this.operationsCounter?.recordCreate(),i}destroy(e){el(e[ue],e),this.operationsCounter?.recordDestroy()}updateValue(e,t){this.getLView(e)[kt].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[kt].$index=e}getLView(e){return PN(this.lContainer,e)}};function RD(n){let e=pe(null),t=Jc();try{let r=Ze(),i=r[ue],o=r[t],s=t+1,a=RI(r,s);if(o.liveCollection===void 0){let l=MI(i,s);o.liveCollection=new Xf(a,r,l)}else o.liveCollection.reset();let u=o.liveCollection;if(MN(u,n,o.trackByFn),u.updateIndexes(),o.hasEmptyBlock){let l=dR(),h=u.length===0;if(Bc(r,l,h)){let p=t+2,m=RI(r,p);if(h){let y=MI(i,p),C=Fc(m,y.tView.ssrId),A=yD(r,y,void 0,{dehydratedView:C});Op(m,A,0,kc(y,C))}else qM(m,0)}}}finally{pe(e)}}function RI(n,e){return n[e]}function NN(n,e){return ea(n,e)}function PN(n,e){return HM(n,e)}function MI(n,e){return cE(n,e)}function kN(n,e,t,r,i,o){let s=e.consts,a=Zs(s,i),u=rl(e,n,2,r,a);return dD(e,t,u,Zs(s,o)),u.attrs!==null&&zf(u,u.attrs,!1),u.mergedAttrs!==null&&zf(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function la(n,e,t,r){let i=Ze(),o=uo(),s=Yt+n,a=i[Lt],u=o.firstCreatePass?kN(s,o,i,e,t,r):o.data[s],l=ON(o,i,u,a,e,n);i[s]=l;let h=iE(u);return aa(u,!0),nD(a,l,u),!CN(u)&&mp()&&Rp(o,i,l,u),eR()===0&&Yr(l,i),tR(),h&&(uD(o,i,u),aD(o,u,i)),r!==null&&cD(i,u),la}function da(){let n=Ln();mE()?aR():(n=n.parent,aa(n,!1));let e=n;iR(e)&&oR(),nR();let t=uo();return t.firstCreatePass&&(vp(t,n),rE(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&IR(e)&&SI(t,e,Ze(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&ER(e)&&SI(t,e,Ze(),e.stylesWithoutHost,!1),da}function lo(n,e,t,r){return la(n,e,t,r),da(),lo}var ON=(n,e,t,r,i,o)=>(yp(!0),QE(r,i,yR()));var $c="en-US";var FN=$c;function LN(n){typeof n=="string"&&(FN=n.toLowerCase().replace(/_/g,"-"))}function VN(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function jp(n,e=""){let t=Ze(),r=uo(),i=n+Yt,o=r.firstCreatePass?rl(r,i,1,e,null):r.data[i],s=jN(r,t,o,e,n);t[i]=s,mp()&&Rp(r,t,s,o),aa(o,!1)}var jN=(n,e,t,r,i)=>(yp(!0),eM(e[Lt],r));function Bp(n,e,t,r,i){let o=Ze(),s=RN(o,n,e,t,r,i);return s!==ua&&jM(o,Jc(),s),Bp}var BN=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=JI(!1,t.type),i=r.length>0?Vp([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=J({token:n,providedIn:"environment",factory:()=>new n($(Ft))})}}return n})();function sl(n){Lp("NgStandalone"),n.getStandaloneInjector=e=>e.get(BN).getOrCreateStandaloneInjector(n)}function UN(n,e){let t=n[e];return t===ua?void 0:t}function $N(n,e,t,r,i,o){let s=e+t;return Bc(n,s,i)?DN(n,s+1,o?r.call(o,i):r(i)):UN(n,s+1)}function MD(n,e){let t=uo(),r,i=n+Yt;t.firstCreatePass?(r=HN(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let o=r.factory||(r.factory=qr(r.type,!0)),s,a=Et(ca);try{let u=Rc(!1),l=o();return Rc(u),VN(t,Ze(),i,l),l}finally{Et(a)}}function HN(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function ND(n,e,t){let r=n+Yt,i=Ze(),o=Zx(i,r);return qN(i,r)?$N(i,uR(),e,o.transform,t,o):o.transform(t)}function qN(n,e){return n[ue].data[e].pure}var ur=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},PD=new ur("18.2.13");var al=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();var kD=new Q("");function ho(n){return!!n&&typeof n.then=="function"}function Up(n){return!!n&&typeof n.subscribe=="function"}var OD=new Q(""),FD=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=U(OD,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=i();if(ho(o))t.push(o);else if(Up(o)){let s=new Promise((a,u)=>{o.subscribe({complete:a,error:u})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),$p=new Q("");function zN(){Tw(()=>{throw new ee(600,!1)})}function GN(n){return n.isBoundToModule}var WN=10;function KN(n,e,t){try{let r=t();return ho(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var Jr=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=U($R),this.afterRenderManager=U(xN),this.zonelessEnabled=U(Fp),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new Le,this.afterTick=new Le,this.componentTypes=[],this.components=[],this.isStable=U(co).hasPendingTasks.pipe(Z(t=>!t)),this._injector=U(Ft)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof Lc;if(!this._injector.get(FD).done){let m=!i&&KI(t),y=!1;throw new ee(405,y)}let s;i?s=t:s=this._injector.get(so).resolveComponentFactory(t),this.componentTypes.push(s.componentType);let a=GN(s)?void 0:this._injector.get(ar),u=r||s.selector,l=s.create(Qr.NULL,[],u,a),h=l.location.nativeElement,p=l.injector.get(kD,null);return p?.registerApplication(h),l.onDestroy(()=>{this.detachView(l.hostView),_c(this.components,l),p?.unregisterApplication(h)}),this._loadComponent(l),l}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new ee(101,!1);let t=pe(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,pe(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(ao,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let r=0;for(;this.dirtyFlags!==0&&r++<WN;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(r);for(let{_lView:i,notifyErrorHandler:o}of this._views)QN(i,o,r,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else t?.begin?.(),t?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Yc(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;_c(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get($p,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>_c(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ee(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function _c(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function QN(n,e,t,r){if(!t&&!Yc(n))return;wD(n,e,t&&!r?0:1)}var ep=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},Hp=(()=>{class n{compileModuleSync(t){return new Kf(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=QI(t),o=KE(i.declarations).reduce((s,a)=>{let u=zr(a);return u&&s.push(new ta(u)),s},[]);return new ep(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var YN=(()=>{class n{constructor(){this.zone=U(Ee),this.changeDetectionScheduler=U(oo),this.applicationRef=U(Jr)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function ZN({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new Ee(Se(z({},JN()),{scheduleInRootZone:t})),[{provide:Ee,useFactory:n},{provide:eo,multi:!0,useFactory:()=>{let r=U(YN,{optional:!0});return()=>r.initialize()}},{provide:eo,multi:!0,useFactory:()=>{let r=U(XN);return()=>{r.initialize()}}},e===!0?{provide:CD,useValue:!0}:[],{provide:bD,useValue:t??LE}]}function JN(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var XN=(()=>{class n{constructor(){this.subscription=new Oe,this.initialized=!1,this.zone=U(Ee),this.pendingTasks=U(co)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Ee.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Ee.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var eP=(()=>{class n{constructor(){this.appRef=U(Jr),this.taskService=U(co),this.ngZone=U(Ee),this.zonelessEnabled=U(Fp),this.disableScheduling=U(CD,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new Oe,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Nc):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(U(bD,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Ff||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?pI:jE;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Nc+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,pI(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function tP(){return typeof $localize<"u"&&$localize.locale||$c}var qp=new Q("",{providedIn:"root",factory:()=>U(qp,ae.Optional|ae.SkipSelf)||tP()});var tp=new Q("");function gc(n){return!n.moduleRef}function nP(n){let e=gc(n)?n.r3Injector:n.moduleRef.injector,t=e.get(Ee);return t.run(()=>{gc(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(Rn,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),gc(n)){let o=()=>e.destroy(),s=n.platformInjector.get(tp);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(tp);s.add(o),n.moduleRef.onDestroy(()=>{_c(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return KN(r,t,()=>{let o=e.get(FD);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(qp,$c);if(LN(s||$c),gc(n)){let a=e.get(Jr);return n.rootComponent!==void 0&&a.bootstrap(n.rootComponent),a}else return rP(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function rP(n,e){let t=n.injector.get(Jr);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new ee(-403,!1);e.push(n)}var wc=null;function iP(n=[],e){return Qr.create({name:e,providers:[{provide:Wc,useValue:"platform"},{provide:tp,useValue:new Set([()=>wc=null])},...n]})}function oP(n=[]){if(wc)return wc;let e=iP(n);return wc=e,zN(),sP(e),e}function sP(n){n.get(Cp,null)?.forEach(t=>t())}function zp(){return!1}var fo=(()=>{class n{static{this.__NG_ELEMENT_ID__=aP}}return n})();function aP(n){return uP(Ln(),Ze(),(n&16)===16)}function uP(n,e,t){if(hp(n)&&!t){let r=sa(n.index,e);return new io(r,r)}else if(n.type&175){let r=e[Qt];return new io(r,e)}return null}function LD(n){try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=oP(r),o=[ZN({}),{provide:oo,useExisting:eP},...t||[]],s=new jc({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return nP({r3Injector:s.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}}function Gp(n){let e=pe(null);try{return n()}finally{pe(e)}}var UD=null;function po(){return UD}function $D(n){UD??=n}var ul=class{};var jt=new Q(""),HD=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:()=>U(fP),providedIn:"platform"})}}return n})();var fP=(()=>{class n extends HD{constructor(){super(),this._doc=U(jt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return po().getBaseHref(this._doc)}onPopState(t){let r=po().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=po().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function qD(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function VD(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Xr(n){return n&&n[0]!=="?"?"?"+n:n}var ll=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:()=>U(zD),providedIn:"root"})}}return n})(),pP=new Q(""),zD=(()=>{class n extends ll{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??U(jt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return qD(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Xr(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+Xr(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+Xr(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)($(HD),$(pP,8))}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ha=(()=>{class n{constructor(t){this._subject=new pt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=yP(VD(jD(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Xr(r))}normalize(t){return n.stripTrailingSlash(mP(this._basePath,jD(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Xr(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Xr(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=Xr}static{this.joinWithSlash=qD}static{this.stripTrailingSlash=VD}static{this.\u0275fac=function(r){return new(r||n)($(ll))}}static{this.\u0275prov=J({token:n,factory:()=>gP(),providedIn:"root"})}}return n})();function gP(){return new ha($(ll))}function mP(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function jD(n){return n.replace(/\/index.html$/,"")}function yP(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function GD(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}function vP(n,e){return new ee(2100,!1)}var Wp=class{createSubscription(e,t){return Gp(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){Gp(()=>e.unsubscribe())}},Kp=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},_P=new Kp,wP=new Wp,WD=(()=>{class n{constructor(t){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,r=>this._updateLatestValue(t,r))}_selectStrategy(t){if(ho(t))return _P;if(Up(t))return wP;throw vP(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,r){t===this._obj&&(this._latestValue=r,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static{this.\u0275fac=function(r){return new(r||n)(ca(fo,16))}}static{this.\u0275pipe=zI({name:"async",type:n,pure:!1,standalone:!0})}}return n})();var Qp=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Nn({type:n})}static{this.\u0275inj=Mn({})}}return n})(),KD="browser",IP="server";function ei(n){return n===IP}var cl=class{};var Jp=class extends ul{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Xp=class n extends Jp{static makeCurrent(){$D(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=DP();return t==null?null:TP(t)}resetBaseElement(){fa=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return GD(document.cookie,e)}},fa=null;function DP(){return fa=fa||document.querySelector("base"),fa?fa.getAttribute("href"):null}function TP(n){return new URL(n,document.baseURI).pathname}var CP=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac})}}return n})(),eg=new Q(""),JD=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new ee(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)($(eg),$(Ee))}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac})}}return n})(),dl=class{constructor(e){this._doc=e}},Yp="ng-app-id",XD=(()=>{class n{constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=ei(o),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${Yp}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let o=i.get(t);return o.usage+=r,o.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,o=i?.get(r);if(o?.parentNode===t)return i.delete(r),o.removeAttribute(Yp),o;{let s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=r,this.platformIsServer&&s.setAttribute(Yp,this.appId),t.appendChild(s),s}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),o=this.styleRef,s=o.get(r)?.elements;s?s.push(i):o.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)($(jt),$(Tp),$(bp,8),$(Vt))}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac})}}return n})(),Zp={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},ng=/%COMP%/g,eT="%COMP%",bP=`_nghost-${eT}`,SP=`_ngcontent-${eT}`,AP=!0,xP=new Q("",{providedIn:"root",factory:()=>AP});function RP(n){return SP.replace(ng,n)}function MP(n){return bP.replace(ng,n)}function tT(n,e){return e.map(t=>t.replace(ng,n))}var QD=(()=>{class n{constructor(t,r,i,o,s,a,u,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=ei(a),this.defaultRenderer=new pa(t,s,u,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===ln.ShadowDom&&(r=Se(z({},r),{encapsulation:ln.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof hl?i.applyToHost(t):i instanceof ga&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(r.encapsulation){case ln.Emulated:o=new hl(u,l,r,this.appId,h,s,a,p);break;case ln.ShadowDom:return new tg(u,l,t,r,s,a,this.nonce,p);default:o=new ga(u,l,r,h,s,a,p);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)($(JD),$(XD),$(Tp),$(xP),$(jt),$(Vt),$(Ee),$(bp))}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac})}}return n})(),pa=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Zp[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(YD(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(YD(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ee(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=Zp[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Zp[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Zr.DashCase|Zr.Important)?e.style.setProperty(t,r,i&Zr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Zr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=po().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function YD(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var tg=class extends pa{constructor(e,t,r,i,o,s,a,u){super(e,o,s,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=tT(i.id,i.styles);for(let h of l){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=h,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},ga=class extends pa{constructor(e,t,r,i,o,s,a,u){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=u?tT(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},hl=class extends ga{constructor(e,t,r,i,o,s,a,u){let l=i+"-"+r.id;super(e,t,r,o,s,a,u,l),this.contentAttr=RP(l),this.hostAttr=MP(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},NP=(()=>{class n extends dl{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)($(jt))}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac})}}return n})(),ZD=["alt","control","meta","shift"],PP={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},kP={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},OP=(()=>{class n extends dl{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let o=n.parseEventName(r),s=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>po().onAndCancel(t,o.domEventName,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),ZD.forEach(l=>{let h=r.indexOf(l);h>-1&&(r.splice(h,1),s+=l+".")}),s+=o,r.length!=0||o.length===0)return null;let u={};return u.domEventName=i,u.fullKey=s,u}static matchEventFullKeyCode(t,r){let i=PP[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),ZD.forEach(s=>{if(s!==i){let a=kP[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)($(jt))}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac})}}return n})();function nT(n,e){return LD(z({rootComponent:n},FP(e)))}function FP(n){return{appProviders:[...UP,...n?.providers??[]],platformProviders:BP}}function LP(){Xp.makeCurrent()}function VP(){return new Rn}function jP(){return GE(document),document}var BP=[{provide:Vt,useValue:KD},{provide:Cp,useValue:LP,multi:!0},{provide:jt,useFactory:jP,deps:[]}];var UP=[{provide:Wc,useValue:"root"},{provide:Rn,useFactory:VP,deps:[]},{provide:eg,useClass:NP,multi:!0,deps:[jt,Ee,Vt]},{provide:eg,useClass:OP,multi:!0,deps:[jt]},QD,XD,JD,{provide:ao,useExisting:QD},{provide:cl,useClass:CP,deps:[]},[]];var rT=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)($(jt))}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var oe="primary",Na=Symbol("RouteTitle"),ag=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function wo(n){return new ag(n)}function HP(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function qP(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!dn(n[t],e[t]))return!1;return!0}function dn(n,e){let t=n?ug(n):void 0,r=e?ug(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!dT(n[i],e[i]))return!1;return!0}function ug(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function dT(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function hT(n){return n.length>0?n[n.length-1]:null}function lr(n){return ef(n)?n:ho(n)?_e(Promise.resolve(n)):Y(n)}var zP={exact:pT,subset:gT},fT={exact:GP,subset:WP,ignored:()=>!0};function iT(n,e,t){return zP[t.paths](n.root,e.root,t.matrixParams)&&fT[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function GP(n,e){return dn(n,e)}function pT(n,e,t){if(!ni(n.segments,e.segments)||!gl(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!pT(n.children[r],e.children[r],t))return!1;return!0}function WP(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>dT(n[t],e[t]))}function gT(n,e,t){return mT(n,e,e.segments,t)}function mT(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!ni(i,t)||e.hasChildren()||!gl(i,t,r))}else if(n.segments.length===t.length){if(!ni(n.segments,t)||!gl(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!gT(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!ni(n.segments,i)||!gl(n.segments,i,r)||!n.children[oe]?!1:mT(n.children[oe],e,o,r)}}function gl(n,e,t){return e.every((r,i)=>fT[t](n[i].parameters,r.parameters))}var jn=class{constructor(e=new ve([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=wo(this.queryParams),this._queryParamMap}toString(){return YP.serialize(this)}},ve=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ml(this)}},ti=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=wo(this.parameters),this._parameterMap}toString(){return vT(this)}};function KP(n,e){return ni(n,e)&&n.every((t,r)=>dn(t.parameters,e[r].parameters))}function ni(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function QP(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===oe&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==oe&&(t=t.concat(e(i,r)))}),t}var kg=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:()=>new Ea,providedIn:"root"})}}return n})(),Ea=class{parse(e){let t=new lg(e);return new jn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${ma(e.root,!0)}`,r=XP(e.queryParams),i=typeof e.fragment=="string"?`#${ZP(e.fragment)}`:"";return`${t}${r}${i}`}},YP=new Ea;function ml(n){return n.segments.map(e=>vT(e)).join("/")}function ma(n,e){if(!n.hasChildren())return ml(n);if(e){let t=n.children[oe]?ma(n.children[oe],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==oe&&r.push(`${i}:${ma(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=QP(n,(r,i)=>i===oe?[ma(n.children[oe],!1)]:[`${i}:${ma(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[oe]!=null?`${ml(n)}/${t[0]}`:`${ml(n)}/(${t.join("//")})`}}function yT(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function fl(n){return yT(n).replace(/%3B/gi,";")}function ZP(n){return encodeURI(n)}function cg(n){return yT(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function yl(n){return decodeURIComponent(n)}function oT(n){return yl(n.replace(/\+/g,"%20"))}function vT(n){return`${cg(n.path)}${JP(n.parameters)}`}function JP(n){return Object.entries(n).map(([e,t])=>`;${cg(e)}=${cg(t)}`).join("")}function XP(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${fl(t)}=${fl(i)}`).join("&"):`${fl(t)}=${fl(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var ek=/^[^\/()?;#]+/;function rg(n){let e=n.match(ek);return e?e[0]:""}var tk=/^[^\/()?;=#]+/;function nk(n){let e=n.match(tk);return e?e[0]:""}var rk=/^[^=?&#]+/;function ik(n){let e=n.match(rk);return e?e[0]:""}var ok=/^[^&#]+/;function sk(n){let e=n.match(ok);return e?e[0]:""}var lg=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ve([],{}):new ve([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[oe]=new ve(e,t)),r}parseSegment(){let e=rg(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ee(4009,!1);return this.capture(e),new ti(yl(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=nk(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=rg(this.remaining);i&&(r=i,this.capture(r))}e[yl(t)]=yl(r)}parseQueryParam(e){let t=ik(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=sk(this.remaining);s&&(r=s,this.capture(r))}let i=oT(t),o=oT(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=rg(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ee(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=oe);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[oe]:new ve([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ee(4011,!1)}};function _T(n){return n.segments.length>0?new ve([],{[oe]:n}):n}function wT(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=wT(i);if(r===oe&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new ve(n.segments,e);return ak(t)}function ak(n){if(n.numberOfChildren===1&&n.children[oe]){let e=n.children[oe];return new ve(n.segments.concat(e.segments),e.children)}return n}function Da(n){return n instanceof jn}function uk(n,e,t=null,r=null){let i=IT(n);return ET(i,e,t,r)}function IT(n){let e;function t(o){let s={};for(let u of o.children){let l=t(u);s[u.outlet]=l}let a=new ve(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=_T(r);return e??i}function ET(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return ig(i,i,i,t,r);let o=ck(e);if(o.toRoot())return ig(i,i,new ve([],{}),t,r);let s=lk(o,i,n),a=s.processChildren?_a(s.segmentGroup,s.index,o.commands):TT(s.segmentGroup,s.index,o.commands);return ig(i,s.segmentGroup,a,t,r)}function vl(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Ta(n){return typeof n=="object"&&n!=null&&n.outlets}function ig(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([u,l])=>{o[u]=Array.isArray(l)?l.map(h=>`${h}`):`${l}`});let s;n===e?s=t:s=DT(n,e,t);let a=_T(wT(s));return new jn(a,o,i)}function DT(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=DT(o,e,t)}),new ve(n.segments,r)}var _l=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&vl(r[0]))throw new ee(4003,!1);let i=r.find(Ta);if(i&&i!==hT(r))throw new ee(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function ck(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new _l(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([u,l])=>{a[u]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new _l(t,e,r)}var yo=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function lk(n,e,t){if(n.isAbsolute)return new yo(e,!0,0);if(!t)return new yo(e,!1,NaN);if(t.parent===null)return new yo(t,!0,0);let r=vl(n.commands[0])?0:1,i=t.segments.length-1+r;return dk(t,i,n.numberOfDoubleDots)}function dk(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new ee(4005,!1);i=r.segments.length}return new yo(r,!1,i-o)}function hk(n){return Ta(n[0])?n[0].outlets:{[oe]:n}}function TT(n,e,t){if(n??=new ve([],{}),n.segments.length===0&&n.hasChildren())return _a(n,e,t);let r=fk(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new ve(n.segments.slice(0,r.pathIndex),{});return o.children[oe]=new ve(n.segments.slice(r.pathIndex),n.children),_a(o,0,i)}else return r.match&&i.length===0?new ve(n.segments,{}):r.match&&!n.hasChildren()?dg(n,e,t):r.match?_a(n,0,i):dg(n,e,t)}function _a(n,e,t){if(t.length===0)return new ve(n.segments,{});{let r=hk(t),i={};if(Object.keys(r).some(o=>o!==oe)&&n.children[oe]&&n.numberOfChildren===1&&n.children[oe].segments.length===0){let o=_a(n.children[oe],e,t);return new ve(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=TT(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new ve(n.segments,i)}}function fk(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(Ta(a))break;let u=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&u===void 0)break;if(u&&l&&typeof l=="object"&&l.outlets===void 0){if(!aT(u,l,s))return o;r+=2}else{if(!aT(u,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function dg(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Ta(o)){let u=pk(o.outlets);return new ve(r,u)}if(i===0&&vl(t[0])){let u=n.segments[e];r.push(new ti(u.path,sT(t[0]))),i++;continue}let s=Ta(o)?o.outlets[oe]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&vl(a)?(r.push(new ti(s,sT(a))),i+=2):(r.push(new ti(s,{})),i++)}return new ve(r,{})}function pk(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=dg(new ve([],{}),0,r))}),e}function sT(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function aT(n,e,t){return n==t.path&&dn(e,t.parameters)}var wa="imperative",et=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(et||{}),Bt=class{constructor(e,t){this.id=e,this.url=t}},Ca=class extends Bt{constructor(e,t,r="imperative",i=null){super(e,t),this.type=et.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ri=class extends Bt{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=et.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},At=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(At||{}),hg=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(hg||{}),Vn=class extends Bt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=et.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ii=class extends Bt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=et.NavigationSkipped}},ba=class extends Bt{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=et.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},wl=class extends Bt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=et.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fg=class extends Bt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=et.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},pg=class extends Bt{constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o,this.type=et.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},gg=class extends Bt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=et.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},mg=class extends Bt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=et.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},yg=class{constructor(e){this.route=e,this.type=et.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},vg=class{constructor(e){this.route=e,this.type=et.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},_g=class{constructor(e){this.snapshot=e,this.type=et.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},wg=class{constructor(e){this.snapshot=e,this.type=et.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ig=class{constructor(e){this.snapshot=e,this.type=et.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Eg=class{constructor(e){this.snapshot=e,this.type=et.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Sa=class{},Io=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function gk(n,e){return n.providers&&!n._injector&&(n._injector=Vp(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Jt(n){return n.outlet||oe}function mk(n,e){let t=n.filter(r=>Jt(r)===e);return t.push(...n.filter(r=>Jt(r)!==e)),t}function Pa(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Dg=class{get injector(){return Pa(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new Sl(this.rootInjector),this.attachRef=null}},Sl=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Dg(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)($(Ft))}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Il=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Tg(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Tg(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Cg(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Cg(e,this._root).map(t=>t.value)}};function Tg(n,e){if(n===e.value)return e;for(let t of e.children){let r=Tg(n,t);if(r)return r}return null}function Cg(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Cg(n,t);if(r.length)return r.unshift(e),r}return[]}var St=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function mo(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var El=class extends Il{constructor(e,t){super(e),this.snapshot=t,Og(this,e)}toString(){return this.snapshot.toString()}};function CT(n){let e=yk(n),t=new Xe([new ti("",{})]),r=new Xe({}),i=new Xe({}),o=new Xe({}),s=new Xe(""),a=new Eo(t,r,o,s,i,oe,n,e.root);return a.snapshot=e.root,new El(new St(a,[]),e)}function yk(n){let e={},t={},r={},i="",o=new vo([],e,r,i,t,oe,n,null,{});return new Tl("",new St(o,[]))}var Eo=class{constructor(e,t,r,i,o,s,a,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(Z(l=>l[Na]))??Y(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Z(e=>wo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Z(e=>wo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Dl(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:z(z({},e.params),n.params),data:z(z({},e.data),n.data),resolve:z(z(z(z({},n.data),e.data),i?.data),n._resolvedData)}:r={params:z({},n.params),data:z({},n.data),resolve:z(z({},n.data),n._resolvedData??{})},i&&ST(i)&&(r.resolve[Na]=i.title),r}var vo=class{get title(){return this.data?.[Na]}constructor(e,t,r,i,o,s,a,u,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=u,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=wo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=wo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Tl=class extends Il{constructor(e,t){super(t),this.url=e,Og(this,t)}toString(){return bT(this._root)}};function Og(n,e){e.value._routerState=n,e.children.forEach(t=>Og(n,t))}function bT(n){let e=n.children.length>0?` { ${n.children.map(bT).join(", ")} } `:"";return`${n.value}${e}`}function og(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,dn(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),dn(e.params,t.params)||n.paramsSubject.next(t.params),qP(e.url,t.url)||n.urlSubject.next(t.url),dn(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function bg(n,e){let t=dn(n.params,e.params)&&KP(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||bg(n.parent,e.parent))}function ST(n){return typeof n.title=="string"||n.title===null}var Fg=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=oe,this.activateEvents=new pt,this.deactivateEvents=new pt,this.attachEvents=new pt,this.detachEvents=new pt,this.parentContexts=U(Sl),this.location=U(ol),this.changeDetector=U(fo),this.inputBinder=U(Lg,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ee(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ee(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ee(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new ee(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new Sg(t,a,i.injector);this.activated=i.createComponent(s,{index:i.length,injector:u,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=ap({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Qc]})}}return n})(),Sg=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Eo?this.route:e===Sl?this.childContexts:this.parent.get(e,t)}},Lg=new Q("");function vk(n,e,t){let r=Aa(n,e._root,t?t._root:void 0);return new El(r,e)}function Aa(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=_k(n,e,t);return new St(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Aa(n,a)),s}}let r=wk(e.value),i=e.children.map(o=>Aa(n,o));return new St(r,i)}}function _k(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Aa(n,r,i);return Aa(n,r)})}function wk(n){return new Eo(new Xe(n.url),new Xe(n.params),new Xe(n.queryParams),new Xe(n.fragment),new Xe(n.data),n.outlet,n.component,n)}var xa=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},AT="ngNavigationCancelingError";function Cl(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Da(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=xT(!1,At.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function xT(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[AT]=!0,t.cancellationCode=e,t}function Ik(n){return RT(n)&&Da(n.url)}function RT(n){return!!n&&n[AT]}var Ek=(n,e,t,r)=>Z(i=>(new Ag(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Ag=class{constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),og(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=mo(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=mo(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=mo(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=mo(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new Eg(o.value.snapshot))}),e.children.length&&this.forwardEvent(new wg(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(og(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),og(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},bl=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},_o=class{constructor(e,t){this.component=e,this.route=t}};function Dk(n,e,t){let r=n._root,i=e?e._root:null;return ya(r,i,t,[r.value])}function Tk(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function To(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!kI(n)?n:e.get(n):r}function ya(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=mo(e);return n.children.forEach(s=>{Ck(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Ia(a,t.getContext(s),i)),i}function Ck(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let u=bk(s,o,o.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new bl(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?ya(n,e,a?a.children:null,r,i):ya(n,e,t,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new _o(a.outlet.component,s))}else s&&Ia(e,a,i),i.canActivateChecks.push(new bl(r)),o.component?ya(n,null,a?a.children:null,r,i):ya(n,null,t,r,i);return i}function bk(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!ni(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ni(n.url,e.url)||!dn(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!bg(n,e)||!dn(n.queryParams,e.queryParams);case"paramsChange":default:return!bg(n,e)}}function Ia(n,e,t){let r=mo(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?Ia(s,e.children.getContext(o),t):Ia(s,null,t):Ia(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new _o(e.outlet.component,i)):t.canDeactivateChecks.push(new _o(null,i)):t.canDeactivateChecks.push(new _o(null,i))}function ka(n){return typeof n=="function"}function Sk(n){return typeof n=="boolean"}function Ak(n){return n&&ka(n.canLoad)}function xk(n){return n&&ka(n.canActivate)}function Rk(n){return n&&ka(n.canActivateChild)}function Mk(n){return n&&ka(n.canDeactivate)}function Nk(n){return n&&ka(n.canMatch)}function MT(n){return n instanceof bn||n?.name==="EmptyError"}var pl=Symbol("INITIAL_VALUE");function Do(){return Ve(n=>cc(n.map(e=>e.pipe(Sn(1),Ur(pl)))).pipe(Z(e=>{for(let t of e)if(t!==!0){if(t===pl)return pl;if(t===!1||Pk(t))return t}return!0}),at(e=>e!==pl),Sn(1)))}function Pk(n){return Da(n)||n instanceof xa}function kk(n,e){return We(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?Y(Se(z({},t),{guardsResult:!0})):Ok(s,r,i,n).pipe(We(a=>a&&Sk(a)?Fk(r,o,n,e):Y(a)),Z(a=>Se(z({},t),{guardsResult:a})))})}function Ok(n,e,t,r){return _e(n).pipe(We(i=>Uk(i.component,i.route,t,e,r)),Nt(i=>i!==!0,!0))}function Fk(n,e,t,r){return _e(e).pipe(Wi(i=>Gi(Vk(i.route.parent,r),Lk(i.route,r),Bk(n,i.path,t),jk(n,i.route,t))),Nt(i=>i!==!0,!0))}function Lk(n,e){return n!==null&&e&&e(new Ig(n)),Y(!0)}function Vk(n,e){return n!==null&&e&&e(new _g(n)),Y(!0)}function jk(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return Y(!0);let i=r.map(o=>lc(()=>{let s=Pa(e)??t,a=To(o,s),u=xk(a)?a.canActivate(e,n):Pn(s,()=>a(e,n));return lr(u).pipe(Nt())}));return Y(i).pipe(Do())}function Bk(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>Tk(s)).filter(s=>s!==null).map(s=>lc(()=>{let a=s.guards.map(u=>{let l=Pa(s.node)??t,h=To(u,l),p=Rk(h)?h.canActivateChild(r,n):Pn(l,()=>h(r,n));return lr(p).pipe(Nt())});return Y(a).pipe(Do())}));return Y(o).pipe(Do())}function Uk(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return Y(!0);let s=o.map(a=>{let u=Pa(e)??i,l=To(a,u),h=Mk(l)?l.canDeactivate(n,e,t,r):Pn(u,()=>l(n,e,t,r));return lr(h).pipe(Nt())});return Y(s).pipe(Do())}function $k(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return Y(!0);let o=i.map(s=>{let a=To(s,n),u=Ak(a)?a.canLoad(e,t):Pn(n,()=>a(e,t));return lr(u)});return Y(o).pipe(Do(),NT(r))}function NT(n){return Kh(Ke(e=>{if(typeof e!="boolean")throw Cl(n,e)}),Z(e=>e===!0))}function Hk(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return Y(!0);let o=i.map(s=>{let a=To(s,n),u=Nk(a)?a.canMatch(e,t):Pn(n,()=>a(e,t));return lr(u)});return Y(o).pipe(Do(),NT(r))}var Ra=class{constructor(e){this.segmentGroup=e||null}},Ma=class extends Error{constructor(e){super(),this.urlTree=e}};function go(n){return zi(new Ra(n))}function qk(n){return zi(new ee(4e3,!1))}function zk(n){return zi(xT(!1,At.GuardRejected))}var xg=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return Y(r);if(i.numberOfChildren>1||!i.children[oe])return qk(`${e.redirectTo}`);i=i.children[oe]}}applyRedirectCommands(e,t,r,i,o){if(typeof t!="string"){let a=t,{queryParams:u,fragment:l,routeConfig:h,url:p,outlet:m,params:y,data:C,title:A}=i,M=Pn(o,()=>a({params:y,data:C,queryParams:u,fragment:l,routeConfig:h,url:p,outlet:m,title:A}));if(M instanceof jn)throw new Ma(M);t=M}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new Ma(s);return s}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new jn(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,u])=>{s[a]=this.createSegmentGroup(e,u,r,i)}),new ve(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new ee(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Rg={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Gk(n,e,t,r,i){let o=PT(n,e,t);return o.matched?(r=gk(e,r),Hk(r,e,t,i).pipe(Z(s=>s===!0?o:z({},Rg)))):Y(o)}function PT(n,e,t){if(e.path==="**")return Wk(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?z({},Rg):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||HP)(t,n,e);if(!i)return z({},Rg);let o={};Object.entries(i.posParams??{}).forEach(([a,u])=>{o[a]=u.path});let s=i.consumed.length>0?z(z({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function Wk(n){return{matched:!0,parameters:n.length>0?hT(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function uT(n,e,t,r){return t.length>0&&Yk(n,t,r)?{segmentGroup:new ve(e,Qk(r,new ve(t,n.children))),slicedSegments:[]}:t.length===0&&Zk(n,t,r)?{segmentGroup:new ve(n.segments,Kk(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new ve(n.segments,n.children),slicedSegments:t}}function Kk(n,e,t,r){let i={};for(let o of t)if(Al(n,e,o)&&!r[Jt(o)]){let s=new ve([],{});i[Jt(o)]=s}return z(z({},r),i)}function Qk(n,e){let t={};t[oe]=e;for(let r of n)if(r.path===""&&Jt(r)!==oe){let i=new ve([],{});t[Jt(r)]=i}return t}function Yk(n,e,t){return t.some(r=>Al(n,e,r)&&Jt(r)!==oe)}function Zk(n,e,t){return t.some(r=>Al(n,e,r))}function Al(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function Jk(n,e,t){return e.length===0&&!n.children[t]}var Mg=class{};function Xk(n,e,t,r,i,o,s="emptyOnly"){return new Ng(n,e,t,r,i,s,o).recognize()}var e1=31,Ng=class{constructor(e,t,r,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new xg(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new ee(4002,`'${e.segmentGroup}'`)}recognize(){let e=uT(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Z(({children:t,rootSnapshot:r})=>{let i=new St(r,t),o=new Tl("",i),s=uk(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new vo([],Object.freeze({}),Object.freeze(z({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),oe,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,oe,t).pipe(Z(r=>({children:r,rootSnapshot:t})),tr(r=>{if(r instanceof Ma)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Ra?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(Z(s=>s instanceof St?[s]:[]))}processChildren(e,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return _e(o).pipe(Wi(s=>{let a=r.children[s],u=mk(t,s);return this.processSegmentGroup(e,u,a,s,i)}),Br((s,a)=>(s.push(...a),s)),nr(null),of(),We(s=>{if(s===null)return go(r);let a=kT(s);return t1(a),Y(a)}))}processSegment(e,t,r,i,o,s,a){return _e(t).pipe(Wi(u=>this.processSegmentAgainstRoute(u._injector??e,t,u,r,i,o,s,a).pipe(tr(l=>{if(l instanceof Ra)return Y(null);throw l}))),Nt(u=>!!u),tr(u=>{if(MT(u))return Jk(r,i,o)?Y(new Mg):go(r);throw u}))}processSegmentAgainstRoute(e,t,r,i,o,s,a,u){return Jt(r)!==s&&(s===oe||!Al(i,o,r))?go(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s,u):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,u):go(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:u,parameters:l,consumedSegments:h,positionalParamSegments:p,remainingSegments:m}=PT(t,i,o);if(!u)return go(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>e1&&(this.allowRedirects=!1));let y=new vo(o,l,Object.freeze(z({},this.urlTree.queryParams)),this.urlTree.fragment,cT(i),Jt(i),i.component??i._loadedComponent??null,i,lT(i)),C=Dl(y,a,this.paramsInheritanceStrategy);y.params=Object.freeze(C.params),y.data=Object.freeze(C.data);let A=this.applyRedirects.applyRedirectCommands(h,i.redirectTo,p,y,e);return this.applyRedirects.lineralizeSegments(i,A).pipe(We(M=>this.processSegment(e,r,t,M.concat(m),s,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,o,s){let a=Gk(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(Ve(u=>u.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Ve(({routes:l})=>{let h=r._loadedInjector??e,{parameters:p,consumedSegments:m,remainingSegments:y}=u,C=new vo(m,p,Object.freeze(z({},this.urlTree.queryParams)),this.urlTree.fragment,cT(r),Jt(r),r.component??r._loadedComponent??null,r,lT(r)),A=Dl(C,s,this.paramsInheritanceStrategy);C.params=Object.freeze(A.params),C.data=Object.freeze(A.data);let{segmentGroup:M,slicedSegments:O}=uT(t,m,y,l);if(O.length===0&&M.hasChildren())return this.processChildren(h,l,M,C).pipe(Z(F=>new St(C,F)));if(l.length===0&&O.length===0)return Y(new St(C,[]));let B=Jt(r)===o;return this.processSegment(h,l,M,O,B?oe:o,!0,C).pipe(Z(F=>new St(C,F instanceof St?[F]:[])))}))):go(t)))}getChildConfig(e,t,r){return t.children?Y({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Y({routes:t._loadedRoutes,injector:t._loadedInjector}):$k(e,t,r,this.urlSerializer).pipe(We(i=>i?this.configLoader.loadChildren(e,t).pipe(Ke(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):zk(t))):Y({routes:[],injector:e})}};function t1(n){n.sort((e,t)=>e.value.outlet===oe?-1:t.value.outlet===oe?1:e.value.outlet.localeCompare(t.value.outlet))}function n1(n){let e=n.value.routeConfig;return e&&e.path===""}function kT(n){let e=[],t=new Set;for(let r of n){if(!n1(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=kT(r.children);e.push(new St(r.value,i))}return e.filter(r=>!t.has(r))}function cT(n){return n.data||{}}function lT(n){return n.resolve||{}}function r1(n,e,t,r,i,o){return We(s=>Xk(n,e,t,r,s.extractedUrl,i,o).pipe(Z(({state:a,tree:u})=>Se(z({},s),{targetSnapshot:a,urlAfterRedirects:u}))))}function i1(n,e){return We(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Y(t);let o=new Set(i.map(u=>u.route)),s=new Set;for(let u of o)if(!s.has(u))for(let l of OT(u))s.add(l);let a=0;return _e(s).pipe(Wi(u=>o.has(u)?o1(u,r,n,e):(u.data=Dl(u,u.parent,n).resolve,Y(void 0))),Ke(()=>a++),Ki(1),We(u=>a===s.size?Y(t):ft))})}function OT(n){let e=n.children.map(t=>OT(t)).flat();return[n,...e]}function o1(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!ST(i)&&(o[Na]=i.title),s1(o,n,e,r).pipe(Z(s=>(n._resolvedData=s,n.data=Dl(n,n.parent,t).resolve,null)))}function s1(n,e,t,r){let i=ug(n);if(i.length===0)return Y({});let o={};return _e(i).pipe(We(s=>a1(n[s],e,t,r).pipe(Nt(),Ke(a=>{if(a instanceof xa)throw Cl(new Ea,a);o[s]=a}))),Ki(1),nf(o),tr(s=>MT(s)?ft:zi(s)))}function a1(n,e,t,r){let i=Pa(e)??r,o=To(n,i),s=o.resolve?o.resolve(e,t):Pn(i,()=>o(e,t));return lr(s)}function sg(n){return Ve(e=>{let t=n(e);return t?_e(t).pipe(Z(()=>e)):Y(e)})}var FT=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===oe);return r}getResolvedTitleForRoute(t){return t.data[Na]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:()=>U(u1),providedIn:"root"})}}return n})(),u1=(()=>{class n extends FT{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)($(rT))}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Vg=new Q("",{providedIn:"root",factory:()=>({})}),c1=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Gc({type:n,selectors:[["ng-component"]],standalone:!0,features:[sl],decls:1,vars:0,template:function(r,i){r&1&&lo(0,"router-outlet")},dependencies:[Fg],encapsulation:2})}}return n})();function jg(n){let e=n.children&&n.children.map(jg),t=e?Se(z({},n),{children:e}):z({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==oe&&(t.component=c1),t}var Bg=new Q(""),l1=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=U(Hp)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Y(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=lr(t.loadComponent()).pipe(Z(LT),Ke(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),Us(()=>{this.componentLoaders.delete(t)})),i=new Ui(r,()=>new Le).pipe(Bi());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Y({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=d1(r,this.compiler,t,this.onLoadEndListener).pipe(Us(()=>{this.childrenLoaders.delete(r)})),s=new Ui(o,()=>new Le).pipe(Bi());return this.childrenLoaders.set(r,s),s}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function d1(n,e,t,r){return lr(n.loadChildren()).pipe(Z(LT),We(i=>i instanceof na||Array.isArray(i)?Y(i):_e(e.compileModuleAsync(i))),Z(i=>{r&&r(n);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(Bg,[],{optional:!0,self:!0}).flat()),{routes:s.map(jg),injector:o}}))}function h1(n){return n&&typeof n=="object"&&"default"in n}function LT(n){return h1(n)?n.default:n}var Ug=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:()=>U(f1),providedIn:"root"})}}return n})(),f1=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),p1=new Q("");var g1=new Q(""),m1=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Le,this.transitionAbortSubject=new Le,this.configLoader=U(l1),this.environmentInjector=U(Ft),this.urlSerializer=U(kg),this.rootContexts=U(Sl),this.location=U(ha),this.inputBindingEnabled=U(Lg,{optional:!0})!==null,this.titleStrategy=U(FT),this.options=U(Vg,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=U(Ug),this.createViewTransition=U(p1,{optional:!0}),this.navigationErrorHandler=U(g1,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Y(void 0),this.rootComponentType=null;let t=i=>this.events.next(new yg(i)),r=i=>this.events.next(new vg(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(Se(z(z({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new Xe({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:wa,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(at(o=>o.id!==0),Z(o=>Se(z({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ve(o=>{let s=!1,a=!1;return Y(o).pipe(Ve(u=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",At.SupersededByNewNavigation),ft;this.currentTransition=o,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,targetBrowserUrl:typeof u.extras.browserUrl=="string"?this.urlSerializer.parse(u.extras.browserUrl):u.extras.browserUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?Se(z({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=u.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!l&&h!=="reload"){let p="";return this.events.next(new ii(u.id,this.urlSerializer.serialize(u.rawUrl),p,hg.IgnoredSameUrlNavigation)),u.resolve(!1),ft}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return Y(u).pipe(Ve(p=>{let m=this.transitions?.getValue();return this.events.next(new Ca(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),m!==this.transitions?.getValue()?ft:Promise.resolve(p)}),r1(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Ke(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=Se(z({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let m=new wl(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(m)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:p,extractedUrl:m,source:y,restoredState:C,extras:A}=u,M=new Ca(p,this.urlSerializer.serialize(m),y,C);this.events.next(M);let O=CT(this.rootComponentType).snapshot;return this.currentTransition=o=Se(z({},u),{targetSnapshot:O,urlAfterRedirects:m,extras:Se(z({},A),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=m,Y(o)}else{let p="";return this.events.next(new ii(u.id,this.urlSerializer.serialize(u.extractedUrl),p,hg.IgnoredByUrlHandlingStrategy)),u.resolve(!1),ft}}),Ke(u=>{let l=new fg(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),Z(u=>(this.currentTransition=o=Se(z({},u),{guards:Dk(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),o)),kk(this.environmentInjector,u=>this.events.next(u)),Ke(u=>{if(o.guardsResult=u.guardsResult,u.guardsResult&&typeof u.guardsResult!="boolean")throw Cl(this.urlSerializer,u.guardsResult);let l=new pg(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),at(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",At.GuardRejected),!1)),sg(u=>{if(u.guards.canActivateChecks.length)return Y(u).pipe(Ke(l=>{let h=new gg(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),Ve(l=>{let h=!1;return Y(l).pipe(i1(this.paramsInheritanceStrategy,this.environmentInjector),Ke({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(l,"",At.NoDataFromResolver)}}))}),Ke(l=>{let h=new mg(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}))}),sg(u=>{let l=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(Ke(m=>{h.component=m}),Z(()=>{})));for(let m of h.children)p.push(...l(m));return p};return cc(l(u.targetSnapshot.root)).pipe(nr(null),Sn(1))}),sg(()=>this.afterPreactivation()),Ve(()=>{let{currentSnapshot:u,targetSnapshot:l}=o,h=this.createViewTransition?.(this.environmentInjector,u.root,l.root);return h?_e(h).pipe(Z(()=>o)):Y(o)}),Z(u=>{let l=vk(t.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=o=Se(z({},u),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),Ke(()=>{this.events.next(new Sa)}),Ek(this.rootContexts,t.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),Sn(1),Ke({next:u=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ri(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{s=!0}}),af(this.transitionAbortSubject.pipe(Ke(u=>{throw u}))),Us(()=>{!s&&!a&&this.cancelNavigationTransition(o,"",At.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),tr(u=>{if(a=!0,RT(u))this.events.next(new Vn(o.id,this.urlSerializer.serialize(o.extractedUrl),u.message,u.cancellationCode)),Ik(u)?this.events.next(new Io(u.url,u.navigationBehaviorOptions)):o.resolve(!1);else{let l=new ba(o.id,this.urlSerializer.serialize(o.extractedUrl),u,o.targetSnapshot??void 0);try{let h=Pn(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(h instanceof xa){let{message:p,cancellationCode:m}=Cl(this.urlSerializer,h);this.events.next(new Vn(o.id,this.urlSerializer.serialize(o.extractedUrl),p,m)),this.events.next(new Io(h.redirectTo,h.navigationBehaviorOptions))}else{this.events.next(l);let p=t.errorHandler(u);o.resolve(!!p)}}catch(h){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(h)}}return ft}))}))}cancelNavigationTransition(t,r,i){let o=new Vn(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function y1(n){return n!==wa}var v1=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:()=>U(_1),providedIn:"root"})}}return n})(),Pg=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},_1=(()=>{class n extends Pg{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=wp(n)))(i||n)}})()}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),VT=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:()=>U(w1),providedIn:"root"})}}return n})(),w1=(()=>{class n extends VT{constructor(){super(...arguments),this.location=U(ha),this.urlSerializer=U(kg),this.options=U(Vg,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=U(Ug),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new jn,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=CT(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof Ca)this.stateMemento=this.createStateMemento();else if(t instanceof ii)this.rawUrlTree=r.initialUrl;else if(t instanceof wl){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof Sa?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof Vn&&(t.code===At.GuardRejected||t.code===At.NoDataFromResolver)?this.restoreHistory(r):t instanceof ba?this.restoreHistory(r,!0):t instanceof ri&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof jn?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let o=this.browserPageId,s=z(z({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(i,"",s)}else{let o=z(z({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===t.finalUrl&&o===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=wp(n)))(i||n)}})()}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),va=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(va||{});function I1(n,e){n.events.pipe(at(t=>t instanceof ri||t instanceof Vn||t instanceof ba||t instanceof ii),Z(t=>t instanceof ri||t instanceof ii?va.COMPLETE:(t instanceof Vn?t.code===At.Redirect||t.code===At.SupersededByNewNavigation:!1)?va.REDIRECTING:va.FAILED),at(t=>t!==va.REDIRECTING),Sn(1)).subscribe(()=>{e()})}function E1(n){throw n}var D1={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},T1={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},jT=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=U(al),this.stateManager=U(VT),this.options=U(Vg,{optional:!0})||{},this.pendingTasks=U(co),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=U(m1),this.urlSerializer=U(kg),this.location=U(ha),this.urlHandlingStrategy=U(Ug),this._events=new Le,this.errorHandler=this.options.errorHandler||E1,this.navigated=!1,this.routeReuseStrategy=U(v1),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=U(Bg,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!U(Lg,{optional:!0}),this.eventsSubscription=new Oe,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof Vn&&r.code!==At.Redirect&&r.code!==At.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof ri)this.navigated=!0;else if(r instanceof Io){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),u=z({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||y1(i.source)},s);this.scheduleNavigation(a,wa,null,u,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}b1(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),wa,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let u=z({},i);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(jg),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:u}=r,l=u?this.currentUrlTree.fragment:s,h=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":h=z(z({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let m=i?i.snapshot:this.routerState.snapshot.root;p=IT(m)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return ET(p,t,h,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Da(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,wa,null,r)}navigate(t,r={skipLocationChange:!1}){return C1(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=z({},D1):r===!1?i=z({},T1):i=r,Da(t))return iT(this.currentUrlTree,t,i);let o=this.parseUrl(t);return iT(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,u,l;s?(a=s.resolve,u=s.reject,l=s.promise):l=new Promise((p,m)=>{a=p,u=m});let h=this.pendingTasks.add();return I1(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(p=>Promise.reject(p))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function C1(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ee(4008,!1)}function b1(n){return!(n instanceof Sa)&&!(n instanceof Io)}var S1=new Q("");function BT(n,...e){return up([{provide:Bg,multi:!0,useValue:n},[],{provide:Eo,useFactory:A1,deps:[jT]},{provide:$p,multi:!0,useFactory:x1},e.map(t=>t.\u0275providers)])}function A1(n){return n.routerState.root}function x1(){let n=U(Qr);return e=>{let t=n.get(Jr);if(e!==t.components[0])return;let r=n.get(jT),i=n.get(R1);n.get(M1)===1&&r.initialNavigation(),n.get(N1,null,ae.Optional)?.setUpPreloading(),n.get(S1,null,ae.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var R1=new Q("",{factory:()=>new Le}),M1=new Q("",{providedIn:"root",factory:()=>1});var N1=new Q("");var P1="firebase",k1="10.14.1";er(P1,k1,"app");var Co=new ur("ANGULARFIRE2_VERSION");var O1=(n,e)=>{let t=e?[e]:ww(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},oi=class{constructor(){return O1(F1)}},F1="app-check";function $g(){}var xl=class{zone;delegate;constructor(e,t=Jh){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i.runGuarded(()=>{e.apply(this,[s])})};return this.delegate.schedule(o,t,r)}},Hg=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",$g,{},$g,$g)),t.pipe(Ke({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Rl=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new xl(Zone.current)),this.insideAngular=t.run(()=>new xl(Zone.current,js)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)($(Ee))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function L1(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function Dt(n){return V1(L1())(n)}function V1(n){return function(t){return t=t.lift(new Hg(n.ngZone)),t.pipe(Gt(n.outsideAngular),Mt(n.insideAngular))}}var U1=new Map,$1={activated:!1,tokenObservers:[]},H1={initialized:!1,enabled:!1};function Xt(n){return U1.get(n)||Object.assign({},$1)}function GT(){return H1}var q1="https://content-firebaseappcheck.googleapis.com/v1";var z1="exchangeDebugToken",$T={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},y4=24*60*60*1e3;var zg=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return N(this,null,function*(){this.stop();try{this.pending=new Mh,this.pending.promise.catch(t=>{}),yield G1(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Mh,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function G1(n){return new Promise(e=>{setTimeout(e,n)})}var W1={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},dr=new vw("appCheck","AppCheck",W1);function WT(n){if(!Xt(n).activated)throw dr.create("use-before-activation",{appName:n.name})}function KT(r,i){return N(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let y=yield s.getHeartbeatsHeader();y&&(o["X-Firebase-Client"]=y)}let a={method:"POST",body:JSON.stringify(e),headers:o},u;try{u=yield fetch(n,a)}catch(y){throw dr.create("fetch-network-error",{originalErrorMessage:y?.message})}if(u.status!==200)throw dr.create("fetch-status-error",{httpStatus:u.status});let l;try{l=yield u.json()}catch(y){throw dr.create("fetch-parse-error",{originalErrorMessage:y?.message})}let h=l.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw dr.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let p=Number(h[1])*1e3,m=Date.now();return{token:l.token,expireTimeMillis:m+p,issuedAtTimeMillis:m}})}function QT(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${q1}/projects/${t}/apps/${r}:${z1}?key=${i}`,body:{debug_token:e}}}var K1="firebase-app-check-database",Q1=1,Gg="firebase-app-check-store";var Ml=null;function Y1(){return Ml||(Ml=new Promise((n,e)=>{try{let t=indexedDB.open(K1,Q1);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(dr.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Gg,{keyPath:"compositeKey"})}}}catch(t){e(dr.create("storage-open",{originalErrorMessage:t?.message}))}}),Ml)}function Z1(n,e){return J1(X1(n),e)}function J1(n,e){return N(this,null,function*(){let r=(yield Y1()).transaction(Gg,"readwrite"),o=r.objectStore(Gg).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=u=>{s()},r.onerror=u=>{var l;a(dr.create("storage-set",{originalErrorMessage:(l=u.target.error)===null||l===void 0?void 0:l.message}))}})})}function X1(n){return`${n.options.appId}-${n.name}`}var Wg=new Hu("@firebase/app-check");function qg(n,e){return $u()?Z1(n,e).catch(t=>{Wg.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function YT(){return GT().enabled}function ZT(){return N(this,null,function*(){let n=GT();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var eO={error:"UNKNOWN_ERROR"};function tO(n){return gw.encodeString(JSON.stringify(n),!1)}function Kg(n,e=!1){return N(this,null,function*(){let t=n.app;WT(t);let r=Xt(t),i=r.token,o;if(i&&!Oa(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(Oa(u)?i=u:yield qg(t,void 0))}if(!e&&i&&Oa(i))return{token:i.token};let s=!1;if(YT()){r.exchangeTokenPromise||(r.exchangeTokenPromise=KT(QT(t,yield ZT()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),s=!0);let u=yield r.exchangeTokenPromise;return yield qg(t,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),s=!0),i=yield Xt(t).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?Wg.warn(u.message):Wg.error(u),o=u}let a;return i?o?Oa(i)?a={token:i.token,internalError:o}:a=qT(o):(a={token:i.token},r.token=i,yield qg(t,i)):a=qT(o),s&&oO(t,a),a})}function nO(n){return N(this,null,function*(){let e=n.app;WT(e);let{provider:t}=Xt(e);if(YT()){let r=yield ZT(),{token:i}=yield KT(QT(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function rO(n,e,t,r){let{app:i}=n,o=Xt(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&Oa(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),HT(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>HT(n))}function JT(n,e){let t=Xt(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function HT(n){let{app:e}=n,t=Xt(e),r=t.tokenRefresher;r||(r=iO(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function iO(n){let{app:e}=n;return new zg(()=>N(this,null,function*(){let t=Xt(e),r;if(t.token?r=yield Kg(n,!0):r=yield Kg(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Xt(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},$T.RETRIAL_MIN_WAIT,$T.RETRIAL_MAX_WAIT)}function oO(n,e){let t=Xt(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Oa(n){return n.expireTimeMillis-Date.now()>0}function qT(n){return{token:tO(eO),error:n}}var Qg=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Xt(this.app);for(let t of e)JT(this.app,t.next);return Promise.resolve()}};function sO(n,e){return new Qg(n,e)}function aO(n){return{getToken:e=>Kg(n,e),getLimitedUseToken:()=>nO(n),addTokenListener:e=>rO(n,"INTERNAL",e),removeTokenListener:e=>JT(n.app,e)}}var uO="@firebase/app-check",cO="0.8.8";var lO="app-check",zT="app-check-internal";function dO(){Os(new Fr(lO,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return sO(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(zT).initialize()})),Os(new Fr(zT,n=>{let e=n.getProvider("app-check").getImmediate();return aO(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),er(uO,cO)}dO();var hO=["localhost","0.0.0.0","127.0.0.1"],x4=typeof window<"u"&&hO.includes(window.location.hostname);var fO="firebase",pO="10.14.1";wt.registerVersion(fO,pO,"app-compat");var gO=["ngOnDestroy"],tC=(n,e,t,r={})=>new Proxy(n,{get:(i,o)=>t.runOutsideAngular(()=>{if(n[o])return r?.spy?.get&&r.spy.get(o,n[o]),n[o];if(gO.indexOf(o)>-1)return()=>{};let s=e.toPromise().then(a=>{let u=a?.[o];return typeof u=="function"?u.bind(a):u?.then?u.then(l=>t.run(()=>l)):t.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>s[u],apply:(a,u,l)=>s.then(h=>{let p=h?.(...l);return r?.spy?.apply&&r.spy.apply(o,l,p),p})})})});var Nl=class{constructor(e){return e}},bo=new Q("angularfire2.app.options"),So=new Q("angularfire2.app.name");function Fa(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let s=wt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>wt.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(s.options)){let a=!!module.hot;mO("error",`${s.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Nl(s)}var mO=(n,...e)=>{zp()&&typeof console<"u"&&console[n](...e)},yO={provide:Nl,useFactory:Fa,deps:[bo,Ee,[new zc,So]]},nC=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:bo,useValue:t},{provide:So,useValue:r}]}}constructor(t){wt.registerVersion("angularfire",Co.full,"core"),wt.registerVersion("angularfire",Co.full,"app-compat"),wt.registerVersion("angular",PD.full,t.toString())}static \u0275fac=function(r){return new(r||n)($(Vt))};static \u0275mod=Nn({type:n});static \u0275inj=Mn({providers:[yO]})}return n})();function Pl(n,e,t,r,i){let[,o,s]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(o)return vO(i,s)||(eC("error",`${e} was already initialized on the ${t} Firebase App with different settings.${_O?" You may need to reload as Firebase is not HMR aware.":""}`),eC("warn",{is:i,was:s})),o;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function vO(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var _O=typeof module<"u"&&!!module.hot,eC=(n,...e)=>{zp()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Yg=new Q("angularfire2.auth.use-emulator"),Zg=new Q("angularfire2.auth.settings"),Jg=new Q("angularfire2.auth.tenant-id"),Xg=new Q("angularfire2.auth.langugage-code"),em=new Q("angularfire2.auth.use-device-language"),tm=new Q("angularfire.auth.persistence"),nm=(n,e,t,r,i,o,s,a)=>Pl(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let u=e.runOutsideAngular(()=>n.auth());if(t&&u.useEmulator(...t),r&&(u.tenantId=r),u.languageCode=i,o&&u.useDeviceLanguage(),s)for(let[l,h]of Object.entries(s))u.settings[l]=h;return a&&u.setPersistence(a),u},[t,r,i,o,s,a]),rC=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,o,s,a,u,l,h,p,m,y){let C=new Le,A=Y(void 0).pipe(Mt(s.outsideAngular),Ve(()=>o.runOutsideAngular(()=>import("./chunk-DT56ZVVI.js"))),Z(()=>Fa(t,o,r)),Z(M=>nm(M,o,a,l,h,p,u,m)),hc({bufferSize:1,refCount:!1}));if(ei(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Y(null);else{A.pipe(Nt()).subscribe();let M=A.pipe(Ve(F=>F.getRedirectResult().then(W=>W,()=>null)),Dt,hc({bufferSize:1,refCount:!1})),O=A.pipe(Ve(F=>new de(W=>({unsubscribe:o.runOutsideAngular(()=>F.onAuthStateChanged(X=>W.next(X),X=>W.error(X),()=>W.complete()))})))),B=A.pipe(Ve(F=>new de(W=>({unsubscribe:o.runOutsideAngular(()=>F.onIdTokenChanged(X=>W.next(X),X=>W.error(X),()=>W.complete()))}))));this.authState=M.pipe(fc(O),Gt(s.outsideAngular),Mt(s.insideAngular)),this.user=M.pipe(fc(B),Gt(s.outsideAngular),Mt(s.insideAngular)),this.idToken=this.user.pipe(Ve(F=>F?_e(F.getIdToken()):Y(null))),this.idTokenResult=this.user.pipe(Ve(F=>F?_e(F.getIdTokenResult()):Y(null))),this.credential=tf(M,C,this.authState.pipe(at(F=>!F))).pipe(Z(F=>F?.user?F:null),Gt(s.outsideAngular),Mt(s.insideAngular))}return tC(this,A,o,{spy:{apply:(M,O,B)=>{(M.startsWith("signIn")||M.startsWith("createUser"))&&B.then(F=>C.next(F))}}})}static \u0275fac=function(r){return new(r||n)($(bo),$(So,8),$(Vt),$(Ee),$(Rl),$(Yg,8),$(Zg,8),$(Jg,8),$(Xg,8),$(em,8),$(tm,8),$(oi,8))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var iC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},oC={};var hr,rm;(function(){var n;function e(I,v){function w(){}w.prototype=v.prototype,I.D=v.prototype,I.prototype=new w,I.prototype.constructor=I,I.C=function(E,D,b){for(var _=Array(arguments.length-2),En=2;En<arguments.length;En++)_[En-2]=arguments[En];return v.prototype[D].apply(E,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,v,w){w||(w=0);var E=Array(16);if(typeof v=="string")for(var D=0;16>D;++D)E[D]=v.charCodeAt(w++)|v.charCodeAt(w++)<<8|v.charCodeAt(w++)<<16|v.charCodeAt(w++)<<24;else for(D=0;16>D;++D)E[D]=v[w++]|v[w++]<<8|v[w++]<<16|v[w++]<<24;v=I.g[0],w=I.g[1],D=I.g[2];var b=I.g[3],_=v+(b^w&(D^b))+E[0]+3614090360&4294967295;v=w+(_<<7&4294967295|_>>>25),_=b+(D^v&(w^D))+E[1]+3905402710&4294967295,b=v+(_<<12&4294967295|_>>>20),_=D+(w^b&(v^w))+E[2]+606105819&4294967295,D=b+(_<<17&4294967295|_>>>15),_=w+(v^D&(b^v))+E[3]+3250441966&4294967295,w=D+(_<<22&4294967295|_>>>10),_=v+(b^w&(D^b))+E[4]+4118548399&4294967295,v=w+(_<<7&4294967295|_>>>25),_=b+(D^v&(w^D))+E[5]+1200080426&4294967295,b=v+(_<<12&4294967295|_>>>20),_=D+(w^b&(v^w))+E[6]+2821735955&4294967295,D=b+(_<<17&4294967295|_>>>15),_=w+(v^D&(b^v))+E[7]+4249261313&4294967295,w=D+(_<<22&4294967295|_>>>10),_=v+(b^w&(D^b))+E[8]+1770035416&4294967295,v=w+(_<<7&4294967295|_>>>25),_=b+(D^v&(w^D))+E[9]+2336552879&4294967295,b=v+(_<<12&4294967295|_>>>20),_=D+(w^b&(v^w))+E[10]+4294925233&4294967295,D=b+(_<<17&4294967295|_>>>15),_=w+(v^D&(b^v))+E[11]+2304563134&4294967295,w=D+(_<<22&4294967295|_>>>10),_=v+(b^w&(D^b))+E[12]+1804603682&4294967295,v=w+(_<<7&4294967295|_>>>25),_=b+(D^v&(w^D))+E[13]+4254626195&4294967295,b=v+(_<<12&4294967295|_>>>20),_=D+(w^b&(v^w))+E[14]+2792965006&4294967295,D=b+(_<<17&4294967295|_>>>15),_=w+(v^D&(b^v))+E[15]+1236535329&4294967295,w=D+(_<<22&4294967295|_>>>10),_=v+(D^b&(w^D))+E[1]+4129170786&4294967295,v=w+(_<<5&4294967295|_>>>27),_=b+(w^D&(v^w))+E[6]+3225465664&4294967295,b=v+(_<<9&4294967295|_>>>23),_=D+(v^w&(b^v))+E[11]+643717713&4294967295,D=b+(_<<14&4294967295|_>>>18),_=w+(b^v&(D^b))+E[0]+3921069994&4294967295,w=D+(_<<20&4294967295|_>>>12),_=v+(D^b&(w^D))+E[5]+3593408605&4294967295,v=w+(_<<5&4294967295|_>>>27),_=b+(w^D&(v^w))+E[10]+38016083&4294967295,b=v+(_<<9&4294967295|_>>>23),_=D+(v^w&(b^v))+E[15]+3634488961&4294967295,D=b+(_<<14&4294967295|_>>>18),_=w+(b^v&(D^b))+E[4]+3889429448&4294967295,w=D+(_<<20&4294967295|_>>>12),_=v+(D^b&(w^D))+E[9]+568446438&4294967295,v=w+(_<<5&4294967295|_>>>27),_=b+(w^D&(v^w))+E[14]+3275163606&4294967295,b=v+(_<<9&4294967295|_>>>23),_=D+(v^w&(b^v))+E[3]+4107603335&4294967295,D=b+(_<<14&4294967295|_>>>18),_=w+(b^v&(D^b))+E[8]+1163531501&4294967295,w=D+(_<<20&4294967295|_>>>12),_=v+(D^b&(w^D))+E[13]+2850285829&4294967295,v=w+(_<<5&4294967295|_>>>27),_=b+(w^D&(v^w))+E[2]+4243563512&4294967295,b=v+(_<<9&4294967295|_>>>23),_=D+(v^w&(b^v))+E[7]+1735328473&4294967295,D=b+(_<<14&4294967295|_>>>18),_=w+(b^v&(D^b))+E[12]+2368359562&4294967295,w=D+(_<<20&4294967295|_>>>12),_=v+(w^D^b)+E[5]+4294588738&4294967295,v=w+(_<<4&4294967295|_>>>28),_=b+(v^w^D)+E[8]+2272392833&4294967295,b=v+(_<<11&4294967295|_>>>21),_=D+(b^v^w)+E[11]+1839030562&4294967295,D=b+(_<<16&4294967295|_>>>16),_=w+(D^b^v)+E[14]+4259657740&4294967295,w=D+(_<<23&4294967295|_>>>9),_=v+(w^D^b)+E[1]+2763975236&4294967295,v=w+(_<<4&4294967295|_>>>28),_=b+(v^w^D)+E[4]+1272893353&4294967295,b=v+(_<<11&4294967295|_>>>21),_=D+(b^v^w)+E[7]+4139469664&4294967295,D=b+(_<<16&4294967295|_>>>16),_=w+(D^b^v)+E[10]+3200236656&4294967295,w=D+(_<<23&4294967295|_>>>9),_=v+(w^D^b)+E[13]+681279174&4294967295,v=w+(_<<4&4294967295|_>>>28),_=b+(v^w^D)+E[0]+3936430074&4294967295,b=v+(_<<11&4294967295|_>>>21),_=D+(b^v^w)+E[3]+3572445317&4294967295,D=b+(_<<16&4294967295|_>>>16),_=w+(D^b^v)+E[6]+76029189&4294967295,w=D+(_<<23&4294967295|_>>>9),_=v+(w^D^b)+E[9]+3654602809&4294967295,v=w+(_<<4&4294967295|_>>>28),_=b+(v^w^D)+E[12]+3873151461&4294967295,b=v+(_<<11&4294967295|_>>>21),_=D+(b^v^w)+E[15]+530742520&4294967295,D=b+(_<<16&4294967295|_>>>16),_=w+(D^b^v)+E[2]+3299628645&4294967295,w=D+(_<<23&4294967295|_>>>9),_=v+(D^(w|~b))+E[0]+4096336452&4294967295,v=w+(_<<6&4294967295|_>>>26),_=b+(w^(v|~D))+E[7]+1126891415&4294967295,b=v+(_<<10&4294967295|_>>>22),_=D+(v^(b|~w))+E[14]+2878612391&4294967295,D=b+(_<<15&4294967295|_>>>17),_=w+(b^(D|~v))+E[5]+4237533241&4294967295,w=D+(_<<21&4294967295|_>>>11),_=v+(D^(w|~b))+E[12]+1700485571&4294967295,v=w+(_<<6&4294967295|_>>>26),_=b+(w^(v|~D))+E[3]+2399980690&4294967295,b=v+(_<<10&4294967295|_>>>22),_=D+(v^(b|~w))+E[10]+4293915773&4294967295,D=b+(_<<15&4294967295|_>>>17),_=w+(b^(D|~v))+E[1]+2240044497&4294967295,w=D+(_<<21&4294967295|_>>>11),_=v+(D^(w|~b))+E[8]+1873313359&4294967295,v=w+(_<<6&4294967295|_>>>26),_=b+(w^(v|~D))+E[15]+4264355552&4294967295,b=v+(_<<10&4294967295|_>>>22),_=D+(v^(b|~w))+E[6]+2734768916&4294967295,D=b+(_<<15&4294967295|_>>>17),_=w+(b^(D|~v))+E[13]+1309151649&4294967295,w=D+(_<<21&4294967295|_>>>11),_=v+(D^(w|~b))+E[4]+4149444226&4294967295,v=w+(_<<6&4294967295|_>>>26),_=b+(w^(v|~D))+E[11]+3174756917&4294967295,b=v+(_<<10&4294967295|_>>>22),_=D+(v^(b|~w))+E[2]+718787259&4294967295,D=b+(_<<15&4294967295|_>>>17),_=w+(b^(D|~v))+E[9]+3951481745&4294967295,I.g[0]=I.g[0]+v&4294967295,I.g[1]=I.g[1]+(D+(_<<21&4294967295|_>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+b&4294967295}r.prototype.u=function(I,v){v===void 0&&(v=I.length);for(var w=v-this.blockSize,E=this.B,D=this.h,b=0;b<v;){if(D==0)for(;b<=w;)i(this,I,b),b+=this.blockSize;if(typeof I=="string"){for(;b<v;)if(E[D++]=I.charCodeAt(b++),D==this.blockSize){i(this,E),D=0;break}}else for(;b<v;)if(E[D++]=I[b++],D==this.blockSize){i(this,E),D=0;break}}this.h=D,this.o+=v},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var v=1;v<I.length-8;++v)I[v]=0;var w=8*this.o;for(v=I.length-8;v<I.length;++v)I[v]=w&255,w/=256;for(this.u(I),I=Array(16),v=w=0;4>v;++v)for(var E=0;32>E;E+=8)I[w++]=this.g[v]>>>E&255;return I};function o(I,v){var w=a;return Object.prototype.hasOwnProperty.call(w,I)?w[I]:w[I]=v(I)}function s(I,v){this.h=v;for(var w=[],E=!0,D=I.length-1;0<=D;D--){var b=I[D]|0;E&&b==v||(w[D]=b,E=!1)}this.g=w}var a={};function u(I){return-128<=I&&128>I?o(I,function(v){return new s([v|0],0>v?-1:0)}):new s([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return M(l(-I));for(var v=[],w=1,E=0;I>=w;E++)v[E]=I/w|0,w*=4294967296;return new s(v,0)}function h(I,v){if(I.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(I.charAt(0)=="-")return M(h(I.substring(1),v));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=l(Math.pow(v,8)),E=p,D=0;D<I.length;D+=8){var b=Math.min(8,I.length-D),_=parseInt(I.substring(D,D+b),v);8>b?(b=l(Math.pow(v,b)),E=E.j(b).add(l(_))):(E=E.j(w),E=E.add(l(_)))}return E}var p=u(0),m=u(1),y=u(16777216);n=s.prototype,n.m=function(){if(A(this))return-M(this).m();for(var I=0,v=1,w=0;w<this.g.length;w++){var E=this.i(w);I+=(0<=E?E:4294967296+E)*v,v*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(C(this))return"0";if(A(this))return"-"+M(this).toString(I);for(var v=l(Math.pow(I,6)),w=this,E="";;){var D=W(w,v).g;w=O(w,D.j(v));var b=((0<w.g.length?w.g[0]:w.h)>>>0).toString(I);if(w=D,C(w))return b+E;for(;6>b.length;)b="0"+b;E=b+E}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function C(I){if(I.h!=0)return!1;for(var v=0;v<I.g.length;v++)if(I.g[v]!=0)return!1;return!0}function A(I){return I.h==-1}n.l=function(I){return I=O(this,I),A(I)?-1:C(I)?0:1};function M(I){for(var v=I.g.length,w=[],E=0;E<v;E++)w[E]=~I.g[E];return new s(w,~I.h).add(m)}n.abs=function(){return A(this)?M(this):this},n.add=function(I){for(var v=Math.max(this.g.length,I.g.length),w=[],E=0,D=0;D<=v;D++){var b=E+(this.i(D)&65535)+(I.i(D)&65535),_=(b>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);E=_>>>16,b&=65535,_&=65535,w[D]=_<<16|b}return new s(w,w[w.length-1]&-2147483648?-1:0)};function O(I,v){return I.add(M(v))}n.j=function(I){if(C(this)||C(I))return p;if(A(this))return A(I)?M(this).j(M(I)):M(M(this).j(I));if(A(I))return M(this.j(M(I)));if(0>this.l(y)&&0>I.l(y))return l(this.m()*I.m());for(var v=this.g.length+I.g.length,w=[],E=0;E<2*v;E++)w[E]=0;for(E=0;E<this.g.length;E++)for(var D=0;D<I.g.length;D++){var b=this.i(E)>>>16,_=this.i(E)&65535,En=I.i(D)>>>16,gs=I.i(D)&65535;w[2*E+2*D]+=_*gs,B(w,2*E+2*D),w[2*E+2*D+1]+=b*gs,B(w,2*E+2*D+1),w[2*E+2*D+1]+=_*En,B(w,2*E+2*D+1),w[2*E+2*D+2]+=b*En,B(w,2*E+2*D+2)}for(E=0;E<v;E++)w[E]=w[2*E+1]<<16|w[2*E];for(E=v;E<2*v;E++)w[E]=0;return new s(w,0)};function B(I,v){for(;(I[v]&65535)!=I[v];)I[v+1]+=I[v]>>>16,I[v]&=65535,v++}function F(I,v){this.g=I,this.h=v}function W(I,v){if(C(v))throw Error("division by zero");if(C(I))return new F(p,p);if(A(I))return v=W(M(I),v),new F(M(v.g),M(v.h));if(A(v))return v=W(I,M(v)),new F(M(v.g),v.h);if(30<I.g.length){if(A(I)||A(v))throw Error("slowDivide_ only works with positive integers.");for(var w=m,E=v;0>=E.l(I);)w=X(w),E=X(E);var D=K(w,1),b=K(E,1);for(E=K(E,2),w=K(w,2);!C(E);){var _=b.add(E);0>=_.l(I)&&(D=D.add(w),b=_),E=K(E,1),w=K(w,1)}return v=O(I,D.j(v)),new F(D,v)}for(D=p;0<=I.l(v);){for(w=Math.max(1,Math.floor(I.m()/v.m())),E=Math.ceil(Math.log(w)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),b=l(w),_=b.j(v);A(_)||0<_.l(I);)w-=E,b=l(w),_=b.j(v);C(b)&&(b=m),D=D.add(b),I=O(I,_)}return new F(D,I)}n.A=function(I){return W(this,I).h},n.and=function(I){for(var v=Math.max(this.g.length,I.g.length),w=[],E=0;E<v;E++)w[E]=this.i(E)&I.i(E);return new s(w,this.h&I.h)},n.or=function(I){for(var v=Math.max(this.g.length,I.g.length),w=[],E=0;E<v;E++)w[E]=this.i(E)|I.i(E);return new s(w,this.h|I.h)},n.xor=function(I){for(var v=Math.max(this.g.length,I.g.length),w=[],E=0;E<v;E++)w[E]=this.i(E)^I.i(E);return new s(w,this.h^I.h)};function X(I){for(var v=I.g.length+1,w=[],E=0;E<v;E++)w[E]=I.i(E)<<1|I.i(E-1)>>>31;return new s(w,I.h)}function K(I,v){var w=v>>5;v%=32;for(var E=I.g.length-w,D=[],b=0;b<E;b++)D[b]=0<v?I.i(b+w)>>>v|I.i(b+w+1)<<32-v:I.i(b+w);return new s(D,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,rm=oC.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=h,hr=oC.Integer=s}).apply(typeof iC<"u"?iC:typeof self<"u"?self:typeof window<"u"?window:{});var kl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Bn={};var im,IO,Ao,om,La,Ol,sm,am,um;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,d,f){return c==Array.prototype||c==Object.prototype||(c[d]=f.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof kl=="object"&&kl];for(var d=0;d<c.length;++d){var f=c[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(c,d){if(d)e:{var f=r;c=c.split(".");for(var g=0;g<c.length-1;g++){var T=c[g];if(!(T in f))break e;f=f[T]}c=c[c.length-1],g=f[c],d=d(g),d!=g&&d!=null&&e(f,c,{configurable:!0,writable:!0,value:d})}}function o(c,d){c instanceof String&&(c+="");var f=0,g=!1,T={next:function(){if(!g&&f<c.length){var x=f++;return{value:d(x,c[x]),done:!1}}return g=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(c){return c||function(){return o(this,function(d,f){return f})}});var s=s||{},a=this||self;function u(c){var d=typeof c;return d=d!="object"?d:c?Array.isArray(c)?"array":d:"null",d=="array"||d=="object"&&typeof c.length=="number"}function l(c){var d=typeof c;return d=="object"&&c!=null||d=="function"}function h(c,d,f){return c.call.apply(c.bind,arguments)}function p(c,d,f){if(!c)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,g),c.apply(d,T)}}return function(){return c.apply(d,arguments)}}function m(c,d,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,m.apply(null,arguments)}function y(c,d){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),c.apply(this,g)}}function C(c,d){function f(){}f.prototype=d.prototype,c.aa=d.prototype,c.prototype=new f,c.prototype.constructor=c,c.Qb=function(g,T,x){for(var L=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)L[Ie-2]=arguments[Ie];return d.prototype[T].apply(g,L)}}function A(c){let d=c.length;if(0<d){let f=Array(d);for(let g=0;g<d;g++)f[g]=c[g];return f}return[]}function M(c,d){for(let f=1;f<arguments.length;f++){let g=arguments[f];if(u(g)){let T=c.length||0,x=g.length||0;c.length=T+x;for(let L=0;L<x;L++)c[T+L]=g[L]}else c.push(g)}}class O{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function B(c){return/^[\s\xa0]*$/.test(c)}function F(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function W(c){return W[" "](c),c}W[" "]=function(){};var X=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function K(c,d,f){for(let g in c)d.call(f,c[g],g,c)}function I(c,d){for(let f in c)d.call(void 0,c[f],f,c)}function v(c){let d={};for(let f in c)d[f]=c[f];return d}let w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(c,d){let f,g;for(let T=1;T<arguments.length;T++){g=arguments[T];for(f in g)c[f]=g[f];for(let x=0;x<w.length;x++)f=w[x],Object.prototype.hasOwnProperty.call(g,f)&&(c[f]=g[f])}}function D(c){var d=1;c=c.split(":");let f=[];for(;0<d&&c.length;)f.push(c.shift()),d--;return c.length&&f.push(c.join(":")),f}function b(c){a.setTimeout(()=>{throw c},0)}function _(){var c=oh;let d=null;return c.g&&(d=c.g,c.g=c.g.next,c.g||(c.h=null),d.next=null),d}class En{constructor(){this.h=this.g=null}add(d,f){let g=gs.get();g.set(d,f),this.h?this.h.next=g:this.g=g,this.h=g}}var gs=new O(()=>new HS,c=>c.reset());class HS{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let ms,ys=!1,oh=new En,d_=()=>{let c=a.Promise.resolve(void 0);ms=()=>{c.then(qS)}};var qS=()=>{for(var c;c=_();){try{c.h.call(c.g)}catch(f){b(f)}var d=gs;d.j(c),100>d.h&&(d.h++,c.next=d.g,d.g=c)}ys=!1};function Yn(){this.s=this.s,this.C=this.C}Yn.prototype.s=!1,Yn.prototype.ma=function(){this.s||(this.s=!0,this.N())},Yn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function rt(c,d){this.type=c,this.g=this.target=d,this.defaultPrevented=!1}rt.prototype.h=function(){this.defaultPrevented=!0};var zS=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,d=Object.defineProperty({},"passive",{get:function(){c=!0}});try{let f=()=>{};a.addEventListener("test",f,d),a.removeEventListener("test",f,d)}catch{}return c}();function vs(c,d){if(rt.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var f=this.type=c.type,g=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=d,d=c.relatedTarget){if(X){e:{try{W(d.nodeName);var T=!0;break e}catch{}T=!1}T||(d=null)}}else f=="mouseover"?d=c.fromElement:f=="mouseout"&&(d=c.toElement);this.relatedTarget=d,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:GS[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&vs.aa.h.call(this)}}C(vs,rt);var GS={2:"touch",3:"pen",4:"mouse"};vs.prototype.h=function(){vs.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var _s="closure_listenable_"+(1e6*Math.random()|0),WS=0;function KS(c,d,f,g,T){this.listener=c,this.proxy=null,this.src=d,this.type=f,this.capture=!!g,this.ha=T,this.key=++WS,this.da=this.fa=!1}function Tu(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Cu(c){this.src=c,this.g={},this.h=0}Cu.prototype.add=function(c,d,f,g,T){var x=c.toString();c=this.g[x],c||(c=this.g[x]=[],this.h++);var L=ah(c,d,g,T);return-1<L?(d=c[L],f||(d.fa=!1)):(d=new KS(d,this.src,x,!!g,T),d.fa=f,c.push(d)),d};function sh(c,d){var f=d.type;if(f in c.g){var g=c.g[f],T=Array.prototype.indexOf.call(g,d,void 0),x;(x=0<=T)&&Array.prototype.splice.call(g,T,1),x&&(Tu(d),c.g[f].length==0&&(delete c.g[f],c.h--))}}function ah(c,d,f,g){for(var T=0;T<c.length;++T){var x=c[T];if(!x.da&&x.listener==d&&x.capture==!!f&&x.ha==g)return T}return-1}var uh="closure_lm_"+(1e6*Math.random()|0),ch={};function h_(c,d,f,g,T){if(g&&g.once)return p_(c,d,f,g,T);if(Array.isArray(d)){for(var x=0;x<d.length;x++)h_(c,d[x],f,g,T);return null}return f=fh(f),c&&c[_s]?c.K(d,f,l(g)?!!g.capture:!!g,T):f_(c,d,f,!1,g,T)}function f_(c,d,f,g,T,x){if(!d)throw Error("Invalid event type");var L=l(T)?!!T.capture:!!T,Ie=dh(c);if(Ie||(c[uh]=Ie=new Cu(c)),f=Ie.add(d,f,g,L,x),f.proxy)return f;if(g=QS(),f.proxy=g,g.src=c,g.listener=f,c.addEventListener)zS||(T=L),T===void 0&&(T=!1),c.addEventListener(d.toString(),g,T);else if(c.attachEvent)c.attachEvent(m_(d.toString()),g);else if(c.addListener&&c.removeListener)c.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function QS(){function c(f){return d.call(c.src,c.listener,f)}let d=YS;return c}function p_(c,d,f,g,T){if(Array.isArray(d)){for(var x=0;x<d.length;x++)p_(c,d[x],f,g,T);return null}return f=fh(f),c&&c[_s]?c.L(d,f,l(g)?!!g.capture:!!g,T):f_(c,d,f,!0,g,T)}function g_(c,d,f,g,T){if(Array.isArray(d))for(var x=0;x<d.length;x++)g_(c,d[x],f,g,T);else g=l(g)?!!g.capture:!!g,f=fh(f),c&&c[_s]?(c=c.i,d=String(d).toString(),d in c.g&&(x=c.g[d],f=ah(x,f,g,T),-1<f&&(Tu(x[f]),Array.prototype.splice.call(x,f,1),x.length==0&&(delete c.g[d],c.h--)))):c&&(c=dh(c))&&(d=c.g[d.toString()],c=-1,d&&(c=ah(d,f,g,T)),(f=-1<c?d[c]:null)&&lh(f))}function lh(c){if(typeof c!="number"&&c&&!c.da){var d=c.src;if(d&&d[_s])sh(d.i,c);else{var f=c.type,g=c.proxy;d.removeEventListener?d.removeEventListener(f,g,c.capture):d.detachEvent?d.detachEvent(m_(f),g):d.addListener&&d.removeListener&&d.removeListener(g),(f=dh(d))?(sh(f,c),f.h==0&&(f.src=null,d[uh]=null)):Tu(c)}}}function m_(c){return c in ch?ch[c]:ch[c]="on"+c}function YS(c,d){if(c.da)c=!0;else{d=new vs(d,this);var f=c.listener,g=c.ha||c.src;c.fa&&lh(c),c=f.call(g,d)}return c}function dh(c){return c=c[uh],c instanceof Cu?c:null}var hh="__closure_events_fn_"+(1e9*Math.random()>>>0);function fh(c){return typeof c=="function"?c:(c[hh]||(c[hh]=function(d){return c.handleEvent(d)}),c[hh])}function it(){Yn.call(this),this.i=new Cu(this),this.M=this,this.F=null}C(it,Yn),it.prototype[_s]=!0,it.prototype.removeEventListener=function(c,d,f,g){g_(this,c,d,f,g)};function lt(c,d){var f,g=c.F;if(g)for(f=[];g;g=g.F)f.push(g);if(c=c.M,g=d.type||d,typeof d=="string")d=new rt(d,c);else if(d instanceof rt)d.target=d.target||c;else{var T=d;d=new rt(g,c),E(d,T)}if(T=!0,f)for(var x=f.length-1;0<=x;x--){var L=d.g=f[x];T=bu(L,g,!0,d)&&T}if(L=d.g=c,T=bu(L,g,!0,d)&&T,T=bu(L,g,!1,d)&&T,f)for(x=0;x<f.length;x++)L=d.g=f[x],T=bu(L,g,!1,d)&&T}it.prototype.N=function(){if(it.aa.N.call(this),this.i){var c=this.i,d;for(d in c.g){for(var f=c.g[d],g=0;g<f.length;g++)Tu(f[g]);delete c.g[d],c.h--}}this.F=null},it.prototype.K=function(c,d,f,g){return this.i.add(String(c),d,!1,f,g)},it.prototype.L=function(c,d,f,g){return this.i.add(String(c),d,!0,f,g)};function bu(c,d,f,g){if(d=c.i.g[String(d)],!d)return!0;d=d.concat();for(var T=!0,x=0;x<d.length;++x){var L=d[x];if(L&&!L.da&&L.capture==f){var Ie=L.listener,Je=L.ha||L.src;L.fa&&sh(c.i,L),T=Ie.call(Je,g)!==!1&&T}}return T&&!g.defaultPrevented}function y_(c,d,f){if(typeof c=="function")f&&(c=m(c,f));else if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(c,d||0)}function v_(c){c.g=y_(()=>{c.g=null,c.i&&(c.i=!1,v_(c))},c.l);let d=c.h;c.h=null,c.m.apply(null,d)}class ZS extends Yn{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:v_(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ws(c){Yn.call(this),this.h=c,this.g={}}C(ws,Yn);var __=[];function w_(c){K(c.g,function(d,f){this.g.hasOwnProperty(f)&&lh(d)},c),c.g={}}ws.prototype.N=function(){ws.aa.N.call(this),w_(this)},ws.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ph=a.JSON.stringify,JS=a.JSON.parse,XS=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function gh(){}gh.prototype.h=null;function I_(c){return c.h||(c.h=c.i())}function E_(){}var Is={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function mh(){rt.call(this,"d")}C(mh,rt);function yh(){rt.call(this,"c")}C(yh,rt);var Nr={},D_=null;function Su(){return D_=D_||new it}Nr.La="serverreachability";function T_(c){rt.call(this,Nr.La,c)}C(T_,rt);function Es(c){let d=Su();lt(d,new T_(d))}Nr.STAT_EVENT="statevent";function C_(c,d){rt.call(this,Nr.STAT_EVENT,c),this.stat=d}C(C_,rt);function dt(c){let d=Su();lt(d,new C_(d,c))}Nr.Ma="timingevent";function b_(c,d){rt.call(this,Nr.Ma,c),this.size=d}C(b_,rt);function Ds(c,d){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},d)}function Ts(){this.g=!0}Ts.prototype.xa=function(){this.g=!1};function eA(c,d,f,g,T,x){c.info(function(){if(c.g)if(x)for(var L="",Ie=x.split("&"),Je=0;Je<Ie.length;Je++){var me=Ie[Je].split("=");if(1<me.length){var ot=me[0];me=me[1];var st=ot.split("_");L=2<=st.length&&st[1]=="type"?L+(ot+"="+me+"&"):L+(ot+"=redacted&")}}else L=null;else L=x;return"XMLHTTP REQ ("+g+") [attempt "+T+"]: "+d+`
`+f+`
`+L})}function tA(c,d,f,g,T,x,L){c.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+T+"]: "+d+`
`+f+`
`+x+" "+L})}function Ni(c,d,f,g){c.info(function(){return"XMLHTTP TEXT ("+d+"): "+rA(c,f)+(g?" "+g:"")})}function nA(c,d){c.info(function(){return"TIMEOUT: "+d})}Ts.prototype.info=function(){};function rA(c,d){if(!c.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(c=0;c<f.length;c++)if(Array.isArray(f[c])){var g=f[c];if(!(2>g.length)){var T=g[1];if(Array.isArray(T)&&!(1>T.length)){var x=T[0];if(x!="noop"&&x!="stop"&&x!="close")for(var L=1;L<T.length;L++)T[L]=""}}}}return ph(f)}catch{return d}}var Au={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},S_={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},vh;function xu(){}C(xu,gh),xu.prototype.g=function(){return new XMLHttpRequest},xu.prototype.i=function(){return{}},vh=new xu;function Zn(c,d,f,g){this.j=c,this.i=d,this.l=f,this.R=g||1,this.U=new ws(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new A_}function A_(){this.i=null,this.g="",this.h=!1}var x_={},_h={};function wh(c,d,f){c.L=1,c.v=Pu(Dn(d)),c.m=f,c.P=!0,R_(c,null)}function R_(c,d){c.F=Date.now(),Ru(c),c.A=Dn(c.v);var f=c.A,g=c.R;Array.isArray(g)||(g=[String(g)]),q_(f.i,"t",g),c.C=0,f=c.j.J,c.h=new A_,c.g=uw(c.j,f?d:null,!c.m),0<c.O&&(c.M=new ZS(m(c.Y,c,c.g),c.O)),d=c.U,f=c.g,g=c.ca;var T="readystatechange";Array.isArray(T)||(T&&(__[0]=T.toString()),T=__);for(var x=0;x<T.length;x++){var L=h_(f,T[x],g||d.handleEvent,!1,d.h||d);if(!L)break;d.g[L.key]=L}d=c.H?v(c.H):{},c.m?(c.u||(c.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,d)):(c.u="GET",c.g.ea(c.A,c.u,null,d)),Es(),eA(c.i,c.u,c.A,c.l,c.R,c.m)}Zn.prototype.ca=function(c){c=c.target;let d=this.M;d&&Tn(c)==3?d.j():this.Y(c)},Zn.prototype.Y=function(c){try{if(c==this.g)e:{let st=Tn(this.g);var d=this.g.Ba();let Oi=this.g.Z();if(!(3>st)&&(st!=3||this.g&&(this.h.h||this.g.oa()||Z_(this.g)))){this.J||st!=4||d==7||(d==8||0>=Oi?Es(3):Es(2)),Ih(this);var f=this.g.Z();this.X=f;t:if(M_(this)){var g=Z_(this.g);c="";var T=g.length,x=Tn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Pr(this),Cs(this);var L="";break t}this.h.i=new a.TextDecoder}for(d=0;d<T;d++)this.h.h=!0,c+=this.h.i.decode(g[d],{stream:!(x&&d==T-1)});g.length=0,this.h.g+=c,this.C=0,L=this.h.g}else L=this.g.oa();if(this.o=f==200,tA(this.i,this.u,this.A,this.l,this.R,st,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ie,Je=this.g;if((Ie=Je.g?Je.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(Ie)){var me=Ie;break t}}me=null}if(f=me)Ni(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Eh(this,f);else{this.o=!1,this.s=3,dt(12),Pr(this),Cs(this);break e}}if(this.P){f=!0;let qt;for(;!this.J&&this.C<L.length;)if(qt=iA(this,L),qt==_h){st==4&&(this.s=4,dt(14),f=!1),Ni(this.i,this.l,null,"[Incomplete Response]");break}else if(qt==x_){this.s=4,dt(15),Ni(this.i,this.l,L,"[Invalid Chunk]"),f=!1;break}else Ni(this.i,this.l,qt,null),Eh(this,qt);if(M_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),st!=4||L.length!=0||this.h.h||(this.s=1,dt(16),f=!1),this.o=this.o&&f,!f)Ni(this.i,this.l,L,"[Invalid Chunked Response]"),Pr(this),Cs(this);else if(0<L.length&&!this.W){this.W=!0;var ot=this.j;ot.g==this&&ot.ba&&!ot.M&&(ot.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),Ah(ot),ot.M=!0,dt(11))}}else Ni(this.i,this.l,L,null),Eh(this,L);st==4&&Pr(this),this.o&&!this.J&&(st==4?iw(this.j,this):(this.o=!1,Ru(this)))}else IA(this.g),f==400&&0<L.indexOf("Unknown SID")?(this.s=3,dt(12)):(this.s=0,dt(13)),Pr(this),Cs(this)}}}catch{}finally{}};function M_(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function iA(c,d){var f=c.C,g=d.indexOf(`
`,f);return g==-1?_h:(f=Number(d.substring(f,g)),isNaN(f)?x_:(g+=1,g+f>d.length?_h:(d=d.slice(g,g+f),c.C=g+f,d)))}Zn.prototype.cancel=function(){this.J=!0,Pr(this)};function Ru(c){c.S=Date.now()+c.I,N_(c,c.I)}function N_(c,d){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Ds(m(c.ba,c),d)}function Ih(c){c.B&&(a.clearTimeout(c.B),c.B=null)}Zn.prototype.ba=function(){this.B=null;let c=Date.now();0<=c-this.S?(nA(this.i,this.A),this.L!=2&&(Es(),dt(17)),Pr(this),this.s=2,Cs(this)):N_(this,this.S-c)};function Cs(c){c.j.G==0||c.J||iw(c.j,c)}function Pr(c){Ih(c);var d=c.M;d&&typeof d.ma=="function"&&d.ma(),c.M=null,w_(c.U),c.g&&(d=c.g,c.g=null,d.abort(),d.ma())}function Eh(c,d){try{var f=c.j;if(f.G!=0&&(f.g==c||Dh(f.h,c))){if(!c.K&&Dh(f.h,c)&&f.G==3){try{var g=f.Da.g.parse(d)}catch{g=null}if(Array.isArray(g)&&g.length==3){var T=g;if(T[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<c.F)Vu(f),Fu(f);else break e;Sh(f),dt(18)}}else f.za=T[1],0<f.za-f.T&&37500>T[2]&&f.F&&f.v==0&&!f.C&&(f.C=Ds(m(f.Za,f),6e3));if(1>=O_(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Or(f,11)}else if((c.K||f.g==c)&&Vu(f),!B(d))for(T=f.Da.g.parse(d),d=0;d<T.length;d++){let me=T[d];if(f.T=me[0],me=me[1],f.G==2)if(me[0]=="c"){f.K=me[1],f.ia=me[2];let ot=me[3];ot!=null&&(f.la=ot,f.j.info("VER="+f.la));let st=me[4];st!=null&&(f.Aa=st,f.j.info("SVER="+f.Aa));let Oi=me[5];Oi!=null&&typeof Oi=="number"&&0<Oi&&(g=1.5*Oi,f.L=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;let qt=c.g;if(qt){let Bu=qt.g?qt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bu){var x=g.h;x.g||Bu.indexOf("spdy")==-1&&Bu.indexOf("quic")==-1&&Bu.indexOf("h2")==-1||(x.j=x.l,x.g=new Set,x.h&&(Th(x,x.h),x.h=null))}if(g.D){let xh=qt.g?qt.g.getResponseHeader("X-HTTP-Session-Id"):null;xh&&(g.ya=xh,be(g.I,g.D,xh))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-c.F,f.j.info("Handshake RTT: "+f.R+"ms")),g=f;var L=c;if(g.qa=aw(g,g.J?g.ia:null,g.W),L.K){F_(g.h,L);var Ie=L,Je=g.L;Je&&(Ie.I=Je),Ie.B&&(Ih(Ie),Ru(Ie)),g.g=L}else nw(g);0<f.i.length&&Lu(f)}else me[0]!="stop"&&me[0]!="close"||Or(f,7);else f.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?Or(f,7):bh(f):me[0]!="noop"&&f.l&&f.l.ta(me),f.v=0)}}Es(4)}catch{}}var oA=class{constructor(c,d){this.g=c,this.map=d}};function P_(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function k_(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function O_(c){return c.h?1:c.g?c.g.size:0}function Dh(c,d){return c.h?c.h==d:c.g?c.g.has(d):!1}function Th(c,d){c.g?c.g.add(d):c.h=d}function F_(c,d){c.h&&c.h==d?c.h=null:c.g&&c.g.has(d)&&c.g.delete(d)}P_.prototype.cancel=function(){if(this.i=L_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let c of this.g.values())c.cancel();this.g.clear()}};function L_(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let d=c.i;for(let f of c.g.values())d=d.concat(f.D);return d}return A(c.i)}function sA(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var d=[],f=c.length,g=0;g<f;g++)d.push(c[g]);return d}d=[],f=0;for(g in c)d[f++]=c[g];return d}function aA(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var d=[];c=c.length;for(var f=0;f<c;f++)d.push(f);return d}d=[],f=0;for(let g in c)d[f++]=g;return d}}}function V_(c,d){if(c.forEach&&typeof c.forEach=="function")c.forEach(d,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,d,void 0);else for(var f=aA(c),g=sA(c),T=g.length,x=0;x<T;x++)d.call(void 0,g[x],f&&f[x],c)}var j_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uA(c,d){if(c){c=c.split("&");for(var f=0;f<c.length;f++){var g=c[f].indexOf("="),T=null;if(0<=g){var x=c[f].substring(0,g);T=c[f].substring(g+1)}else x=c[f];d(x,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function kr(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof kr){this.h=c.h,Mu(this,c.j),this.o=c.o,this.g=c.g,Nu(this,c.s),this.l=c.l;var d=c.i,f=new As;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),B_(this,f),this.m=c.m}else c&&(d=String(c).match(j_))?(this.h=!1,Mu(this,d[1]||"",!0),this.o=bs(d[2]||""),this.g=bs(d[3]||"",!0),Nu(this,d[4]),this.l=bs(d[5]||"",!0),B_(this,d[6]||"",!0),this.m=bs(d[7]||"")):(this.h=!1,this.i=new As(null,this.h))}kr.prototype.toString=function(){var c=[],d=this.j;d&&c.push(Ss(d,U_,!0),":");var f=this.g;return(f||d=="file")&&(c.push("//"),(d=this.o)&&c.push(Ss(d,U_,!0),"@"),c.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&c.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&c.push("/"),c.push(Ss(f,f.charAt(0)=="/"?dA:lA,!0))),(f=this.i.toString())&&c.push("?",f),(f=this.m)&&c.push("#",Ss(f,fA)),c.join("")};function Dn(c){return new kr(c)}function Mu(c,d,f){c.j=f?bs(d,!0):d,c.j&&(c.j=c.j.replace(/:$/,""))}function Nu(c,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);c.s=d}else c.s=null}function B_(c,d,f){d instanceof As?(c.i=d,pA(c.i,c.h)):(f||(d=Ss(d,hA)),c.i=new As(d,c.h))}function be(c,d,f){c.i.set(d,f)}function Pu(c){return be(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function bs(c,d){return c?d?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Ss(c,d,f){return typeof c=="string"?(c=encodeURI(c).replace(d,cA),f&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function cA(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var U_=/[#\/\?@]/g,lA=/[#\?:]/g,dA=/[#\?]/g,hA=/[#\?@]/g,fA=/#/g;function As(c,d){this.h=this.g=null,this.i=c||null,this.j=!!d}function Jn(c){c.g||(c.g=new Map,c.h=0,c.i&&uA(c.i,function(d,f){c.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}n=As.prototype,n.add=function(c,d){Jn(this),this.i=null,c=Pi(this,c);var f=this.g.get(c);return f||this.g.set(c,f=[]),f.push(d),this.h+=1,this};function $_(c,d){Jn(c),d=Pi(c,d),c.g.has(d)&&(c.i=null,c.h-=c.g.get(d).length,c.g.delete(d))}function H_(c,d){return Jn(c),d=Pi(c,d),c.g.has(d)}n.forEach=function(c,d){Jn(this),this.g.forEach(function(f,g){f.forEach(function(T){c.call(d,T,g,this)},this)},this)},n.na=function(){Jn(this);let c=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let g=0;g<d.length;g++){let T=c[g];for(let x=0;x<T.length;x++)f.push(d[g])}return f},n.V=function(c){Jn(this);let d=[];if(typeof c=="string")H_(this,c)&&(d=d.concat(this.g.get(Pi(this,c))));else{c=Array.from(this.g.values());for(let f=0;f<c.length;f++)d=d.concat(c[f])}return d},n.set=function(c,d){return Jn(this),this.i=null,c=Pi(this,c),H_(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[d]),this.h+=1,this},n.get=function(c,d){return c?(c=this.V(c),0<c.length?String(c[0]):d):d};function q_(c,d,f){$_(c,d),0<f.length&&(c.i=null,c.g.set(Pi(c,d),A(f)),c.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let c=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var g=d[f];let x=encodeURIComponent(String(g)),L=this.V(g);for(g=0;g<L.length;g++){var T=x;L[g]!==""&&(T+="="+encodeURIComponent(String(L[g]))),c.push(T)}}return this.i=c.join("&")};function Pi(c,d){return d=String(d),c.j&&(d=d.toLowerCase()),d}function pA(c,d){d&&!c.j&&(Jn(c),c.i=null,c.g.forEach(function(f,g){var T=g.toLowerCase();g!=T&&($_(this,g),q_(this,T,f))},c)),c.j=d}function gA(c,d){let f=new Ts;if(a.Image){let g=new Image;g.onload=y(Xn,f,"TestLoadImage: loaded",!0,d,g),g.onerror=y(Xn,f,"TestLoadImage: error",!1,d,g),g.onabort=y(Xn,f,"TestLoadImage: abort",!1,d,g),g.ontimeout=y(Xn,f,"TestLoadImage: timeout",!1,d,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=c}else d(!1)}function mA(c,d){let f=new Ts,g=new AbortController,T=setTimeout(()=>{g.abort(),Xn(f,"TestPingServer: timeout",!1,d)},1e4);fetch(c,{signal:g.signal}).then(x=>{clearTimeout(T),x.ok?Xn(f,"TestPingServer: ok",!0,d):Xn(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(T),Xn(f,"TestPingServer: error",!1,d)})}function Xn(c,d,f,g,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),g(f)}catch{}}function yA(){this.g=new XS}function vA(c,d,f){let g=f||"";try{V_(c,function(T,x){let L=T;l(T)&&(L=ph(T)),d.push(g+x+"="+encodeURIComponent(L))})}catch(T){throw d.push(g+"type="+encodeURIComponent("_badmap")),T}}function xs(c){this.l=c.Ub||null,this.j=c.eb||!1}C(xs,gh),xs.prototype.g=function(){return new ku(this.l,this.j)},xs.prototype.i=function(c){return function(){return c}}({});function ku(c,d){it.call(this),this.D=c,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(ku,it),n=ku.prototype,n.open=function(c,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=d,this.readyState=1,Ms(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(d.body=c),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Rs(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Ms(this)),this.g&&(this.readyState=3,Ms(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;z_(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function z_(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var d=c.value?c.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!c.done}))&&(this.response=this.responseText+=d)}c.done?Rs(this):Ms(this),this.readyState==3&&z_(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,Rs(this))},n.Qa=function(c){this.g&&(this.response=c,Rs(this))},n.ga=function(){this.g&&Rs(this)};function Rs(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Ms(c)}n.setRequestHeader=function(c,d){this.u.append(c,d)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let c=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,c.push(f[0]+": "+f[1]),f=d.next();return c.join(`\r
`)};function Ms(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(ku.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function G_(c){let d="";return K(c,function(f,g){d+=g,d+=":",d+=f,d+=`\r
`}),d}function Ch(c,d,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=G_(f),typeof c=="string"?f!=null&&encodeURIComponent(String(f)):be(c,d,f))}function ke(c){it.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(ke,it);var _A=/^https?$/i,wA=["POST","PUT"];n=ke.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,d,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);d=d?d.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():vh.g(),this.v=this.o?I_(this.o):I_(vh),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(c),!0),this.B=!1}catch(x){W_(this,x);return}if(c=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var T in g)f.set(T,g[T]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let x of g.keys())f.set(x,g.get(x));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(x=>x.toLowerCase()=="content-type"),T=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(wA,d,void 0))||g||T||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[x,L]of f)this.g.setRequestHeader(x,L);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Y_(this),this.u=!0,this.g.send(c),this.u=!1}catch(x){W_(this,x)}};function W_(c,d){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=d,c.m=5,K_(c),Ou(c)}function K_(c){c.A||(c.A=!0,lt(c,"complete"),lt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,lt(this,"complete"),lt(this,"abort"),Ou(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ou(this,!0)),ke.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Q_(this):this.bb())},n.bb=function(){Q_(this)};function Q_(c){if(c.h&&typeof s<"u"&&(!c.v[1]||Tn(c)!=4||c.Z()!=2)){if(c.u&&Tn(c)==4)y_(c.Ea,0,c);else if(lt(c,"readystatechange"),Tn(c)==4){c.h=!1;try{let L=c.Z();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var g;if(g=L===0){var T=String(c.D).match(j_)[1]||null;!T&&a.self&&a.self.location&&(T=a.self.location.protocol.slice(0,-1)),g=!_A.test(T?T.toLowerCase():"")}f=g}if(f)lt(c,"complete"),lt(c,"success");else{c.m=6;try{var x=2<Tn(c)?c.g.statusText:""}catch{x=""}c.l=x+" ["+c.Z()+"]",K_(c)}}finally{Ou(c)}}}}function Ou(c,d){if(c.g){Y_(c);let f=c.g,g=c.v[0]?()=>{}:null;c.g=null,c.v=null,d||lt(c,"ready");try{f.onreadystatechange=g}catch{}}}function Y_(c){c.I&&(a.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function Tn(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<Tn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var d=this.g.responseText;return c&&d.indexOf(c)==0&&(d=d.substring(c.length)),JS(d)}};function Z_(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function IA(c){let d={};c=(c.g&&2<=Tn(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<c.length;g++){if(B(c[g]))continue;var f=D(c[g]);let T=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let x=d[T]||[];d[T]=x,x.push(f)}I(d,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ns(c,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[c]||d}function J_(c){this.Aa=0,this.i=[],this.j=new Ts,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ns("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ns("baseRetryDelayMs",5e3,c),this.cb=Ns("retryDelaySeedMs",1e4,c),this.Wa=Ns("forwardChannelMaxRetries",2,c),this.wa=Ns("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new P_(c&&c.concurrentRequestLimit),this.Da=new yA,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=J_.prototype,n.la=8,n.G=1,n.connect=function(c,d,f,g){dt(0),this.W=c,this.H=d||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.I=aw(this,null,this.W),Lu(this)};function bh(c){if(X_(c),c.G==3){var d=c.U++,f=Dn(c.I);if(be(f,"SID",c.K),be(f,"RID",d),be(f,"TYPE","terminate"),Ps(c,f),d=new Zn(c,c.j,d),d.L=2,d.v=Pu(Dn(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=d.v,f=!0),f||(d.g=uw(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Ru(d)}sw(c)}function Fu(c){c.g&&(Ah(c),c.g.cancel(),c.g=null)}function X_(c){Fu(c),c.u&&(a.clearTimeout(c.u),c.u=null),Vu(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function Lu(c){if(!k_(c.h)&&!c.s){c.s=!0;var d=c.Ga;ms||d_(),ys||(ms(),ys=!0),oh.add(d,c),c.B=0}}function EA(c,d){return O_(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=d.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Ds(m(c.Ga,c,d),ow(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;let T=new Zn(this,this.j,c),x=this.o;if(this.S&&(x?(x=v(x),E(x,this.S)):x=this.S),this.m!==null||this.O||(T.H=x,x=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(d+=g,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=tw(this,T,d),f=Dn(this.I),be(f,"RID",c),be(f,"CVER",22),this.D&&be(f,"X-HTTP-Session-Id",this.D),Ps(this,f),x&&(this.O?d="headers="+encodeURIComponent(String(G_(x)))+"&"+d:this.m&&Ch(f,this.m,x)),Th(this.h,T),this.Ua&&be(f,"TYPE","init"),this.P?(be(f,"$req",d),be(f,"SID","null"),T.T=!0,wh(T,f,null)):wh(T,f,d),this.G=2}}else this.G==3&&(c?ew(this,c):this.i.length==0||k_(this.h)||ew(this))};function ew(c,d){var f;d?f=d.l:f=c.U++;let g=Dn(c.I);be(g,"SID",c.K),be(g,"RID",f),be(g,"AID",c.T),Ps(c,g),c.m&&c.o&&Ch(g,c.m,c.o),f=new Zn(c,c.j,f,c.B+1),c.m===null&&(f.H=c.o),d&&(c.i=d.D.concat(c.i)),d=tw(c,f,1e3),f.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Th(c.h,f),wh(f,g,d)}function Ps(c,d){c.H&&K(c.H,function(f,g){be(d,g,f)}),c.l&&V_({},function(f,g){be(d,g,f)})}function tw(c,d,f){f=Math.min(c.i.length,f);var g=c.l?m(c.l.Na,c.l,c):null;e:{var T=c.i;let x=-1;for(;;){let L=["count="+f];x==-1?0<f?(x=T[0].g,L.push("ofs="+x)):x=0:L.push("ofs="+x);let Ie=!0;for(let Je=0;Je<f;Je++){let me=T[Je].g,ot=T[Je].map;if(me-=x,0>me)x=Math.max(0,T[Je].g-100),Ie=!1;else try{vA(ot,L,"req"+me+"_")}catch{g&&g(ot)}}if(Ie){g=L.join("&");break e}}}return c=c.i.splice(0,f),d.D=c,g}function nw(c){if(!c.g&&!c.u){c.Y=1;var d=c.Fa;ms||d_(),ys||(ms(),ys=!0),oh.add(d,c),c.v=0}}function Sh(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Ds(m(c.Fa,c),ow(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,rw(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Ds(m(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,dt(10),Fu(this),rw(this))};function Ah(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function rw(c){c.g=new Zn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var d=Dn(c.qa);be(d,"RID","rpc"),be(d,"SID",c.K),be(d,"AID",c.T),be(d,"CI",c.F?"0":"1"),!c.F&&c.ja&&be(d,"TO",c.ja),be(d,"TYPE","xmlhttp"),Ps(c,d),c.m&&c.o&&Ch(d,c.m,c.o),c.L&&(c.g.I=c.L);var f=c.g;c=c.ia,f.L=1,f.v=Pu(Dn(d)),f.m=null,f.P=!0,R_(f,c)}n.Za=function(){this.C!=null&&(this.C=null,Fu(this),Sh(this),dt(19))};function Vu(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function iw(c,d){var f=null;if(c.g==d){Vu(c),Ah(c),c.g=null;var g=2}else if(Dh(c.h,d))f=d.D,F_(c.h,d),g=1;else return;if(c.G!=0){if(d.o)if(g==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var T=c.B;g=Su(),lt(g,new b_(g,f)),Lu(c)}else nw(c);else if(T=d.s,T==3||T==0&&0<d.X||!(g==1&&EA(c,d)||g==2&&Sh(c)))switch(f&&0<f.length&&(d=c.h,d.i=d.i.concat(f)),T){case 1:Or(c,5);break;case 4:Or(c,10);break;case 3:Or(c,6);break;default:Or(c,2)}}}function ow(c,d){let f=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(f*=2),f*d}function Or(c,d){if(c.j.info("Error code "+d),d==2){var f=m(c.fb,c),g=c.Xa;let T=!g;g=new kr(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Mu(g,"https"),Pu(g),T?gA(g.toString(),f):mA(g.toString(),f)}else dt(2);c.G=0,c.l&&c.l.sa(d),sw(c),X_(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),dt(2)):(this.j.info("Failed to ping google.com"),dt(1))};function sw(c){if(c.G=0,c.ka=[],c.l){let d=L_(c.h);(d.length!=0||c.i.length!=0)&&(M(c.ka,d),M(c.ka,c.i),c.h.i.length=0,A(c.i),c.i.length=0),c.l.ra()}}function aw(c,d,f){var g=f instanceof kr?Dn(f):new kr(f);if(g.g!="")d&&(g.g=d+"."+g.g),Nu(g,g.s);else{var T=a.location;g=T.protocol,d=d?d+"."+T.hostname:T.hostname,T=+T.port;var x=new kr(null);g&&Mu(x,g),d&&(x.g=d),T&&Nu(x,T),f&&(x.l=f),g=x}return f=c.D,d=c.ya,f&&d&&be(g,f,d),be(g,"VER",c.la),Ps(c,g),g}function uw(c,d,f){if(d&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=c.Ca&&!c.pa?new ke(new xs({eb:f})):new ke(c.pa),d.Ha(c.J),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function cw(){}n=cw.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ju(){}ju.prototype.g=function(c,d){return new Ct(c,d)};function Ct(c,d){it.call(this),this.g=new J_(d),this.l=c,this.h=d&&d.messageUrlParams||null,c=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(c?c["X-WebChannel-Content-Type"]=d.messageContentType:c={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(c?c["X-WebChannel-Client-Profile"]=d.va:c={"X-WebChannel-Client-Profile":d.va}),this.g.S=c,(c=d&&d.Sb)&&!B(c)&&(this.g.m=c),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!B(d)&&(this.g.D=d,c=this.h,c!==null&&d in c&&(c=this.h,d in c&&delete c[d])),this.j=new ki(this)}C(Ct,it),Ct.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ct.prototype.close=function(){bh(this.g)},Ct.prototype.o=function(c){var d=this.g;if(typeof c=="string"){var f={};f.__data__=c,c=f}else this.u&&(f={},f.__data__=ph(c),c=f);d.i.push(new oA(d.Ya++,c)),d.G==3&&Lu(d)},Ct.prototype.N=function(){this.g.l=null,delete this.j,bh(this.g),delete this.g,Ct.aa.N.call(this)};function lw(c){mh.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var d=c.__sm__;if(d){e:{for(let f in d){c=f;break e}c=void 0}(this.i=c)&&(c=this.i,d=d!==null&&c in d?d[c]:void 0),this.data=d}else this.data=c}C(lw,mh);function dw(){yh.call(this),this.status=1}C(dw,yh);function ki(c){this.g=c}C(ki,cw),ki.prototype.ua=function(){lt(this.g,"a")},ki.prototype.ta=function(c){lt(this.g,new lw(c))},ki.prototype.sa=function(c){lt(this.g,new dw)},ki.prototype.ra=function(){lt(this.g,"b")},ju.prototype.createWebChannel=ju.prototype.g,Ct.prototype.send=Ct.prototype.o,Ct.prototype.open=Ct.prototype.m,Ct.prototype.close=Ct.prototype.close,um=Bn.createWebChannelTransport=function(){return new ju},am=Bn.getStatEventTarget=function(){return Su()},sm=Bn.Event=Nr,Ol=Bn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Au.NO_ERROR=0,Au.TIMEOUT=8,Au.HTTP_ERROR=6,La=Bn.ErrorCode=Au,S_.COMPLETE="complete",om=Bn.EventType=S_,E_.EventType=Is,Is.OPEN="a",Is.CLOSE="b",Is.ERROR="c",Is.MESSAGE="d",it.prototype.listen=it.prototype.K,Ao=Bn.WebChannel=E_,IO=Bn.FetchXmlHttpFactory=xs,ke.prototype.listenOnce=ke.prototype.L,ke.prototype.getLastError=ke.prototype.Ka,ke.prototype.getLastErrorCode=ke.prototype.Ba,ke.prototype.getStatus=ke.prototype.Z,ke.prototype.getResponseJson=ke.prototype.Oa,ke.prototype.getResponseText=ke.prototype.oa,ke.prototype.send=ke.prototype.ea,ke.prototype.setWithCredentials=ke.prototype.Ha,im=Bn.XhrIo=ke}).apply(typeof kl<"u"?kl:typeof self<"u"?self:typeof window<"u"?window:{});var sC="@firebase/firestore";var ze=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ze.UNAUTHENTICATED=new ze(null),ze.GOOGLE_CREDENTIALS=new ze("google-credentials-uid"),ze.FIRST_PARTY=new ze("first-party-uid"),ze.MOCK_USER=new ze("mock-user");var os="10.14.0";var _r=new Hu("@firebase/firestore");function Po(){return _r.logLevel}function cb(n){_r.setLogLevel(n)}function k(n,...e){if(_r.logLevel<=sn.DEBUG){let t=e.map(fv);_r.debug(`Firestore (${os}): ${n}`,...t)}}function je(n,...e){if(_r.logLevel<=sn.ERROR){let t=e.map(fv);_r.error(`Firestore (${os}): ${n}`,...t)}}function en(n,...e){if(_r.logLevel<=sn.WARN){let t=e.map(fv);_r.warn(`Firestore (${os}): ${n}`,...t)}}function fv(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function H(n="Unexpected state"){let e=`FIRESTORE (${os}) INTERNAL ASSERTION FAILED: `+n;throw je(e),new Error(e)}function q(n,e){n||H()}function lb(n,e){n||H()}function V(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},P=class extends yw{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Qe=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var zl=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},pm=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ze.UNAUTHENTICATED))}shutdown(){}},gm=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},mm=class{constructor(e){this.t=e,this.currentUser=ze.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){q(this.o===void 0);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),o=new Qe;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Qe,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let u=o;e.enqueueRetryable(()=>N(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Qe)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(q(typeof r.accessToken=="string"),new zl(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return q(e===null||typeof e=="string"),new ze(e)}},ym=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ze.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},vm=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new ym(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ze.FIRST_PARTY))}shutdown(){}invalidateToken(){}},_m=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},wm=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){q(this.o===void 0);let r=o=>{o.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,k("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(q(typeof t.token=="string"),this.R=t.token,new _m(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function EO(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Gl=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=EO(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function ne(n,e){return n<e?-1:n>e?1:0}function $o(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function db(n){return n+"\0"}var Ne=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new P(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new P(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new P(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var G=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Ne(0,0))}static max(){return new n(new Ne(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Wl=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&H(),r===void 0?r=e.length-t:r>e.length-t&&H(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),s=t.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},fe=class n extends Wl{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new P(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},DO=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Be=class n extends Wl{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return DO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new P(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new P(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new P(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new P(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var j=class n{constructor(e){this.path=e}static fromPath(e){return new n(fe.fromString(e))}static fromName(e){return new n(fe.fromString(e).popFirst(5))}static empty(){return new n(fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return fe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new fe(e.slice()))}};var Ho=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function Im(n){return n.fields.find(e=>e.kind===2)}function ai(n){return n.fields.filter(e=>e.kind!==2)}Ho.UNKNOWN_ID=-1;var jo=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Qa=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,$t.min())}};function hb(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=G.fromTimestamp(r===1e9?new Ne(t+1,0):new Ne(t,r));return new $t(i,j.empty(),e)}function fb(n){return new $t(n.readTime,n.key,-1)}var $t=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(G.min(),j.empty(),-1)}static max(){return new n(G.max(),j.empty(),-1)}};function pv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=j.comparator(n.documentKey,e.documentKey),t!==0?t:ne(n.largestBatchId,e.largestBatchId))}var pb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Kl=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function xr(n){return N(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==pb)throw n;k("LocalStore","Unexpectedly lost primary lease")})}var S=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&H(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},u=>r(u))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let u=0;u<o;u++){let l=u;t(e[l]).next(h=>{s[l]=h,++a,a===o&&r(s)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};var Ql=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Qe,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new fi(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=gv(r.target.error);this.V.reject(new fi(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(o){throw new fi(t,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(k("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new Dm(t)}},wr=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(ks())===12.2&&je("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return k("SimpleDb","Removing database:",e),ui(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!$u())return!1;if(n.v())return!0;let e=ks(),t=n.S(e),r=0<t&&t<10,i=gb(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return N(this,null,function*(){return this.db||(k("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{r(new fi(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?r(new P(R.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new P(R.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new fi(e,s))},i.onupgradeneeded=o=>{k("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;this.p.O(s,i.transaction,o.oldVersion,this.version).next(()=>{k("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return N(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.M(e);let a=Ql.open(this.db,e,o?"readonly":"readwrite",r),u=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),S.reject(l))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,l=u.name!=="FirebaseError"&&s<3;if(k("SimpleDb","Transaction failed with error:",u.message,"Retrying:",l),this.close(),!l)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function gb(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var Em=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ui(this.B.delete())}},fi=class extends P{constructor(e,t){super(R.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Rr(n){return n.name==="IndexedDbTransactionError"}var Dm=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(k("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(k("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ui(r)}add(e){return k("SimpleDb","ADD",this.store.name,e,e),ui(this.store.add(e))}get(e){return ui(this.store.get(e)).next(t=>(t===void 0&&(t=null),k("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return k("SimpleDb","DELETE",this.store.name,e),ui(this.store.delete(e))}count(){return k("SimpleDb","COUNT",this.store.name),ui(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(r.range);return new S((s,a)=>{o.onerror=u=>{a(u.target.error)},o.onsuccess=u=>{s(u.target.result)}})}{let o=this.cursor(r),s=[];return this.W(o,(a,u)=>{s.push(u)}).next(()=>s)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new S((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}j(e,t){k("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(o,s,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new S((r,i)=>{t.onerror=o=>{let s=gv(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}W(e,t){let r=[];return new S((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let a=s.target.result;if(!a)return void i();let u=new Em(a),l=t(a.primaryKey,a.value,u);if(l instanceof S){let h=l.catch(p=>(u.done(),S.reject(p)));r.push(h)}u.isDone?i():u.K===null?a.continue():a.continue(u.K)}}).next(()=>S.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function ui(n){return new S((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=gv(r.target.error);t(i)}})}var aC=!1;function gv(n){let e=wr.S(ks());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new P("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return aC||(aC=!0,setTimeout(()=>{throw r},0)),r}}return n}var Tm=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){k("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>N(this,null,function*(){this.task=null;try{k("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){Rr(t)?k("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield xr(t)}yield this.X(6e4)}))}},Cm=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return N(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,o=!0;return S.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return k("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(i,o)).next(a=>(k("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}re(e,t){let r=e;return t.changes.forEach((i,o)=>{let s=fb(o);pv(s,r)>0&&(r=s)}),new $t(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var xt=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function mu(n){return n==null}function Ya(n){return n===0&&1/n==-1/0}function mb(n){return typeof n=="number"&&Number.isInteger(n)&&!Ya(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function yt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=uC(e)),e=TO(n.get(t),e);return uC(e)}function TO(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function uC(n){return n+""}function hn(n){let e=n.length;if(q(e>=2),e===2)return q(n.charAt(0)===""&&n.charAt(1)===""),fe.emptyPath();let t=e-2,r=[],i="";for(let o=0;o<e;){let s=n.indexOf("",o);switch((s<0||s>t)&&H(),n.charAt(s+1)){case"":let a=n.substring(o,s),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:H()}o=s+2}return new fe(r)}var cC=["userId","batchId"];function Bl(n,e){return[n,yt(e)]}function yb(n,e,t){return[n,yt(e),t]}var CO={},bO=["prefixPath","collectionGroup","readTime","documentId"],SO=["prefixPath","collectionGroup","documentId"],AO=["collectionGroup","readTime","prefixPath","documentId"],xO=["canonicalId","targetId"],RO=["targetId","path"],MO=["path","targetId"],NO=["collectionId","parent"],PO=["indexId","uid"],kO=["uid","sequenceNumber"],OO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],FO=["indexId","uid","orderedDocumentKey"],LO=["userId","collectionPath","documentId"],VO=["userId","collectionPath","largestBatchId"],jO=["userId","collectionGroup","largestBatchId"],vb=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],BO=[...vb,"documentOverlays"],_b=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],wb=_b,mv=[...wb,"indexConfiguration","indexState","indexEntries"],UO=mv,$O=[...mv,"globals"];var Za=class extends Kl{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function Ye(n,e){let t=V(n);return wr.F(t._e,e)}function lC(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ci(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Ib(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ae=class n{constructor(e,t){this.comparator=e,this.root=t||pn.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pn.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vo(this.root,e,this.comparator,!0)}},Vo=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},pn=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw H();let e=this.left.check();if(e!==this.right.check())throw H();return e+(this.isRed()?0:1)}};pn.EMPTY=null,pn.RED=!0,pn.BLACK=!1;pn.EMPTY=new class{constructor(){this.size=0}get key(){throw H()}get value(){throw H()}get color(){throw H()}get left(){throw H()}get right(){throw H()}copy(e,t,r,i,o){return this}insert(e,t,r){return new pn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Te=class n{constructor(e){this.comparator=e,this.data=new Ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Yl(this.data.getIterator())}getIteratorFrom(e){return new Yl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Yl=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function xo(n){return n.hasNext()?n.getNext():void 0}var Rt=class n{constructor(e){this.fields=e,e.sort(Be.comparator)}static empty(){return new n([])}unionWith(e){let t=new Te(Be.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return $o(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Zl=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function Eb(){return typeof atob<"u"}var $e=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Zl("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};$e.EMPTY_BYTE_STRING=new $e("");var HO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hn(n){if(q(!!n),typeof n=="string"){let e=0,t=HO.exec(n);if(q(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:xe(n.seconds),nanos:xe(n.nanos)}}function xe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ir(n){return typeof n=="string"?$e.fromBase64String(n):$e.fromUint8Array(n)}function $d(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function yv(n){let e=n.mapValue.fields.__previous_value__;return $d(e)?yv(e):e}function Ja(n){let e=Hn(n.mapValue.fields.__local_write_time__.timestampValue);return new Ne(e.seconds,e.nanos)}var bm=class{constructor(e,t,r,i,o,s,a,u,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}},Er=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var yr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ul={nullValue:"NULL_VALUE"};function pi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?$d(n)?4:Db(n)?9007199254740991:Hd(n)?10:11:H()}function yn(n,e){if(n===e)return!0;let t=pi(n);if(t!==pi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ja(n).isEqual(Ja(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=Hn(i.timestampValue),a=Hn(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Ir(i.bytesValue).isEqual(Ir(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return xe(i.geoPointValue.latitude)===xe(o.geoPointValue.latitude)&&xe(i.geoPointValue.longitude)===xe(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return xe(i.integerValue)===xe(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=xe(i.doubleValue),a=xe(o.doubleValue);return s===a?Ya(s)===Ya(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return $o(n.arrayValue.values||[],e.arrayValue.values||[],yn);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(lC(s)!==lC(a))return!1;for(let u in s)if(s.hasOwnProperty(u)&&(a[u]===void 0||!yn(s[u],a[u])))return!1;return!0}(n,e);default:return H()}}function Xa(n,e){return(n.values||[]).find(t=>yn(t,e))!==void 0}function Dr(n,e){if(n===e)return 0;let t=pi(n),r=pi(e);if(t!==r)return ne(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ne(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=xe(o.integerValue||o.doubleValue),u=xe(s.integerValue||s.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return dC(n.timestampValue,e.timestampValue);case 4:return dC(Ja(n),Ja(e));case 5:return ne(n.stringValue,e.stringValue);case 6:return function(o,s){let a=Ir(o),u=Ir(s);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),u=s.split("/");for(let l=0;l<a.length&&l<u.length;l++){let h=ne(a[l],u[l]);if(h!==0)return h}return ne(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=ne(xe(o.latitude),xe(s.latitude));return a!==0?a:ne(xe(o.longitude),xe(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return hC(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,u,l,h;let p=o.fields||{},m=s.fields||{},y=(a=p.value)===null||a===void 0?void 0:a.arrayValue,C=(u=m.value)===null||u===void 0?void 0:u.arrayValue,A=ne(((l=y?.values)===null||l===void 0?void 0:l.length)||0,((h=C?.values)===null||h===void 0?void 0:h.length)||0);return A!==0?A:hC(y,C)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===yr.mapValue&&s===yr.mapValue)return 0;if(o===yr.mapValue)return 1;if(s===yr.mapValue)return-1;let a=o.fields||{},u=Object.keys(a),l=s.fields||{},h=Object.keys(l);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){let m=ne(u[p],h[p]);if(m!==0)return m;let y=Dr(a[u[p]],l[h[p]]);if(y!==0)return y}return ne(u.length,h.length)}(n.mapValue,e.mapValue);default:throw H()}}function dC(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ne(n,e);let t=Hn(n),r=Hn(e),i=ne(t.seconds,r.seconds);return i!==0?i:ne(t.nanos,r.nanos)}function hC(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Dr(t[i],r[i]);if(o)return o}return ne(t.length,r.length)}function qo(n){return Sm(n)}function Sm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Hn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ir(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return j.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=Sm(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${Sm(t.fields[s])}`;return i+"}"}(n.mapValue):H()}function gi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Am(n){return!!n&&"integerValue"in n}function eu(n){return!!n&&"arrayValue"in n}function fC(n){return!!n&&"nullValue"in n}function pC(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function $l(n){return!!n&&"mapValue"in n}function Hd(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function qa(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Ci(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=qa(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=qa(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Db(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Tb={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function qO(n){return"nullValue"in n?Ul:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?gi(Er.empty(),j.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Hd(n)?Tb:{mapValue:{}}:H()}function zO(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?gi(Er.empty(),j.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Tb:"mapValue"in n?Hd(n)?{mapValue:{}}:yr:H()}function gC(n,e){let t=Dr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function mC(n,e){let t=Dr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var ct=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!$l(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=qa(t)}setAll(e){let t=Be.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=qa(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());$l(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return yn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];$l(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Ci(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(qa(this.value))}};function Cb(n){let e=[];return Ci(n.fields,(t,r)=>{let i=new Be([t]);if($l(r)){let o=Cb(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new Rt(e)}var Ge=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,G.min(),G.min(),G.min(),ct.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,G.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,G.min(),G.min(),ct.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,G.min(),G.min(),ct.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(G.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ct.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ct.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=G.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var vn=class{constructor(e,t){this.position=e,this.inclusive=t}};function yC(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=j.comparator(j.fromName(s.referenceValue),t.key):r=Dr(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function vC(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!yn(n.position[t],e.position[t]))return!1;return!0}var mi=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function GO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Jl=class{},le=class n extends Jl{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Mm(e,t,r):t==="array-contains"?new km(e,r):t==="in"?new Xl(e,r):t==="not-in"?new Om(e,r):t==="array-contains-any"?new Fm(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Nm(e,r):new Pm(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Dr(t,this.value)):t!==null&&pi(this.value)===pi(t)&&this.matchesComparison(Dr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return H()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},we=class n extends Jl{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return zo(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function zo(n){return n.op==="and"}function xm(n){return n.op==="or"}function vv(n){return bb(n)&&zo(n)}function bb(n){for(let e of n.filters)if(e instanceof we)return!1;return!0}function Rm(n){if(n instanceof le)return n.field.canonicalString()+n.op.toString()+qo(n.value);if(vv(n))return n.filters.map(e=>Rm(e)).join(",");{let e=n.filters.map(t=>Rm(t)).join(",");return`${n.op}(${e})`}}function Sb(n,e){return n instanceof le?function(r,i){return i instanceof le&&r.op===i.op&&r.field.isEqual(i.field)&&yn(r.value,i.value)}(n,e):n instanceof we?function(r,i){return i instanceof we&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&Sb(s,i.filters[a]),!0):!1}(n,e):void H()}function Ab(n,e){let t=n.filters.concat(e);return we.create(t,n.op)}function xb(n){return n instanceof le?function(t){return`${t.field.canonicalString()} ${t.op} ${qo(t.value)}`}(n):n instanceof we?function(t){return t.op.toString()+" {"+t.getFilters().map(xb).join(" ,")+"}"}(n):"Filter"}var Mm=class extends le{constructor(e,t,r){super(e,t,r),this.key=j.fromName(r.referenceValue)}matches(e){let t=j.comparator(e.key,this.key);return this.matchesComparison(t)}},Nm=class extends le{constructor(e,t){super(e,"in",t),this.keys=Rb("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Pm=class extends le{constructor(e,t){super(e,"not-in",t),this.keys=Rb("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Rb(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>j.fromName(r.referenceValue))}var km=class extends le{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return eu(t)&&Xa(t.arrayValue,this.value)}},Xl=class extends le{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Xa(this.value.arrayValue,t)}},Om=class extends le{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Xa(this.value.arrayValue,t)}},Fm=class extends le{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!eu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Xa(this.value.arrayValue,r))}};var Lm=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}};function Vm(n,e=null,t=[],r=[],i=null,o=null,s=null){return new Lm(n,e,t,r,i,o,s)}function yi(n){let e=V(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Rm(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),mu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>qo(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>qo(r)).join(",")),e.ue=t}return e.ue}function yu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!GO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Sb(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!vC(n.startAt,e.startAt)&&vC(n.endAt,e.endAt)}function ed(n){return j.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function td(n,e){return n.filters.filter(t=>t instanceof le&&t.field.isEqual(e))}function _C(n,e,t){let r=Ul,i=!0;for(let o of td(n,e)){let s=Ul,a=!0;switch(o.op){case"<":case"<=":s=qO(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=Ul}gC({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];gC({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function wC(n,e,t){let r=yr,i=!0;for(let o of td(n,e)){let s=yr,a=!0;switch(o.op){case">=":case">":s=zO(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=yr}mC({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];mC({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}var tn=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Mb(n,e,t,r,i,o,s,a){return new tn(n,e,t,r,i,o,s,a)}function ss(n){return new tn(n)}function IC(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function _v(n){return n.collectionGroup!==null}function Bo(n){let e=V(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Te(Be.comparator);return s.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new mi(o,r))}),t.has(Be.keyField().canonicalString())||e.ce.push(new mi(Be.keyField(),r))}return e.ce}function vt(n){let e=V(n);return e.le||(e.le=WO(e,Bo(n))),e.le}function WO(n,e){if(n.limitType==="F")return Vm(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new mi(i.field,o)});let t=n.endAt?new vn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new vn(n.startAt.position,n.startAt.inclusive):null;return Vm(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function jm(n,e){let t=n.filters.concat([e]);return new tn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function nd(n,e,t){return new tn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function vu(n,e){return yu(vt(n),vt(e))&&n.limitType===e.limitType}function Nb(n){return`${yi(vt(n))}|lt:${n.limitType}`}function ko(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>xb(i)).join(", ")}]`),mu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>qo(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>qo(i)).join(",")),`Target(${r})`}(vt(n))}; limitType=${n.limitType})`}function _u(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):j.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of Bo(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,u){let l=yC(s,a,u);return s.inclusive?l<=0:l<0}(r.startAt,Bo(r),i)||r.endAt&&!function(s,a,u){let l=yC(s,a,u);return s.inclusive?l>=0:l>0}(r.endAt,Bo(r),i))}(n,e)}function Pb(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function kb(n){return(e,t)=>{let r=!1;for(let i of Bo(n)){let o=KO(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function KO(n,e,t){let r=n.field.isKeyField()?j.comparator(e.key,t.key):function(o,s,a){let u=s.data.field(o),l=a.data.field(o);return u!==null&&l!==null?Dr(u,l):H()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return H()}}var _n=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ci(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return Ib(this.inner)}size(){return this.innerSize}};var QO=new Ae(j.comparator);function Tt(){return QO}var Ob=new Ae(j.comparator);function $a(...n){let e=Ob;for(let t of n)e=e.insert(t.key,t);return e}function Fb(n){let e=Ob;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function fn(){return za()}function Lb(){return za()}function za(){return new _n(n=>n.toString(),(n,e)=>n.isEqual(e))}var YO=new Ae(j.comparator),ZO=new Te(j.comparator);function ie(...n){let e=ZO;for(let t of n)e=e.add(t);return e}var JO=new Te(ne);function wv(){return JO}function Iv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ya(e)?"-0":e}}function Vb(n){return{integerValue:""+n}}function jb(n,e){return mb(e)?Vb(e):Iv(n,e)}var Go=class{constructor(){this._=void 0}};function XO(n,e,t){return n instanceof Tr?function(i,o){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&$d(o)&&(o=yv(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof qn?Ub(n,e):n instanceof zn?$b(n,e):function(i,o){let s=Bb(i,o),a=EC(s)+EC(i.Pe);return Am(s)&&Am(i.Pe)?Vb(a):Iv(i.serializer,a)}(n,e)}function eF(n,e,t){return n instanceof qn?Ub(n,e):n instanceof zn?$b(n,e):t}function Bb(n,e){return n instanceof Cr?function(r){return Am(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var Tr=class extends Go{},qn=class extends Go{constructor(e){super(),this.elements=e}};function Ub(n,e){let t=Hb(e);for(let r of n.elements)t.some(i=>yn(i,r))||t.push(r);return{arrayValue:{values:t}}}var zn=class extends Go{constructor(e){super(),this.elements=e}};function $b(n,e){let t=Hb(e);for(let r of n.elements)t=t.filter(i=>!yn(i,r));return{arrayValue:{values:t}}}var Cr=class extends Go{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function EC(n){return xe(n.integerValue||n.doubleValue)}function Hb(n){return eu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var vi=class{constructor(e,t){this.field=e,this.transform=t}};function tF(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof qn&&i instanceof qn||r instanceof zn&&i instanceof zn?$o(r.elements,i.elements,yn):r instanceof Cr&&i instanceof Cr?yn(r.Pe,i.Pe):r instanceof Tr&&i instanceof Tr}(n.transform,e.transform)}var Bm=class{constructor(e,t){this.version=e,this.transformResults=t}},Fe=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Hl(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Wo=class{};function qb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Sr(n.key,Fe.none()):new br(n.key,n.data,Fe.none());{let t=n.data,r=ct.empty(),i=new Te(Be.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new nn(n.key,r,new Rt(i.toArray()),Fe.none())}}function nF(n,e,t){n instanceof br?function(i,o,s){let a=i.value.clone(),u=TC(i.fieldTransforms,o,s.transformResults);a.setAll(u),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof nn?function(i,o,s){if(!Hl(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=TC(i.fieldTransforms,o,s.transformResults),u=o.data;u.setAll(zb(i)),u.setAll(a),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function Ga(n,e,t,r){return n instanceof br?function(o,s,a,u){if(!Hl(o.precondition,s))return a;let l=o.value.clone(),h=CC(o.fieldTransforms,u,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof nn?function(o,s,a,u){if(!Hl(o.precondition,s))return a;let l=CC(o.fieldTransforms,u,s),h=s.data;return h.setAll(zb(o)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(o,s,a){return Hl(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function rF(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=Bb(r.transform,i||null);o!=null&&(t===null&&(t=ct.empty()),t.set(r.field,o))}return t||null}function DC(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&$o(r,i,(o,s)=>tF(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var br=class extends Wo{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},nn=class extends Wo{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function zb(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function TC(n,e,t){let r=new Map;q(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,eF(s,a,t[i]))}return r}function CC(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,XO(o,s,e))}return r}var Sr=class extends Wo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},tu=class extends Wo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var nu=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&nF(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ga(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ga(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Lb();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let u=qb(s,a);u!==null&&r.set(i.key,u),s.isValidDocument()||s.convertToNoDocument(G.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ie())}isEqual(e){return this.batchId===e.batchId&&$o(this.mutations,e.mutations,(t,r)=>DC(t,r))&&$o(this.baseMutations,e.baseMutations,(t,r)=>DC(t,r))}},Um=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){q(e.mutations.length===r.length);let i=function(){return YO}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var ru=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var $m=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var He,he;function Gb(n){switch(n){default:return H();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function Wb(n){if(n===void 0)return je("GRPC error has no .code"),R.UNKNOWN;switch(n){case He.OK:return R.OK;case He.CANCELLED:return R.CANCELLED;case He.UNKNOWN:return R.UNKNOWN;case He.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case He.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case He.INTERNAL:return R.INTERNAL;case He.UNAVAILABLE:return R.UNAVAILABLE;case He.UNAUTHENTICATED:return R.UNAUTHENTICATED;case He.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case He.NOT_FOUND:return R.NOT_FOUND;case He.ALREADY_EXISTS:return R.ALREADY_EXISTS;case He.PERMISSION_DENIED:return R.PERMISSION_DENIED;case He.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case He.ABORTED:return R.ABORTED;case He.OUT_OF_RANGE:return R.OUT_OF_RANGE;case He.UNIMPLEMENTED:return R.UNIMPLEMENTED;case He.DATA_LOSS:return R.DATA_LOSS;default:return H()}}(he=He||(He={}))[he.OK=0]="OK",he[he.CANCELLED=1]="CANCELLED",he[he.UNKNOWN=2]="UNKNOWN",he[he.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",he[he.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",he[he.NOT_FOUND=5]="NOT_FOUND",he[he.ALREADY_EXISTS=6]="ALREADY_EXISTS",he[he.PERMISSION_DENIED=7]="PERMISSION_DENIED",he[he.UNAUTHENTICATED=16]="UNAUTHENTICATED",he[he.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",he[he.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",he[he.ABORTED=10]="ABORTED",he[he.OUT_OF_RANGE=11]="OUT_OF_RANGE",he[he.UNIMPLEMENTED=12]="UNIMPLEMENTED",he[he.INTERNAL=13]="INTERNAL",he[he.UNAVAILABLE=14]="UNAVAILABLE",he[he.DATA_LOSS=15]="DATA_LOSS";var bC=null;function Kb(){return new TextEncoder}var iF=new hr([4294967295,4294967295],0);function SC(n){let e=Kb().encode(n),t=new rm;return t.update(e),new Uint8Array(t.digest())}function AC(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new hr([t,r],0),new hr([i,o],0)]}var Hm=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new hi(`Invalid padding: ${t}`);if(r<0)throw new hi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new hi(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new hi(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=hr.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(hr.fromNumber(r)));return i.compare(iF)===1&&(i=new hr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=SC(e),[r,i]=AC(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);if(!this.de(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.Ie===0)return;let t=SC(e),[r,i]=AC(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);this.Ae(s)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},hi=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var iu=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,ou.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(G.min(),i,new Ae(ne),Tt(),ie())}},ou=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ie(),ie(),ie())}};var Uo=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},rd=class{constructor(e,t){this.targetId=e,this.me=t}},id=class{constructor(e,t,r=$e.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},od=class{constructor(){this.fe=0,this.ge=RC(),this.pe=$e.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ie(),t=ie(),r=ie();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:H()}}),new ou(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=RC()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,q(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},qm=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Tt(),this.qe=xC(),this.Qe=new Ae(ne)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:H()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(ed(o))if(r===0){let s=new j(o.path);this.Ue(t,s,Ge.newNoDocument(s,G.min()))}else q(r===1);else{let s=this.Ye(t);if(s!==r){let a=this.Ze(e),u=a?this.Xe(a,e,s):1;if(u!==0){this.je(t);let l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}bC?.et(function(h,p,m,y,C){var A,M,O,B,F,W;let X={localCacheCount:h,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},K=p.unchangedNames;return K&&(X.bloomFilter={applied:C===0,hashCount:(A=K?.hashCount)!==null&&A!==void 0?A:0,bitmapLength:(B=(O=(M=K?.bits)===null||M===void 0?void 0:M.bitmap)===null||O===void 0?void 0:O.length)!==null&&B!==void 0?B:0,padding:(W=(F=K?.bits)===null||F===void 0?void 0:F.padding)!==null&&W!==void 0?W:0,mightContain:I=>{var v;return(v=y?.mightContain(I))!==null&&v!==void 0&&v}}),X}(s,e.me,this.Le.tt(),a,u))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=Ir(r).toUint8Array()}catch(u){if(u instanceof Zl)return en("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Hm(s,i,o)}catch(u){return en(u instanceof hi?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Le.tt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,s)=>{let a=this.Je(s);if(a){if(o.current&&ed(a.target)){let u=new j(a.target.path);this.ke.get(u)!==null||this.it(s,u)||this.Ue(s,u,Ge.newNoDocument(u,e))}o.be&&(t.set(s,o.ve()),o.Ce())}});let r=ie();this.qe.forEach((o,s)=>{let a=!0;s.forEachWhile(u=>{let l=this.Je(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));let i=new iu(e,t,this.Qe,this.ke,r);return this.ke=Tt(),this.qe=xC(),this.Qe=new Ae(ne),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new od,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Te(ne),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new od),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function xC(){return new Ae(j.comparator)}function RC(){return new Ae(j.comparator)}var oF={asc:"ASCENDING",desc:"DESCENDING"},sF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},aF={and:"AND",or:"OR"},zm=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Gm(n,e){return n.useProto3Json||mu(e)?e:{value:e}}function Ko(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Qb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function uF(n,e){return Ko(n,e.toTimestamp())}function Ue(n){return q(!!n),G.fromTimestamp(function(t){let r=Hn(t);return new Ne(r.seconds,r.nanos)}(n))}function Ev(n,e){return Wm(n,e).canonicalString()}function Wm(n,e){let t=function(i){return new fe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Yb(n){let e=fe.fromString(n);return q(s0(e)),e}function su(n,e){return Ev(n.databaseId,e.path)}function gn(n,e){let t=Yb(e);if(t.get(1)!==n.databaseId.projectId)throw new P(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new P(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new j(Xb(t))}function Zb(n,e){return Ev(n.databaseId,e)}function Jb(n){let e=Yb(n);return e.length===4?fe.emptyPath():Xb(e)}function Km(n){return new fe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Xb(n){return q(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function MC(n,e,t){return{name:su(n,e),fields:t.value.mapValue.fields}}function e0(n,e,t){let r=gn(n,e.name),i=Ue(e.updateTime),o=e.createTime?Ue(e.createTime):G.min(),s=new ct({mapValue:{fields:e.fields}}),a=Ge.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function cF(n,e){return"found"in e?function(r,i){q(!!i.found),i.found.name,i.found.updateTime;let o=gn(r,i.found.name),s=Ue(i.found.updateTime),a=i.found.createTime?Ue(i.found.createTime):G.min(),u=new ct({mapValue:{fields:i.found.fields}});return Ge.newFoundDocument(o,s,a,u)}(n,e):"missing"in e?function(r,i){q(!!i.missing),q(!!i.readTime);let o=gn(r,i.missing),s=Ue(i.readTime);return Ge.newNoDocument(o,s)}(n,e):H()}function lF(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:H()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(l,h){return l.useProto3Json?(q(h===void 0||typeof h=="string"),$e.fromBase64String(h||"")):(q(h===void 0||h instanceof Buffer||h instanceof Uint8Array),$e.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(l){let h=l.code===void 0?R.UNKNOWN:Wb(l.code);return new P(h,l.message||"")}(s);t=new id(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=gn(n,r.document.name),o=Ue(r.document.updateTime),s=r.document.createTime?Ue(r.document.createTime):G.min(),a=new ct({mapValue:{fields:r.document.fields}}),u=Ge.newFoundDocument(i,o,s,a),l=r.targetIds||[],h=r.removedTargetIds||[];t=new Uo(l,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=gn(n,r.document),o=r.readTime?Ue(r.readTime):G.min(),s=Ge.newNoDocument(i,o),a=r.removedTargetIds||[];t=new Uo([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=gn(n,r.document),o=r.removedTargetIds||[];t=new Uo([],o,i,null)}else{if(!("filter"in e))return H();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new $m(i,o),a=r.targetId;t=new rd(a,s)}}return t}function au(n,e){let t;if(e instanceof br)t={update:MC(n,e.key,e.value)};else if(e instanceof Sr)t={delete:su(n,e.key)};else if(e instanceof nn)t={update:MC(n,e.key,e.data),updateMask:mF(e.fieldMask)};else{if(!(e instanceof tu))return H();t={verify:su(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof Tr)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof qn)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof zn)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Cr)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw H()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:uF(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:H()}(n,e.precondition)),t}function Qm(n,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?Fe.updateTime(Ue(o.updateTime)):o.exists!==void 0?Fe.exists(o.exists):Fe.none()}(e.currentDocument):Fe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let u=null;if("setToServerValue"in a)q(a.setToServerValue==="REQUEST_TIME"),u=new Tr;else if("appendMissingElements"in a){let h=a.appendMissingElements.values||[];u=new qn(h)}else if("removeAllFromArray"in a){let h=a.removeAllFromArray.values||[];u=new zn(h)}else"increment"in a?u=new Cr(s,a.increment):H();let l=Be.fromServerFormat(a.fieldPath);return new vi(l,u)}(n,i)):[];if(e.update){e.update.name;let i=gn(n,e.update.name),o=new ct({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(u){let l=u.fieldPaths||[];return new Rt(l.map(h=>Be.fromServerFormat(h)))}(e.updateMask);return new nn(i,o,s,t,r)}return new br(i,o,t,r)}if(e.delete){let i=gn(n,e.delete);return new Sr(i,t)}if(e.verify){let i=gn(n,e.verify);return new tu(i,t)}return H()}function dF(n,e){return n&&n.length>0?(q(e!==void 0),n.map(t=>function(i,o){let s=i.updateTime?Ue(i.updateTime):Ue(o);return s.isEqual(G.min())&&(s=Ue(o)),new Bm(s,i.transformResults||[])}(t,e))):[]}function t0(n,e){return{documents:[Zb(n,e.path)]}}function n0(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Zb(n,i);let o=function(l){if(l.length!==0)return o0(we.create(l,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(l){if(l.length!==0)return l.map(h=>function(m){return{field:Oo(m.field),direction:fF(m.dir)}}(h))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=Gm(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function r0(n){let e=Jb(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){q(r===1);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=function(p){let m=i0(p);return m instanceof we&&vv(m)?m.getFilters():[m]}(t.where));let s=[];t.orderBy&&(s=function(p){return p.map(m=>function(C){return new mi(Fo(C.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,mu(m)?null:m}(t.limit));let u=null;t.startAt&&(u=function(p){let m=!!p.before,y=p.values||[];return new vn(y,m)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let m=!p.before,y=p.values||[];return new vn(y,m)}(t.endAt)),Mb(e,i,s,o,a,"F",u,l)}function hF(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return H()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function i0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Fo(t.unaryFilter.field);return le.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Fo(t.unaryFilter.field);return le.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Fo(t.unaryFilter.field);return le.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=Fo(t.unaryFilter.field);return le.create(s,"!=",{nullValue:"NULL_VALUE"});default:return H()}}(n):n.fieldFilter!==void 0?function(t){return le.create(Fo(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return H()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return we.create(t.compositeFilter.filters.map(r=>i0(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return H()}}(t.compositeFilter.op))}(n):H()}function fF(n){return oF[n]}function pF(n){return sF[n]}function gF(n){return aF[n]}function Oo(n){return{fieldPath:n.canonicalString()}}function Fo(n){return Be.fromServerFormat(n.fieldPath)}function o0(n){return n instanceof le?function(t){if(t.op==="=="){if(pC(t.value))return{unaryFilter:{field:Oo(t.field),op:"IS_NAN"}};if(fC(t.value))return{unaryFilter:{field:Oo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(pC(t.value))return{unaryFilter:{field:Oo(t.field),op:"IS_NOT_NAN"}};if(fC(t.value))return{unaryFilter:{field:Oo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Oo(t.field),op:pF(t.op),value:t.value}}}(n):n instanceof we?function(t){let r=t.getFilters().map(i=>o0(i));return r.length===1?r[0]:{compositeFilter:{op:gF(t.op),filters:r}}}(n):H()}function mF(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function s0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Qo=class n{constructor(e,t,r,i,o=G.min(),s=G.min(),a=$e.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var sd=class{constructor(e){this.ct=e}};function yF(n,e){let t;if(e.document)t=e0(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=j.fromSegments(e.noDocument.path),i=wi(e.noDocument.readTime);t=Ge.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return H();{let r=j.fromSegments(e.unknownDocument.path),i=wi(e.unknownDocument.version);t=Ge.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let o=new Ne(i[0],i[1]);return G.fromTimestamp(o)}(e.readTime)),t}function NC(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ad(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:su(o,s.key),fields:s.data.value.mapValue.fields,updateTime:Ko(o,s.version.toTimestamp()),createTime:Ko(o,s.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:_i(e.version)};else{if(!e.isUnknownDocument())return H();r.unknownDocument={path:t.path.toArray(),version:_i(e.version)}}return r}function ad(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function _i(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function wi(n){let e=new Ne(n.seconds,n.nanoseconds);return G.fromTimestamp(e)}function ci(n,e){let t=(e.baseMutations||[]).map(o=>Qm(n.ct,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let r=e.mutations.map(o=>Qm(n.ct,o)),i=Ne.fromMillis(e.localWriteTimeMs);return new nu(e.batchId,i,t,r)}function Ha(n){let e=wi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?wi(n.lastLimboFreeSnapshotVersion):G.min(),r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){return q(o.documents.length===1),vt(ss(Jb(o.documents[0])))}(n.query):function(o){return vt(r0(o))}(n.query),new Qo(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,$e.fromBase64String(n.resumeToken))}function a0(n,e){let t=_i(e.snapshotVersion),r=_i(e.lastLimboFreeSnapshotVersion),i;i=ed(e.target)?t0(n.ct,e.target):n0(n.ct,e.target)._t;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:yi(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Dv(n){let e=r0({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?nd(e,e.limit,"L"):e}function cm(n,e){return new ru(e.largestBatchId,Qm(n.ct,e.overlayMutation))}function PC(n,e){let t=e.path.lastSegment();return[n,yt(e.path.popLast()),t]}function kC(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:_i(r.readTime),documentKey:yt(r.documentKey.path),largestBatchId:r.largestBatchId}}var Ym=class{getBundleMetadata(e,t){return OC(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:wi(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return OC(e).put(function(i){return{bundleId:i.id,createTime:_i(Ue(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return FC(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:Dv(o.bundledQuery),readTime:wi(o.readTime)}}(r)})}saveNamedQuery(e,t){return FC(e).put(function(i){return{name:i.name,readTime:_i(Ue(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function OC(n){return Ye(n,"bundles")}function FC(n){return Ye(n,"namedQueries")}var ud=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Va(e).get(PC(this.userId,t)).next(r=>r?cm(this.serializer,r):null)}getOverlays(e,t){let r=fn();return S.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((o,s)=>{let a=new ru(t,s);i.push(this.ht(e,a))}),S.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(s=>i.add(yt(s.getCollectionPath())));let o=[];return i.forEach(s=>{let a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(Va(e).j("collectionPathOverlayIndex",a))}),S.waitFor(o)}getOverlaysForCollection(e,t,r){let i=fn(),o=yt(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Va(e).U("collectionPathOverlayIndex",s).next(a=>{for(let u of a){let l=cm(this.serializer,u);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let o=fn(),s,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Va(e).J({index:"collectionGroupOverlayIndex",range:a},(u,l,h)=>{let p=cm(this.serializer,l);o.size()<i||p.largestBatchId===s?(o.set(p.getKey(),p),s=p.largestBatchId):h.done()}).next(()=>o)}ht(e,t){return Va(e).put(function(i,o,s){let[a,u,l]=PC(o,s.mutation.key);return{userId:o,collectionPath:u,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:au(i.ct,s.mutation)}}(this.serializer,this.userId,t))}};function Va(n){return Ye(n,"documentOverlays")}var Zm=class{Pt(e){return Ye(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?$e.fromUint8Array(r):$e.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var Un=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(xe(e.integerValue));else if("doubleValue"in e){let r=xe(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Ya(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Hn(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Ir(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Db(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Hd(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):H()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let s="value",a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(xe(a)),this.Vt(s,t),this.Tt(o[s],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),j.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Un.vt=new Un;function vF(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function LC(n){let e=64-function(r){let i=0;for(let o=0;o<8;++o){let s=vF(255&r[o]);if(i+=s,s!==8)break}return i}(n);return Math.ceil(e/8)}var Jm=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),r=LC(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),r=LC(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},Xm=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},ey=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},li=class{constructor(){this.jt=new Jm,this.Ht=new Xm(this.jt),this.Jt=new ey(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var di=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function fr(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=VC(n.arrayValue,e.arrayValue),t!==0?t:(t=VC(n.directionalValue,e.directionalValue),t!==0?t:j.comparator(n.documentKey,e.documentKey)))}function VC(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var cd=class{constructor(e){this.Xt=new Te((t,r)=>Be.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(q(e.collectionGroup===this.collectionId),this.nn)return!1;let t=Im(e);if(t!==void 0&&!this.sn(t))return!1;let r=ai(e),i=new Set,o=0,s=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[o];if(!this.on(a,u)||!this._n(this.en[s++],u))return!1}++o}for(;o<r.length;++o){let a=r[o];if(s>=this.en.length||!this._n(this.en[s++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Te(Be.comparator),t=[];for(let r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new jo(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new jo(r.field,0))}for(let r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new jo(r.field,r.dir==="asc"?0:1)));return new Ho(Ho.UNKNOWN_ID,this.collectionId,t,Qa.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function u0(n){var e,t;if(q(n instanceof le||n instanceof we),n instanceof le){if(n instanceof Xl){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>le.create(n.field,"==",o)))||[];return we.create(i,"or")}return n}let r=n.filters.map(i=>u0(i));return we.create(r,n.op)}function _F(n){if(n.getFilters().length===0)return[];let e=ry(u0(n));return q(c0(e)),ty(e)||ny(e)?[e]:e.getFilters()}function ty(n){return n instanceof le}function ny(n){return n instanceof we&&vv(n)}function c0(n){return ty(n)||ny(n)||function(t){if(t instanceof we&&xm(t)){for(let r of t.getFilters())if(!ty(r)&&!ny(r))return!1;return!0}return!1}(n)}function ry(n){if(q(n instanceof le||n instanceof we),n instanceof le)return n;if(n.filters.length===1)return ry(n.filters[0]);let e=n.filters.map(r=>ry(r)),t=we.create(e,n.op);return t=ld(t),c0(t)?t:(q(t instanceof we),q(zo(t)),q(t.filters.length>1),t.filters.reduce((r,i)=>Tv(r,i)))}function Tv(n,e){let t;return q(n instanceof le||n instanceof we),q(e instanceof le||e instanceof we),t=n instanceof le?e instanceof le?function(i,o){return we.create([i,o],"and")}(n,e):jC(n,e):e instanceof le?jC(e,n):function(i,o){if(q(i.filters.length>0&&o.filters.length>0),zo(i)&&zo(o))return Ab(i,o.getFilters());let s=xm(i)?i:o,a=xm(i)?o:i,u=s.filters.map(l=>Tv(l,a));return we.create(u,"or")}(n,e),ld(t)}function jC(n,e){if(zo(e))return Ab(e,n.getFilters());{let t=e.filters.map(r=>Tv(n,r));return we.create(t,"or")}}function ld(n){if(q(n instanceof le||n instanceof we),n instanceof le)return n;let e=n.getFilters();if(e.length===1)return ld(e[0]);if(bb(n))return n;let t=e.map(i=>ld(i)),r=[];return t.forEach(i=>{i instanceof le?r.push(i):i instanceof we&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:we.create(r,n.op)}var iy=class{constructor(){this.un=new uu}addToCollectionParentIndex(e,t){return this.un.add(t),S.resolve()}getCollectionParents(e,t){return S.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return S.resolve()}deleteFieldIndex(e,t){return S.resolve()}deleteAllFieldIndexes(e){return S.resolve()}createTargetIndexes(e,t){return S.resolve()}getDocumentsMatchingTarget(e,t){return S.resolve(null)}getIndexType(e,t){return S.resolve(0)}getFieldIndexes(e,t){return S.resolve([])}getNextCollectionGroupToUpdate(e){return S.resolve(null)}getMinOffset(e,t){return S.resolve($t.min())}getMinOffsetFromCollectionGroup(e,t){return S.resolve($t.min())}updateCollectionGroup(e,t,r){return S.resolve()}updateIndexEntries(e,t){return S.resolve()}},uu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Te(fe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Te(fe.comparator)).toArray()}};var Fl=new Uint8Array(0),oy=class{constructor(e,t){this.databaseId=t,this.cn=new uu,this.ln=new _n(r=>yi(r),(r,i)=>yu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let o={collectionId:r,parent:yt(i)};return BC(e).put(o)}return S.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[db(t),""],!1,!0);return BC(e).U(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;r.push(hn(s.parent))}return r})}addFieldIndex(e,t){let r=ja(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete i.indexId;let o=r.add(i);if(t.indexState){let s=Mo(e);return o.next(a=>{s.put(kC(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let r=ja(e),i=Mo(e),o=Ro(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=ja(e),r=Ro(e),i=Mo(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return S.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let o=new cd(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let r=Ro(e),i=!0,o=new Map;return S.forEach(this.hn(t),s=>this.Pn(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=ie(),a=[];return S.forEach(o,(u,l)=>{k("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(W=>`${W.fieldPath}:${W.kind}`).join(",")}`}(u)} to execute ${yi(t)}`);let h=function(F,W){let X=Im(W);if(X===void 0)return null;for(let K of td(F,X.fieldPath))switch(K.op){case"array-contains-any":return K.value.arrayValue.values||[];case"array-contains":return[K.value]}return null}(l,u),p=function(F,W){let X=new Map;for(let K of ai(W))for(let I of td(F,K.fieldPath))switch(I.op){case"==":case"in":X.set(K.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return X.set(K.fieldPath.canonicalString(),I.value),Array.from(X.values())}return null}(l,u),m=function(F,W){let X=[],K=!0;for(let I of ai(W)){let v=I.kind===0?_C(F,I.fieldPath,F.startAt):wC(F,I.fieldPath,F.startAt);X.push(v.value),K&&(K=v.inclusive)}return new vn(X,K)}(l,u),y=function(F,W){let X=[],K=!0;for(let I of ai(W)){let v=I.kind===0?wC(F,I.fieldPath,F.endAt):_C(F,I.fieldPath,F.endAt);X.push(v.value),K&&(K=v.inclusive)}return new vn(X,K)}(l,u),C=this.In(u,l,m),A=this.In(u,l,y),M=this.Tn(u,l,p),O=this.En(u.indexId,h,C,m.inclusive,A,y.inclusive,M);return S.forEach(O,B=>r.G(B,t.limit).next(F=>{F.forEach(W=>{let X=j.fromSegments(W.documentKey);s.has(X)||(s=s.add(X),a.push(X))})}))}).next(()=>a)}return S.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=_F(we.create(e.filters,"and")).map(r=>Vm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,o,s,a){let u=(t!=null?t.length:1)*Math.max(r.length,o.length),l=u/(t!=null?t.length:1),h=[];for(let p=0;p<u;++p){let m=t?this.dn(t[p/l]):Fl,y=this.An(e,m,r[p%l],i),C=this.Rn(e,m,o[p%l],s),A=a.map(M=>this.An(e,m,M,!0));h.push(...this.createRange(y,C,A))}return h}An(e,t,r,i){let o=new di(e,j.empty(),t,r);return i?o:o.Zt()}Rn(e,t,r,i){let o=new di(e,j.empty(),t,r);return i?o.Zt():o}Pn(e,t){let r=new cd(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let a of o)r.rn(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2,i=this.hn(t);return S.forEach(i,o=>this.Pn(e,o).next(s=>{s?r!==0&&s.fields.length<function(u){let l=new Te(Be.comparator),h=!1;for(let p of u.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:l=l.add(m.field));for(let p of u.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(h?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){let r=new li;for(let i of ai(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=r.Yt(i.kind);Un.vt.It(o,s)}return r.zt()}dn(e){let t=new li;return Un.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let r=new li;return Un.vt.It(gi(this.databaseId,t),r.Yt(function(o){let s=ai(o);return s.length===0?0:s[s.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new li);let o=0;for(let s of ai(e)){let a=r[o++];for(let u of i)if(this.fn(t,s.fieldPath)&&eu(a))i=this.gn(i,s,a);else{let l=u.Yt(s.kind);Un.vt.It(a,l)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){let i=[...e],o=[];for(let s of r.arrayValue.values||[])for(let a of i){let u=new li;u.seed(a.zt()),Un.vt.It(s,u.Yt(t.kind)),o.push(u)}return o}fn(e,t){return!!e.filters.find(r=>r instanceof le&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=ja(e),i=Mo(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(o=>{let s=[];return S.forEach(o,a=>i.get([a.indexId,this.uid]).next(u=>{s.push(function(h,p){let m=p?new Qa(p.sequenceNumber,new $t(wi(p.readTime),new j(hn(p.documentKey)),p.largestBatchId)):Qa.empty(),y=h.fields.map(([C,A])=>new jo(Be.fromServerFormat(C),A));return new Ho(h.indexId,h.collectionGroup,y,m)}(a,u))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:ne(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=ja(e),o=Mo(e);return this.yn(e).next(s=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>S.forEach(a,u=>o.put(kC(u.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){let r=new Map;return S.forEach(t,(i,o)=>{let s=r.get(i.collectionGroup);return(s?S.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),S.forEach(a,u=>this.wn(e,i,u).next(l=>{let h=this.Sn(o,u);return l.isEqual(h)?S.resolve():this.bn(e,o,u,l,h)}))))})}Dn(e,t,r,i){return Ro(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return Ro(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){let i=Ro(e),o=new Te(fr);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(s,a)=>{o=o.add(new di(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>o)}Sn(e,t){let r=new Te(fr),i=this.Vn(t,e);if(i==null)return r;let o=Im(t);if(o!=null){let s=e.data.field(o.fieldPath);if(eu(s))for(let a of s.arrayValue.values||[])r=r.add(new di(t.indexId,e.key,this.dn(a),i))}else r=r.add(new di(t.indexId,e.key,Fl,i));return r}bn(e,t,r,i,o){k("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let s=[];return function(u,l,h,p,m){let y=u.getIterator(),C=l.getIterator(),A=xo(y),M=xo(C);for(;A||M;){let O=!1,B=!1;if(A&&M){let F=h(A,M);F<0?B=!0:F>0&&(O=!0)}else A!=null?B=!0:O=!0;O?(p(M),M=xo(C)):B?(m(A),A=xo(y)):(A=xo(y),M=xo(C))}}(i,o,fr,a=>{s.push(this.Dn(e,t,r,a))},a=>{s.push(this.vn(e,t,r,a))}),S.waitFor(s)}yn(e){let t=1;return Mo(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>fr(s,a)).filter((s,a,u)=>!a||fr(s,u[a-1])!==0);let i=[];i.push(e);for(let s of r){let a=fr(s,e),u=fr(s,t);if(a===0)i[0]=e.Zt();else if(a>0&&u<0)i.push(s),i.push(s.Zt());else if(u>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.Cn(i[s],i[s+1]))return[];let a=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,Fl,[]],u=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,Fl,[]];o.push(IDBKeyRange.bound(a,u))}return o}Cn(e,t){return fr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(UC)}getMinOffset(e,t){return S.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||H())).next(UC)}};function BC(n){return Ye(n,"collectionParents")}function Ro(n){return Ye(n,"indexEntries")}function ja(n){return Ye(n,"indexConfiguration")}function Mo(n){return Ye(n,"indexState")}function UC(n){q(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;pv(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new $t(e.readTime,e.documentKey,t)}var $C={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ut=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function l0(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),o=[],s=IDBKeyRange.only(t.batchId),a=0,u=r.J({range:s},(h,p,m)=>(a++,m.delete()));o.push(u.next(()=>{q(a===1)}));let l=[];for(let h of t.mutations){let p=yb(e,h.key.path,t.batchId);o.push(i.delete(p)),l.push(h.key)}return S.waitFor(o).next(()=>l)}function dd(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw H();e=n.noDocument}return JSON.stringify(e).length}Ut.DEFAULT_COLLECTION_PERCENTILE=10,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ut.DEFAULT=new Ut(41943040,Ut.DEFAULT_COLLECTION_PERCENTILE,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ut.DISABLED=new Ut(-1,0,0);var hd=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){q(e.uid!=="");let o=e.isAuthenticated()?e.uid:"";return new n(o,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return pr(e).J({index:"userMutationsIndex",range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let o=Lo(e),s=pr(e);return s.add({}).next(a=>{q(typeof a=="number");let u=new nu(a,t,r,i),l=function(y,C,A){let M=A.baseMutations.map(B=>au(y.ct,B)),O=A.mutations.map(B=>au(y.ct,B));return{userId:C,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:M,mutations:O}}(this.serializer,this.userId,u),h=[],p=new Te((m,y)=>ne(m.canonicalString(),y.canonicalString()));for(let m of i){let y=yb(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),h.push(s.put(l)),h.push(o.put(y,CO))}return p.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=u.keys()}),S.waitFor(h).next(()=>u)})}lookupMutationBatch(e,t){return pr(e).get(t).next(r=>r?(q(r.userId===this.userId),ci(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?S.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return pr(e).J({index:"userMutationsIndex",range:i},(s,a,u)=>{a.userId===this.userId&&(q(a.batchId>=r),o=ci(this.serializer,a)),u.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return pr(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return pr(e).U("userMutationsIndex",t).next(r=>r.map(i=>ci(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Bl(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Lo(e).J({range:i},(s,a,u)=>{let[l,h,p]=s,m=hn(h);if(l===this.userId&&t.path.isEqual(m))return pr(e).get(p).next(y=>{if(!y)throw H();q(y.userId===this.userId),o.push(ci(this.serializer,y))});u.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Te(ne),i=[];return t.forEach(o=>{let s=Bl(this.userId,o.path),a=IDBKeyRange.lowerBound(s),u=Lo(e).J({range:a},(l,h,p)=>{let[m,y,C]=l,A=hn(y);m===this.userId&&o.path.isEqual(A)?r=r.add(C):p.done()});i.push(u)}),S.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=Bl(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Te(ne);return Lo(e).J({range:s},(u,l,h)=>{let[p,m,y]=u,C=hn(m);p===this.userId&&r.isPrefixOf(C)?C.length===i&&(a=a.add(y)):h.done()}).next(()=>this.xn(e,a))}xn(e,t){let r=[],i=[];return t.forEach(o=>{i.push(pr(e).get(o).next(s=>{if(s===null)throw H();q(s.userId===this.userId),r.push(ci(this.serializer,s))}))}),S.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return l0(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),S.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return S.resolve();let r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return Lo(e).J({range:r},(o,s,a)=>{if(o[0]===this.userId){let u=hn(o[1]);i.push(u)}else a.done()}).next(()=>{q(i.length===0)})})}containsKey(e,t){return d0(e,this.userId,t)}Nn(e){return h0(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function d0(n,e,t){let r=Bl(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Lo(n).J({range:o,H:!0},(a,u,l)=>{let[h,p,m]=a;h===e&&p===i&&(s=!0),l.done()}).next(()=>s)}function pr(n){return Ye(n,"mutations")}function Lo(n){return Ye(n,"documentMutations")}function h0(n){return Ye(n,"mutationQueues")}var Yo=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var sy=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let r=new Yo(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>G.fromTimestamp(new Ne(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>No(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(q(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0,o=[];return No(e).J((s,a)=>{let u=Ha(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,o.push(this.removeTargetData(e,u)))}).next(()=>S.waitFor(o)).next(()=>i)}forEachTarget(e,t){return No(e).J((r,i)=>{let o=Ha(i);t(o)})}qn(e){return HC(e).get("targetGlobalKey").next(t=>(q(t!==null),t))}Qn(e,t){return HC(e).put("targetGlobalKey",t)}Kn(e,t){return No(e).put(a0(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=yi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return No(e).J({range:i,index:"queryTargetsIndex"},(s,a,u)=>{let l=Ha(a);yu(t,l.target)&&(o=l,u.done())}).next(()=>o)}addMatchingKeys(e,t,r){let i=[],o=gr(e);return t.forEach(s=>{let a=yt(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),S.waitFor(i)}removeMatchingKeys(e,t,r){let i=gr(e);return S.forEach(t,o=>{let s=yt(o.path);return S.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){let r=gr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=gr(e),o=ie();return i.J({range:r,H:!0},(s,a,u)=>{let l=hn(s[1]),h=new j(l);o=o.add(h)}).next(()=>o)}containsKey(e,t){let r=yt(t.path),i=IDBKeyRange.bound([r],[db(r)],!1,!0),o=0;return gr(e).J({index:"documentTargetsIndex",H:!0,range:i},([s,a],u,l)=>{s!==0&&(o++,l.done())}).next(()=>o>0)}ot(e,t){return No(e).get(t).next(r=>r?Ha(r):null)}};function No(n){return Ye(n,"targets")}function HC(n){return Ye(n,"targetGlobal")}function gr(n){return Ye(n,"targetDocuments")}function qC([n,e],[t,r]){let i=ne(n,t);return i===0?ne(e,r):i}var ay=class{constructor(e){this.Un=e,this.buffer=new Te(qC),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();qC(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},uy=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){k("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>N(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Rr(t)?k("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield xr(t)}yield this.Hn(3e5)}))}},cy=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return S.resolve(xt.oe);let r=new ay(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),S.resolve($C)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$C):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,o,s,a,u,l,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(o=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),Po()<=sn.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(u-a)+`ms
	Removed ${p} documents in `+(l-u)+`ms
Total Duration: ${l-h}ms`),S.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}};function wF(n,e){return new cy(n,e)}var ly=class{constructor(e,t){this.db=e,this.garbageCollector=wF(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return Ll(e,r)}removeReference(e,t,r){return Ll(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Ll(e,t)}nr(e,t){return function(i,o){let s=!1;return h0(i).Y(a=>d0(i,a,o).next(u=>(u&&(s=!0),S.resolve(!u)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.tr(e,(s,a)=>{if(a<=t){let u=this.nr(e,s).next(l=>{if(!l)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,G.min()),gr(e).delete(function(p){return[0,yt(p.path)]}(s))))});i.push(u)}}).next(()=>S.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Ll(e,t)}tr(e,t){let r=gr(e),i,o=xt.oe;return r.J({index:"documentTargetsIndex"},([s,a],{path:u,sequenceNumber:l})=>{s===0?(o!==xt.oe&&t(new j(hn(i)),o),o=l,i=u):o=xt.oe}).next(()=>{o!==xt.oe&&t(new j(hn(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Ll(n,e){return gr(n).put(function(r,i){return{targetId:0,path:yt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var fd=class{constructor(){this.changes=new _n(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ge.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?S.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var dy=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return si(e).put(r)}removeEntry(e,t,r){return si(e).delete(function(o,s){let a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],ad(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Ge.newInvalidDocument(t);return si(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ba(t))},(i,o)=>{r=this.ir(t,o)}).next(()=>r)}sr(e,t){let r={size:0,document:Ge.newInvalidDocument(t)};return si(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ba(t))},(i,o)=>{r={document:this.ir(t,o),size:dd(o)}}).next(()=>r)}getEntries(e,t){let r=Tt();return this._r(e,t,(i,o)=>{let s=this.ir(i,o);r=r.insert(i,s)}).next(()=>r)}ar(e,t){let r=Tt(),i=new Ae(j.comparator);return this._r(e,t,(o,s)=>{let a=this.ir(o,s);r=r.insert(o,a),i=i.insert(o,dd(s))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return S.resolve();let i=new Te(WC);t.forEach(u=>i=i.add(u));let o=IDBKeyRange.bound(Ba(i.first()),Ba(i.last())),s=i.getIterator(),a=s.getNext();return si(e).J({index:"documentKeyIndex",range:o},(u,l,h)=>{let p=j.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&WC(a,p)<0;)r(a,null),a=s.getNext();a&&a.isEqual(p)&&(r(a,l),a=s.hasNext()?s.getNext():null),a?h.$(Ba(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),ad(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return si(e).U(IDBKeyRange.bound(a,u,!0)).next(l=>{o?.incrementDocumentReadCount(l.length);let h=Tt();for(let p of l){let m=this.ir(j.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(_u(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,t,r,i){let o=Tt(),s=GC(t,r),a=GC(t,$t.max());return si(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(u,l,h)=>{let p=this.ir(j.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);o=o.insert(p.key,p),o.size===i&&h.done()}).next(()=>o)}newChangeBuffer(e){return new hy(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return zC(e).get("remoteDocumentGlobalKey").next(t=>(q(!!t),t))}rr(e,t){return zC(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let r=yF(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(G.min())))return r}return Ge.newInvalidDocument(e)}};function f0(n){return new dy(n)}var hy=class extends fd{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new _n(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Te((o,s)=>ne(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let a=this.lr.get(o);if(t.push(this.cr.removeEntry(e,o,a.readTime)),s.isValidDocument()){let u=NC(this.cr.serializer,s);i=i.add(o.path.popLast());let l=dd(u);r+=l-a.size,t.push(this.cr.addEntry(e,o,u))}else if(r-=a.size,this.trackRemovals){let u=NC(this.cr.serializer,s.convertToNoDocument(G.min()));t.push(this.cr.addEntry(e,o,u))}}),i.forEach(o=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.cr.updateMetadata(e,r)),S.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((o,s)=>{this.lr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}};function zC(n){return Ye(n,"remoteDocumentGlobal")}function si(n){return Ye(n,"remoteDocumentsV14")}function Ba(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function GC(n,e){let t=e.documentKey.path.toArray();return[n,ad(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function WC(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=ne(t[o],r[o]),i)return i;return i=ne(t.length,r.length),i||(i=ne(t[t.length-2],r[r.length-2]),i||ne(t[t.length-1],r[r.length-1]))}var fy=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var pd=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ga(r.mutation,i,Rt.empty(),Ne.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ie()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ie()){let i=fn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=$a();return o.forEach((a,u)=>{s=s.insert(a,u.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=fn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ie()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=Tt(),s=za(),a=function(){return za()}();return t.forEach((u,l)=>{let h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof nn)?o=o.insert(l.key,l):h!==void 0?(s.set(l.key,h.mutation.getFieldMask()),Ga(h.mutation,l,h.mutation.getFieldMask(),Ne.now())):s.set(l.key,Rt.empty())}),this.recalculateAndSaveOverlays(e,o).next(u=>(u.forEach((l,h)=>s.set(l,h)),t.forEach((l,h)=>{var p;return a.set(l,new fy(h,(p=s.get(l))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=za(),i=new Ae((s,a)=>s-a),o=ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(u=>{let l=t.get(u);if(l===null)return;let h=r.get(u)||Rt.empty();h=a.applyToLocalView(l,h),r.set(u,h);let p=(i.get(a.batchId)||ie()).add(u);i=i.insert(a.batchId,p)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),l=u.key,h=u.value,p=Lb();h.forEach(m=>{if(!o.has(m)){let y=qb(t.get(m),r.get(m));y!==null&&p.set(m,y),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,p))}return S.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return j.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):_v(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):S.resolve(fn()),a=-1,u=o;return s.next(l=>S.forEach(l,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),o.get(h)?S.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{u=u.insert(h,m)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,u,l,ie())).next(h=>({batchId:a,changes:Fb(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new j(t)).next(r=>{let i=$a();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=$a();return this.indexManager.getCollectionParents(e,o).next(a=>S.forEach(a,u=>{let l=function(p,m){return new tn(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(h=>{h.forEach((p,m)=>{s=s.insert(p,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((u,l)=>{let h=l.getKey();s.get(h)===null&&(s=s.insert(h,Ge.newInvalidDocument(h)))});let a=$a();return s.forEach((u,l)=>{let h=o.get(u);h!==void 0&&Ga(h.mutation,l,Rt.empty(),Ne.now()),_u(t,l)&&(a=a.insert(u,l))}),a})}};var py=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return S.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ue(i.createTime)}}(t)),S.resolve()}getNamedQuery(e,t){return S.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:Dv(i.bundledQuery),readTime:Ue(i.readTime)}}(t)),S.resolve()}};var gy=class{constructor(){this.overlays=new Ae(j.comparator),this.Ir=new Map}getOverlay(e,t){return S.resolve(this.overlays.get(t))}getOverlays(e,t){let r=fn();return S.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),S.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),S.resolve()}getOverlaysForCollection(e,t,r){let i=fn(),o=t.length+1,s=new j(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&u.largestBatchId>r&&i.set(u.getKey(),u)}return S.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Ae((l,h)=>l-h),s=this.overlays.getIterator();for(;s.hasNext();){let l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=o.get(l.largestBatchId);h===null&&(h=fn(),o=o.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let a=fn(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,h)=>a.set(l,h)),!(a.size()>=i)););return S.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new ru(t,r));let o=this.Ir.get(t);o===void 0&&(o=ie(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var my=class{constructor(){this.sessionToken=$e.EMPTY_BYTE_STRING}getSessionToken(e){return S.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,S.resolve()}};var cu=class{constructor(){this.Tr=new Te(qe.Er),this.dr=new Te(qe.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new qe(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new qe(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new j(new fe([])),r=new qe(t,e),i=new qe(t,e+1),o=[];return this.dr.forEachInRange([r,i],s=>{this.Vr(s),o.push(s.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new j(new fe([])),r=new qe(t,e),i=new qe(t,e+1),o=ie();return this.dr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new qe(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},qe=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return j.comparator(e.key,t.key)||ne(e.wr,t.wr)}static Ar(e,t){return ne(e.wr,t.wr)||j.comparator(e.key,t.key)}};var yy=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Te(qe.Er)}checkEmpty(e){return S.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new nu(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.br=this.br.add(new qe(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return S.resolve(s)}lookupMutationBatch(e,t){return S.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return S.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return S.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return S.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new qe(t,0),i=new qe(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],s=>{let a=this.Dr(s.wr);o.push(a)}),S.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Te(ne);return t.forEach(i=>{let o=new qe(i,0),s=new qe(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,s],a=>{r=r.add(a.wr)})}),S.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;j.isDocumentKey(o)||(o=o.child(""));let s=new qe(new j(o),0),a=new Te(ne);return this.br.forEachWhile(u=>{let l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.wr)),!0)},s),S.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){q(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return S.forEach(t.mutations,i=>{let o=new qe(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new qe(t,0),i=this.br.firstAfterOrEqual(r);return S.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,S.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var vy=class{constructor(e){this.Mr=e,this.docs=function(){return new Ae(j.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return S.resolve(r?r.document.mutableCopy():Ge.newInvalidDocument(t))}getEntries(e,t){let r=Tt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Ge.newInvalidDocument(i))}),S.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Tt(),s=t.path,a=new j(s.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:l,value:{document:h}}=u.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||pv(fb(h),r)<=0||(i.has(h.key)||_u(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return S.resolve(o)}getAllFromCollectionGroup(e,t,r,i){H()}Or(e,t){return S.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new _y(this)}getSize(e){return S.resolve(this.size)}},_y=class extends fd{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),S.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var wy=class{constructor(e){this.persistence=e,this.Nr=new _n(t=>yi(t),yu),this.lastRemoteSnapshotVersion=G.min(),this.highestTargetId=0,this.Lr=0,this.Br=new cu,this.targetCount=0,this.kr=Yo.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),S.resolve()}getLastRemoteSnapshotVersion(e){return S.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return S.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),S.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),S.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Yo(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,S.resolve()}updateTargetData(e,t){return this.Kn(t),S.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,S.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),S.waitFor(o).next(()=>i)}getTargetCount(e){return S.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return S.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),S.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),S.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),S.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return S.resolve(r)}containsKey(e,t){return S.resolve(this.Br.containsKey(t))}};var gd=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new xt(0),this.Kr=!1,this.Kr=!0,this.$r=new my,this.referenceDelegate=e(this),this.Ur=new wy(this),this.indexManager=new iy,this.remoteDocumentCache=function(i){return new vy(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new sd(t),this.Gr=new py(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new gy,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new yy(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){k("MemoryPersistence","Starting transaction:",e);let i=new Iy(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return S.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Iy=class extends Kl{constructor(e){super(),this.currentSequenceNumber=e}},md=class n{constructor(e){this.persistence=e,this.Jr=new cu,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw H()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),S.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),S.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),S.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return S.forEach(this.Xr,r=>{let i=j.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,G.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return S.or([()=>S.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Ey=class{constructor(e){this.serializer=e}O(e,t,r,i){let o=new Ql("createOrUpgrade",t);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",cC,{unique:!0}),u.createObjectStore("documentMutations")}(e),KC(e),function(u){u.createObjectStore("remoteDocuments")}(e));let s=S.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),KC(e)),s=s.next(()=>function(u){let l=u.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:G.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",h)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(u,l){return l.store("mutations").U().next(h=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",cC,{unique:!0});let p=l.store("mutations"),m=h.map(y=>p.put(y));return S.waitFor(m)})}(e,o))),s=s.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.ni(o))),r<6&&i>=6&&(s=s.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(s=s.next(()=>this.ii(o))),r<8&&i>=8&&(s=s.next(()=>this.si(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.oi(o))),r<11&&i>=11&&(s=s.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(u){let l=u.createObjectStore("documentOverlays",{keyPath:LO});l.createIndex("collectionPathOverlayIndex",VO,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",jO,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(u){let l=u.createObjectStore("remoteDocumentsV14",{keyPath:bO});l.createIndex("documentKeyIndex",SO),l.createIndex("collectionGroupIndex",AO)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(s=s.next(()=>this.ai(e,o))),r<15&&i>=15&&(s=s.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:PO}).createIndex("sequenceNumberIndex",kO,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:OO}).createIndex("documentKeyIndex",FO,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),s}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=dd(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>S.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",s).next(a=>S.forEach(a,u=>{q(u.userId===o.userId);let l=ci(this.serializer,u);return l0(e,o.userId,l).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let o=[];return r.J((s,a)=>{let u=new fe(s),l=function(p){return[0,yt(p)]}(u);o.push(t.get(l).next(h=>h?S.resolve():(p=>t.put({targetId:0,path:yt(p),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>S.waitFor(o))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:NO});let r=t.store("collectionParents"),i=new uu,o=s=>{if(i.add(s)){let a=s.lastSegment(),u=s.popLast();return r.put({collectionId:a,parent:yt(u)})}};return t.store("remoteDocuments").J({H:!0},(s,a)=>{let u=new fe(s);return o(u.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([s,a,u],l)=>{let h=hn(a);return o(h.popLast())}))}oi(e){let t=e.store("targets");return t.J((r,i)=>{let o=Ha(i),s=a0(this.serializer,o);return t.put(s)})}_i(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((o,s)=>{let a=t.store("remoteDocumentsV14"),u=function(p){return p.document?new j(fe.fromString(p.document.name).popFirst(5)):p.noDocument?j.fromSegments(p.noDocument.path):p.unknownDocument?j.fromSegments(p.unknownDocument.path):H()}(s).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(l))}).next(()=>S.waitFor(i))}ai(e,t){let r=t.store("mutations"),i=f0(this.serializer),o=new gd(md.Zr,this.serializer.ct);return r.U().next(s=>{let a=new Map;return s.forEach(u=>{var l;let h=(l=a.get(u.userId))!==null&&l!==void 0?l:ie();ci(this.serializer,u).keys().forEach(p=>h=h.add(p)),a.set(u.userId,h)}),S.forEach(a,(u,l)=>{let h=new ze(l),p=ud.lt(this.serializer,h),m=o.getIndexManager(h),y=hd.lt(h,this.serializer,m,o.referenceDelegate);return new pd(i,y,p,m).recalculateAndSaveOverlaysForDocumentKeys(new Za(t,xt.oe),u).next()})})}};function KC(n){n.createObjectStore("targetDocuments",{keyPath:RO}).createIndex("documentTargetsIndex",MO,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",xO,{unique:!0}),n.createObjectStore("targetGlobal")}var lm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Dy=class n{constructor(e,t,r,i,o,s,a,u,l,h,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=o,this.window=s,this.document=a,this.ci=l,this.li=h,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!n.D())throw new P(R.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ly(this,i),this.Ai=t+"main",this.serializer=new sd(u),this.Ri=new wr(this.Ai,this.hi,new Ey(this.serializer)),this.$r=new Zm,this.Ur=new sy(this.referenceDelegate,this.serializer),this.remoteDocumentCache=f0(this.serializer),this.Gr=new Ym,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&je("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new P(R.FAILED_PRECONDITION,lm);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new xt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>N(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>N(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>N(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Vl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Rr(e))return k("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return k("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Ua(e).get("owner").next(t=>S.resolve(this.vi(t)))}Ci(e){return Vl(e).delete(this.clientId)}Fi(){return N(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Ye(t,"clientMetadata");return r.U().next(i=>{let o=this.xi(i,18e5),s=i.filter(a=>o.indexOf(a)===-1);return S.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?S.resolve(!0):Ua(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new P(R.FAILED_PRECONDITION,lm);return!1}}return!(!this.networkEnabled||!this.inForeground)||Vl(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&k("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return N(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Za(e,xt.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Vl(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return hd.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new oy(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return ud.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){k("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=function(u){return u===17?$O:u===16?UO:u===15?mv:u===14?wb:u===13?_b:u===12?BO:u===11?vb:void H()}(this.hi),s;return this.Ri.runTransaction(e,i,o,a=>(s=new Za(a,this.Qr?this.Qr.next():xt.oe),t==="readwrite-primary"?this.wi(s).next(u=>!!u||this.Si(s)).next(u=>{if(!u)throw je(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new P(R.FAILED_PRECONDITION,pb);return r(s)}).next(u=>this.Di(s).next(()=>u)):this.Ki(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}Ki(e){return Ua(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new P(R.FAILED_PRECONDITION,lm)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ua(e).put("owner",t)}static D(){return wr.D()}bi(e){let t=Ua(e);return t.get("owner").next(r=>this.vi(r)?(k("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):S.resolve())}Mi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(je(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;Nh()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return k("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return je("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){je("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Ua(n){return Ye(n,"owner")}function Vl(n){return Ye(n,"clientMetadata")}function Cv(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var Ty=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=ie(),i=ie();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var Cy=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var yd=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Nh()?8:gb(ks())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new Cy;return this.Xi(e,t,s).next(a=>{if(o.result=a,this.zi)return this.es(e,t,s,a.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Po()<=sn.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",ko(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),S.resolve()):(Po()<=sn.DEBUG&&k("QueryEngine","Query:",ko(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Po()<=sn.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",ko(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,vt(t))):S.resolve())}Yi(e,t){if(IC(t))return S.resolve(null);let r=vt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=nd(t,null,"F"),r=vt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=ie(...o);return this.Ji.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let l=this.ts(t,a);return this.ns(t,l,s,u.readTime)?this.Yi(e,nd(t,null,"F")):this.rs(e,l,t,u)}))})))}Zi(e,t,r,i){return IC(t)||i.isEqual(G.min())?S.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let s=this.ts(t,o);return this.ns(t,s,r,i)?S.resolve(null):(Po()<=sn.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ko(t)),this.rs(e,s,t,hb(i,-1)).next(a=>a))})}ts(e,t){let r=new Te(kb(e));return t.forEach((i,o)=>{_u(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return Po()<=sn.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",ko(t)),this.Ji.getDocumentsMatchingQuery(e,t,$t.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var by=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Ae(ne),this._s=new _n(o=>yi(o),yu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pd(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function p0(n,e,t,r){return new by(n,e,t,r)}function g0(n,e){return N(this,null,function*(){let t=V(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],u=ie();for(let l of i){s.push(l.batchId);for(let h of l.mutations)u=u.add(h.key)}for(let l of o){a.push(l.batchId);for(let h of l.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next(l=>({hs:l,removedBatchIds:s,addedBatchIds:a}))})})})}function IF(n,e){let t=V(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,u,l,h){let p=l.batch,m=p.keys(),y=S.resolve();return m.forEach(C=>{y=y.next(()=>h.getEntry(u,C)).next(A=>{let M=l.docVersions.get(C);q(M!==null),A.version.compareTo(M)<0&&(p.applyToRemoteDocument(A,l),A.isValidDocument()&&(A.setReadTime(l.commitVersion),h.addEntry(A)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(u,p))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=ie();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function m0(n){let e=V(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function EF(n,e){let t=V(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((h,p)=>{let m=i.get(p);if(!m)return;a.push(t.Ur.removeMatchingKeys(o,h.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(o,h.addedDocuments,p)));let y=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?y=y.withResumeToken($e.EMPTY_BYTE_STRING,G.min()).withLastLimboFreeSnapshotVersion(G.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(p,y),function(A,M,O){return A.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0}(m,y,h)&&a.push(t.Ur.updateTargetData(o,y))});let u=Tt(),l=ie();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))}),a.push(y0(o,s,e.documentUpdates).next(h=>{u=h.Ps,l=h.Is})),!r.isEqual(G.min())){let h=t.Ur.getLastRemoteSnapshotVersion(o).next(p=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(h)}return S.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,u,l)).next(()=>u)}).then(o=>(t.os=i,o))}function y0(n,e,t){let r=ie(),i=ie();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=Tt();return t.forEach((a,u)=>{let l=o.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(G.min())?(e.removeEntry(a,u.readTime),s=s.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),s=s.insert(a,u)):k("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{Ps:s,Is:i}})}function DF(n,e){let t=V(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Zo(n,e){let t=V(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,S.resolve(i)):t.Ur.allocateTargetId(r).next(s=>(i=new Qo(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Jo(n,e,t){return N(this,null,function*(){let r=V(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!Rr(s))throw s;k("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function vd(n,e,t){let r=V(n),i=G.min(),o=ie();return r.persistence.runTransaction("Execute query","readwrite",s=>function(u,l,h){let p=V(u),m=p._s.get(h);return m!==void 0?S.resolve(p.os.get(m)):p.Ur.getTargetData(l,h)}(r,s,vt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(s,a.targetId).next(u=>{o=u})}).next(()=>r.ss.getDocumentsMatchingQuery(s,e,t?i:G.min(),t?o:ie())).next(a=>(w0(r,Pb(e),a),{documents:a,Ts:o})))}function v0(n,e){let t=V(n),r=V(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.ot(o,e).next(s=>s?s.target:null))}function _0(n,e){let t=V(n),r=t.us.get(e)||G.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,hb(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(w0(t,e,i),i))}function w0(n,e,t){let r=n.us.get(e)||G.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}function TF(n,e,t,r){return N(this,null,function*(){let i=V(n),o=ie(),s=Tt();for(let l of t){let h=e.Es(l.metadata.name);l.document&&(o=o.add(h));let p=e.ds(l);p.setReadTime(e.As(l.metadata.readTime)),s=s.insert(h,p)}let a=i.cs.newChangeBuffer({trackRemovals:!0}),u=yield Zo(i,function(h){return vt(ss(fe.fromString(`__bundle__/docs/${h}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>y0(l,a,s).next(h=>(a.apply(l),h)).next(h=>i.Ur.removeMatchingKeysForTargetId(l,u.targetId).next(()=>i.Ur.addMatchingKeys(l,o,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,h.Ps,h.Is)).next(()=>h.Ps)))})}function CF(r,i){return N(this,arguments,function*(n,e,t=ie()){let o=yield Zo(n,vt(Dv(e.bundledQuery))),s=V(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{let u=Ue(e.readTime);if(o.snapshotVersion.compareTo(u)>=0)return s.Gr.saveNamedQuery(a,e);let l=o.withResumeToken($e.EMPTY_BYTE_STRING,u);return s.os=s.os.insert(l.targetId,l),s.Ur.updateTargetData(a,l).next(()=>s.Ur.removeMatchingKeysForTargetId(a,o.targetId)).next(()=>s.Ur.addMatchingKeys(a,t,o.targetId)).next(()=>s.Gr.saveNamedQuery(a,e))})})}function QC(n,e){return`firestore_clients_${n}_${e}`}function YC(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function dm(n,e){return`firestore_targets_${n}_${e}`}var _d=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){let i=JSON.parse(r),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new P(i.error.code,i.error.message))),s?new n(e,t,i.state,o):(je("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Wa=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){let r=JSON.parse(t),i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new P(r.error.code,r.error.message))),o?new n(e,r.state,i):(je("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},wd=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=wv();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=mb(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new n(e,o):(je("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},Sy=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(je("SharedClientState",`Failed to parse online state: ${e}`),null)}},lu=class{constructor(){this.activeTargetIds=wv()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Ka=class{constructor(e,t,r,i,o){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Ae(ne),this.started=!1,this.bs=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=QC(this.persistenceKey,this.ps),this.vs=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new lu),this.Cs=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.xs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Os=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return N(this,null,function*(){let e=yield this.syncEngine.Qi();for(let r of e){if(r===this.ps)continue;let i=this.getItem(QC(this.persistenceKey,r));if(i){let o=wd.Rs(r,i);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let r=this.Ls(t);r&&this.Bs(r)}for(let r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(dm(this.persistenceKey,e));if(i){let o=Wa.Rs(e,i);o&&(r=o.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(dm(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return k("SharedClientState","READ",e,t),t}setItem(e,t){k("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){k("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(k("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void je("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>N(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Gs(t.key);return this.zs(r,null)}{let r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){let r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){let r=function(o){let s=xt.oe;if(o!=null)try{let a=JSON.parse(o);q(typeof a=="number"),s=a}catch(a){je("SharedClientState","Failed to read sequence number from WebStorage",a)}return s}(t.newValue);r!==xt.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){let r=this.Xs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){let i=new _d(this.currentUser,e,t,r),o=YC(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Vs())}Qs(e){let t=YC(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){let i=dm(this.persistenceKey,e),o=new Wa(e,t,r);this.setItem(i,o.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let r=this.Gs(e);return wd.Rs(r,t)}Hs(e,t){let r=this.Fs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return _d.Rs(new ze(o),i,t)}Ys(e,t){let r=this.Ms.exec(e),i=Number(r[1]);return Wa.Rs(i,t)}Ls(e){return Sy.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return N(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);k("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),o=this.ks(r),s=[],a=[];return o.forEach(u=>{i.has(u)||s.push(u)}),i.forEach(u=>{o.has(u)||a.push(u)}),this.syncEngine.io(s,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=wv();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Id=class{constructor(){this.so=new lu,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new lu,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Ay=class{_o(e){}shutdown(){}};var Ed=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){k("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){k("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var jl=null;function hm(){return jl===null?jl=function(){return 268435456+Math.round(2147483648*Math.random())}():jl++,"0x"+jl.toString(16)}var bF={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var xy=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var ut="WebChannelConnection",Ry=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,s){let a=hm(),u=this.xo(t,r.toUriEncodedString());k("RestConnection",`Sending RPC '${t}' ${a}:`,u,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,o,s),this.No(t,u,l,i).then(h=>(k("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw en("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",u,"request:",i),h})}Lo(t,r,i,o,s,a){return this.Mo(t,r,i,o,s)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+os}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}xo(t,r){let i=bF[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=hm();return new Promise((s,a)=>{let u=new im;u.setWithCredentials(!0),u.listenOnce(om.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case La.NO_ERROR:let h=u.getResponseJson();k(ut,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),s(h);break;case La.TIMEOUT:k(ut,`RPC '${e}' ${o} timed out`),a(new P(R.DEADLINE_EXCEEDED,"Request time out"));break;case La.HTTP_ERROR:let p=u.getStatus();if(k(ut,`RPC '${e}' ${o} failed with status:`,p,"response text:",u.getResponseText()),p>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);let y=m?.error;if(y&&y.status&&y.message){let C=function(M){let O=M.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(O)>=0?O:R.UNKNOWN}(y.status);a(new P(C,y.message))}else a(new P(R.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new P(R.UNAVAILABLE,"Connection failed."));break;default:H()}}finally{k(ut,`RPC '${e}' ${o} completed.`)}});let l=JSON.stringify(i);k(ut,`RPC '${e}' ${o} sending request:`,i),u.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=hm(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=um(),a=am(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let h=o.join("");k(ut,`Creating RPC '${e}' stream ${i}: ${h}`,u);let p=s.createWebChannel(h,u),m=!1,y=!1,C=new xy({Io:M=>{y?k(ut,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(m||(k(ut,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),k(ut,`RPC '${e}' stream ${i} sending:`,M),p.send(M))},To:()=>p.close()}),A=(M,O,B)=>{M.listen(O,F=>{try{B(F)}catch(W){setTimeout(()=>{throw W},0)}})};return A(p,Ao.EventType.OPEN,()=>{y||(k(ut,`RPC '${e}' stream ${i} transport opened.`),C.yo())}),A(p,Ao.EventType.CLOSE,()=>{y||(y=!0,k(ut,`RPC '${e}' stream ${i} transport closed`),C.So())}),A(p,Ao.EventType.ERROR,M=>{y||(y=!0,en(ut,`RPC '${e}' stream ${i} transport errored:`,M),C.So(new P(R.UNAVAILABLE,"The operation could not be completed")))}),A(p,Ao.EventType.MESSAGE,M=>{var O;if(!y){let B=M.data[0];q(!!B);let F=B,W=F.error||((O=F[0])===null||O===void 0?void 0:O.error);if(W){k(ut,`RPC '${e}' stream ${i} received error:`,W);let X=W.status,K=function(w){let E=He[w];if(E!==void 0)return Wb(E)}(X),I=W.message;K===void 0&&(K=R.INTERNAL,I="Unknown error status: "+X+" with message "+W.message),y=!0,C.So(new P(K,I)),p.close()}else k(ut,`RPC '${e}' stream ${i} received:`,B),C.bo(B)}}),A(a,sm.STAT_EVENT,M=>{M.stat===Ol.PROXY?k(ut,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===Ol.NOPROXY&&k(ut,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{C.wo()},0),C}};function I0(){return typeof window<"u"?window:null}function ql(){return typeof document<"u"?document:null}function wu(n){return new zm(n,!0)}var du=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&k("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Dd=class{constructor(e,t,r,i,o,s,a,u){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new du(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return N(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return N(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return N(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(je(t.toString()),je("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new P(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>N(this,null,function*(){this.state=0,this.start()}))}I_(e){return k("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(k("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},My=class extends Dd{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=lF(this.serializer,e),r=function(o){if(!("targetChange"in o))return G.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?G.min():s.readTime?Ue(s.readTime):G.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=Km(this.serializer),t.addTarget=function(o,s){let a,u=s.target;if(a=ed(u)?{documents:t0(o,u)}:{query:n0(o,u)._t},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=Qb(o,s.resumeToken);let l=Gm(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(G.min())>0){a.readTime=Ko(o,s.snapshotVersion.toTimestamp());let l=Gm(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=hF(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=Km(this.serializer),t.removeTarget=e,this.a_(t)}},Ny=class extends Dd{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return q(!!e.streamToken),this.lastStreamToken=e.streamToken,q(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){q(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=dF(e.writeResults,e.commitTime),r=Ue(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=Km(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>au(this.serializer,r))};this.a_(t)}};var Py=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new P(R.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Mo(e,Wm(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new P(R.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Lo(e,Wm(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new P(R.UNKNOWN,s.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},ky=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(je(t),this.D_=!1):k("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var Oy=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(s=>{r.enqueueAndForget(()=>N(this,null,function*(){Mr(this)&&(k("RemoteStore","Restarting streams for network reachability change."),yield function(u){return N(this,null,function*(){let l=V(u);l.L_.add(4),yield as(l),l.q_.set("Unknown"),l.L_.delete(4),yield Iu(l)})}(this))}))}),this.q_=new ky(r,i)}};function Iu(n){return N(this,null,function*(){if(Mr(n))for(let e of n.B_)yield e(!0)})}function as(n){return N(this,null,function*(){for(let e of n.B_)yield e(!1)})}function qd(n,e){let t=V(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Av(t)?Sv(t):cs(t).r_()&&bv(t,e))}function Xo(n,e){let t=V(n),r=cs(t);t.N_.delete(e),r.r_()&&E0(t,e),t.N_.size===0&&(r.r_()?r.o_():Mr(t)&&t.q_.set("Unknown"))}function bv(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(G.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}cs(n).A_(e)}function E0(n,e){n.Q_.xe(e),cs(n).R_(e)}function Sv(n){n.Q_=new qm({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),cs(n).start(),n.q_.v_()}function Av(n){return Mr(n)&&!cs(n).n_()&&n.N_.size>0}function Mr(n){return V(n).L_.size===0}function D0(n){n.Q_=void 0}function SF(n){return N(this,null,function*(){n.q_.set("Online")})}function AF(n){return N(this,null,function*(){n.N_.forEach((e,t)=>{bv(n,e)})})}function xF(n,e){return N(this,null,function*(){D0(n),Av(n)?(n.q_.M_(e),Sv(n)):n.q_.set("Unknown")})}function RF(n,e,t){return N(this,null,function*(){if(n.q_.set("Online"),e instanceof id&&e.state===2&&e.cause)try{yield function(i,o){return N(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){k("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Td(n,r)}else if(e instanceof Uo?n.Q_.Ke(e):e instanceof rd?n.Q_.He(e):n.Q_.We(e),!t.isEqual(G.min()))try{let r=yield m0(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.Q_.rt(s);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){let h=o.N_.get(l);h&&o.N_.set(l,h.withResumeToken(u.resumeToken,s))}}),a.targetMismatches.forEach((u,l)=>{let h=o.N_.get(u);if(!h)return;o.N_.set(u,h.withResumeToken($e.EMPTY_BYTE_STRING,h.snapshotVersion)),E0(o,u);let p=new Qo(h.target,u,l,h.sequenceNumber);bv(o,p)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){k("RemoteStore","Failed to raise snapshot:",r),yield Td(n,r)}})}function Td(n,e,t){return N(this,null,function*(){if(!Rr(e))throw e;n.L_.add(1),yield as(n),n.q_.set("Offline"),t||(t=()=>m0(n.localStore)),n.asyncQueue.enqueueRetryable(()=>N(this,null,function*(){k("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Iu(n)}))})}function T0(n,e){return e().catch(t=>Td(n,t,e))}function us(n){return N(this,null,function*(){let e=V(n),t=Ar(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;MF(e);)try{let i=yield DF(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,NF(e,i)}catch(i){yield Td(e,i)}C0(e)&&b0(e)})}function MF(n){return Mr(n)&&n.O_.length<10}function NF(n,e){n.O_.push(e);let t=Ar(n);t.r_()&&t.V_&&t.m_(e.mutations)}function C0(n){return Mr(n)&&!Ar(n).n_()&&n.O_.length>0}function b0(n){Ar(n).start()}function PF(n){return N(this,null,function*(){Ar(n).p_()})}function kF(n){return N(this,null,function*(){let e=Ar(n);for(let t of n.O_)e.m_(t.mutations)})}function OF(n,e,t){return N(this,null,function*(){let r=n.O_.shift(),i=Um.from(r,e,t);yield T0(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield us(n)})}function FF(n,e){return N(this,null,function*(){e&&Ar(n).V_&&(yield function(r,i){return N(this,null,function*(){if(function(s){return Gb(s)&&s!==R.ABORTED}(i.code)){let o=r.O_.shift();Ar(r).s_(),yield T0(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield us(r)}})}(n,e)),C0(n)&&b0(n)})}function ZC(n,e){return N(this,null,function*(){let t=V(n);t.asyncQueue.verifyOperationInProgress(),k("RemoteStore","RemoteStore received new credentials");let r=Mr(t);t.L_.add(3),yield as(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Iu(t)})}function Fy(n,e){return N(this,null,function*(){let t=V(n);e?(t.L_.delete(2),yield Iu(t)):e||(t.L_.add(2),yield as(t),t.q_.set("Unknown"))})}function cs(n){return n.K_||(n.K_=function(t,r,i){let o=V(t);return o.w_(),new My(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:SF.bind(null,n),Ro:AF.bind(null,n),mo:xF.bind(null,n),d_:RF.bind(null,n)}),n.B_.push(e=>N(this,null,function*(){e?(n.K_.s_(),Av(n)?Sv(n):n.q_.set("Unknown")):(yield n.K_.stop(),D0(n))}))),n.K_}function Ar(n){return n.U_||(n.U_=function(t,r,i){let o=V(t);return o.w_(),new Ny(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:PF.bind(null,n),mo:FF.bind(null,n),f_:kF.bind(null,n),g_:OF.bind(null,n)}),n.B_.push(e=>N(this,null,function*(){e?(n.U_.s_(),yield us(n)):(yield n.U_.stop(),n.O_.length>0&&(k("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var Ly=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Qe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ls(n,e){if(je("AsyncQueue",`${e}: ${n}`),Rr(n))return new P(R.UNAVAILABLE,`${e}: ${n}`);throw n}var Cd=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||j.comparator(t.key,r.key):(t,r)=>j.comparator(t.key,r.key),this.keyedMap=$a(),this.sortedSet=new Ae(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var bd=class{constructor(){this.W_=new Ae(j.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):H():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},es=class n{constructor(e,t,r,i,o,s,a,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Cd.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Vy=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},jy=class{constructor(){this.queries=JC(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=V(t),o=i.queries;i.queries=JC(),o.forEach((s,a)=>{for(let u of a.j_)u.onError(r)})})(this,new P(R.ABORTED,"Firestore shutting down"))}};function JC(){return new _n(n=>Nb(n),vu)}function xv(n,e){return N(this,null,function*(){let t=V(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new Vy,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=ls(s,`Initialization of query '${ko(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&Mv(t)})}function Rv(n,e){return N(this,null,function*(){let t=V(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.j_.indexOf(e);s>=0&&(o.j_.splice(s,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function LF(n,e){let t=V(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.j_)a.X_(i)&&(r=!0);s.z_=i}}r&&Mv(t)}function VF(n,e,t){let r=V(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function Mv(n){n.Y_.forEach(e=>{e.next()})}var By,XC;(XC=By||(By={})).ea="default",XC.Cache="cache";var hu=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new es(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=es.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==By.Cache}};var Uy=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var Sd=class{constructor(e){this.serializer=e}Es(e){return gn(this.serializer,e)}ds(e){return e.metadata.exists?e0(this.serializer,e.document,!1):Ge.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Ue(e)}},$y=class{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=S0(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let r=fe.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,r=new Sd(this.serializer);for(let i of e)if(i.metadata.queries){let o=r.Es(i.metadata.name);for(let s of i.metadata.queries){let a=(t.get(s)||ie()).add(o);t.set(s,a)}}return t}complete(){return N(this,null,function*(){let e=yield TF(this.localStore,new Sd(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let r of this.queries)yield CF(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function S0(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Ad=class{constructor(e){this.key=e}},xd=class{constructor(e){this.key=e}},Rd=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ie(),this.mutatedKeys=ie(),this.Aa=kb(e),this.Ra=new Cd(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new bd,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{let m=i.get(h),y=_u(this.query,p)?p:null,C=!!m&&this.mutatedKeys.has(m.key),A=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),M=!1;m&&y?m.data.isEqual(y.data)?C!==A&&(r.track({type:3,doc:y}),M=!0):this.ga(m,y)||(r.track({type:2,doc:y}),M=!0,(u&&this.Aa(y,u)>0||l&&this.Aa(y,l)<0)&&(a=!0)):!m&&y?(r.track({type:0,doc:y}),M=!0):m&&!y&&(r.track({type:1,doc:m}),M=!0,(u||l)&&(a=!0)),M&&(y?(s=s.add(y),o=A?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Ra:s,fa:r,ns:a,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let s=e.fa.G_();s.sort((h,p)=>function(y,C){let A=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H()}};return A(y)-A(C)}(h.type,p.type)||this.Aa(h.doc,p.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,l=u!==this.Ea;return this.Ea=u,s.length!==0||l?{snapshot:new es(this.query,e.Ra,o,s,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new bd,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=ie(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new xd(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Ad(r))}),t}ba(e){this.Ta=e.Ts,this.da=ie();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return es.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Hy=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},qy=class{constructor(e){this.key=e,this.va=!1}},zy=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new _n(a=>Nb(a),vu),this.Ma=new Map,this.xa=new Set,this.Oa=new Ae(j.comparator),this.Na=new Map,this.La=new cu,this.Ba={},this.ka=new Map,this.qa=Yo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function jF(n,e,t=!0){return N(this,null,function*(){let r=zd(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield A0(r,e,t,!0),i})}function BF(n,e){return N(this,null,function*(){let t=zd(n);yield A0(t,e,!0,!1)})}function A0(n,e,t,r){return N(this,null,function*(){let i=yield Zo(n.localStore,vt(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield Nv(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&qd(n.remoteStore,i),a})}function Nv(n,e,t,r,i){return N(this,null,function*(){n.Ka=(p,m,y)=>function(A,M,O,B){return N(this,null,function*(){let F=M.view.ma(O);F.ns&&(F=yield vd(A.localStore,M.query,!1).then(({documents:I})=>M.view.ma(I,F)));let W=B&&B.targetChanges.get(M.targetId),X=B&&B.targetMismatches.get(M.targetId)!=null,K=M.view.applyChanges(F,A.isPrimaryClient,W,X);return Gy(A,M.targetId,K.wa),K.snapshot})}(n,p,m,y);let o=yield vd(n.localStore,e,!0),s=new Rd(e,o.Ts),a=s.ma(o.documents),u=ou.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,u);Gy(n,t,l.wa);let h=new Hy(e,t,s);return n.Fa.set(e,h),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function UF(n,e,t){return N(this,null,function*(){let r=V(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(s=>!vu(s,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Jo(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Xo(r.remoteStore,i.targetId),ts(r,i.targetId)}).catch(xr))):(ts(r,i.targetId),yield Jo(r.localStore,i.targetId,!0))})}function $F(n,e){return N(this,null,function*(){let t=V(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Xo(t.remoteStore,r.targetId))})}function HF(n,e,t){return N(this,null,function*(){let r=Fv(n);try{let i=yield function(s,a){let u=V(s),l=Ne.now(),h=a.reduce((y,C)=>y.add(C.key),ie()),p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let C=Tt(),A=ie();return u.cs.getEntries(y,h).next(M=>{C=M,C.forEach((O,B)=>{B.isValidDocument()||(A=A.add(O))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,C)).next(M=>{p=M;let O=[];for(let B of a){let F=rF(B,p.get(B.key).overlayedDocument);F!=null&&O.push(new nn(B.key,F,Cb(F.value.mapValue),Fe.exists(!0)))}return u.mutationQueue.addMutationBatch(y,l,O,a)}).next(M=>{m=M;let O=M.applyToLocalDocumentSet(p,A);return u.documentOverlayCache.saveOverlays(y,M.batchId,O)})}).then(()=>({batchId:m.batchId,changes:Fb(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,u){let l=s.Ba[s.currentUser.toKey()];l||(l=new Ae(ne)),l=l.insert(a,u),s.Ba[s.currentUser.toKey()]=l}(r,i.batchId,t),yield Kn(r,i.changes),yield us(r.remoteStore)}catch(i){let o=ls(i,"Failed to persist write");t.reject(o)}})}function x0(n,e){return N(this,null,function*(){let t=V(n);try{let r=yield EF(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Na.get(o);s&&(q(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.va=!0:i.modifiedDocuments.size>0?q(s.va):i.removedDocuments.size>0&&(q(s.va),s.va=!1))}),yield Kn(t,r,e)}catch(r){yield xr(r)}})}function eb(n,e,t){let r=V(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,s)=>{let a=s.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let u=V(s);u.onlineState=a;let l=!1;u.queries.forEach((h,p)=>{for(let m of p.j_)m.Z_(a)&&(l=!0)}),l&&Mv(u)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function qF(n,e,t){return N(this,null,function*(){let r=V(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let s=new Ae(j.comparator);s=s.insert(o,Ge.newNoDocument(o,G.min()));let a=ie().add(o),u=new iu(G.min(),new Map,new Ae(ne),s,a);yield x0(r,u),r.Oa=r.Oa.remove(o),r.Na.delete(e),Ov(r)}else yield Jo(r.localStore,e,!1).then(()=>ts(r,e,t)).catch(xr)})}function zF(n,e){return N(this,null,function*(){let t=V(n),r=e.batch.batchId;try{let i=yield IF(t.localStore,e);kv(t,r,null),Pv(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Kn(t,i)}catch(i){yield xr(i)}})}function GF(n,e,t){return N(this,null,function*(){let r=V(n);try{let i=yield function(s,a){let u=V(s);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return u.mutationQueue.lookupMutationBatch(l,a).next(p=>(q(p!==null),h=p.keys(),u.mutationQueue.removeMutationBatch(l,p))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,h,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>u.localDocuments.getDocuments(l,h))})}(r.localStore,e);kv(r,e,t),Pv(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Kn(r,i)}catch(i){yield xr(i)}})}function WF(n,e){return N(this,null,function*(){let t=V(n);Mr(t.remoteStore)||k("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(s){let a=V(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(t.localStore);if(r===-1)return void e.resolve();let i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){let i=ls(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function Pv(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function kv(n,e,t){let r=V(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function ts(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||R0(n,r)})}function R0(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Xo(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Ov(n))}function Gy(n,e,t){for(let r of t)r instanceof Ad?(n.La.addReference(r.key,e),KF(n,r)):r instanceof xd?(k("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||R0(n,r.key)):H()}function KF(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(k("SyncEngine","New document in limbo: "+t),n.xa.add(r),Ov(n))}function Ov(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new j(fe.fromString(e)),r=n.qa.next();n.Na.set(r,new qy(t)),n.Oa=n.Oa.insert(t,r),qd(n.remoteStore,new Qo(vt(ss(t.path)),r,"TargetPurposeLimboResolution",xt.oe))}}function Kn(n,e,t){return N(this,null,function*(){let r=V(n),i=[],o=[],s=[];r.Fa.isEmpty()||(r.Fa.forEach((a,u)=>{s.push(r.Ka(u,e,t).then(l=>{var h;if((l||t)&&r.isPrimaryClient){let p=l?!l.fromCache:(h=t?.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(l){i.push(l);let p=Ty.Wi(u.targetId,l);o.push(p)}}))}),yield Promise.all(s),r.Ca.d_(i),yield function(u,l){return N(this,null,function*(){let h=V(u);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>S.forEach(l,m=>S.forEach(m.$i,y=>h.persistence.referenceDelegate.addReference(p,m.targetId,y)).next(()=>S.forEach(m.Ui,y=>h.persistence.referenceDelegate.removeReference(p,m.targetId,y)))))}catch(p){if(!Rr(p))throw p;k("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let y=h.os.get(m),C=y.snapshotVersion,A=y.withLastLimboFreeSnapshotVersion(C);h.os=h.os.insert(m,A)}}})}(r.localStore,o))})}function QF(n,e){return N(this,null,function*(){let t=V(n);if(!t.currentUser.isEqual(e)){k("SyncEngine","User change. New user:",e.toKey());let r=yield g0(t.localStore,e);t.currentUser=e,function(o,s){o.ka.forEach(a=>{a.forEach(u=>{u.reject(new P(R.CANCELLED,s))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Kn(t,r.hs)}})}function YF(n,e){let t=V(n),r=t.Na.get(e);if(r&&r.va)return ie().add(r.key);{let i=ie(),o=t.Ma.get(e);if(!o)return i;for(let s of o){let a=t.Fa.get(s);i=i.unionWith(a.view.Va)}return i}}function ZF(n,e){return N(this,null,function*(){let t=V(n),r=yield vd(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&Gy(t,e.targetId,i.wa),i})}function JF(n,e){return N(this,null,function*(){let t=V(n);return _0(t.localStore,e).then(r=>Kn(t,r))})}function XF(n,e,t,r){return N(this,null,function*(){let i=V(n),o=yield function(a,u){let l=V(a),h=V(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.Mn(p,u).next(m=>m?l.localDocuments.getDocuments(p,m):S.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?yield us(i.remoteStore):t==="acknowledged"||t==="rejected"?(kv(i,e,r||null),Pv(i,e),function(a,u){V(V(a).mutationQueue).On(u)}(i.localStore,e)):H(),yield Kn(i,o)):k("SyncEngine","Cannot apply mutation batch with id: "+e)})}function eL(n,e){return N(this,null,function*(){let t=V(n);if(zd(t),Fv(t),e===!0&&t.Qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield tb(t,r.toArray());t.Qa=!0,yield Fy(t.remoteStore,!0);for(let o of i)qd(t.remoteStore,o)}else if(e===!1&&t.Qa!==!1){let r=[],i=Promise.resolve();t.Ma.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then(()=>(ts(t,s),Jo(t.localStore,s,!0))),Xo(t.remoteStore,s)}),yield i,yield tb(t,r),function(s){let a=V(s);a.Na.forEach((u,l)=>{Xo(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new Ae(j.comparator)}(t),t.Qa=!1,yield Fy(t.remoteStore,!1)}})}function tb(n,e,t){return N(this,null,function*(){let r=V(n),i=[],o=[];for(let s of e){let a,u=r.Ma.get(s);if(u&&u.length!==0){a=yield Zo(r.localStore,vt(u[0]));for(let l of u){let h=r.Fa.get(l),p=yield ZF(r,h);p.snapshot&&o.push(p.snapshot)}}else{let l=yield v0(r.localStore,s);a=yield Zo(r.localStore,l),yield Nv(r,M0(l),s,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(o),i})}function M0(n){return Mb(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function tL(n){return function(t){return V(V(t).persistence).Qi()}(V(n).localStore)}function nL(n,e,t,r){return N(this,null,function*(){let i=V(n);if(i.Qa)return void k("SyncEngine","Ignoring unexpected query state notification.");let o=i.Ma.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield _0(i.localStore,Pb(o[0])),a=iu.createSynthesizedRemoteEventForCurrentChange(e,t==="current",$e.EMPTY_BYTE_STRING);yield Kn(i,s,a);break}case"rejected":yield Jo(i.localStore,e,!0),ts(i,e,r);break;default:H()}})}function rL(n,e,t){return N(this,null,function*(){let r=zd(n);if(r.Qa){for(let i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){k("SyncEngine","Adding an already active target "+i);continue}let o=yield v0(r.localStore,i),s=yield Zo(r.localStore,o);yield Nv(r,M0(o),s.targetId,!1,s.resumeToken),qd(r.remoteStore,s)}for(let i of t)r.Ma.has(i)&&(yield Jo(r.localStore,i,!1).then(()=>{Xo(r.remoteStore,i),ts(r,i)}).catch(xr))}})}function zd(n){let e=V(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=x0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=YF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qF.bind(null,e),e.Ca.d_=LF.bind(null,e.eventManager),e.Ca.$a=VF.bind(null,e.eventManager),e}function Fv(n){let e=V(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=GF.bind(null,e),e}function iL(n,e,t){let r=V(n);(function(o,s,a){return N(this,null,function*(){try{let u=yield s.getMetadata();if(yield function(y,C){let A=V(y),M=Ue(C.createTime);return A.persistence.runTransaction("hasNewerBundle","readonly",O=>A.Gr.getBundleMetadata(O,C.id)).then(O=>!!O&&O.createTime.compareTo(M)>=0)}(o.localStore,u))return yield s.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(S0(u));let l=new $y(u,o.localStore,s.serializer),h=yield s.Ua();for(;h;){let m=yield l.la(h);m&&a._updateProgress(m),h=yield s.Ua()}let p=yield l.complete();return yield Kn(o,p.Ia,void 0),yield function(y,C){let A=V(y);return A.persistence.runTransaction("Save bundle","readwrite",M=>A.Gr.saveBundleMetadata(M,C))}(o.localStore,u),a._completeWith(p.progress),Promise.resolve(p.Pa)}catch(u){return en("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Wy=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return N(this,null,function*(){this.serializer=wu(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return p0(this.persistence,new yd,t.initialUser,this.serializer)}Ga(t){return new gd(md.Zr,this.serializer)}Wa(t){return new Id}terminate(){return N(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var Md=class n extends Wy{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return N(this,null,function*(){yield Rh(n.prototype,this,"initialize").call(this,e),yield this.Ja.initialize(this,e),yield Fv(this.Ja.syncEngine),yield us(this.Ja.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}za(e){return p0(this.persistence,new yd,e.initialUser,this.serializer)}ja(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new uy(r,e.asyncQueue,t)}Ha(e,t){let r=new Cm(t,this.persistence);return new Tm(e.asyncQueue,r)}Ga(e){let t=Cv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ut.withCacheSize(this.cacheSizeBytes):Ut.DEFAULT;return new Dy(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,I0(),ql(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new Id}},Ky=class n extends Md{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return N(this,null,function*(){yield Rh(n.prototype,this,"initialize").call(this,e);let t=this.Ja.syncEngine;this.sharedClientState instanceof Ka&&(this.sharedClientState.syncEngine={no:XF.bind(null,t),ro:nL.bind(null,t),io:rL.bind(null,t),Qi:tL.bind(null,t),eo:JF.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(r=>N(this,null,function*(){yield eL(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}Wa(e){let t=I0();if(!Ka.D(t))throw new P(R.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=Cv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ka(t,e.asyncQueue,r,e.clientId,e.initialUser)}},Lv=(()=>{class n{initialize(t,r){return N(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>eb(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=QF.bind(null,this.syncEngine),yield Fy(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new jy}()}createDatastore(t){let r=wu(t.databaseInfo.databaseId),i=function(s){return new Ry(s)}(t.databaseInfo);return function(s,a,u,l){return new Py(s,a,u,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,s,a,u){return new Oy(i,o,s,a,u)}(this.localStore,this.datastore,t.asyncQueue,r=>eb(this.syncEngine,r,0),function(){return Ed.D()?new Ed:new Ay}())}createSyncEngine(t,r){return function(o,s,a,u,l,h,p){let m=new zy(o,s,a,u,l,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return N(this,null,function*(){var t,r;yield function(o){return N(this,null,function*(){let s=V(o);k("RemoteStore","RemoteStore shutting down."),s.L_.add(5),yield as(s),s.k_.shutdown(),s.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function nb(n,e=10240){let t=0;return{read(){return N(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return N(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var ns=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):je("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Qy=class{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new Qe,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}getMetadata(){return N(this,null,function*(){return this.metadata.promise})}Ua(){return N(this,null,function*(){return yield this.getMetadata(),this.tu()})}tu(){return N(this,null,function*(){let e=yield this.nu();if(e===null)return null;let t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);let i=yield this.iu(r);return new Uy(JSON.parse(i),e.length+r)})}su(){return this.buffer.findIndex(e=>e===123)}nu(){return N(this,null,function*(){for(;this.su()<0&&!(yield this.ou()););if(this.buffer.length===0)return null;let e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}iu(e){return N(this,null,function*(){for(;this.buffer.length<e;)(yield this.ou())&&this.ru("Reached the end of bundle when more is expected.");let t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}ou(){return N(this,null,function*(){let e=yield this.Xa.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var Yy=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return N(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new P(R.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,o){return N(this,null,function*(){let s=V(i),a={documents:o.map(p=>su(s.serializer,p))},u=yield s.Lo("BatchGetDocuments",s.serializer.databaseId,fe.emptyPath(),a,o.length),l=new Map;u.forEach(p=>{let m=cF(s.serializer,p);l.set(m.key.toString(),m)});let h=[];return o.forEach(p=>{let m=l.get(p.toString());q(!!m),h.push(m)}),h})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Sr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return N(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=j.fromPath(r);this.mutations.push(new tu(i,this.precondition(i)))}),yield function(r,i){return N(this,null,function*(){let o=V(r),s={writes:i.map(a=>au(o.serializer,a))};yield o.Mo("Commit",o.serializer.databaseId,fe.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw H();t=G.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new P(R.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(G.min())?Fe.exists(!1):Fe.updateTime(t):Fe.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(G.min()))throw new P(R.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fe.updateTime(t)}return Fe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var Zy=class{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this._u=r.maxAttempts,this.t_=new du(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(()=>N(this,null,function*(){let e=new Yy(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})}))}cu(e){try{let t=this.updateFunction(e);return!mu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Gb(t)}return!1}};var Jy=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ze.UNAUTHENTICATED,this.clientId=Gl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>N(this,null,function*(){k("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(k("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Qe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>N(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=ls(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function fm(n,e){return N(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),k("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>N(this,null,function*(){r.isEqual(i)||(yield g0(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function rb(n,e){return N(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield Vv(n);k("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>ZC(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>ZC(e.remoteStore,i)),n._onlineComponents=e})}function Vv(n){return N(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k("FirestoreClient","Using user provided OfflineComponentProvider");try{yield fm(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===R.FAILED_PRECONDITION||i.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;en("Error using user provided cache. Falling back to memory cache: "+t),yield fm(n,new Wy)}}else k("FirestoreClient","Using default OfflineComponentProvider"),yield fm(n,new Wy);return n._offlineComponents})}function Gd(n){return N(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(k("FirestoreClient","Using user provided OnlineComponentProvider"),yield rb(n,n._uninitializedComponentsProvider._online)):(k("FirestoreClient","Using default OnlineComponentProvider"),yield rb(n,new Lv))),n._onlineComponents})}function N0(n){return Vv(n).then(e=>e.persistence)}function jv(n){return Vv(n).then(e=>e.localStore)}function P0(n){return Gd(n).then(e=>e.remoteStore)}function Bv(n){return Gd(n).then(e=>e.syncEngine)}function oL(n){return Gd(n).then(e=>e.datastore)}function rs(n){return N(this,null,function*(){let e=yield Gd(n),t=e.eventManager;return t.onListen=jF.bind(null,e.syncEngine),t.onUnlisten=UF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=BF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=$F.bind(null,e.syncEngine),t})}function sL(n){return n.asyncQueue.enqueue(()=>N(this,null,function*(){let e=yield N0(n),t=yield P0(n);return e.setNetworkEnabled(!0),function(i){let o=V(i);return o.L_.delete(0),Iu(o)}(t)}))}function aL(n){return n.asyncQueue.enqueue(()=>N(this,null,function*(){let e=yield N0(n),t=yield P0(n);return e.setNetworkEnabled(!1),function(i){return N(this,null,function*(){let o=V(i);o.L_.add(0),yield as(o),o.q_.set("Offline")})}(t)}))}function uL(n,e){let t=new Qe;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,o,s){return N(this,null,function*(){try{let a=yield function(l,h){let p=V(l);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,h))}(i,o);a.isFoundDocument()?s.resolve(a):a.isNoDocument()?s.resolve(null):s.reject(new P(R.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=ls(a,`Failed to get document '${o} from cache`);s.reject(u)}})}(yield jv(n),e,t)})),t.promise}function k0(n,e,t={}){let r=new Qe;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(o,s,a,u,l){let h=new ns({next:m=>{h.Za(),s.enqueueAndForget(()=>Rv(o,p));let y=m.docs.has(a);!y&&m.fromCache?l.reject(new P(R.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&u&&u.source==="server"?l.reject(new P(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new hu(ss(a.path),h,{includeMetadataChanges:!0,_a:!0});return xv(o,p)}(yield rs(n),n.asyncQueue,e,t,r)})),r.promise}function cL(n,e){let t=new Qe;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,o,s){return N(this,null,function*(){try{let a=yield vd(i,o,!0),u=new Rd(o,a.Ts),l=u.ma(a.documents),h=u.applyChanges(l,!1);s.resolve(h.snapshot)}catch(a){let u=ls(a,`Failed to execute query '${o} against cache`);s.reject(u)}})}(yield jv(n),e,t)})),t.promise}function O0(n,e,t={}){let r=new Qe;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(o,s,a,u,l){let h=new ns({next:m=>{h.Za(),s.enqueueAndForget(()=>Rv(o,p)),m.fromCache&&u.source==="server"?l.reject(new P(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new hu(a,h,{includeMetadataChanges:!0,_a:!0});return xv(o,p)}(yield rs(n),n.asyncQueue,e,t,r)})),r.promise}function lL(n,e){let t=new ns(e);return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,o){V(i).Y_.add(o),o.next()}(yield rs(n),t)})),()=>{t.Za(),n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,o){V(i).Y_.delete(o)}(yield rs(n),t)}))}}function dL(n,e,t,r){let i=function(s,a){let u;return u=typeof s=="string"?Kb().encode(s):s,function(h,p){return new Qy(h,p)}(function(h,p){if(h instanceof Uint8Array)return nb(h,p);if(h instanceof ArrayBuffer)return nb(new Uint8Array(h),p);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(t,wu(e));n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){iL(yield Bv(n),i,r)}))}function hL(n,e){return n.asyncQueue.enqueue(()=>N(this,null,function*(){return function(r,i){let o=V(r);return o.persistence.runTransaction("Get named query","readonly",s=>o.Gr.getNamedQuery(s,i))}(yield jv(n),e)}))}function F0(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var ib=new Map;function Uv(n,e,t){if(!t)throw new P(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function $v(n,e,t,r){if(e===!0&&r===!0)throw new P(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function ob(n){if(!j.isDocumentKey(n))throw new P(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function sb(n){if(j.isDocumentKey(n))throw new P(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Wd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":H()}function ge(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new P(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Wd(n);throw new P(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function L0(n,e){if(e<=0)throw new P(R.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Nd=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new P(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$v("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=F0((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new P(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new P(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new P(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ii=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nd({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new P(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new P(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nd(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new pm;switch(r.type){case"firstParty":return new vm(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new P(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return N(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=ib.get(t);r&&(k("ComponentProvider","Removing Datastore"),ib.delete(t),r.terminate())}(this),Promise.resolve()}};function V0(n,e,t,r={}){var i;let o=(n=ge(n,Ii))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&en("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=ze.MOCK_USER;else{a=mw(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new P(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new ze(l)}n._authCredentials=new gm(new zl(a,u))}}var tt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ce=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},mn=class n extends tt{constructor(e,t,r){super(e,t,ss(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ce(this.firestore,null,new j(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Hv(n,e,...t){if(n=Re(n),Uv("collection","path",e),n instanceof Ii){let r=fe.fromString(e,...t);return sb(r),new mn(n,null,r)}{if(!(n instanceof Ce||n instanceof mn))throw new P(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(fe.fromString(e,...t));return sb(r),new mn(n.firestore,null,r)}}function j0(n,e){if(n=ge(n,Ii),Uv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(R.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new tt(n,null,function(r){return new tn(fe.emptyPath(),r)}(e))}function Eu(n,e,...t){if(n=Re(n),arguments.length===1&&(e=Gl.newId()),Uv("doc","path",e),n instanceof Ii){let r=fe.fromString(e,...t);return ob(r),new Ce(n,null,new j(r))}{if(!(n instanceof Ce||n instanceof mn))throw new P(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(fe.fromString(e,...t));return ob(r),new Ce(n.firestore,n instanceof mn?n.converter:null,new j(r))}}function qv(n,e){return n=Re(n),e=Re(e),(n instanceof Ce||n instanceof mn)&&(e instanceof Ce||e instanceof mn)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function zv(n,e){return n=Re(n),e=Re(e),n instanceof tt&&e instanceof tt&&n.firestore===e.firestore&&vu(n._query,e._query)&&n.converter===e.converter}var Pd=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new du(this,"async_queue_retry"),this.Vu=()=>{let r=ql();r&&k("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=ql();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=ql();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new Qe;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return N(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Rr(e))throw e;k("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw je("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=Ly.createAndSchedule(this,e,t,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&H()}verifyOperationInProgress(){}wu(){return N(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function Xy(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var ev=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Qe,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var B0=-1,Pe=class extends Ii{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Pd,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return N(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Pd(e),this._firestoreClient=void 0,yield e}})}};function nt(n){if(n._terminated)throw new P(R.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||U0(n),n._firestoreClient}function U0(n){var e,t,r;let i=n._freezeSettings(),o=function(a,u,l,h){return new bm(a,u,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,F0(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Jy(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){let u=a?._online.build();return{_offline:a?._offline.build(u),_online:u}}(n._componentsProvider))}function $0(n,e){en("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return q0(n,Lv.provider,{build:r=>new Md(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function H0(n){return N(this,null,function*(){en("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();q0(n,Lv.provider,{build:t=>new Ky(t,e.cacheSizeBytes)})})}function q0(n,e,t){if((n=ge(n,Pe))._firestoreClient||n._terminated)throw new P(R.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new P(R.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},U0(n)}function z0(n){if(n._initialized&&!n._terminated)throw new P(R.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Qe;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>N(this,null,function*(){try{yield function(r){return N(this,null,function*(){if(!wr.D())return Promise.resolve();let i=r+"main";yield wr.delete(i)})}(Cv(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function G0(n){return function(t){let r=new Qe;return t.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return WF(yield Bv(t),r)})),r.promise}(nt(n=ge(n,Pe)))}function W0(n){return sL(nt(n=ge(n,Pe)))}function K0(n){return aL(nt(n=ge(n,Pe)))}function Q0(n,e){let t=nt(n=ge(n,Pe)),r=new ev;return dL(t,n._databaseId,e,r),r}function Y0(n,e){return hL(nt(n=ge(n,Pe)),e).then(t=>t?new tt(n,null,t.query):null)}var wn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n($e.fromBase64String(e))}catch(t){throw new P(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n($e.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var rn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new P(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Be(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Gn=class{constructor(e){this._methodName=e}};var Ei=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new P(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new P(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}};var fu=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var fL=/^__.*__$/,tv=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new nn(e,this.data,this.fieldMask,t,this.fieldTransforms):new br(e,this.data,t,this.fieldTransforms)}},kd=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new nn(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function Z0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H()}}var Od=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Fd(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Z0(this.Cu)&&fL.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},nv=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||wu(e)}Qu(e,t,r,i=!1){return new Od({Cu:e,methodName:t,qu:r,path:Be.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function bi(n){let e=n._freezeSettings(),t=wu(n._databaseId);return new nv(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Kd(n,e,t,r,i,o={}){let s=n.Qu(o.merge||o.mergeFields?2:0,e,t,i);Kv("Data must be an object, but it was:",s,r);let a=eS(r,s),u,l;if(o.merge)u=new Rt(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){let h=[];for(let p of o.mergeFields){let m=av(e,p,t);if(!s.contains(m))throw new P(R.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);nS(h,m)||h.push(m)}u=new Rt(h),l=s.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,l=s.fieldTransforms;return new tv(new ct(a),u,l)}var pu=class n extends Gn{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function J0(n,e,t){return new Od({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var rv=class n extends Gn{_toFieldTransform(e){return new vi(e.path,new Tr)}isEqual(e){return e instanceof n}},iv=class n extends Gn{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=J0(this,e,!0),r=this.Ku.map(o=>Si(o,t)),i=new qn(r);return new vi(e.path,i)}isEqual(e){return e instanceof n&&Ph(this.Ku,e.Ku)}},ov=class n extends Gn{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=J0(this,e,!0),r=this.Ku.map(o=>Si(o,t)),i=new zn(r);return new vi(e.path,i)}isEqual(e){return e instanceof n&&Ph(this.Ku,e.Ku)}},sv=class n extends Gn{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){let t=new Cr(e.serializer,jb(e.serializer,this.$u));return new vi(e.path,t)}isEqual(e){return e instanceof n&&this.$u===e.$u}};function Gv(n,e,t,r){let i=n.Qu(1,e,t);Kv("Data must be an object, but it was:",i,r);let o=[],s=ct.empty();Ci(r,(u,l)=>{let h=Qv(e,u,t);l=Re(l);let p=i.Nu(h);if(l instanceof pu)o.push(h);else{let m=Si(l,p);m!=null&&(o.push(h),s.set(h,m))}});let a=new Rt(o);return new kd(s,a,i.fieldTransforms)}function Wv(n,e,t,r,i,o){let s=n.Qu(1,e,t),a=[av(e,r,t)],u=[i];if(o.length%2!=0)throw new P(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<o.length;m+=2)a.push(av(e,o[m])),u.push(o[m+1]);let l=[],h=ct.empty();for(let m=a.length-1;m>=0;--m)if(!nS(l,a[m])){let y=a[m],C=u[m];C=Re(C);let A=s.Nu(y);if(C instanceof pu)l.push(y);else{let M=Si(C,A);M!=null&&(l.push(y),h.set(y,M))}}let p=new Rt(l);return new kd(h,p,s.fieldTransforms)}function X0(n,e,t,r=!1){return Si(t,n.Qu(r?4:3,e))}function Si(n,e){if(tS(n=Re(n)))return Kv("Unsupported field value:",e,n),eS(n,e);if(n instanceof Gn)return function(r,i){if(!Z0(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let u=Si(a,i.Lu(s));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Re(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return jb(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Ne.fromDate(r);return{timestampValue:Ko(i.serializer,o)}}if(r instanceof Ne){let o=new Ne(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ko(i.serializer,o)}}if(r instanceof Ei)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof wn)return{bytesValue:Qb(i.serializer,r._byteString)};if(r instanceof Ce){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Bu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Ev(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof fu)return function(s,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(u=>{if(typeof u!="number")throw a.Bu("VectorValues must only contain numeric values.");return Iv(a.serializer,u)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Wd(r)}`)}(n,e)}function eS(n,e){let t={};return Ib(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ci(n,(r,i)=>{let o=Si(i,e.Mu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function tS(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ne||n instanceof Ei||n instanceof wn||n instanceof Ce||n instanceof Gn||n instanceof fu)}function Kv(n,e,t){if(!tS(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Wd(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function av(n,e,t){if((e=Re(e))instanceof rn)return e._internalPath;if(typeof e=="string")return Qv(n,e);throw Fd("Field path arguments must be of type string or ",n,!1,void 0,t)}var pL=new RegExp("[~\\*/\\[\\]]");function Qv(n,e,t){if(e.search(pL)>=0)throw Fd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new rn(...e.split("."))._internalPath}catch{throw Fd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Fd(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(o||s)&&(u+=" (found",o&&(u+=` in field ${r}`),s&&(u+=` in document ${i}`),u+=")"),new P(R.INVALID_ARGUMENT,a+n+u)}function nS(n,e){return n.some(t=>t.isEqual(e))}var Di=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ce(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new uv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Qd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},uv=class extends Di{data(){return super.data()}};function Qd(n,e){return typeof e=="string"?Qv(n,e):e instanceof rn?e._internalPath:e._delegate._internalPath}function rS(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new P(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var gu=class{},Ti=class extends gu{};function Qn(n,e,...t){let r=[];e instanceof gu&&r.push(e),r=r.concat(t),function(o){let s=o.filter(u=>u instanceof cv).length,a=o.filter(u=>u instanceof Ld).length;if(s>1||s>0&&a>0)throw new P(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Ld=class n extends Ti{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return fS(e._query,t),new tt(e.firestore,e.converter,jm(e._query,t))}_parse(e){let t=bi(e.firestore);return function(o,s,a,u,l,h,p){let m;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new P(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){ub(p,h);let y=[];for(let C of p)y.push(ab(u,o,C));m={arrayValue:{values:y}}}else m=ab(u,o,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||ub(p,h),m=X0(a,s,p,h==="in"||h==="not-in");return le.create(l,h,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function iS(n,e,t){let r=e,i=Qd("where",n);return Ld._create(i,r,t)}var cv=class n extends gu{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:we.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let u of a)fS(s,u),s=jm(s,u)}(e._query,t),new tt(e.firestore,e.converter,jm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var lv=class n extends Ti{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new P(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new P(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new mi(o,s)}(e._query,this._field,this._direction);return new tt(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new tn(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function oS(n,e="asc"){let t=e,r=Qd("orderBy",n);return lv._create(r,t)}var Vd=class n extends Ti{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new tt(e.firestore,e.converter,nd(e._query,this._limit,this._limitType))}};function sS(n){return L0("limit",n),Vd._create("limit",n,"F")}function aS(n){return L0("limitToLast",n),Vd._create("limitToLast",n,"L")}var jd=class n extends Ti{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=hS(e,this.type,this._docOrFields,this._inclusive);return new tt(e.firestore,e.converter,function(i,o){return new tn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}};function uS(...n){return jd._create("startAt",n,!0)}function cS(...n){return jd._create("startAfter",n,!1)}var Bd=class n extends Ti{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=hS(e,this.type,this._docOrFields,this._inclusive);return new tt(e.firestore,e.converter,function(i,o){return new tn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}};function lS(...n){return Bd._create("endBefore",n,!1)}function dS(...n){return Bd._create("endAt",n,!0)}function hS(n,e,t,r){if(t[0]=Re(t[0]),t[0]instanceof Di)return function(o,s,a,u,l){if(!u)throw new P(R.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let h=[];for(let p of Bo(o))if(p.field.isKeyField())h.push(gi(s,u.key));else{let m=u.data.field(p.field);if($d(m))throw new P(R.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let y=p.field.canonicalString();throw new P(R.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}h.push(m)}return new vn(h,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=bi(n.firestore);return function(s,a,u,l,h,p){let m=s.explicitOrderBy;if(h.length>m.length)throw new P(R.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let y=[];for(let C=0;C<h.length;C++){let A=h[C];if(m[C].field.isKeyField()){if(typeof A!="string")throw new P(R.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof A}`);if(!_v(s)&&A.indexOf("/")!==-1)throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${A}' contains a slash.`);let M=s.path.child(fe.fromString(A));if(!j.isDocumentKey(M))throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${M}' is not because it contains an odd number of segments.`);let O=new j(M);y.push(gi(a,O))}else{let M=X0(u,l,A);y.push(M)}}return new vn(y,p)}(n._query,n.firestore._databaseId,i,e,t,r)}}function ab(n,e,t){if(typeof(t=Re(t))=="string"){if(t==="")throw new P(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_v(e)&&t.indexOf("/")!==-1)throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(fe.fromString(t));if(!j.isDocumentKey(r))throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return gi(n,new j(r))}if(t instanceof Ce)return gi(n,t._key);throw new P(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wd(t)}.`)}function ub(n,e){if(!Array.isArray(n)||n.length===0)throw new P(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function fS(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new P(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var is=class{convertValue(e,t="none"){switch(pi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ir(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw H()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Ci(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>xe(s.doubleValue));return new fu(o)}convertGeoPoint(e){return new Ei(xe(e.latitude),xe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=yv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ja(e));default:return null}}convertTimestamp(e){let t=Hn(e);return new Ne(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=fe.fromString(e);q(s0(r));let i=new Er(r.get(1),r.get(3)),o=new j(r.popFirst(5));return i.isEqual(t)||je(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function Yd(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var dv=class extends is{constructor(e){super(),this.firestore=e}convertBytes(e){return new wn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ce(this.firestore,null,t)}};var $n=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ht=class extends Di{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new vr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Qd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},vr=class extends Ht{data(e={}){return super.data(e)}},on=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new $n(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new vr(this._firestore,this._userDataWriter,r.key,r,new $n(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new P(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let u=new vr(i._firestore,i._userDataWriter,a.doc.key,a.doc,new $n(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let u=new vr(i._firestore,i._userDataWriter,a.doc.key,a.doc,new $n(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,h=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:gL(a.type),doc:u,oldIndex:l,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function gL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H()}}function Yv(n,e){return n instanceof Ht&&e instanceof Ht?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof on&&e instanceof on&&n._firestore===e._firestore&&zv(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function pS(n){n=ge(n,Ce);let e=ge(n.firestore,Pe);return k0(nt(e),n._key).then(t=>e_(e,n,t))}var Wn=class extends is{constructor(e){super(),this.firestore=e}convertBytes(e){return new wn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ce(this.firestore,null,t)}};function gS(n){n=ge(n,Ce);let e=ge(n.firestore,Pe),t=nt(e),r=new Wn(e);return uL(t,n._key).then(i=>new Ht(e,r,n._key,i,new $n(i!==null&&i.hasLocalMutations,!0),n.converter))}function mS(n){n=ge(n,Ce);let e=ge(n.firestore,Pe);return k0(nt(e),n._key,{source:"server"}).then(t=>e_(e,n,t))}function yS(n){n=ge(n,tt);let e=ge(n.firestore,Pe),t=nt(e),r=new Wn(e);return rS(n._query),O0(t,n._query).then(i=>new on(e,r,n,i))}function vS(n){n=ge(n,tt);let e=ge(n.firestore,Pe),t=nt(e),r=new Wn(e);return cL(t,n._query).then(i=>new on(e,r,n,i))}function _S(n){n=ge(n,tt);let e=ge(n.firestore,Pe),t=nt(e),r=new Wn(e);return O0(t,n._query,{source:"server"}).then(i=>new on(e,r,n,i))}function Zv(n,e,t){n=ge(n,Ce);let r=ge(n.firestore,Pe),i=Yd(n.converter,e,t);return ds(r,[Kd(bi(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Fe.none())])}function Jv(n,e,t,...r){n=ge(n,Ce);let i=ge(n.firestore,Pe),o=bi(i),s;return s=typeof(e=Re(e))=="string"||e instanceof rn?Wv(o,"updateDoc",n._key,e,t,r):Gv(o,"updateDoc",n._key,e),ds(i,[s.toMutation(n._key,Fe.exists(!0))])}function wS(n){return ds(ge(n.firestore,Pe),[new Sr(n._key,Fe.none())])}function IS(n,e){let t=ge(n.firestore,Pe),r=Eu(n),i=Yd(n.converter,e);return ds(t,[Kd(bi(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Fe.exists(!1))]).then(()=>r)}function Xv(n,...e){var t,r,i;n=Re(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Xy(e[s])||(o=e[s],s++);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Xy(e[s])){let p=e[s];e[s]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[s+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[s+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let u,l,h;if(n instanceof Ce)l=ge(n.firestore,Pe),h=ss(n._key.path),u={next:p=>{e[s]&&e[s](e_(l,n,p))},error:e[s+1],complete:e[s+2]};else{let p=ge(n,tt);l=ge(p.firestore,Pe),h=p._query;let m=new Wn(l);u={next:y=>{e[s]&&e[s](new on(l,m,p,y))},error:e[s+1],complete:e[s+2]},rS(n._query)}return function(m,y,C,A){let M=new ns(A),O=new hu(y,M,C);return m.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return xv(yield rs(m),O)})),()=>{M.Za(),m.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return Rv(yield rs(m),O)}))}}(nt(l),h,a,u)}function ES(n,e){return lL(nt(n=ge(n,Pe)),Xy(e)?e:{next:e})}function ds(n,e){return function(r,i){let o=new Qe;return r.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return HF(yield Bv(r),i,o)})),o.promise}(nt(n),e)}function e_(n,e,t){let r=t.docs.get(e._key),i=new Wn(n);return new Ht(n,i,e._key,r,new $n(t.hasPendingWrites,t.fromCache),e.converter)}var mL={maxAttempts:5};var Ud=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=bi(e)}set(e,t,r){this._verifyNotCommitted();let i=mr(e,this._firestore),o=Yd(i.converter,t,r),s=Kd(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,Fe.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let o=mr(e,this._firestore),s;return s=typeof(t=Re(t))=="string"||t instanceof rn?Wv(this._dataReader,"WriteBatch.update",o._key,t,r,i):Gv(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,Fe.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=mr(e,this._firestore);return this._mutations=this._mutations.concat(new Sr(t._key,Fe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new P(R.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function mr(n,e){if((n=Re(n)).firestore!==e)throw new P(R.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var hv=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=bi(t)}get(t){let r=mr(t,this._firestore),i=new dv(this._firestore);return this._transaction.lookup([r._key]).then(o=>{if(!o||o.length!==1)return H();let s=o[0];if(s.isFoundDocument())return new Di(this._firestore,i,s.key,s,r.converter);if(s.isNoDocument())return new Di(this._firestore,i,r._key,null,r.converter);throw H()})}set(t,r,i){let o=mr(t,this._firestore),s=Yd(o.converter,r,i),a=Kd(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,i);return this._transaction.set(o._key,a),this}update(t,r,i,...o){let s=mr(t,this._firestore),a;return a=typeof(r=Re(r))=="string"||r instanceof rn?Wv(this._dataReader,"Transaction.update",s._key,r,i,o):Gv(this._dataReader,"Transaction.update",s._key,r),this._transaction.update(s._key,a),this}delete(t){let r=mr(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=mr(e,this._firestore),r=new Wn(this._firestore);return super.get(e).then(i=>new Ht(this._firestore,r,t._key,i._document,new $n(!1,!1),t.converter))}};function DS(n,e,t){n=ge(n,Pe);let r=Object.assign(Object.assign({},mL),t);return function(o){if(o.maxAttempts<1)throw new P(R.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,s,a){let u=new Qe;return o.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){let l=yield oL(o);new Zy(o.asyncQueue,l,a,s,u).au()})),u.promise}(nt(n),i=>e(new hv(n,i)),r)}function TS(){return new pu("deleteField")}function CS(){return new rv("serverTimestamp")}function bS(...n){return new iv("arrayUnion",n)}function SS(...n){return new ov("arrayRemove",n)}function AS(n){return new sv("increment",n)}(function(e,t=!0){(function(i){os=i})(_w),Os(new Fr("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new Pe(new mm(r.getProvider("auth-internal")),new wm(r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new P(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Er(l.options.projectId,h)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),er(sC,"4.7.3",e),er(sC,"4.7.3","esm2017")})();var yL="@firebase/firestore-compat",vL="0.3.38";function s_(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function xS(){if(typeof Uint8Array>"u")throw new P("unimplemented","Uint8Arrays are not available in this environment.")}function RS(){if(!Eb())throw new P("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Zd=class n{constructor(e){this._delegate=e}static fromBase64String(e){return RS(),new n(wn.fromBase64String(e))}static fromUint8Array(e){return xS(),new n(wn.fromUint8Array(e))}toBase64(){return RS(),this._delegate.toBase64()}toUint8Array(){return xS(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function t_(n){return _L(n,["next","error","complete"])}function _L(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var n_=class{enableIndexedDbPersistence(e,t){return $0(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return H0(e._delegate)}clearIndexedDbPersistence(e){return z0(e._delegate)}},Jd=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Er||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&en("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){V0(this._delegate,e,t,r)}enableNetwork(){return W0(this._delegate)}disableNetwork(){return K0(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,$v("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return G0(this._delegate)}onSnapshotsInSync(e){return ES(this._delegate,e)}get app(){if(!this._appCompat)throw new P("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ps(this,Hv(this._delegate,e))}catch(t){throw _t(t,"collection()","Firestore.collection()")}}doc(e){try{return new In(this,Eu(this._delegate,e))}catch(t){throw _t(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Mi(this,j0(this._delegate,e))}catch(t){throw _t(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return DS(this._delegate,t=>e(new Xd(this,t)))}batch(){return nt(this._delegate),new eh(new Ud(this._delegate,e=>ds(this._delegate,e)))}loadBundle(e){return Q0(this._delegate,e)}namedQuery(e){return Y0(this._delegate,e).then(t=>t?new Mi(this,t):null)}},hs=class extends is{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zd(new wn(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return In.forKey(t,this.firestore,null)}};function wL(n){cb(n)}var Xd=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new hs(e)}get(e){let t=Ai(e);return this._delegate.get(t).then(r=>new xi(this._firestore,new Ht(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Ai(e);return r?(s_("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=Ai(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=Ai(e);return this._delegate.delete(t),this}},eh=class{constructor(e){this._delegate=e}set(e,t,r){let i=Ai(e);return r?(s_("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=Ai(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=Ai(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},fs=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new vr(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ri(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let o=i.get(t);return o||(o=new n(e,new hs(e),t),i.set(t,o)),o}};fs.INSTANCES=new WeakMap;var In=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new hs(e)}static forPath(e,t,r){if(e.length%2!==0)throw new P("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new Ce(t._delegate,r,new j(e)))}static forKey(e,t,r){return new n(t,new Ce(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ps(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ps(this.firestore,Hv(this._delegate,e))}catch(t){throw _t(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Re(e),e instanceof Ce?qv(this._delegate,e):!1}set(e,t){t=s_("DocumentReference.set",t);try{return t?Zv(this._delegate,e,t):Zv(this._delegate,e)}catch(r){throw _t(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?Jv(this._delegate,e):Jv(this._delegate,e,t,...r)}catch(i){throw _t(i,"updateDoc()","DocumentReference.update()")}}delete(){return wS(this._delegate)}onSnapshot(...e){let t=MS(e),r=NS(e,i=>new xi(this.firestore,new Ht(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Xv(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=gS(this._delegate):e?.source==="server"?t=mS(this._delegate):t=pS(this._delegate),t.then(r=>new xi(this.firestore,new Ht(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(fs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function _t(n,e,t){return n.message=n.message.replace(e,t),n}function MS(n){for(let e of n)if(typeof e=="object"&&!t_(e))return e;return{}}function NS(n,e){var t,r;let i;return t_(n[0])?i=n[0]:t_(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:o=>{i.next&&i.next(e(o))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var xi=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new In(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Yv(this._delegate,e._delegate)}},Ri=class extends xi{data(e){let t=this._delegate.data(e);return this._delegate._converter||lb(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Mi=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new hs(e)}where(e,t,r){try{return new n(this.firestore,Qn(this._delegate,iS(e,t,r)))}catch(i){throw _t(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Qn(this._delegate,oS(e,t)))}catch(r){throw _t(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Qn(this._delegate,sS(e)))}catch(t){throw _t(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Qn(this._delegate,aS(e)))}catch(t){throw _t(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Qn(this._delegate,uS(...e)))}catch(t){throw _t(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Qn(this._delegate,cS(...e)))}catch(t){throw _t(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Qn(this._delegate,lS(...e)))}catch(t){throw _t(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Qn(this._delegate,dS(...e)))}catch(t){throw _t(t,"endAt()","Query.endAt()")}}isEqual(e){return zv(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=vS(this._delegate):e?.source==="server"?t=_S(this._delegate):t=yS(this._delegate),t.then(r=>new Du(this.firestore,new on(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=MS(e),r=NS(e,i=>new Du(this.firestore,new on(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Xv(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(fs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},r_=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ri(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Du=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Mi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Ri(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new r_(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Ri(this._firestore,r))})}isEqual(e){return Yv(this._delegate,e._delegate)}},ps=class n extends Mi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new In(this.firestore,e):null}doc(e){try{return e===void 0?new In(this.firestore,Eu(this._delegate)):new In(this.firestore,Eu(this._delegate,e))}catch(t){throw _t(t,"doc()","CollectionReference.doc()")}}add(e){return IS(this._delegate,e).then(t=>new In(this.firestore,t))}isEqual(e){return qv(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(fs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Ai(n){return ge(n,Ce)}var i_=class n{constructor(...e){this._delegate=new rn(...e)}static documentId(){return new n(Be.keyField().canonicalString())}isEqual(e){return e=Re(e),e instanceof rn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var o_=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=CS();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=TS();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=bS(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=SS(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=AS(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var IL={Firestore:Jd,GeoPoint:Ei,Timestamp:Ne,Blob:Zd,Transaction:Xd,WriteBatch:eh,DocumentReference:In,DocumentSnapshot:xi,Query:Mi,QueryDocumentSnapshot:Ri,QuerySnapshot:Du,CollectionReference:ps,FieldPath:i_,FieldValue:o_,setLogLevel:wL,CACHE_SIZE_UNLIMITED:B0};function EL(n,e){n.INTERNAL.registerComponent(new Fr("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},IL)))}function DL(n){EL(n,(e,t)=>new Jd(e,t,new n_)),n.registerVersion(yL,vL)}DL(wt);function TL(n,e=js){return new de(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function PS(n,e){return TL(n,e)}function CL(n,e){return PS(n,e).pipe(Ur(void 0),$s(),Z(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function c_(n,e){return PS(n,e).pipe(Z(t=>({payload:t,type:"query"})))}var th=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:o}=VS(r,t);return new rh(i,o,this.afs)}snapshotChanges(){return CL(this.ref,this.afs.schedulers.outsideAngular).pipe(Dt)}valueChanges(e={}){return this.snapshotChanges().pipe(Z(({payload:t})=>e.idField?Se(z({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return _e(this.ref.get(e)).pipe(Dt)}};function nh(n,e){return c_(n,e).pipe(Ur(void 0),$s(),Z(t=>{let[r,i]=t,o=i.payload.docChanges(),s=o.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let l=o.find(p=>p.doc.ref.isEqual(a.ref)),h=r?.payload.docs.find(p=>p.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&h&&JSON.stringify(h.metadata)===JSON.stringify(a.metadata)||s.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),s}))}function kS(n,e,t){return nh(n,t).pipe(Br((r,i)=>bL(r,i.map(o=>o.payload),e),[]),rf(),Z(r=>r.map(i=>({type:i.type,payload:i}))))}function bL(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=SL(n,r))}),n}function a_(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function SL(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return a_(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return a_(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return a_(n,e.oldIndex,1);break}return n}function OS(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var rh=class{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=nh(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Z(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Ur(void 0),$s(),at(([r,i])=>i.length>0||!r),Z(([,r])=>r),Dt)}auditTrail(e){return this.stateChanges(e).pipe(Br((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=OS(e);return kS(this.query,t,this.afs.schedulers.outsideAngular).pipe(Dt)}valueChanges(e={}){return c_(this.query,this.afs.schedulers.outsideAngular).pipe(Z(t=>t.payload.docs.map(r=>e.idField?Se(z({},r.data()),{[e.idField]:r.id}):r.data())),Dt)}get(e){return _e(this.query.get(e)).pipe(Dt)}add(e){return this.ref.add(e)}doc(e){return new th(this.ref.doc(e),this.afs)}},u_=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?nh(this.query,this.afs.schedulers.outsideAngular).pipe(Dt):nh(this.query,this.afs.schedulers.outsideAngular).pipe(Z(t=>t.filter(r=>e.indexOf(r.type)>-1)),at(t=>t.length>0),Dt)}auditTrail(e){return this.stateChanges(e).pipe(Br((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=OS(e);return kS(this.query,t,this.afs.schedulers.outsideAngular).pipe(Dt)}valueChanges(e={}){return c_(this.query,this.afs.schedulers.outsideAngular).pipe(Z(r=>r.payload.docs.map(i=>e.idField?z({[e.idField]:i.id},i.data()):i.data())),Dt)}get(e){return _e(this.query.get(e)).pipe(Dt)}},FS=new Q("angularfire2.enableFirestorePersistence"),LS=new Q("angularfire2.firestore.persistenceSettings"),AL=new Q("angularfire2.firestore.settings"),xL=new Q("angularfire2.firestore.use-emulator");function VS(n,e=t=>t){return{query:e(n),ref:n}}var l_=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,o,s,a,u,l,h,p,m,y,C,A,M,O,B){this.schedulers=u;let F=Fa(t,a,r),W=h;p&&nm(F,a,m,C,A,M,y,O),[this.firestore,this.persistenceEnabled$]=Pl(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let X=a.runOutsideAngular(()=>F.firestore());if(o&&X.settings(o),W&&X.useEmulator(...W),i&&!ei(s)){let K=()=>{try{return _e(X.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),Y(!1)}};return[X,a.runOutsideAngular(K)]}else return[X,Y(!1)]},[o,W,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:o,query:s}=VS(i,r),a=this.schedulers.ngZone.run(()=>o);return new rh(a,s,this)}collectionGroup(t,r){let i=r||(s=>s),o=this.firestore.collectionGroup(t);return new u_(i(o),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.schedulers.ngZone.run(()=>r);return new th(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)($(bo),$(So,8),$(FS,8),$(AL,8),$(Vt),$(Ee),$(Rl),$(LS,8),$(xL,8),$(rC,8),$(Yg,8),$(Zg,8),$(Jg,8),$(Xg,8),$(em,8),$(tm,8),$(oi,8))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),jS=(()=>{class n{constructor(){wt.registerVersion("angularfire",Co.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:FS,useValue:!0},{provide:LS,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Nn({type:n});static \u0275inj=Mn({providers:[l_]})}return n})();var BS=[];var US={production:!1,firebaseConfig:{apiKey:"AIzaSyAYtj6yb97NevfWKPKMCM00tIffPfexTmY",authDomain:"study-platform-4a2ba.firebaseapp.com",projectId:"study-platform-4a2ba",storageBucket:"study-platform-4a2ba.firebasestorage.app",messagingSenderId:"685861735336",appId:"1:685861735336:web:2fe57826d8b92d1355ab9d",measurementId:"G-7J8J9NJTFX"}};var $S={providers:[BT(BS),cp([jS,nC.initializeApp(US.firebaseConfig)])]};function RL(n,e){if(n&1&&(la(0,"div"),jp(1),da(),lo(2,"br")),n&2){let t=e.$implicit;Np(),Bp(" ",t.name," ",t.subjectType," ")}}var ih=class n{_client=U(l_);getSubjects(){return this._client.collection("subjects").valueChanges()}subjects$=this.getSubjects();static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Gc({type:n,selectors:[["app-root"]],standalone:!0,features:[sl],decls:6,vars:2,template:function(t,r){t&1&&(lo(0,"router-outlet"),la(1,"div"),jp(2,"Hello"),da(),xD(3,RL,3,2,null,null,AD),MD(5,"async")),t&2&&(Np(3),RD(ND(5,0,r.subjects$)))},dependencies:[Fg,Qp,WD]})};nT(ih,$S).catch(n=>console.error(n));
